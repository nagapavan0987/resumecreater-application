(this.webpackJsonpRhyme=this.webpackJsonpRhyme||[]).push([[4,2],{1045:function(e,t,r){"use strict";var n,o,a,i,s,c,l,p,u,d,h,m,f=r(4),y=r(1064),v=r(90),b=r(5),g=r(11),O=r(30),k=r(28),C=r(29),w=(r(1299),r(91)),j=r.n(w),E=(r(1300),r(1150)),_=r(1071),S=r(291),D=function e(){Object(b.a)(this,e)},P=(n=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(O.a)(this,Object(k.a)(t).call(this,e)))._input=void 0,r._keyEventCb=void 0,r._docClickCb=void 0,r._inputBlurEvent=void 0,r._clickFlag=void 0,r.state={filtered:[],highlighted:null,focused:!1,disabledFiltering:!1},r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.showSuggestions){var t=this.props.showSuggestions?this._input.value:"";this._performFiltering(t)}}},{key:"onChange",value:function(e){if(!this.state.disabledFiltering){var t=e.target.value;this._performFiltering(t)}this.props.onChange(e)}},{key:"onClick",value:function(e){e.stopPropagation(),this._clickFlag=!0}},{key:"onFocus",value:function(e){this.setState({focused:!0,disabledFiltering:!1}),this.props.onFocus(e)}},{key:"selectOption",value:function(e){this._clickFlag=!0;var t=e.target.getAttribute("data-sugg");this._applyOption(t)}},{key:"resetFocus",value:function(){this.setState({highlighted:null})}},{key:"preserveBlurEvent",value:function(e){this.state.filtered.length?(e.persist(),this._inputBlurEvent=e):this.props.onBlur(e)}},{key:"focusInput",value:function(){this._input.focus();var e=this._input.value.length;this._input.setSelectionRange(e,e)}},{key:"componentDidMount",value:function(){var e=this;this._input.addEventListener("keydown",this._keyEventCb=function(t){return e._keyboardControl(t)}),document.addEventListener("click",this._docClickCb=function(t){e._clickFlag?e._clickFlag=!1:e.setState({focused:!1},(function(){e.props.onBlur(e._inputBlurEvent)}))})}},{key:"componentWillUnmount",value:function(){this._input.removeEventListener("keydown",this._keyEventCb),document.removeEventListener("click",this._docClickCb)}},{key:"render",value:function(){var e=this,t=this.props.manager,r=!!this.state.filtered.length&&this.state.focused||this.props.showSuggestions;return f.createElement("div",{className:"autocomplete-input"},f.createElement("div",null,f.createElement(_.a,{type:"text",autoComplete:"off",spellCheck:!1,label:this.props.label,name:this.props.name,value:this.props.value,disabled:this.props.disabled,error:this.props.error,autoFocus:this.props.autoFocus,onRef:function(t){return e._input=t},onChange:this.onChange,onClick:this.onClick,onBlur:this.preserveBlurEvent,onFocus:this.onFocus})),f.createElement("ul",{className:r?"visible":"",onClick:this.selectOption,onMouseEnter:this.resetFocus},this.state.filtered.map((function(r,n){return f.createElement("li",{key:"k-"+n,className:e.state.highlighted===r?"highlighted":"","data-sugg":r.t},t.stringify(r.s))}))))}},{key:"_performFiltering",value:function(e){var t=this.props.suggestions,r=this.props.manager.filterStrategy(e,t);this.setState({filtered:r,highlighted:null})}},{key:"_applyOption",value:function(e){this._input.value=e,this.props.onSelect(e),this.setState({filtered:[],highlighted:null})}},{key:"_keyboardControl",value:function(e){if(this.state.filtered.length){[S.e,S.b,S.m,S.g].forEach((function(t){t===e.keyCode&&e.preventDefault()}));var t=this.state,r=t.highlighted,n=t.filtered;switch(e.keyCode){case S.b:case S.m:this.setState({highlighted:Object(E.a)(n,r,0,n.length-1)});break;case S.e:this.setState({highlighted:Object(E.a)(n,r,n.length-1,0)});break;case S.g:r&&this._applyOption(r.t);break;case S.h:this.setState({disabledFiltering:!0,filtered:[],highlighted:null})}}}}]),t}(f.Component),Object(v.a)(n.prototype,"onChange",[j.a],Object.getOwnPropertyDescriptor(n.prototype,"onChange"),n.prototype),Object(v.a)(n.prototype,"onClick",[j.a],Object.getOwnPropertyDescriptor(n.prototype,"onClick"),n.prototype),Object(v.a)(n.prototype,"onFocus",[j.a],Object.getOwnPropertyDescriptor(n.prototype,"onFocus"),n.prototype),Object(v.a)(n.prototype,"selectOption",[j.a],Object.getOwnPropertyDescriptor(n.prototype,"selectOption"),n.prototype),Object(v.a)(n.prototype,"resetFocus",[j.a],Object.getOwnPropertyDescriptor(n.prototype,"resetFocus"),n.prototype),Object(v.a)(n.prototype,"preserveBlurEvent",[j.a],Object.getOwnPropertyDescriptor(n.prototype,"preserveBlurEvent"),n.prototype),n),T=r(1302),R=new(function(e){function t(){return Object(b.a)(this,t),Object(O.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(g.a)(t,[{key:"filterStrategy",value:function(e,t){if("@"===e[e.length-1])return this._map(e,t).slice(0,8);var r=e.indexOf("@");if(-1!==r){var n=e.substring(r,e.length);return this._map(e,t.filter((function(e){return e.startsWith(n)&&e!==n}))).slice(0,8)}return[]}},{key:"stringify",value:function(e){return e}},{key:"_map",value:function(e,t){return t.map((function(t){return{s:t,t:e.split("@")[0]+t}}))}}]),t}(D)),x=(o=function(e){function t(){var e,r;Object(b.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o))))._ref=void 0,r._divPlaceholder=void 0,r._options=void 0,r._inputPaddingLeft=void 0,r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this._options=this._ref.querySelector("ul")}},{key:"onChange",value:function(e){if(e.target&&-1!==e.target.value.indexOf("@")&&this._options){var t=e.target.value.split("@")[0];this._divPlaceholder.innerHTML=t;var r=this._divPlaceholder.clientWidth;this._inputPaddingLeft||(this._inputPaddingLeft=parseInt(window.getComputedStyle(e.target)["padding-left"].replace("px",""),10)),r<157&&(this._options.style.left=r+this._inputPaddingLeft-25+"px")}this.props.input.onChange(e)}},{key:"render",value:function(){var e=this,t=this.props,r=t.input,n=t.meta,o=this.props,a=n.touched&&n.dirty&&n.error&&!n.active;return f.createElement("div",{className:"email-input",ref:function(t){return e._ref=t}},f.createElement(P,{label:o.label?o.label:"Email",manager:R,suggestions:this.emailProviders,name:r.name,value:r.value,error:a?n.error:null,disabled:this.props.disabled,autoFocus:this.props.autoFocus,onSelect:this.props.input.onChange,onChange:this.onChange,onFocus:r.onFocus,onBlur:r.onBlur}),f.createElement("div",{ref:function(t){return e._divPlaceholder=t},className:"mail-name-holder"}))}},{key:"emailProviders",get:function(){return T.map((function(e){return"@"+e}))}}]),t}(f.Component),Object(v.a)(o.prototype,"onChange",[j.a],Object.getOwnPropertyDescriptor(o.prototype,"onChange"),o.prototype),o),N=(r(1303),a=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(O.a)(this,Object(k.a)(t).call(this,e)))._autocompleteInputRef=void 0,r._clickFlag=void 0,r._docClickCb=void 0,r.state={optionsVisible:!1},r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docClickCb=function(){e._clickFlag?e._clickFlag=!1:e.setState({optionsVisible:!1})})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docClickCb)}},{key:"toggleOptionsVisiblity",value:function(){this._clickFlag=!0,this.setState({optionsVisible:!this.state.optionsVisible})}},{key:"onFocus",value:function(e){this._clickFlag=!0,this.props.onFocus(e),this.setState({optionsVisible:!0})}},{key:"onSelect",value:function(e){this.props.onChange(e),this._clickFlag=!0,this.setState({optionsVisible:!1})}},{key:"focusInput",value:function(){this._autocompleteInputRef&&this._autocompleteInputRef.focusInput()}},{key:"render",value:function(){var e=this,t=P;return f.createElement("div",{className:"autocomplete-select"+(this.state.optionsVisible?" visible":"")},f.createElement(t,{ref:function(t){return e._autocompleteInputRef=t},manager:this.props.manager,suggestions:this.props.options,error:this.props.error,label:this.props.label,name:this.props.name,value:this.props.value,onChange:this.props.onChange,onBlur:this.props.onBlur,onFocus:this.onFocus,onSelect:this.onSelect,showSuggestions:this.state.optionsVisible}),f.createElement("div",{className:"arrow",onClick:this.toggleOptionsVisiblity}))}}]),t}(f.Component),Object(v.a)(a.prototype,"toggleOptionsVisiblity",[j.a],Object.getOwnPropertyDescriptor(a.prototype,"toggleOptionsVisiblity"),a.prototype),Object(v.a)(a.prototype,"onFocus",[j.a],Object.getOwnPropertyDescriptor(a.prototype,"onFocus"),a.prototype),Object(v.a)(a.prototype,"onSelect",[j.a],Object.getOwnPropertyDescriptor(a.prototype,"onSelect"),a.prototype),a),M=r(1085),V=r(1086),A=(i=function(e){function t(){return Object(b.a)(this,t),Object(O.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(g.a)(t,[{key:"onBlur",value:function(){if(this.props.onBlur){var e="+1 "===this.props.value?"":this.props.value;this.props.onBlur(e)}}},{key:"onChange",value:function(e){this.props.onChange(e.target.value)}},{key:"onFocus",value:function(e){e.target.value||this.props.onChange("+1 "),this.props.onFocus&&this.props.onFocus(e)}},{key:"render",value:function(){return f.createElement(_.a,{type:"text",placeholder:"+1 XXX-XXX-XXXX",label:this.props.label||"Cell Number",name:this.props.name,className:this.props.className,value:this.props.value,error:this.props.error,autoComplete:"off",alwaysShowPlaceholder:this.props.alwaysShowPlaceholder,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onDragStart:this.props.onDragStart,onDrop:this.props.onDrop})}}]),t}(f.PureComponent),Object(v.a)(i.prototype,"onBlur",[j.a],Object.getOwnPropertyDescriptor(i.prototype,"onBlur"),i.prototype),Object(v.a)(i.prototype,"onChange",[j.a],Object.getOwnPropertyDescriptor(i.prototype,"onChange"),i.prototype),Object(v.a)(i.prototype,"onFocus",[j.a],Object.getOwnPropertyDescriptor(i.prototype,"onFocus"),i.prototype),i),I=r(122),U=function(e){function t(){return Object(b.a)(this,t),Object(O.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.props,t=e.input,r=e.meta,n=Object(I.a)(e,["input","meta"]),o=r.touched&&r.dirty&&r.error&&!r.active;return f.createElement(A,Object.assign({},n,{name:t.name,value:t.value,onChange:t.onChange,onFocus:t.onFocus,onBlur:t.onBlur,onDragStart:t.onDragStart,onDrop:t.onDrop,error:o?r.error:null}))}}]),t}(f.PureComponent),L=(r(1307),f.Component,r(1308),function(e){function t(){return Object(b.a)(this,t),Object(O.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return f.createElement("div",{className:"coursera-login-btn "+(this.props.className||""),onClick:this.props.onClick},f.createElement("span",{className:"icon"}),f.createElement("span",{className:"label"},this.props.label))}}]),t}(f.Component)),F=(r(1309),function(e){var t=e.input,r=e.meta,n=Object(I.a)(e,["input","meta"]),o=r.touched&&r.dirty&&r.error&&!r.active;return f.createElement(_.a,Object.assign({},n,{name:t.name,value:t.value,className:e.className,onChange:t.onChange,onFocus:t.onFocus,onBlur:t.onBlur,onDragStart:t.onDragStart,onDrop:t.onDrop,error:o?r.error:null}))}),B=(r(1310),function(e){function t(){var e,r;Object(b.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o))))._textarea=void 0,r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"focus",value:function(){this._textarea&&this._textarea.focus()}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"rhyme-textarea","data-name":this.props.name},f.createElement("textarea",{ref:function(t){return e._textarea=t},value:this.props.value,cols:this.props.cols,rows:this.props.rows,disabled:this.props.disabled,autoFocus:this.props.autoFocus,className:this.className,name:this.props.name,placeholder:this.props.placeholder,onChange:this.props.onChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur}),this.props.label&&f.createElement("span",{className:"label"},this.props.label),this.props.error&&f.createElement("span",{className:"input-error-msg"},this.props.error))}},{key:"className",get:function(){var e="";return this.props.className&&(e+=this.props.className),this.props.value&&(e+=" filled-input"),this.props.error&&(e+=" error"),e}}]),t}(f.Component)),z=function(e){function t(){return Object(b.a)(this,t),Object(O.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.props,t=e.input,r=e.meta,n=Object(I.a)(e,["input","meta"]);return f.createElement(B,Object.assign({value:t.value,name:t.name,onChange:t.onChange,onFocus:t.onFocus,onBlur:t.onBlur,error:this.errored?r.error:null},n))}},{key:"errored",get:function(){var e=this.props.meta;return e.touched&&e.dirty&&e.error&&!e.active}}]),t}(f.Component),H=r(1097),W=r(1114),K=(r(1312),function(e){function t(){var e,r;Object(b.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o))))._ref=void 0,r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this._listenForFocusChanges()}},{key:"render",value:function(){var e=this,t=this.props,r=t.className,n=Object(I.a)(t,["className"]);return f.createElement("fieldset",Object.assign({ref:function(t){return e._ref=t},className:"rhyme-fieldset"+(r?" "+r:"")},n),this.props.children)}},{key:"_listenForFocusChanges",value:function(){var e=this;if(/Edge/.test(window.navigator.userAgent)){var t=this._ref.getElementsByTagName("input");[].slice.call(t).forEach((function(t){t.addEventListener("focus",(function(){return e._focus()})),t.addEventListener("blur",(function(){return e._unfocus()}))}))}}},{key:"_focus",value:function(){this._ref.style.zIndex="9"}},{key:"_unfocus",value:function(){this._ref.style.zIndex="0"}}]),t}(f.Component)),Y=function(e){var t=e.input,r=e.meta,n=Object(I.a)(e,["input","meta"]);return f.createElement(H.a,Object.assign({},n,{value:t.value,onChange:function(r){return G(r,t.onChange,e.onSelect)},dirty:r.dirty}))},G=function(e,t,r){t(e),r&&r(e)},q=r(1562),J=(s=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(O.a)(this,Object(k.a)(t).call(this,e)))._input=void 0,r._label=void 0,r._arrow=void 0,r._inputWrapper=void 0,r.state={isCalendarOpen:!1},r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"onClickOutside",value:function(e){var t=e.target;this._isOutsideFieldWrapper(t)&&this.unfocusInput(e)}},{key:"unfocusInput",value:function(e){this.onInputBlur(e),this.setState({isCalendarOpen:!1})}},{key:"onInputFocus",value:function(e){this.props.onFocus&&this.props.onFocus(e)}},{key:"onInputBlur",value:function(e){this.props.onBlur&&this.props.onBlur(e)}},{key:"onInputClick",value:function(e){this.props.focused||this.onInputFocus(e)}},{key:"onClick",value:function(e){if(this.props.onClick&&!this.props.disabled){var t=e.target===this._inputWrapper||!this.state.isCalendarOpen;t&&(this._input&&this._input.focus(),this.props.onClick(e)),this.setState({isCalendarOpen:t})}}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"date-picker-field"+(this.props.focused?" focused":"")+(this.props.disabled?" disabled":""),"data-name":this.props.name,onClick:this.onClick},f.createElement("div",{className:"selected",ref:function(t){return e._inputWrapper=t}},this.props.label&&f.createElement("span",{ref:function(t){return e._label=t},className:"label"},this.props.label),f.createElement("input",{ref:function(t){return e._input=t},className:"rhyme-date-picker-input",value:this.props.value,onChange:this.props.onChange,onFocus:this.onInputFocus,onClick:this.onInputClick,onBlur:this.onInputBlur,onKeyDown:this.props.onKeyDown,name:this.props.name,disabled:this.props.disabled})),f.createElement("div",{className:"arrow",ref:function(t){return e._arrow=t}}))}},{key:"_isOutsideFieldWrapper",value:function(e){return e!==this._label&&e!==this._arrow&&e!==this._inputWrapper}}]),t}(f.Component),Object(v.a)(s.prototype,"onInputFocus",[j.a],Object.getOwnPropertyDescriptor(s.prototype,"onInputFocus"),s.prototype),Object(v.a)(s.prototype,"onInputBlur",[j.a],Object.getOwnPropertyDescriptor(s.prototype,"onInputBlur"),s.prototype),Object(v.a)(s.prototype,"onInputClick",[j.a],Object.getOwnPropertyDescriptor(s.prototype,"onInputClick"),s.prototype),Object(v.a)(s.prototype,"onClick",[j.a],Object.getOwnPropertyDescriptor(s.prototype,"onClick"),s.prototype),s),X=(r(1313),c=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(O.a)(this,Object(k.a)(t).call(this,e)))._calendar=void 0,r.state={focused:!1},r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"onFocus",value:function(){this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus()}},{key:"onBlur",value:function(){this.setState({focused:!1}),this.props.onBlur&&this.props.onBlur()}},{key:"onClickOutside",value:function(e){this._calendar.input.onClickOutside(e)}},{key:"onChange",value:function(e,t){e&&this.props.onDateChange(e),this._calendar.input.unfocusInput(t),this.onBlur()}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"rhyme-date-picker"},f.createElement(q.a,{ref:function(t){return e._calendar=t},customInput:f.createElement(J,{focused:this.state.focused,label:this.props.label}),selected:this.props.date,dateFormat:"YYYY-MM-DD",onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,disabled:this.props.disabled,minDate:this.props.minDate,onClickOutside:this.onClickOutside}))}}]),t}(f.Component),Object(v.a)(c.prototype,"onFocus",[j.a],Object.getOwnPropertyDescriptor(c.prototype,"onFocus"),c.prototype),Object(v.a)(c.prototype,"onBlur",[j.a],Object.getOwnPropertyDescriptor(c.prototype,"onBlur"),c.prototype),Object(v.a)(c.prototype,"onClickOutside",[j.a],Object.getOwnPropertyDescriptor(c.prototype,"onClickOutside"),c.prototype),Object(v.a)(c.prototype,"onChange",[j.a],Object.getOwnPropertyDescriptor(c.prototype,"onChange"),c.prototype),c),Z=r(1474),Q=r(292),$=(r(1314),r(491)),ee=["Canada/Atlantic","US/Alaska"],te=new Map([["HST","Hawaii Time"],["US/Alaska","Alaska Time"],["Canada/Atlantic","Atlantic Time"],["PST8PDT","Pacific Time"],["MST7MDT","Mountain Time"],["CST6CDT","Central Time"],["EST5EDT","Eastern Time"]]),re=new Map([["HST",["HTS","HDT"]],["US/Alaska",["AKDT","AKST"]],["Canada/Atlantic",["AST","ADT"]],["PST8PDT",["PST","PDT"]],["MST7MDT",["MST","MDT"]],["CST6CDT",["CST","CDT"]],["EST5EDT",["EST","EDT"]]]),ne=function(e){return!e.startsWith("Etc/")&&"EST"!==e&&"MST"!==e},oe=function(e){var t=e.map((function(e){return e.split("|")[0]})).filter(ne);t=t.concat(ee);var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value,l=Q.tz(c).format("Z");r.push({location:c,offset:l})}}catch(p){o=!0,a=p}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r.sort((function(e,t){var r=e.offset.replace(":",""),n=t.offset.replace(":","");return parseInt(r,10)-parseInt(n,10)})).map((function(e){var t=e.location,r=e.offset,n=te.has(t)?te.get(t):t.split("_").join(" "),o=re.get(t);return{location:t,label:"(GMT ".concat(r,") ").concat(n),aliases:o}}))}($.zones),ae={threshold:.3,keys:["label","aliases"]},ie=new(function(e){function t(){return Object(b.a)(this,t),Object(O.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(g.a)(t,[{key:"filterStrategy",value:function(e,t){return e?new Z(t,ae).search(e).map((function(e){return{s:e,t:e.location}})):t.map((function(e){return{s:e,t:e.location}}))}},{key:"stringify",value:function(e){return e.label}}]),t}(D)),se=N,ce=(l=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(O.a)(this,Object(k.a)(t).call(this,e)))._autocompleteSelectRef=void 0,r.state={selected:!1,inputValue:r._getTimezoneLabel(r.props.timezone)},r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"componentWillUpdate",value:function(e,t){(e.timezone!==this.props.timezone||!t.selected&&t.selected!==this.state.selected)&&this.setState({inputValue:this._getTimezoneLabel(e.timezone)})}},{key:"componentDidUpdate",value:function(e,t){this.state.selected&&this.state.selected!==t.selected&&this._autocompleteSelectRef&&this._autocompleteSelectRef.focusInput()}},{key:"onToggle",value:function(){this.setState((function(e){return{selected:!e.selected}}))}},{key:"onChange",value:function(e){if("object"===typeof e)this.setState({inputValue:e.target.value});else{var t=oe.find((function(t){return t.location===e}));t?this.props.onTimezoneChange(t.location):this.props.onTimezoneChange(this.props.timezone)}}},{key:"onBlur",value:function(e){this.setState({selected:!1})}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"rhyme-timezone"+(this.props.disabled?" disabled":"")},this.state.selected&&!this.props.disabled?f.createElement(se,{ref:function(t){return e._autocompleteSelectRef=t},manager:ie,options:oe,name:"timezone",value:this.state.inputValue,onChange:this.onChange,onBlur:this.onBlur,onFocus:function(){}}):f.createElement("div",{className:"selected",onClick:this.onToggle},this._getTimezoneLabel(this.props.timezone)))}},{key:"_getTimezoneLabel",value:function(e){var t=oe.find((function(t){return t.location===e}));return t?t.label:e}}]),t}(f.Component),Object(v.a)(l.prototype,"onToggle",[j.a],Object.getOwnPropertyDescriptor(l.prototype,"onToggle"),l.prototype),Object(v.a)(l.prototype,"onChange",[j.a],Object.getOwnPropertyDescriptor(l.prototype,"onChange"),l.prototype),Object(v.a)(l.prototype,"onBlur",[j.a],Object.getOwnPropertyDescriptor(l.prototype,"onBlur"),l.prototype),l),le=function(e){var t=e.input,r=(e.meta,Object(I.a)(e,["input","meta"]));return f.createElement(ce,Object.assign({},r,{timezone:t.value,onTimezoneChange:t.onChange}))},pe=r(1128),ue=r(166),de=(r(1320),p=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(O.a)(this,Object(k.a)(t).call(this,e)))._timeOptions=function(e,t,r){for(var n=ue.duration(1,"day").as(r),o=[],a=ue(e,"hh:mm"),i=0;i<n;i+=t)a.add(0===i?0:t,r),o.push(a.format("hh:mma"));return o}("00:00",30,"m"),r._timeRef=void 0,r.state={focused:!1},r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"onTimeChange",value:function(e){var t=this._getTimeDate(e),r=t.isValid()?t:this.props.date;this.props.onTimeChange(r)}},{key:"onTimeShowOptions",value:function(){if(this._timeRef){var e=this._roundTime(this.props.date).format("hh:mma");this._timeRef.scrollToOption(e)}}},{key:"onFocus",value:function(){this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus()}},{key:"onBlur",value:function(){this.setState({focused:!1}),this.props.onBlur&&this.props.onBlur()}},{key:"render",value:function(){var e=this.props.date.format("hh:mma");return f.createElement("div",{className:"rhyme-time-picker"+(this.props.disabled?" disabled":"")+(this.state.focused?" focused":"")},f.createElement(H.a,{ref:this._setTimeRef,className:"time-select",editable:!0,value:e,disabled:this.props.disabled,onChange:this.onTimeChange,onFocus:this.onFocus,onBlur:this.onBlur,onShowOptions:this.onTimeShowOptions},this.renderTimeOptions()))}},{key:"renderTimeOptions",value:function(){var e=this;return this._timeOptions.map((function(t){var r=!1;e.props.minDate&&(r=!e._getTimeDate(t).isSameOrAfter(e.props.minDate,"minute"));return f.createElement(W.a,{value:t,key:t,disabled:r},t)}))}},{key:"_roundTime",value:function(e){var t=ue(e),r=t.minute()%30;return 0!==r&&(t=ue(t).add(-r,"minutes")),t}},{key:"_setTimeRef",value:function(e){this._timeRef=e}},{key:"_getTimeDate",value:function(e){var t=this.props.date.format("MM-DD-YYYY")+e;return ue(t,"".concat("MM-DD-YYYY").concat("hh:mma"))}}]),t}(f.Component),Object(v.a)(p.prototype,"onTimeChange",[j.a],Object.getOwnPropertyDescriptor(p.prototype,"onTimeChange"),p.prototype),Object(v.a)(p.prototype,"onTimeShowOptions",[j.a],Object.getOwnPropertyDescriptor(p.prototype,"onTimeShowOptions"),p.prototype),Object(v.a)(p.prototype,"onFocus",[j.a],Object.getOwnPropertyDescriptor(p.prototype,"onFocus"),p.prototype),Object(v.a)(p.prototype,"onBlur",[j.a],Object.getOwnPropertyDescriptor(p.prototype,"onBlur"),p.prototype),Object(v.a)(p.prototype,"_setTimeRef",[j.a],Object.getOwnPropertyDescriptor(p.prototype,"_setTimeRef"),p.prototype),p),he=(r(1321),u=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(O.a)(this,Object(k.a)(t).call(this,e))).state={focused:!1},r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"onDateChange",value:function(e){var t=this._mergeDateAndTime(e,this.props.date);this.props.onDateChange(t)}},{key:"onTimeChange",value:function(e){var t=this._mergeDateAndTime(this.props.date,e);this.props.onDateChange(t)}},{key:"onFocusChange",value:function(e){this.setState({focused:e})}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"rhyme-date-time-picker","data-name":this.props.name},f.createElement("div",{className:"pickers"+(this.props.disabled?" disabled":"")+(this.state.focused?" focused":"")},f.createElement("span",{className:"label"},this.props.label),f.createElement("div",{className:"fields"},f.createElement(X,{date:this.props.date,minDate:this.props.minDate,disabled:this.props.disabled,onDateChange:this.onDateChange,onFocus:function(){return e.onFocusChange(!0)},onBlur:function(){return e.onFocusChange(!1)}}),f.createElement("span",{className:"at-label"},"at"),f.createElement(de,{date:this.props.date,minDate:this.props.minDate,disabled:this.props.disabled,onTimeChange:this.onTimeChange,onFocus:function(){return e.onFocusChange(!0)},onBlur:function(){return e.onFocusChange(!1)}}))))}},{key:"_mergeDateAndTime",value:function(e,t){var r=ue(t);return r.year(e.year()).month(e.month()).date(e.date()),r}}]),t}(f.Component),Object(v.a)(u.prototype,"onDateChange",[j.a],Object.getOwnPropertyDescriptor(u.prototype,"onDateChange"),u.prototype),Object(v.a)(u.prototype,"onTimeChange",[j.a],Object.getOwnPropertyDescriptor(u.prototype,"onTimeChange"),u.prototype),u),me=function(e){var t=e.input,r=(e.meta,Object(I.a)(e,["input","meta"]));return f.createElement(he,Object.assign({},r,{name:t.name,date:t.value,onDateChange:t.onChange}))},fe=r(1479),ye=r.n(fe),ve=(r(1322),d=function(e){function t(){return Object(b.a)(this,t),Object(O.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(g.a)(t,[{key:"onStarClick",value:function(e,t,r,n){(n.pageX-n.currentTarget.getBoundingClientRect().left)/n.currentTarget.offsetWidth<=.5&&(e-=.5),this.props.onChange(e)}},{key:"render",value:function(){return f.createElement("div",{className:"rhyme-rating"},f.createElement("div",null,this.props.label?f.createElement("span",{className:"label"},this.props.label):null,f.createElement(ye.a,{className:"stars",name:"rating",value:this.props.value,starColor:"#edd15b",emptyStarColor:"#edd15b",onStarClick:this.onStarClick,renderStarIcon:function(e,t){return f.createElement("i",{className:e<=t?"fa fa-star":"fa fa-star-o"})},renderStarIconHalf:function(){return f.createElement("i",{className:"fa fa-star-half-o"})}})))}}]),t}(f.Component),Object(v.a)(d.prototype,"onStarClick",[j.a],Object.getOwnPropertyDescriptor(d.prototype,"onStarClick"),d.prototype),d),be=function(e){var t=e.input,r=Object(I.a)(e,["input"]);return f.createElement(ve,Object.assign({},r,{value:t.value,onChange:t.onChange}))},ge=r(290),Oe=(r(1323),r(1047),r(8)),ke=r(1218),Ce=r(1152),we=(h=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(O.a)(this,Object(k.a)(t).call(this,e)))._textareas=[],r._dirty=Object(Oe.List)([]),r.state={expanded:-1,timeFocused:!1,textFocused:!1},e.onRef&&e.onRef(Object(ge.a)(r)),r}return Object(C.a)(t,e),Object(g.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this,r=e.input.value;this.annotations.forEach((function(e,n){var o=r.get(n);!o||e.content===o.content&&e.time===o.time||t._updateDirty(t._dirty.push(n))}))}},{key:"openLastAnnotation",value:function(){var e=this;this.setState({expanded:this.annotations.size-1},(function(){return e._focusTextarea()}))}},{key:"cleanse",value:function(){this.setState({expanded:-1}),this._updateDirty(Object(Oe.List)([]))}},{key:"updateTime",value:function(e,t,r){t=t.set("time",e.target.value),this.props.input.onChange(this.annotations.set(r,t))}},{key:"updateText",value:function(e,t,r){t=t.set("content",e.target.value),this.props.input.onChange(this.annotations.set(r,t))}},{key:"onContainerToggle",value:function(e,t){var r=this;e?this.setState({expanded:t},(function(){return r._focusTextarea()})):e||t!==this.state.expanded||this.setState({expanded:-1})}},{key:"onDelete",value:function(e,t){var r=this;this.props.onDelete(e).then((function(e){r.setState({expanded:-1}),e&&r.props.input.onChange(r.annotations.delete(t))}))}},{key:"onTimeFocus",value:function(e){this.setState({timeFocused:!0,expanded:e})}},{key:"onTimeBlur",value:function(){this.setState({timeFocused:!1})}},{key:"onTextFocus",value:function(e){this.setState({textFocused:!0,expanded:e})}},{key:"onTextBlur",value:function(){this.setState({textFocused:!1})}},{key:"onTextareaRef",value:function(e,t){e&&(this._textareas[t]=e)}},{key:"render",value:function(){var e=this,t=this.state,r=t.timeFocused,n=t.textFocused;return f.createElement("div",{className:"redux-form-annotations-list form-styles"},this.annotations.map((function(t,o){var a,i,s=(e.props.meta.error||{})[o]||{},c=!s.time&&(a=e.props,i=t.time,1e3*a.chapterDuration>Object(ke.a)(i))?"":"Invalid time";return f.createElement(Ce.a,{expanded:e.state.expanded===o,onToggle:function(t){return e.onContainerToggle(t,o)},expandHeader:e.renderExpandHeader(o+1),collapseHeader:e.renderCollapseHeader(t,o+1),errored:("{}"!==JSON.stringify(s)||!!c)&&!r&&!n,key:"eca-"+o},f.createElement(_.a,{value:t.time,label:"Notify at",error:e.state.timeFocused?"":c,onChange:function(r){return e.updateTime(r,t,o)},onFocus:function(){return e.onTimeFocus(o)},onBlur:e.onTimeBlur}),f.createElement("div",{className:"row"},f.createElement(B,{value:t.content,ref:function(t){return e.onTextareaRef(t,o)},className:"annon-text",label:"Message",error:e.state.textFocused?"":s.content,onChange:function(r){return e.updateText(r,t,o)},onFocus:function(){return e.onTextFocus(o)},onBlur:e.onTextBlur}),f.createElement("p",{className:"field-info delete"},f.createElement("a",{href:"javascript:void(0);",onClick:function(){return e.onDelete(t,o)}},"Delete Annotation "+(o+1)))))})))}},{key:"renderExpandHeader",value:function(e){return f.createElement("span",{className:"expand-header"},"Edit Annotation ",e)}},{key:"renderCollapseHeader",value:function(e,t){return f.createElement("span",{className:"collapse-header"},f.createElement("span",{className:"label"},"Annotation ",t),f.createElement("span",{className:"name"},"(",e.time,") ",e.content))}},{key:"_focusTextarea",value:function(){var e=this.state.expanded;-1!==e&&this._textareas[e]&&this._textareas[e].focus()}},{key:"_updateDirty",value:function(e){this._dirty=e,this.props.onDirty(this._dirty)}},{key:"annotations",get:function(){return this.props.input.value}}]),t}(f.Component),Object(v.a)(h.prototype,"onTimeBlur",[j.a],Object.getOwnPropertyDescriptor(h.prototype,"onTimeBlur"),h.prototype),Object(v.a)(h.prototype,"onTextBlur",[j.a],Object.getOwnPropertyDescriptor(h.prototype,"onTextBlur"),h.prototype),h),je=r(17),Ee=Object(je.b)({id:"",time:"",content:""}),_e=r(47),Se=r(3),De=r(0),Pe=r(1219),Te=(m={},Object(Se.a)(m,De.Y.enUS,"English (United States)"),Object(Se.a)(m,De.Y.enGB,"English (Great Britain)"),Object(Se.a)(m,De.Y.enAU,"English (Australia)"),Object(Se.a)(m,De.Y.enIN,"English (India)"),Object(Se.a)(m,De.Y.esES,"Spanish"),Object(Se.a)(m,De.Y.frFR,"French"),Object(Se.a)(m,De.Y.arSA,"Arabic (Modern Standard)"),m),Re=function(e){return f.createElement(Y,e,Object.entries(De.Y).sort(Object(Pe.a)((function(e){return Object(_e.a)(e,1)[0]}))).map((function(e){var t=Object(_e.a)(e,2),r=t[0],n=t[1];return f.createElement(W.a,{key:r,value:n},function(e){return Te[e]}(n))})))};r.d(t,"l",(function(){return y.c})),r.d(t,"B",(function(){return y.e})),r.d(t,"j",(function(){return y.b})),r.d(t,"m",(function(){return y.d})),r.d(t,"g",(function(){return y.a})),r.d(t,"F",(function(){return y.j})),r.d(t,"C",(function(){return y.f})),r.d(t,"J",(function(){return y.p})),r.d(t,"M",(function(){return y.u})),r.d(t,"E",(function(){return y.i})),r.d(t,"N",(function(){return y.v})),r.d(t,"L",(function(){return y.s})),r.d(t,"H",(function(){return y.l})),r.d(t,"K",(function(){return y.q})),r.d(t,"D",(function(){return y.g})),r.d(t,"G",(function(){return y.k})),r.d(t,"I",(function(){return y.n})),r.d(t,"f",(function(){return x})),r.d(t,"a",(function(){return M.a})),r.d(t,"b",(function(){return V.a})),r.d(t,"c",(function(){return A})),r.d(t,"p",(function(){return U})),r.d(t,"d",(function(){return L})),r.d(t,"k",(function(){return _.a})),r.d(t,"s",(function(){return F})),r.d(t,"v",(function(){return z})),r.d(t,"y",(function(){return H.a})),r.d(t,"n",(function(){return W.a})),r.d(t,"h",(function(){return K})),r.d(t,"u",(function(){return Y})),r.d(t,"w",(function(){return le})),r.d(t,"A",(function(){return ce})),r.d(t,"q",(function(){return pe.a})),r.d(t,"z",(function(){return B})),r.d(t,"r",(function(){return me})),r.d(t,"e",(function(){return he})),r.d(t,"t",(function(){return be})),r.d(t,"o",(function(){return we})),r.d(t,"i",(function(){return Ee})),r.d(t,"x",(function(){return Re}))},1047:function(e,t,r){},1051:function(e,t,r){"use strict";var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=r.n(c);r(1305);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var d=l.a.createElement("circle",{cx:84,cy:50,r:0,fill:"#ffffff"},l.a.createElement("animate",{attributeName:"r",values:"5;0;0;0;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"}),l.a.createElement("animate",{attributeName:"cx",values:"84;84;84;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"})),h=l.a.createElement("circle",{cx:47.7776,cy:50,r:5,fill:"#ffffff",fillOpacity:.5},l.a.createElement("animate",{attributeName:"r",values:"0;5;5;5;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"-1.25s"}),l.a.createElement("animate",{attributeName:"cx",values:"16;16;50;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"-1.25s"})),m=l.a.createElement("circle",{cx:16,cy:50,r:4.67318,fill:"#ffffff",fillOpacity:.1},l.a.createElement("animate",{attributeName:"r",values:"0;5;5;5;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"-0.625s"}),l.a.createElement("animate",{attributeName:"cx",values:"16;16;50;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"-0.625s"})),f=l.a.createElement("circle",{cx:84,cy:50,r:.326821,fill:"#ffffff"},l.a.createElement("animate",{attributeName:"r",values:"0;5;5;5;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"}),l.a.createElement("animate",{attributeName:"cx",values:"16;16;50;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"})),y=l.a.createElement("circle",{cx:81.7776,cy:50,r:5,fill:"#ffffff"},l.a.createElement("animate",{attributeName:"r",values:"0;0;5;5;5",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"}),l.a.createElement("animate",{attributeName:"cx",values:"16;16;16;50;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"2.5s",repeatCount:"indefinite",begin:"0s"})),v=function(e){var t=e.svgRef,r=e.title,n=u(e,["svgRef","title"]);return l.a.createElement("svg",p({viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",className:"lds-ellipsis",style:{background:"none"},ref:t},n),r?l.a.createElement("title",null,r):null,d,h,m,f,y)},b=l.a.forwardRef((function(e,t){return l.a.createElement(v,p({svgRef:t},e))}));r.p;r.d(t,"a",(function(){return g}));var g=function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:"rhyme-loader"+(this.props.theme?" "+this.props.theme:"")},c.createElement(b,null))}}]),t}(c.PureComponent)},1054:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return p}));var n=r(3),o=r(1058),a=r(1066),i=Object(n.a)({},a.c,(function(){return new a.a})),s=function(e){var t=Object(o.b)(e),r=i[t];if(!r)throw new Error("InputCodec with version ".concat(t," not supported"));return r()},c=function(e){return new Promise((function(t,r){var n=new FileReader;n.onload=function(){t(this.result)},n.readAsArrayBuffer(e)}))},l=function(e){var t=0;return e.left&&(t|=1),e.middle&&(t|=2),e.right&&(t|=4),e.up&&(t|=8),e.down&&(t|=16),t},p=function(e){return{left:!!(1&e),middle:!!(2&e),right:!!(4&e),up:!!(8&e),down:!!(16&e)}}},1058:function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return c}));var n=0;function o(){return"".concat(n++)}function a(e){return new DataView(e).getUint8(0)}function i(e){return new Promise((function(t){var r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=function(){t(Math.round(1e3*r.duration))},r.src=e}))}function s(e,t,r){var n=e.reduce((function(e,r){return e+t(r).byteLength}),0)-e.size+1,o=new ArrayBuffer(n),i=new Uint8Array(o);i[0]=r.version[0];var s=0,c=1;return e.forEach((function(e){var n=t(e),l=a(n);if(l!==r.version[0])throw new Error("Merging streams with different versions is not supported. Expected version: ".concat(r.version[0]," actual version: ").concat(l));if((n.byteLength-1)%r.packetSize!==0)throw new Error("Invalid buffer size. It is not dividable by ".concat(r.packetSize));var p=new Uint8Array(n,1);i.set(p,c);for(var u=new DataView(o,c,p.length),d=new DataView(n,1,p.length),h=0;h<d.byteLength;h+=r.packetSize){var m=r.getPacketTimestamp(d,h);r.setPacketTimestamp(u,h,m+s)}c+=p.length,s+=e.duration})),o}function c(e,t,r){for(var n=t(e),o=new DataView(e),a=1;a<o.byteLength&&n.getPacketTimestamp(o,a)<=r;)a+=n.packetSize;return e.slice(0,a)}},1059:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s}));var n,o=r(51),a=r(1054),i=r(1066);function s(e){if(e[0]===i.b)return{type:n.Keyboard,timestamp:e[1],down:1===e[2],keyCode:e[3]};var t=Object(a.b)(e[2]);return Object(o.a)({type:n.Mouse,timestamp:e[1],x:e[3],y:e[4]},t)}!function(e){e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse"}(n||(n={}))},1061:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=(r(1258),r(1216)),p=50,u=50,d=20,h=function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"getInitials",value:function(){if(!this.props.source.name)return"...";var e=this.props.source.name.split(" "),t=e[0],r=e[1];return t[0]+(r?r[0]:"")}},{key:"render",value:function(){var e,t=this.props.source;return t.avatarUrl?e=t.avatarUrl:t.photo&&(e=l.a[t.photo-1]),c.createElement("div",{className:"avatar"+(this.props.tooltip?" tooltip rel b":""),style:this.styles,"data-tooltip":this.props.source.name},e?c.createElement("img",{src:e,width:this.styles.width,height:this.styles.height}):c.createElement("span",null,this.getInitials()))}},{key:"styles",get:function(){var e=this.props;return{width:e.width||p,height:e.height||u,fontSize:e.fontSize||d}}}]),t}(c.Component)},1062:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"f",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"e",(function(){return p}));var n=r(8),o=r(0),a=30,i=function(e,t){switch(e){case o.ab.Micro:return"Micro (2 vCPU, 1GB RAM, 30GB SSD)";case o.ab.Small:return"Small (2 vCPU, 2GB RAM, 30GB SSD)";case o.ab.Medium:return"Medium (2 vCPUs, 4GB RAM, 30GB SSD)";case o.ab.Large:return"Normal (2 vCPUs, 8GB RAM, 50GB SSD)";case o.ab.XLarge:return"Double (4 vCPUs, 16GB RAM, 100GB SSD)";case o.ab.XXLarge:return"Quadruple (8 vCPUs, 32GB RAM, 250 SSD)";case o.ab.GPUMicro:return"GPU Micro (1 NVIDIA Tesla M60 2048 cores, 4 vCPUs, 30.5GB RAM, 100 SSD)";case o.ab.GPUSmall:return"GPU Small (1 NVIDIA K80 2496 cores, 4 vCPUs, 61GB RAM, 100 SSD)";case o.ab.GPUMedium:return"GPU Medium (1 NVIDIA Tesla V100 5120 cores, 8 vCPUs, 61GB RAM, 100 SSD)";case o.ab.GPULarge:return"GPU Large (4 NVIDIA Tesla V100 5120 cores each, 32 vCPUs, 244GB RAM, 100 SSD)";case o.ab.MemMicro:return"Memory Micro (8 vCPUs, 64GB RAM, 100 SSD)";case o.ab.MemSmall:return"Memory Small (16 vCPUs, 128GB RAM, 100 SSD)";default:return""}},s=function(e,t){var r=e.find((function(e){return e.defaultTemplate&&e.os===o.L.Win}));if(!t)return r?r.screenshotUrl:"";if(!t.screenshotUrl)switch(t.os){case o.L.Linux:var n=e.find((function(e){return e.defaultTemplate&&e.os===o.L.Linux}));return n?n.screenshotUrl:"";case o.L.Win:return r?r.screenshotUrl:"";case o.L.Docker:var a=e.find((function(e){return e.defaultTemplate&&e.os===o.L.Docker}));return a?a.screenshotUrl:""}return t.screenshotUrl},c=function(e){return e&&!e.ownerId&&!e.defaultTemplate},l=function(e,t){return t?e.filter((function(e){if(t&&e.os!==t.os)return!1;var r=p(e);return t&&t.id===e.id&&c(e)?r:r&&(!!e.ownerId||e.defaultTemplate)})).toList():Object(n.List)([])},p=function(e){return e.state!==o.bb.Deleted}},1064:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"e",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"a",(function(){return l})),r.d(t,"j",(function(){return d})),r.d(t,"f",(function(){return h})),r.d(t,"p",(function(){return m})),r.d(t,"t",(function(){return y})),r.d(t,"u",(function(){return v})),r.d(t,"i",(function(){return b})),r.d(t,"v",(function(){return g})),r.d(t,"s",(function(){return k})),r.d(t,"r",(function(){return C})),r.d(t,"m",(function(){return E})),r.d(t,"h",(function(){return _})),r.d(t,"l",(function(){return D})),r.d(t,"q",(function(){return P})),r.d(t,"g",(function(){return T})),r.d(t,"o",(function(){return R})),r.d(t,"k",(function(){return N})),r.d(t,"n",(function(){return M}));var n=r(51),o=r(1127),a={email:{min:6,max:300},password:{min:6,max:200},name:{min:2,max:200},securityCode:{min:6,max:6},inviteCode:{min:6,max:20},sessionName:{min:4,max:200},sessionDescription:{min:0,max:1e4},templateName:{min:4,max:200},rhymeCard:{min:16,max:16},feedback:{min:0,max:1e4},feedbackRequired:{min:3,max:1e4},bio:{min:0,max:1e4},twitterUrl:{min:13,max:300},githubUrl:{min:12,max:300},linkedinUrl:{min:17,max:300},facebookUrl:{min:14,max:300},annotation:{min:5,max:100}},i=/^(http(?:s)?:\/\/)?(?:www\.)?(twitter\.com\/\S+$)/g,s=/^(http(?:s)?:\/\/)?(?:www\.)?(github\.com\/\S+$)/g,c=/^(http(?:s)?:\/\/)?(?:www\.)?(linkedin\.com\/in\/\S+$)/g,l=/^(http(?:s)?:\/\/)?(?:www\.)?(facebook\.com\/\S+$)/g,p={twitterUrl:"Twitter profile should be of the form: twitter.com/username",githubUrl:"GitHub profile should be of the form: github.com/username",linkedinUrl:"LinkedIn profile should be of the form: linkedin.com/in/username",facebookUrl:"Facebook profile should be of the form: facebook.com/username"},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"password",r=arguments.length>2?arguments[2]:void 0,n={},o=(e[t]||"").trim();return""===o&&r?n:(o?(o.length<a.password.min||a.password.max<o.length)&&(n[t]="Password must be between ".concat(a.password.min," and ").concat(a.password.max," characters")):n[t]="Required",n)},d=function(e,t){var r={},n=(e[t]||"").trim();return n?n.length<a.email.min||a.email.max<n.length?r[t]="Email must be between ".concat(a.email.min," and ").concat(a.email.max," characters"):/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]+$/i.test(n)||(r[t]="Invalid email address"):r[t]="Required",r},h=function(e){var t={},r=e.cellNumber;if(!r)return t;if(r.length<7||30<r.length)t.cellNumber="Cell number must be between 7 and 30 characters";else if(r.startsWith("+")){if(r){var n=Object(o.b)(r);n&&n.country&&n.phone||(t.cellNumber="Invalid cell number")}}else t.cellNumber='Cell number should start with country code. E.g., for USA, start with "+1"';return t},m=function(e){var t={},r=e.newPassword,n=e.repeatPassword;return t.newPassword||t.repeatPassword||n||(t.repeatPassword="Repeat your new password"),t.newPassword||t.repeatPassword||r===n||(t.repeatPassword="Password doesn't match"),t},f=function(e,t,r){var n={},o=(e[t]||"").trim();if(o){var i=a[t];if(o.length<i.min||o.length>i.max)n[t]="The link should be between ".concat(i.min," and ").concat(i.max," characters");else o.match(r)||(n[t]=p[t])}return n},y=function(e){var t={},r=(e.url||"").trim();if(r)if(r.startsWith("http://")||r.startsWith("https://"))try{var n=new URL(r);console.log("The url ".concat(n," is valid"))}catch(o){t.url="Invalid URL"}else t.url="URL must start with http(s)://";else t.url="Required";return t},v=function(e){var t={};t=Object(n.a)({},u(e,"password",!1),{},d(e,"email"),{},function(e){var t={},r=e.bio;return r?(r.length>a.bio.max&&(t.bio="The About You shouldn't exceed ".concat(a.bio.max," characters")),t):t}(e),{},function(e){return Object(n.a)({},f(e,"twitterUrl",i),{},f(e,"githubUrl",s),{},f(e,"linkedinUrl",c),{},f(e,"facebookUrl",l))}(e));var r=(e.name||"").trim();return r?(r.length<a.name.min||a.name.max<r.length)&&(t.name="Name must be between ".concat(a.name.min," and ").concat(a.name.max," characters")):t.name="Required",t},b=function(e){return u(e,"confirmPassword",!1)},g=function(e){var t={};return t=Object(n.a)({},v(e),{},h(e)),e.newPassword&&(t=Object(n.a)({},u(e,"newPassword",!0),{},m(e))),t},O=function(e){var t={},r=(e.courseName||"").trim();return r?(r.length<a.sessionName.min||a.sessionName.max<r.length)&&(t.courseName="The name should be between ".concat(a.sessionName.min," and ").concat(a.sessionName.max," characters")):t.courseName="Required",t},k=function(e){var t={},r=(e.templateName||"").trim();return r?(r.length<a.templateName.min||a.templateName.max<r.length)&&(t.templateName="The name should be between ".concat(a.templateName.min," and ").concat(a.templateName.max," characters")):t.templateName="Required",t},C=function(e){var t=Object(n.a)({},O(e));(e.description||"").trim().length>a.sessionDescription.max&&(t.description="The description shouldn't exceed ".concat(a.sessionDescription.max," characters"));var r=y({url:e.virtualBrowserUrl});return r.url&&(t.virtualBrowserUrl=r.url),t},w=function(e){var t={},r=(e.name||"").trim();return r?(r.length<a.sessionName.min||a.sessionName.max<r.length)&&(t.name="The name should be between ".concat(a.sessionName.min," and ").concat(a.sessionName.max," characters")):t.name="Required",t},j=function(e){var t={};return(e.description||"").trim().length>a.sessionDescription.max&&(t.description="The description shouldn't exceed ".concat(a.sessionDescription.max," characters")),t},E=function(e){return Object(n.a)({},C(e),{},_(e))},_=function(e){var t=[];return e.chapters?(e.chapters.forEach((function(e){return t.push((r=e,Object(n.a)({},w(r),{},j(r))));var r})),0===t.filter((function(e){return 0!==Object.keys(e).length})).length?{}:{chapters:JSON.stringify(t)}):{}},S=function(e){var t={},r="Invalid time";if(/^(\d{1,2}:)?\d{1,2}:\d{1,2}$/.test(e.time)){var n=e.time.split(":").map((function(e){return parseInt(e,10)})),o=0,i=0,s=0;n.length>2?(o=n[0],i=n[1],s=n[2]):(i=n[0],s=n[1]),0<=o&&o<=23&&0<=i&&i<=59&&0<=s&&s<=59&&(r="")}return r&&(t.time=r),(!e.content||e.content.length<a.annotation.min||a.annotation.max<e.content.length)&&(t.content="Text should be between ".concat(a.annotation.min," and ").concat(a.annotation.max," characters.")),t},D=function(e){var t=e.annotations;if(!t)return{};var r=(t.toArray()||[]).map(S);return r.filter((function(e){return Object.keys(e).length>0})).length?{annotations:r}:{}},P=function(e){var t={},r=(e.securityCode||"").trim();return r?r.length!==a.securityCode.max?t.securityCode="Security code must be ".concat(a.securityCode.max," digits"):/^[0-9]+$/.test(r)||(t.securityCode="Security code must contain only digits"):t.securityCode="Required",t},T=function(e){return Object(n.a)({},u(e,"newPassword",!1),{},m(e),{},P(e))},R=function(e){var t={};if(e.card){var r=e.card.replace(/\s/g,"");"99"!==r.substr(0,2)?t.card="The card number should start with 99":/^\d+$/.test(r)?r.length!==a.rhymeCard.max&&(t.card="The card number should be exactly ".concat(a.rhymeCard.max," digits")):t.card="The card should contain only digits"}else t.card="The card number is required";return t},x=function(e,t){var r={},n=(e.feedbackText||"").trim();return(n.length<t.min||n.length>t.max)&&(r.feedbackText="The feedback should be between ".concat(t.min," and ").concat(t.max," characters")),r},N=function(e){return x(e,a.feedback)},M=function(e){return x(e,a.feedbackRequired)}},1065:function(e,t,r){"use strict";var n,o=r(84),a=r(5),i=r(11),s=r(30),c=r(28),l=r(290),p=r(29),u=r(1050),d=r.n(u),h=r(8),m=r(210),f=r.n(m),y=r(4),v=r(165),b=r(1060),g=r(211),O=r(1069),k=r(0),C=r(1087),w=r(19),j=r.n(w),E=r(44),_=r(1466),S=function(e){return function(t){if(t.seekable&&Number.isFinite(t.duration)){var r=Object(_.a)(0,t.duration,t.currentTime+e);t.currentTime=r}}},D=function(e){return function(t){t.volume=Object(_.a)(0,1,t.volume+e)}},P=function(e){var t=document,r=t.fullscreenElement,n=t.webkitFullscreenElement;return r===e||n===e},T=function(e){return e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.requestFullscreen()},R=function(){var e=Object(E.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P(t)){e.next=4;break}return e.next=3,T(t);case 3:return e.abrupt("return",!0);case 4:return e.next=6,document.webkitExitFullscreen?document.webkitExitFullscreen():document.exitFullscreen();case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(e){return e.muted=!e.muted},N=r(1074),M=r(134),V=r(1051),A=r(1105),I=r(47),U=function(e){if(e.startsWith("blob:"))return e;var t,r,n,o,a,i=e.replace("https://","").split("/"),s=Object(I.a)(i,2),c=s[0],l=s[1].split("."),p=Object(I.a)(l,1)[0],u=c.split(".");if(5===u.length){var d=Object(I.a)(u,5);t=d[0],r=d[1],n=d[2],o=d[3],a=d[4]}else{var h=Object(I.a)(u,4);t=h[0],r=h[1],o=h[2],a=h[3],n="us-east-1"}var m=t.split("-"),f=m.indexOf("skillspace");return t=m.slice(0,f).join("-")+"-mp4-"+m.slice(f,m.length).join("-"),"https://".concat(t,".").concat(r,".").concat(n,".").concat(o,".").concat(a,"/").concat(p,".mp4")},L=(r(1164),function(e){function t(){var e,r;Object(a.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(r=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={current:void 0},r._leftOn=!1,r._ref=void 0,r}return Object(p.a)(t,e),Object(i.a)(t,[{key:"onMouseEvent",value:function(e){this.setState({current:e})}},{key:"render",value:function(){var e=this;if(!this.state.current)return null;var t=this.state.current,r=t.x,n=t.y,o=t.left,a=this.props.scale;return o&&this._leftOn!==o&&this._playRipple(r*a,n*a),this._leftOn=o,y.createElement("div",{ref:function(t){return e._ref=t},className:"cursor-player cursor"})}},{key:"_playRipple",value:function(e,t){if(this._ref){var r=document.createElement("div");r.className="ripple ripple-effect",this._ref.appendChild(r),r.style.left=e-r.offsetHeight/2+"px",r.style.top=t-r.offsetWidth/2+"px",r.addEventListener("animationend",(function(){var e=r.parentElement;e&&e.removeChild(r)}))}}}]),t}(y.Component)),F=r(1106);r(1165);r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return B})),function(e){e.x025="0.25",e.x050="0.5",e.x075="0.75",e.x100="1",e.x125="1.25",e.x150="1.5",e.x200="2"}(n||(n={}));var B=function(e){function t(e){var r;Object(a.a)(this,t),(r=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={zoomPointerCenter:{x:0,y:0},videoSize:{width:0,height:0},videoDimm:{width:0,height:0},firstFrame:null,videoPlayable:!1,windowBlured:!1,failedUrls:new Set},r._video=void 0,r._videoWrapper=void 0,r._inputPlayer=void 0,r._annotationsPlayer=void 0,r._expandModePlayer=void 0,r._cursor=void 0,r._lastSync=NaN,r._resizeObserver=void 0,r._mouseDownTimestamp=0,r._playbackRate=n.x100,r._screenshotCanvas=void 0,r._canPlayTimeout=null,r._moveZoomPointerCenter=void 0,r._resetZoomPointerMovementHistory=void 0,r._keyboardActionHandlers={"video.toggleMute":r._withVideoRef(x),"video.toggleFullscreen":r._withVideoRef(R),"video.volumeUp":r._withVideoRef(D(.1)),"video.volumeDown":r._withVideoRef(D(-.1)),"video.forward":r._withVideoRef(S(15)),"video.backward":r._withVideoRef(S(-15))},r.onVideoRef=function(e){r._video=e,e&&(e.playbackRate=parseFloat(r._playbackRate),e.oncanplay=function(){r._obtainDimmensions(e),r._createFirstFrame(e),r._canPlayTimeout=setTimeout((function(){r.setState({videoPlayable:!0},(function(){return r.props.onCanPlay(!0)}))}),500),e.oncanplay=null},e.onplaying=function(){r.setState({firstFrame:null}),e.onplaying=null})},r.onLoadedData=function(){r._video&&r._video.readyState>=1&&r.props.onReadyMetadata()},r._onSourceError=function(e){var t=e.target.src;r.setState({videoPlayable:!1,failedUrls:new Set([].concat(Object(o.a)(r.state.failedUrls),[t]))})},r._onClick=function(){Date.now()-r._mouseDownTimestamp<=500&&r.props.onClick()},r._onWrapperRef=function(e){e&&(r._videoWrapper=e,r._resizeObserver&&r._resizeObserver.disconnect(),r._resizeObserver=new b.a((function(){if(r._video){var e={width:r._video.clientWidth,height:r._video.clientHeight};r.setState({videoSize:e})}})),r._resizeObserver.observe(r._videoWrapper))},r._onMediaPlay=function(){if(r._inputPlayer){r.props.captionPlayer&&r.props.captionPlayer.reset(),r._annotationsPlayer&&r._annotationsPlayer.play(r.currentTimeInMs),r._expandModePlayer&&r._expandModePlayer.play(r.currentTimeInMs);var e=r._inputPlayer.play(r.currentTimeInMs);r._playMouseEvent(e.mouse)}},r._onSeeked=function(){if(r._video&&r._inputPlayer){r._resetZoomPointerMovementHistory();var e=r._inputPlayer.getKeyframeAt(r.currentTimeInMs);r._playMouseEvent(e.mouse)}},r._onMediaPause=function(){r._inputPlayer&&(r._inputPlayer.pause(),r._annotationsPlayer&&r._annotationsPlayer.pause(),r._expandModePlayer&&r._expandModePlayer.pause())},r._frameHandler=function(e){e.type===O.a.Mouse?r._playMouseEvent(e):r._playKeyboardEvent(e)},r._onLoadedMetadata=function(e){var t=e.target;t.duration===1/0&&(t.currentTime=1e101,t.ontimeupdate=function(){t.currentTime=.1,t.ontimeupdate=null})},r._syncInput=function(){if(r._video&&r._inputPlayer){var e=Date.now();!r._video.paused&&(isNaN(r._lastSync)||e-r._lastSync>500)&&(r._lastSync=e,r._inputPlayer.sync(r.currentTimeInMs))}},r._onWindowFocus=function(){r.setState({windowBlured:!1},(function(){r.play(),r.props.onCanPlay(!0)})),window.removeEventListener("focus",r._onWindowFocus)},r._onWindowBlur=function(){r.playing&&(r.pause(),r.setState({windowBlured:!0},(function(){return r.props.onCanPlay(!1)})),window.addEventListener("focus",r._onWindowFocus))},r._tryInitInputPlayer(e),r._tryInitAnnotationsPlayer(e),r._tryInitExpandModePlayer(e),r._screenshotCanvas=document.createElement("canvas");var i=Object(N.b)(Object(l.a)(r));return r._moveZoomPointerCenter=i.moveCenter,r._resetZoomPointerMovementHistory=i.resetHistory,r}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("blur",this._onWindowBlur)}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.input,n=t.expandModeData;r&&r!==e.input&&this._tryInitInputPlayer(this.props),!r&&this._inputPlayer&&(this._inputPlayer.pause(),this._inputPlayer=void 0),n&&n!==e.expandModeData&&this._tryInitExpandModePlayer(this.props),!n&&this._expandModePlayer&&(this._expandModePlayer.pause(),this._expandModePlayer=void 0),this._handleNewUrlProps(e),this._tryInitAnnotationsPlayer(this.props)}},{key:"componentWillUnmount",value:function(){this._inputPlayer&&this._inputPlayer.pause(),this._annotationsPlayer&&this._annotationsPlayer.destroy(),this._expandModePlayer&&this._expandModePlayer.destroy(),this._canPlayTimeout&&clearTimeout(this._canPlayTimeout),window.removeEventListener("blur",this._onWindowBlur),window.removeEventListener("focus",this._onWindowFocus)}},{key:"play",value:function(){return this._inputPlayer&&this._video&&this.canPlay?(this.props.captionPlayer&&this.props.captionPlayer.reset(),this._video.play()):Promise.reject()}},{key:"pause",value:function(){this._inputPlayer&&this._video&&this.canPlay&&(window.removeEventListener("focus",this._onWindowFocus),this._video.pause())}},{key:"changePlaybackRate",value:function(e){if(this._video&&this._inputPlayer){this._playbackRate=e;var t=parseFloat(this._playbackRate);this._video.playbackRate=t,this._inputPlayer.setPlaybackRate(t),this._annotationsPlayer&&this._annotationsPlayer.setPlaybackRate(t,this.currentTimeInMs),this._expandModePlayer&&this._expandModePlayer.setPlaybackRate(t,this.currentTimeInMs)}}},{key:"toggleViewbox",value:function(){if(this.props.onViewboxToggle)return this.props.onViewboxToggle(!this.props.showViewbox),!this.props.showViewbox}},{key:"setCurrentTime",value:function(e){this._video&&(this.props.captionPlayer&&this.props.captionPlayer.reset(),e&&!isNaN(e)||(e=0),this._video.currentTime=e)}},{key:"learnerChangedSidebarMode",value:function(){this._expandModePlayer&&this._expandModePlayer.learnerChangedSidebarMode(this.currentTimeInMs)}},{key:"takeScreenshot",value:function(){if(!this._video)return null;var e=this._video,t=e.videoWidth,r=e.videoHeight;this._screenshotCanvas.width=t,this._screenshotCanvas.height=r,this._screenshotCanvas.getContext("2d").drawImage(this._video,0,0,t,r);var n=this._screenshotCanvas.toDataURL("image/png");return new Blob([g.a.toArrayBuffer(n)],{type:"image/png"})}},{key:"render",value:function(){var e=this,t=d()("vm-player",this.props.className);return this.props.src?y.createElement("div",{className:t},y.createElement(M.Hotkeys,{handlers:this._keyboardActionHandlers}),y.createElement("div",{className:"video-wrapper",ref:this._onWrapperRef},this.state.firstFrame&&y.createElement("img",{className:"first-frame",src:this.state.firstFrame}),y.createElement("video",{key:"".concat(this.props.mp4).concat(this.props.webm).concat(this.props.src),autoPlay:this.props.autoPlay,onTimeUpdate:this._syncInput,onSeeked:this._onSeeked,ref:this.onVideoRef,onLoadedMetadata:this._onLoadedMetadata,onLoadedData:this.onLoadedData,controls:Boolean(this.props.src||this.props.mp4||this.props.webm)&&this.props.controls,onPlaying:this._onMediaPlay,onPause:this._onMediaPause,onMouseDown:function(){return e._mouseDownTimestamp=Date.now()},onMouseUp:this._onClick,crossOrigin:"anonymous",onError:this._onSourceError},this.props.mp4&&y.createElement("source",{type:"video/mp4",src:this.props.mp4}),this.props.webm&&y.createElement("source",{type:"video/webm",src:this.props.webm}),this.props.src&&y.createElement("source",{type:"video/mp4",src:U(this.props.src)}),this.props.src&&y.createElement("source",{type:"video/webm",src:this.props.src}),(this.props.subtitles||Object(h.Map)()).filter(C.d).map((function(t,r,n){return y.createElement(F.a,{key:t.url,url:t.url,srcLang:Object(C.e)(t.language),default:t.language===e.props.subtitleLang||1===n.size,onCueChange:e.props.onCueChange})})).toList()),this.props.mouse?y.createElement(L,{ref:function(t){return e._cursor=t},scale:this.scale}):null,this.renderViewbox(),this.props.errorContainer?v.createPortal(this.renderSourceSplash(),this.props.errorContainer):this.renderSourceSplash())):y.createElement("div",{className:t},y.createElement("div",{className:"video-placeholder"}))}},{key:"renderViewbox",value:function(){var e=this.props,t=e.showViewbox,r=e.viewboxSize,n=this.state,o=n.videoSize,a=n.videoDimm,i=n.zoomPointerCenter;if(!t||!r)return null;var s=o.width/a.width,c=i.x,l=i.y;return y.createElement("div",{className:"zoom-wrapper"},y.createElement(A.a,{isExpanded:this.props.isViewExpanded||!1,width:r.width*s,height:r.height*s,maxWidth:o.width,maxHeight:o.height,x:c*s,y:l*s}))}},{key:"renderSourceSplash",value:function(){var e=this.state,t=e.videoPlayable,r=e.windowBlured,n=e.failedUrls;if(t||r)return null;var o=[this.props.webm,this.props.mp4,this.props.src,this.props.src].reduce((function(e,t){return e+(t?1:0)}),0),a=n.size>0&&n.size>=o;return y.createElement("div",{className:"source-splash"},a?y.createElement(y.Fragment,null,y.createElement("p",null,"We are sorry, but we were not able to load the video. :("),y.createElement("p",null,"Please, try again later.")):y.createElement(V.a,null))}},{key:"_tryInitInputPlayer",value:function(e){this._inputPlayer&&this._inputPlayer.pause(),e.input&&(this._inputPlayer=new O.f(e.input),this._inputPlayer.onFrame(this._frameHandler),this._inputPlayer.setPlaybackRate(parseFloat(this._playbackRate)))}},{key:"_tryInitAnnotationsPlayer",value:function(e){!this._annotationsPlayer&&e.annotations&&e.annotations.size&&(this._annotationsPlayer=Object(O.k)(this),this._annotationsPlayer.setPlaybackRate(parseFloat(this._playbackRate),this.currentTimeInMs))}},{key:"_tryInitExpandModePlayer",value:function(e){this._expandModePlayer&&this._expandModePlayer.destroy(),e.expandModeData&&(this._expandModePlayer=new O.b(e.expandModeData),this._expandModePlayer.setPlaybackRate(parseFloat(this._playbackRate),this.currentTimeInMs),this.props.onExpandModeChange&&this._expandModePlayer.onExpandModeChange(this.props.onExpandModeChange))}},{key:"_playMouseEvent",value:function(e){this._cursor&&this._cursor.onMouseEvent(e),this._moveZoomPointerCenter(e),this.props.onMouseFrame&&this.props.onMouseFrame(e)}},{key:"_playKeyboardEvent",value:function(e){this.props.captionPlayer&&this.props.captionPlayer.onKey(e),this.props.onKeyboardFrame&&this.props.onKeyboardFrame(e)}},{key:"_obtainDimmensions",value:function(e){this.setState({videoDimm:{width:e.videoWidth,height:e.videoHeight}}),this.props.onVideoDimmensions&&this.props.onVideoDimmensions(e.videoWidth,e.videoHeight)}},{key:"_createFirstFrame",value:function(e){var t=e.videoWidth,r=e.videoHeight,n=document.createElement("canvas");n.width=t,n.height=r;var o=n.getContext("2d");o&&(o.filter="blur(5px) opacity(40%)",o.drawImage(e,0,0,t,r),this.setState({firstFrame:n.toDataURL()}))}},{key:"_withVideoRef",value:function(e){var t=this;return function(){return t._video?e(t._video):void 0}}},{key:"_handleNewUrlProps",value:function(e){var t=this.props,r=t.webm,n=t.mp4,a=t.src,i=[r!==e.webm&&e.webm,n!==e.mp4&&e.mp4].concat(Object(o.a)(a!==e.src&&e.src?[U(e.src),e.src]:[])).filter(Boolean);if(0!==i.length){var s=this.state.failedUrls.size>0?i.reduce((function(e,t){return e.delete(t),e}),new Set(this.state.failedUrls)):this.state.failedUrls;this.setState({videoPlayable:!1,failedUrls:s}),this.props.onCanPlay(!1)}}},{key:"playing",get:function(){return!!this._video&&!this._video.paused}},{key:"playbackRate",get:function(){return this._playbackRate}},{key:"canPlay",get:function(){return this.state.videoPlayable&&!this.state.windowBlured}},{key:"zoomPointerDimensions",get:function(){return this.props.viewboxSize||{height:0,width:0}}},{key:"currentTime",get:function(){return this._video?this._video.currentTime:0}},{key:"currentTimeInMs",get:function(){return Math.round(1e3*this.currentTime)}},{key:"duration",get:function(){return this._video?this._video.duration:0}},{key:"scale",get:function(){if(!this._video)return 1;var e=this._video.getBoundingClientRect(),t=e.width,r=e.height,n=this.state.videoDimm.width/this.state.videoDimm.height;return Math.min(t,r*n)/this.state.videoDimm.width}}]),t}(y.Component);B.defaultProps={subtitleLang:k.Y.enUS,onCanPlay:f.a,onReadyMetadata:f.a,onClick:f.a}},1066:function(e,t,r){"use strict";r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return d}));var n=r(5),o=r(11),a=Math.pow(2,8)-1,i=Math.pow(2,16)-1,s=Math.pow(2,32)-1,c=0,l=1,p=new Uint8Array([0]),u=new Uint8Array([l]),d=function(){function e(){Object(n.a)(this,e),this.version=new Uint8Array([c]),this.packetSize=10}return Object(o.a)(e,[{key:"encodeMouseEvent",value:function(e,t,r,n){if(e>s)throw new Error("Cannot encode time stamps bigger than 32bit");if(r>i)throw new Error("Cannot encode x coordinate bigger than 16bit");if(n>i)throw new Error("Cannot encode y coordinate bigger than 16bit");if(t>a)throw new Error("Cannot encode mouse mask bigger than 8bit");var o=new Uint32Array([e]),c=new Uint8Array([t]),l=new Uint16Array([r]),u=new Uint16Array([n]);return new Blob([p,o,c,l,u])}},{key:"encodeKeyboardEvent",value:function(e,t,r){if(e>s)throw new Error("Cannot encode time stamps bigger than 32bit");if(0!==t&&1!==t)throw new Error("Cannot encode down flag in more than 8bits");if(r>s)throw new Error("Cannot key code in more than 32bits");var n=new Uint32Array([e]),o=new Uint8Array([t]),a=new Uint32Array([r]);return new Blob([u,n,o,a])}},{key:"decodeBuffer",value:function(e){for(var t=[],r=0;r+10<=e.byteLength;r+=10)t.push(this.decodePacket(new DataView(e,r,10)));if(r!==e.byteLength)throw new Error("Invalid package size. It is not dividable by 10.");return t}},{key:"decodePacket",value:function(e){if(10===e.byteLength)return e.getInt8(0).toString()===p.toString()?this.decodeMousePacket(e):this.decodeKeyboardPacket(e);throw new Error("Cannot decode packet with size "+e.byteLength)}},{key:"decodeMousePacket",value:function(e){return[0,e.getUint32(1,!0),e.getUint8(5),e.getUint16(6,!0),e.getUint16(8,!0)]}},{key:"decodeKeyboardPacket",value:function(e){return[l,e.getUint32(1,!0),e.getUint8(5),e.getUint32(6,!0)]}},{key:"getPacketTimestamp",value:function(e,t){return e.getUint32(t+1,!0)}},{key:"setPacketTimestamp",value:function(e,t,r){e.setUint32(t+1,r,!0)}}]),e}()},1067:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(5),o=r(11),a=r(1059),i=r(1054),s={x:0,y:0,left:!1,middle:!1,right:!1,up:!1,down:!1,timestamp:0,type:a.a.Mouse},c=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(n.a)(this,e),this._events=t,this._start=r}return Object(o.a)(e,[{key:"next",value:function(){return this._start<this._events.length?{done:!1,value:Object(a.b)(this._events[this._start++])}:{done:!0,value:null}}}]),e}(),l=function(){function e(t){Object(n.a)(this,e),this._codec=void 0,this._events=void 0,this._codec=Object(i.a)(t),this._events=this._codec.decodeBuffer(t.slice(1))}return Object(o.a)(e,[{key:"getKeyframeAt",value:function(e){for(var t=p(this._events,e),r=s,n=t-1;n>=0;n-=1){var o=Object(a.b)(this._events[n]);if(o.type===a.a.Mouse){r=o;break}}return{mouse:r,keysDown:[]}}},{key:"getIteratorAt",value:function(e){var t=p(this._events,e);return-1===t&&(t=this._events.length),new c(this._events,t)}}]),e}(),p=function(e,t){if(1===e.length)return 0;for(var r=0,n=e.length;r<n;){var o=Math.floor(r+(n-r)/2);if(e[o][1]>=t&&(!e[o-1]||e[o-1][1]<t))return o;e[o][1]<t?r=o+1:n=o}return-1}},1068:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=(r(1153),r(91)),d=r.n(u),h=(n=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this,e)))._docEvent=void 0,r._clickFlag=void 0,r.state={visible:!1},r}return Object(c.a)(t,e),Object(a.a)(t,[{key:"onClick",value:function(){this._clickFlag=!0,this.setState({visible:!this.state.visible})}},{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docEvent=function(){e._clickFlag?e._clickFlag=!1:e.setState({visible:!1})})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docEvent)}},{key:"render",value:function(){return p.createElement("div",{onClick:this.onClick,className:"hint "+(this.state.visible?"visible ":"")+(this.props.className||"")},p.createElement("div",{className:"question"},"?"),p.createElement("p",{className:"text"+(this.props.position?" "+this.props.position:" top")},this.props.children))}}]),t}(p.Component),Object(l.a)(n.prototype,"onClick",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"onClick"),n.prototype),n)},1069:function(e,t,r){"use strict";var n;!function(e){e[e.Collapse=0]="Collapse",e[e.Expand=1]="Expand"}(n||(n={}));var o,a=r(19),i=r.n(a),s=r(44),c=r(5),l=r(11),p=r(1058),u=r(1099),d=r(1080),h=function(){function e(){Object(c.a)(this,e),this._encoder=new d.a}return Object(l.a)(e,[{key:"trim",value:function(e,t){var r=Object(p.e)(e.expandTrackBuffer,u.createExpandModeCodec,t);return Promise.resolve(r)}},{key:"merge",value:function(e){var t=Object(p.c)(e,(function(e){return e.expandTrackBuffer}),this._encoder);return Promise.resolve(t)}}]),e}(),m=r(1081),f=r(1066),y=function(){function e(){Object(c.a)(this,e),this._encoder=new f.a}return Object(l.a)(e,[{key:"trim",value:function(e,t){var r=Object(p.e)(e.inputTrackBuffer,m.createInputCodec,t);return Promise.resolve(r)}},{key:"merge",value:function(e){var t=Object(p.c)(e,(function(e){return e.inputTrackBuffer}),this._encoder);return Promise.resolve(t)}}]),e}(),v=r(295),b=function(){function e(){Object(c.a)(this,e),this._expandEditor=new h,this._inputEditor=new y}return Object(l.a)(e,[{key:"trim",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){var n,o,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.d)(t,r);case 2:return n=e.sent,e.next=5,this._expandEditor.trim(t,r);case 5:return o=e.sent,e.next=8,this._inputEditor.trim(t,r);case 8:return a=e.sent,s=URL.createObjectURL(n),e.abrupt("return",{id:Object(p.d)(),videoTrack:n,inputTrackBuffer:a,expandTrackBuffer:o,dataSize:n.size+a.byteLength+o.byteLength,mediaUrl:s,duration:r});case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"merge",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var r,n,o,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.c)(t);case 2:return r=e.sent,e.next=5,this._expandEditor.merge(t);case 5:return n=e.sent,e.next=8,this._inputEditor.merge(t);case 8:return o=e.sent,a=t.reduce((function(e,t){return e+t.duration}),0),s=URL.createObjectURL(r),e.abrupt("return",{id:Object(p.d)(),videoTrack:r,inputTrackBuffer:o,expandTrackBuffer:n,dataSize:r.size+o.byteLength+n.byteLength,mediaUrl:s,duration:a});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),g=r(47),O=r(30),k=r(28),C=r(29),w=r(1468),j=function(e){function t(){var e,r;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o)))).notificationText="Recording too short",r}return Object(C.a)(t,e),t}(Object(w.a)(Error)),E=function(){function e(t,r,n){Object(c.a)(this,e),this._mediaRecorder=t,this._inputRecorder=r,this._expandModeRecorder=n,this._state="stopped",this._startTime=void 0,this._duration=0,this._recorders=void 0,this._recorders=[this._mediaRecorder,this._inputRecorder,this._expandModeRecorder]}return Object(l.a)(e,[{key:"start",value:function(){"stopped"===this._state&&(this._startTime=Date.now(),this._duration=0,this._state="recording",this._recorders.forEach((function(e){return e.start()})))}},{key:"stop",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t,r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("recording"===this._state){e.next=2;break}return e.abrupt("return",Promise.reject("Cannot stop ScreenRecorder. Current state is ".concat(this._state)));case 2:return this._state="processing",t=Date.now()-this._startTime,this._duration=t,e.abrupt("return",Promise.all(this._recorders.map((function(e){return e.stop()}))).then(function(){var e=Object(s.a)(i.a.mark((function e(n){var o,a,s,c,l,u,d,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object(g.a)(n,3),a=o[0],s=o[1],c=o[2],r._state="stopped",!(t<1e3)){e.next=4;break}throw new j;case 4:return e.next=6,Object(v.a)(a);case 6:return a=e.sent,l=URL.createObjectURL(a),e.next=10,Object(m.toArrayBuffer)(s);case 10:return u=e.sent,e.next=13,Object(m.toArrayBuffer)(c);case 13:return d=e.sent,e.next=16,Object(p.a)(l);case 16:return h=e.sent,e.abrupt("return",{id:Object(p.d)(),videoTrack:a,inputTrack:s,inputTrackBuffer:u,expandTrack:c,expandTrackBuffer:d,dataSize:a.size+s.size+c.size,mediaUrl:l,duration:h});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateStream",value:function(e){this._recorders.forEach((function(t){return t.updateStream(e)}))}},{key:"size",get:function(){return this._recorders.reduce((function(e,t){return e+t.size}),0)}},{key:"duration",get:function(){return"recording"===this._state?Date.now()-this._startTime:this._duration}},{key:"isRecording",get:function(){return"recording"===this._state}}]),e}(),_=r(84),S=r(90),D=r(91),P=r.n(D);var T,R,x=(o=function(){function e(t,r,n){Object(c.a)(this,e),this._client=t,this._audioStream=r,this._resolution=n,this._state="stopped",this._config=function(){var e,t=[{mediaType:"video/webm;codecs=vp9,opus",audioBitRate:128e3,videoBitRate:2516582,frameRate:30,timeSlice:1e3},{mediaType:"video/webm;codecs=vp8,opus",audioBitRate:128e3,videoBitRate:2516582,frameRate:24,timeSlice:1e3}];return function(){if(e)return e;if(!(e=t.find((function(e){return MediaRecorder.isTypeSupported(e.mediaType)}))))throw new Error("No supported media codec found");return e}()}(),this._videoElement=document.createElement("video"),this._recorder=void 0,this._videoStreamCanvasContext=void 0,this._blobBuffer=[],this._pollingTimeout=void 0,this._pollingDuration=void 0,this._isUsingUpdatedVideoStream=!1,this._stopResolve=void 0,this._stopReject=void 0}return Object(l.a)(e,[{key:"start",value:function(){if("stopped"===this._state){this._pollingDuration=1e3/(this._config.frameRate||30);var e=this._createVideoStreamCanvas(),t=new MediaStream([].concat(Object(_.a)(e.getTracks()),Object(_.a)(this._audioStream.getAudioTracks())));this._recorder=new MediaRecorder(t,{mimeType:this._config.mediaType,audioBitsPerSecond:this._config.audioBitRate,videoBitsPerSecond:this._config.videoBitRate}),this._recorder.ondataavailable=this._onRecorderDataAvailable,this._recorder.onstop=this._onRecorderStopped,this._recorder.onerror=this._onRecorderError,this._recorder.start(this._config.timeSlice),this._poll(),this._state="recording",console.log("Recording started. MediaType: ".concat(this._config.mediaType," FrameRate: ").concat(this._config.frameRate," Resolution: ").concat(this._resolution.width,"/").concat(this._resolution.height))}}},{key:"stop",value:function(){var e=this;return this._stopPolling(),this._recorder.stop(),this._state="processing",new Promise((function(t,r){e._stopResolve=function(){e._state="stopped",t(new Blob(e._blobBuffer,{type:"video/webm"})),e._cleanUp()},e._stopReject=r}))}},{key:"updateStream",value:function(e){this._isUsingUpdatedVideoStream=!!e,e&&(this._videoElement.autoplay=!0,this._videoElement.srcObject=e,this._videoElement.height=this._resolution.height,this._videoElement.width=this._resolution.width)}},{key:"_onRecorderDataAvailable",value:function(e){this._blobBuffer.push(e.data)}},{key:"_onRecorderStopped",value:function(e){this._stopResolve&&this._stopResolve()}},{key:"_onRecorderError",value:function(e){console.error("MediaRecorder error",e),this._state="error",this._stopReject&&this._stopReject(e),this._cleanUp()}},{key:"_poll",value:function(){this._refreshCanvas(),this._pollingTimeout=setTimeout(this._poll,this._pollingDuration)}},{key:"_cleanUp",value:function(){this._stopPolling(),this._blobBuffer=[],this._stopResolve=void 0,this._stopReject=void 0}},{key:"_stopPolling",value:function(){this._pollingTimeout&&(clearTimeout(this._pollingTimeout),this._pollingTimeout=void 0)}},{key:"_createVideoStreamCanvas",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),r=e.captureStream(this._config.frameRate),n=this._resolution,o=n.width,a=n.height;if(e.width=o,e.height=a,!t)throw new Error("Cannot initialize the context");return this._videoStreamCanvasContext=t,r}},{key:"_refreshCanvas",value:function(){this._isUsingUpdatedVideoStream?this._drawVideoStream():this._drawVM()}},{key:"_drawVM",value:function(){var e=this._client.getDisplay(),t=this._client.getDisplayCanvas();if(t&&t.width&&t.height&&e){var r=this._resolution;this._videoStreamCanvasContext.drawImage(t,0,0,e?e.getWidth():0,e?e.getHeight():0,0,0,r.width,r.height);var n=this._client.getMouse();if(n){var o=this._client.getCursorCanvas();if(o){var a=n.currentState,i=t.width/r.width;this._videoStreamCanvasContext.drawImage(o,0,0,o.width,o.height,(a.x-e.cursorHotspotX)/i/this._client.scaleX||1,(a.y-e.cursorHotspotY)/i/this._client.scaleY||1,o.width/i,o.height/i)}}}}},{key:"_drawVideoStream",value:function(){this._videoStreamCanvasContext.drawImage(this._videoElement,0,0,this._videoElement.width,this._videoElement.height)}},{key:"size",get:function(){return this._blobBuffer.reduce((function(e,t){return e+t.size}),0)}}]),e}(),Object(S.a)(o.prototype,"_onRecorderDataAvailable",[P.a],Object.getOwnPropertyDescriptor(o.prototype,"_onRecorderDataAvailable"),o.prototype),Object(S.a)(o.prototype,"_onRecorderStopped",[P.a],Object.getOwnPropertyDescriptor(o.prototype,"_onRecorderStopped"),o.prototype),Object(S.a)(o.prototype,"_onRecorderError",[P.a],Object.getOwnPropertyDescriptor(o.prototype,"_onRecorderError"),o.prototype),Object(S.a)(o.prototype,"_poll",[P.a],Object.getOwnPropertyDescriptor(o.prototype,"_poll"),o.prototype),o),N=r(293),M=r(1059),V=r(1054),A=(T=function(){function e(t,r){Object(c.a)(this,e),this._client=void 0,this._onKeyboardEventCallback=void 0,this._codec=new f.a,this._startedAt=0,this._disableClicks=void 0,this._blobs=[],this._lastMouseMoveUpdate=void 0,this._recordKeyUp=this._recordKey(!1),this._recordKeyDown=this._recordKey(!0),this._client=t,this._onKeyboardEventCallback=r}return Object(l.a)(e,[{key:"_isRecording",get:function(){return 0!==this._startedAt}},{key:"size",get:function(){return this._blobs.reduce((function(e,t){return e+t.size}),0)}}]),Object(l.a)(e,[{key:"start",value:function(){this._isRecording||(this._startedAt=Date.now(),this._blobs=[new Blob([this._codec.version])],this._recordInitialMousePosition(),this._client.on(N.h,this._recordMouseUp),this._client.on(N.f,this._recordMouseDown),this._client.on(N.g,this._recordMouseMove),this._client.on(N.d,this._recordKeyDown),this._client.on(N.e,this._recordKeyUp))}},{key:"stop",value:function(){if(!this._isRecording)return Promise.reject(new Error("Cannot stop when not recording"));this._client.off(N.h,this._recordMouseUp),this._client.off(N.f,this._recordMouseDown),this._client.off(N.g,this._recordMouseMove),this._client.off(N.d,this._recordKeyDown),this._client.off(N.e,this._recordKeyUp);var e=new Blob(this._blobs);return this._startedAt=0,Promise.resolve(e)}},{key:"updateStream",value:function(e){this._disableClicks=!!e}},{key:"_recordMouseUp",value:function(e){this._isRecording&&!this._disableClicks&&this._encodeMouseEvent(Object(V.d)(e),e.x/this._client.scaleX,e.y/this._client.scaleY)}},{key:"_recordMouseDown",value:function(e){this._isRecording&&!this._disableClicks&&this._encodeMouseEvent(Object(V.d)(e),e.x/this._client.scaleX,e.y/this._client.scaleY)}},{key:"_recordMouseMove",value:function(e){this._isRecording&&(!this._lastMouseMoveUpdate||Math.abs(this._lastMouseMoveUpdate.x-e.x)>=5||Math.abs(this._lastMouseMoveUpdate.y-e.y)>=5)&&(this._disableClicks&&(e.left=!1,e.right=!1,e.middle=!1),this._lastMouseMoveUpdate={x:e.x,y:e.y},this._encodeMouseEvent(Object(V.d)(e),e.x/this._client.scaleX,e.y/this._client.scaleY))}},{key:"_recordInitialMousePosition",value:function(){var e=this._client.getMouse();e&&this._recordMouseMove(e.currentState)}},{key:"_recordKey",value:function(e){var t=this;return function(r){if(t._isRecording){var n=t._encodeKeyboardEvent(e?1:0,r).timestamp;t._onKeyboardEventCallback({type:M.a.Keyboard,timestamp:n,keyCode:r,down:e})}}}},{key:"_encodeKeyboardEvent",value:function(e,t){var r=Date.now()-this._startedAt;return this._blobs.push(this._codec.encodeKeyboardEvent(r,e,t)),{timestamp:r,down:e,keyCode:t}}},{key:"_encodeMouseEvent",value:function(e,t,r){var n=Date.now()-this._startedAt;this._blobs.push(this._codec.encodeMouseEvent(n,e,t,r))}}]),e}(),Object(S.a)(T.prototype,"_recordMouseUp",[P.a],Object.getOwnPropertyDescriptor(T.prototype,"_recordMouseUp"),T.prototype),Object(S.a)(T.prototype,"_recordMouseDown",[P.a],Object.getOwnPropertyDescriptor(T.prototype,"_recordMouseDown"),T.prototype),Object(S.a)(T.prototype,"_recordMouseMove",[P.a],Object.getOwnPropertyDescriptor(T.prototype,"_recordMouseMove"),T.prototype),T),I=(R=function(){function e(t){Object(c.a)(this,e),this._source=t,this._codec=new d.a,this._blobs=[],this._startedAt=0}return Object(l.a)(e,[{key:"_isRecording",get:function(){return 0!==this._startedAt}}]),Object(l.a)(e,[{key:"start",value:function(){this._isRecording||(this._blobs=[new Blob([this._codec.version])],this._startedAt=Date.now(),this._recordInitialMode(this._source.currentMode),this._source.onCollapse(this._collapse),this._source.onExpand(this._expand))}},{key:"stop",value:function(){if(!this._isRecording)return Promise.reject(new Error("Cannot stop when not recording"));var e=new Blob(this._blobs);return this._source.offCollapse(this._collapse),this._source.offExpand(this._expand),this._startedAt=0,Promise.resolve(e)}},{key:"updateStream",value:function(e){}},{key:"_collapse",value:function(){this._recordExpandModeEvent(n.Collapse)}},{key:"_expand",value:function(){this._recordExpandModeEvent(n.Expand)}},{key:"_recordExpandModeEvent",value:function(e){this._isRecording&&this._blobs.push(this._codec.encodeExpandModeEvent(Date.now()-this._startedAt,e))}},{key:"_recordInitialMode",value:function(e){this._blobs.push(this._codec.encodeExpandModeEvent(0,e))}},{key:"size",get:function(){return this._blobs.reduce((function(e,t){return e+t.size}),0)}}]),e}(),Object(S.a)(R.prototype,"_collapse",[P.a],Object.getOwnPropertyDescriptor(R.prototype,"_collapse"),R.prototype),Object(S.a)(R.prototype,"_expand",[P.a],Object.getOwnPropertyDescriptor(R.prototype,"_expand"),R.prototype),Object(S.a)(R.prototype,"_recordExpandModeEvent",[P.a],Object.getOwnPropertyDescriptor(R.prototype,"_recordExpandModeEvent"),R.prototype),R),U=r(8),L=r(2),F=r(0),B=Object(U.List)([]),z=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(O.a)(this,Object(k.a)(t).call(this,e)))._timeout=void 0,r._playbackRate=1,r._isPlaying=!1,r}return Object(C.a)(t,e),Object(l.a)(t,[{key:"play",value:function(e){this._isPlaying=!0,this._instance.props.dispatch(new L.P("annotations-notification-contex"));var t=this._annotations.filter((function(t){return t.time>=e}));this._nextAnnotation(e,t)}},{key:"pause",value:function(){this._isPlaying=!1,this._timeout&&clearTimeout(this._timeout)}},{key:"destroy",value:function(){this.pause(),this._instance.props.dispatch(new L.P("annotations-notification-contex"))}},{key:"setPlaybackRate",value:function(e,t){this._playbackRate=e,this._isPlaying&&(this.pause(),this.play(t))}},{key:"_nextAnnotation",value:function(e,t){var r=this;if(this._timeout&&clearTimeout(this._timeout),t.size){var n=t.first(),o=(n.time-e)/this._playbackRate;this._timeout=setTimeout((function(){r._instance.props.dispatch(new L.i(new F.J({type:F.K.Annotation,title:"Annotation",text:n.content,context:"annotations-notification-contex",ttl:n.duration}))),r._nextAnnotation(n.time,t.delete(0))}),o)}}}]),t}(function(){function e(t){Object(c.a)(this,e),this._instance=t}return Object(l.a)(e,[{key:"_annotations",get:function(){return this._instance.props.annotations||B}}]),e}()),H=function(e){return new z(e)},W=r(50),K=(r(1067),Symbol("OnFrame")),Y=Symbol("Finish"),G=function(){function e(t){Object(c.a)(this,e),this._emitter=new W.EventEmitter,this._currentTime=0,this._startedFrom=0,this._playing=!1,this._view=void 0,this._iterator=void 0,this._lastMouseEvent=void 0,this._skipNextFrame=!1,this._startTime=0,this._currentTimeout=void 0,this._playbackRate=1,this._view=new m.InputPlayerView(t)}return Object(l.a)(e,[{key:"play",value:function(e){return clearTimeout(this._currentTimeout),this._startTime=Date.now(),this._startedFrom=e/this._playbackRate,this._currentTime=e/this._playbackRate,this._skipNextFrame=!1,this._iterator=this._view.getIteratorAt(e),this._playing=!0,this._nextFrame(),this._view.getKeyframeAt(e)}},{key:"setPlaybackRate",value:function(e){this._playbackRate=e}},{key:"getKeyframeAt",value:function(e){return this._view.getKeyframeAt(e)}},{key:"pause",value:function(){clearTimeout(this._currentTimeout),this._playing=!1}},{key:"resume",value:function(){this._playing||this._nextFrame()}},{key:"onFrame",value:function(e){var t=this;return this._emitter.on(K,e),function(){return t._emitter.off(K,e)}}},{key:"onFinish",value:function(e){var t=this;return this._emitter.on(Y,e),function(){return t._emitter.off(Y,e)}}},{key:"sync",value:function(e){Math.abs(e-this._currentTime)>150&&(console.log("Syncing the input player"),this.play(e))}},{key:"_nextFrame",value:function(){var e=this,t=this._iterator.next();if(!t.done&&t.value){var r=t.value,n=r.timestamp/this._playbackRate;if(this._skipNextFrame&&this._canSkip(r))return console.log("Skipping frame"),this._currentTime=n,this._nextFrame();var o=Date.now()-this._startTime,a=this._currentTime-this._startedFrom,i=n-this._currentTime,s=o-a,c=Math.max(0,i-s);0===c&&(this._skipNextFrame=!0),this._currentTimeout=setTimeout((function(){e._emitter.emit(K,r),e._currentTime=n,e._nextFrame()}),c)}else this._emitter.emit(Y)}},{key:"_canSkip",value:function(e){if(e.type===m.EventType.Keyboard)return!1;var t=this._lastMouseEvent;return!!t&&(t.down===e.down&&t.left===e.left&&t.middle===e.middle&&t.right===e.right&&e.up===e.up)}}]),e}(),q=function(){},J=function(){function e(t){Object(c.a)(this,e),this._codec=void 0,this._events=void 0,this._playbackRate=1,this._learnerSidebarModeChangeTimestamp=-1,this._isPlaying=!1,this._timeout=void 0,this._expandModeChangeCallback=q,this._codec=Object(u.createExpandModeCodec)(t);var r=this._codec.decodeBuffer(t.slice(1));this._events=this._translate(r)}return Object(l.a)(e,[{key:"onExpandModeChange",value:function(e){this._expandModeChangeCallback=e}},{key:"play",value:function(e){this._isPlaying=!0;var t=this._events.filter((function(t){return t.timestamp<e}));if(t.length){var r=t[t.length-1];r.timestamp>this._learnerSidebarModeChangeTimestamp&&this._expandModeChangeCallback(r.type)}else-1===this._learnerSidebarModeChangeTimestamp&&this._expandModeChangeCallback(n.Collapse);var o=this._events.filter((function(t){return t.timestamp>=e}));this._nextExpandModeChange(e,o)}},{key:"pause",value:function(){this._isPlaying=!1,this._clearTimeout()}},{key:"destroy",value:function(){this._isPlaying=!1,this._clearTimeout()}},{key:"setPlaybackRate",value:function(e,t){this._playbackRate=e,this._isPlaying&&(this.pause(),this.play(t))}},{key:"learnerChangedSidebarMode",value:function(e){this._learnerSidebarModeChangeTimestamp=e}},{key:"_nextExpandModeChange",value:function(e,t){var r=this;if(t.length){var n=t[0],o=(n.timestamp-e)/this._playbackRate;this._clearTimeout(),this._timeout=setTimeout((function(){r._expandModeChangeCallback(n.type),t.shift(),r._nextExpandModeChange(n.timestamp,t)}),o)}}},{key:"_clearTimeout",value:function(){this._timeout&&clearTimeout(this._timeout)}},{key:"_translate",value:function(e){return e.map((function(e){return{timestamp:e[0],type:e[1]}}))}}]),e}(),X=Symbol("Expand"),Z=Symbol("Collapse"),Q=function(e){function t(){var e,r;Object(c.a)(this,t);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(r=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(a))))._currentMode=n.Collapse,r}return Object(C.a)(t,e),Object(l.a)(t,[{key:"onExpand",value:function(e){return this.addListener(X,e)}},{key:"onCollapse",value:function(e){return this.addListener(Z,e)}},{key:"offExpand",value:function(e){return this.removeListener(X,e)}},{key:"offCollapse",value:function(e){return this.removeListener(Z,e)}},{key:"didExpand",value:function(){this._currentMode=n.Expand,this.emit(X)}},{key:"didCollapse",value:function(){this._currentMode=n.Collapse,this.emit(Z)}},{key:"currentMode",get:function(){return this._currentMode}}]),t}(W.EventEmitter);r.d(t,"e",(function(){return n})),r.d(t,"h",(function(){return b})),r.d(t,"j",(function(){return E})),r.d(t,"i",(function(){return x})),r.d(t,"g",(function(){return A})),r.d(t,"c",(function(){return I})),r.d(t,"k",(function(){return H})),r.d(t,"f",(function(){return G})),r.d(t,"b",(function(){return J})),r.d(t,"d",(function(){return Q})),r.d(t,"a",(function(){return M.a}))},1070:function(e,t,r){"use strict";var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(1472),l=function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(a.a)(this,Object(i.a)(t).call(this)))._handleConfig(e),r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"destroy",value:function(){Object(c.a)(Object(i.a)(t.prototype),"removeAllListeners",this).call(this)}}]),t}(r(50).EventEmitter),p=Symbol("ComboPress"),u=function(e){function t(){var e,r;Object(n.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(r=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).emitted=void 0,r._pressed=new Set,r._keys=[],r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"_handleConfig",value:function(e){this._keys=e}},{key:"keys",get:function(){return this._keys}},{key:"pressed",get:function(){return this._pressed}}]),t}(l),d=new(function(){function e(){Object(n.a)(this,e),this._instances=[],this._init()}return Object(o.a)(e,[{key:"create",value:function(e,t){var r=new u(e);return r.addListener(p,t),this._instances.push(r),r}},{key:"destroy",value:function(e){var t=this._instances.indexOf(e);t>-1&&(e.destroy(),this._instances.splice(t,1))}},{key:"_init",value:function(){var e=this;console.log("Initializing the KeyComboListener"),document.addEventListener("click",(function(){e._instances.forEach((function(e){return e.pressed.clear()}))})),document.addEventListener("keydown",(function(t){e._instances.forEach((function(e){if(e.keys.indexOf(t.keyCode)>-1){if(e.pressed.add(t.keyCode),!e.emitted&&e.pressed.size===e.keys.length){var r=0;e.keys.forEach((function(t){e.pressed.has(t)&&(r+=1)})),r===e.keys.length&&(e.emit(p),e.emitted=!0)}}else e.pressed.clear()}))})),document.addEventListener("keyup",(function(t){e._instances.forEach((function(e){e.keys.indexOf(t.keyCode)>-1&&(e.pressed.delete(t.keyCode),e.emitted=!1)}))}))}}]),e}()),h=function(e){function t(e,r){var o;return Object(n.a)(this,t),(o=Object(a.a)(this,Object(i.a)(t).call(this,e)))._eventSymbol=r,o._delay=void 0,o._timeout=void 0,o}return Object(s.a)(t,e),Object(o.a)(t,[{key:"execute",value:function(){var e=this;this._timeout&&clearTimeout(this._timeout),this._delay>0?this._timeout=setTimeout((function(){return e.emit(e._eventSymbol)}),this._delay):this.emit(this._eventSymbol)}},{key:"_handleConfig",value:function(e){this._delay=100,void 0!==e.delay&&null!==e.delay&&(this._delay=e.delay)}}]),t}(l),m=new(function(){function e(){Object(n.a)(this,e),this._instances=[],this._init()}return Object(o.a)(e,[{key:"create",value:function(e,t){var r=Symbol("WindowResize"),n=new h(e,r);return n.addListener(r,t),this._instances.push(n),n}},{key:"destroy",value:function(e){var t=this._instances.indexOf(e);t>-1&&(e.destroy(),this._instances.splice(t,1))}},{key:"_init",value:function(){var e=this;console.log("Initializing the ResizeListener"),window.addEventListener("resize",(function(){e._instances.forEach((function(e){return e.execute()}))}))}}]),e}());r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return m}))},1071:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(91),u=r.n(p),d=r(4),h=(r(1301),n=function(e){function t(){var e,r;Object(o.a)(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(r=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a)))).state={focused:!1},r._ref=void 0,r}return Object(c.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this._ref)}},{key:"onFocus",value:function(e){this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus(e)}},{key:"onBlur",value:function(e){this.setState({focused:!1}),this.props.onBlur&&this.props.onBlur(e)}},{key:"render",value:function(){var e=this,t=this.props;return d.createElement("div",{className:"rhyme-input","data-name":this.props.name,onClick:this._focusInput},d.createElement("input",Object.assign({ref:function(t){return e._ref=t},className:this.className,onChange:this.props.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onClick:this.props.onClick,onDragStart:this.props.onDragStart,onDrop:this.props.onDrop,onKeyUp:this.props.onKeyUp,onKeyDown:this.props.onKeyDown,name:this.props.name,value:this.props.value,spellCheck:this.props.spellCheck,id:t.id,type:t.type,size:t.size,disabled:t.disabled,defaultValue:t.defaultValue,placeholder:this.placeholder,maxLength:t.maxLength,autoComplete:this.props.autoComplete,autoFocus:t.autoFocus},this.props.ignoreLastPass?{"data-lpignore":!0}:{})),t.label&&d.createElement("span",{className:"label"},t.label),this.props.error&&d.createElement("span",{className:"input-error-msg"},this.props.error))}},{key:"_focusInput",value:function(){this._ref&&this._ref.focus()}},{key:"className",get:function(){var e="";return this.props.className&&(e+=this.props.className),this.props.error&&(e+=" error"),this.props.value&&(e+=" filled-input"),this.props.ignoreLastPass&&(e+=" lpignore-search-box"),e}},{key:"placeholder",get:function(){return this.state.focused||this.props.alwaysShowPlaceholder?this.props.placeholder:""}}]),t}(d.Component),Object(l.a)(n.prototype,"onFocus",[u.a],Object.getOwnPropertyDescriptor(n.prototype,"onFocus"),n.prototype),Object(l.a)(n.prototype,"onBlur",[u.a],Object.getOwnPropertyDescriptor(n.prototype,"onBlur"),n.prototype),Object(l.a)(n.prototype,"_focusInput",[u.a],Object.getOwnPropertyDescriptor(n.prototype,"_focusInput"),n.prototype),n)},1074:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r(51),o=r(84),a=r(5),i=r(11),s=function(e,t,r,n){return{left:e,top:t,right:r,bottom:n}},c=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((function(e,t){var r=t.x,n=t.y;return s(Math.min(e.left,r),Math.min(e.top,n),Math.max(e.right,r),Math.max(e.bottom,n))}),s(e.x,e.y,e.x,e.y))},l=function(e,t){return s(Math.max(e.left,t.left),Math.max(e.top,t.top),Math.min(e.right,t.right),Math.min(e.bottom,t.bottom))},p=function(e,t){var r=t.x,n=t.y,o=r-e.left,a=r-e.right,i=n-e.top,s=n-e.bottom;return{x:o<0?o:a>0?a:0,y:i<0?i:s>0?s:0}},u=function(){function e(t){Object(a.a)(this,e),this.minRectWidth=100,this.minRectHeight=100,this.keepHistoryFor=5e3,this.positions=[],this.center={x:0,y:0},this.now=Date.now,Object.assign(this,t)}return Object(i.a)(e,[{key:"update",value:function(t){var r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.center,s=i.x,u=i.y,d=c.apply(void 0,[{x:s-this.minRectWidth/2,y:u-this.minRectHeight/2},{x:s+this.minRectWidth/2,y:u+this.minRectHeight/2}].concat(Object(o.a)(this.positions))),h=a?l(a,d):d,m=p(h,t),f=this.now(),y=this.positions.filter((function(e){return f-e.ts<r.keepHistoryFor})),v=[].concat(Object(o.a)(y),[Object(n.a)({},t,{ts:f})]),b=m.x||m.y?{x:s+m.x,y:u+m.y}:this.center;return new e({positions:v,center:b})}}]),e}();u.empty=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new u(e)};var d=function(e){var t=u.empty();return function(r){var n=r.x,o=r.y,a=e.padding,i=void 0===a?20:a,c={x:e.zoom*n,y:e.zoom*o},l=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!t)return null;var n=e.getBoundingClientRect(),o=t.getBoundingClientRect(),a=o.left-n.left,i=o.top-n.top;return s(a+r,i+r,a+o.width-r,i+o.height-r)}(e.vmContainer,e.vmKeyhole,i),p=t.update(c,l);if(p.center!==t.center){var u=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.minSmoothDist,o=void 0===n?10:n,a=r.maxIntermediatePoints,i=void 0===a?8:a,s=t.x-e.x,c=t.y-e.y,l=Math.max(Math.abs(s),Math.abs(c)),p=Math.floor(l/o)+1,u=Math.min(i,p),d=Array.from({length:u},(function(e,t){return(t+1)/u})),h=d.map((function(t){return{x:e.x+t*s,y:e.y+t*c}}));return h}(t.center,p.center),d=!0,h=!1,m=void 0;try{for(var f,y=u[Symbol.iterator]();!(d=(f=y.next()).done);d=!0){var v=f.value;e.setState({keyholeCenter:v})}}catch(b){h=!0,m=b}finally{try{d||null==y.return||y.return()}finally{if(h)throw m}}}t=p}},h=function(e){var t=u.empty();return{moveCenter:function(r){var n=e.zoomPointerDimensions,o=n.width,a=n.height,i=e.padding,s=void 0===i?20:i,c=o/2,l=a/2,p=t.center,u={left:p.x-c+s,top:p.y-l+s,right:p.x+c-s,bottom:p.y+l-s},d=t.update(r,u);d.center!==t.center&&e.setState({zoomPointerCenter:d.center}),t=d},resetHistory:function(){return t=u.empty()}}}},1076:function(e,t,r){"use strict";r.d(t,"f",(function(){return o})),r.d(t,"d",(function(){return a})),r.d(t,"g",(function(){return i})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"e",(function(){return p}));var n=r(0),o=function(e){return e.type!==n.s.Instruction},a=function(e,t){return!!t.find((function(t){return t.order<e.order&&t.paid&&o(t)&&t.state===n.h.NotCompleted}))},i=function(e){return e.type===n.s.ChallengePeerApproval||e.type===n.s.ChallengeHostApproval},s=function(e){return e.map((function(e){return o(e)&&e.state===n.h.Approved||!o(e)})).reduce((function(e,t){return!(!e||!t)}))},c=function(e){return e.filter((function(e){return e.state===n.h.Rejected}))},l=function(e){return!!function(e){return e.filter((function(e){return o(e)&&e.state===n.h.Submitted}))}(e).count()},p=function(e){return!!c(e).count()}},1077:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r(166);var n=function(e){if(!e)return"-";var t=Math.floor(e/1e3),r=Math.floor(t/60),n=Math.floor(r/60),a=r-60*n,i=t-60*r,s="";return n&&(s="".concat(o(n),":")),"".concat(s).concat(o(a),":").concat(o(i))},o=function(e){return"".concat(e<10?0:"").concat(e)}},1078:function(e,t,r){"use strict";r.d(t,"e",(function(){return n})),r.d(t,"f",(function(){return o})),r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"j",(function(){return s})),r.d(t,"k",(function(){return c})),r.d(t,"i",(function(){return l})),r.d(t,"g",(function(){return p})),r.d(t,"h",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return h}));var n=function(e,t){return t.some((function(t){return t.courseId===e.id}))},o=function(e,t){var r=new Date;return t.some((function(t){return t.courseId===e.id&&t.startTime>r}))},a=function(e,t){return t.some((function(t){return t.courseId===e.id&&l(t)}))},i=function(e,t){return t.some((function(t){return t.courseId===e.id&&p(t)}))},s=function(e,t,r){return d(e,t,r).some((function(e){return p(e)}))},c=function(e,t,r){return d(e,t,r).some((function(e){return l(e)}))},l=function(e){return new Date>e.startTime&&!u(e)},p=function(e){var t=new Date,r=e.startTime.getTime()-t.getTime();return r>0&&r<6e5},u=function(e){var t=new Date;return t>e.expirationTime||!!e.endTime&&t>e.endTime},d=function(e,t,r){var n=t.filter((function(t){return t.templateId===e.id})).map((function(e){return e.id}));return r.filter((function(e){return n.includes(e.courseId)})).toList()},h=function(e,t){return t.find((function(t){return t.courseId===e.id&&!!t.courseraTeachUrl&&l(t)}))||null}},1079:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=r(165),p=(r(1325),function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:"rhyme-v2-bg",style:this.props.overflow?{overflow:this.props.overflow}:{}},c.createElement("div",{className:"shape-second"}),c.createElement("div",{className:"shape-gray2"}))}}]),t}(c.PureComponent)),u=function(e){function t(){var e,r;Object(n.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(r=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s))))._bgContainer=void 0,r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this._appendBackground()}},{key:"render",value:function(){return null}},{key:"componentWillUnmount",value:function(){(this.props.wrapper?this.props.wrapper:document.body).removeChild(this._bgContainer)}},{key:"_appendBackground",value:function(){this._bgContainer=document.createElement("div"),(this.props.wrapper?this.props.wrapper:document.body).appendChild(this._bgContainer),l.render(c.createElement(p,this.props),this._bgContainer)}}]),t}(c.PureComponent)},1080:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return s}));var n=r(5),o=r(11),a=Math.pow(2,32)-1,i=0,s=function(){function e(){Object(n.a)(this,e),this.version=new Uint8Array([i]),this.packetSize=5}return Object(o.a)(e,[{key:"encodeExpandModeEvent",value:function(e,t){if(e>a)throw new Error("Cannot encode time stamps bigger than 32bit");var r=new Uint32Array([e]),n=new Uint8Array([t]);return new Blob([r,n])}},{key:"decodeBuffer",value:function(e){for(var t=[],r=0;r+5<=e.byteLength;r+=5){var n=new DataView(e,r,5);t.push(this.decodePacket(n))}if(r!==e.byteLength)throw new Error("Invalid package size. It is not dividable by ".concat(5,"."));return t}},{key:"decodePacket",value:function(e){if(5===e.byteLength)return[e.getUint32(0,!0),e.getUint8(4)];throw new Error("Cannot decode packet with size "+e.byteLength)}},{key:"getPacketTimestamp",value:function(e,t){return e.getUint32(t,!0)}},{key:"setPacketTimestamp",value:function(e,t,r){return e.setUint32(t,r,!0)}}]),e}()},1081:function(e,t,r){"use strict";var n=r(1059);r.d(t,"EventType",(function(){return n.a}));var o=r(1103);r.o(o,"InputPlayerView")&&r.d(t,"InputPlayerView",(function(){return o.InputPlayerView}));var a=r(1054);r.d(t,"toArrayBuffer",(function(){return a.c})),r.d(t,"createInputCodec",(function(){return a.a}));var i=r(1067);r.d(t,"InputPlayerView",(function(){return i.a}))},1085:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=(r(1304),r(1051)),p=function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:"rhyme-btn "+(this.props.className||"")},c.createElement("button",{className:"native-btn",onClick:this.props.onClick,disabled:this.disabled,type:this.type}),c.createElement("div",{className:"rendered-btn"},this.props.loading?c.createElement(l.a,null):this.props.children))}},{key:"disabled",get:function(){return this.props.disabled||this.props.loading}},{key:"type",get:function(){return this.props.type||"submit"}}]),t}(c.Component)},1086:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=(r(1306),r(1051)),p=function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("button",{className:"rhyme-btn2 "+(this.props.className||""),onClick:this.props.onClick,disabled:this.disabled,type:this.type},this.props.loading?c.createElement(c.Fragment,null,c.createElement(l.a,{theme:(this.props.className||"").indexOf("empty")<0?"light":"dark"}),"\xa0"):this.props.children)}},{key:"disabled",get:function(){return this.props.disabled||this.props.loading}},{key:"type",get:function(){return this.props.type||"submit"}}]),t}(c.Component)},1087:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"e",(function(){return s})),r.d(t,"b",(function(){return c}));var n=r(0),o=function(e){return"pending"===e.status},a=function(e){return"transcribed"===e.status},i=function(e,t){if(t){var r=e.subtitles.get(t);return r&&a(r)}return e.subtitles.some(a)},s=function(e){return e.split("-")[0]},c=function(e){return e?e.track.language===n.Y.arSA.slice(0,2)?"rtl":"ltr":"ltr"}},1089:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return O}));var n,o=r(47),a=r(5),i=r(11),s=r(30),c=r(28),l=r(29),p=r(90),u=r(4),d=r(165),h=r(91),m=r.n(h),f=r(14),y=r(1070),v=(r(1182),r(1347).default),b=600,g=500,O=(n=function(e){function t(e){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(c.a)(t).call(this,e)))._splitter=void 0,r._leftResolver=void 0,r._rightResolver=void 0,r._leftPromise=new Promise((function(e){return r._leftResolver=e})),r._rightPromise=new Promise((function(e){return r._rightResolver=e})),r._resizeEntry=void 0,r._rightPanelSize=void 0,r.state={resizing:!1},r.props.onPanelsRefs&&Promise.all([r._leftPromise,r._rightPromise]).then((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return r.props.onPanelsRefs(n,a)})),r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._configureSplitter(),this._resizeEntry=y.b.create({delay:0},(function(){e._onResize(e._rightPanelSize)}))}},{key:"componentDidUpdate",value:function(){this._configureSplitter()}},{key:"componentWillUnmount",value:function(){y.b.destroy(this._resizeEntry)}},{key:"onResizeStart",value:function(){this.setState({resizing:!0}),this.props.onResizeStart&&this.props.onResizeStart()}},{key:"onResizeEnd",value:function(){this.setState({resizing:!1}),this.props.onResizeEnd&&this.props.onResizeEnd()}},{key:"onResize",value:function(e){this._rightPanelSize=e,this._onResize(this._rightPanelSize)}},{key:"render",value:function(){var e=this,t=this.props.children;return u.createElement(v,{ref:function(t){return e._splitter=t},onDragStart:this.onResizeStart,onSecondaryPaneSizeChange:this.onResize,onDragEnd:this.onResizeEnd,primaryMinSize:b,secondaryInitialSize:this.props.rightPanelInitialSize,customClassName:"split-view "+(this.props.className||"")},t&&t[0]?u.createElement("section",{className:"left-panel",ref:this._leftResolver},this.state.resizing?u.createElement("div",{className:"overlay"}):null,t[0]):null,t&&t[1]?u.createElement("section",{className:"right-panel",ref:this._rightResolver},t[1]):null)}},{key:"_createDotWrapper",value:function(){var e=function(){var e=document.createElement("i");return e.className="fa fa-circle",e},t=document.createElement("div");return t.appendChild(e()),t.appendChild(e()),t.appendChild(e()),t.className="dot-wrapper",t}},{key:"_configureSplitter",value:function(){if(this._splitter){var e=Object(d.findDOMNode)(this._splitter);if(!e||e instanceof Text)return;var t=e.querySelector(".splitter-layout > .layout-splitter");if(t)t.querySelector(".dot-wrapper")||t.appendChild(this._createDotWrapper())}}},{key:"_onResize",value:function(e){if(this.props.onResize){var t=window.innerWidth-e-f.a.SplitterWidth;this.props.onResize(t,e)}}}]),t}(u.Component),Object(p.a)(n.prototype,"onResizeStart",[m.a],Object.getOwnPropertyDescriptor(n.prototype,"onResizeStart"),n.prototype),Object(p.a)(n.prototype,"onResizeEnd",[m.a],Object.getOwnPropertyDescriptor(n.prototype,"onResizeEnd"),n.prototype),Object(p.a)(n.prototype,"onResize",[m.a],Object.getOwnPropertyDescriptor(n.prototype,"onResize"),n.prototype),n)},1092:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=(r(1179),function(e){function t(){var e,r;Object(n.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(r=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s))))._wrapperRef=void 0,r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.forceUpdate()}))}},{key:"getScale",value:function(){var e={scaleX:1,scaleY:1,width:0,height:0};if(this._wrapperRef&&this._wrapperRef.children[0]){var t=this.props.scaledWidth;(void 0===t||isNaN(t))&&(t=this._wrapperRef.parentElement.clientWidth),e.scaleX=t/this.props.originalWidth;var r=t/(this.props.originalWidth/this.props.originalHeight);e.scaleY=r/this.props.originalHeight,e.height=r,e.width=t}return!isNaN(e.width)&&!isNaN(e.height)&&isFinite(e.scaleX)&&isFinite(e.scaleY)?e:{scaleX:1,scaleY:1,width:0,height:0}}},{key:"render",value:function(){var e=this,t=this.props.children,r=this.getScale(),n=r.scaleX,o=r.scaleY,a=r.width,i=r.height;if(t.length&&t.length>=2)throw new Error("Only one scalable child allowed");var s={WebkitTransform:"scale(".concat(n,", ").concat(o,")"),msTransform:"scale(".concat(n,", ").concat(o,")"),transform:"scale(".concat(n,", ").concat(o,")"),WebkitTransformOrigin:"0 0 0",msTransformOrigin:"0 0 0",transformOrigin:"0 0 0"};return c.createElement("div",{ref:function(t){e._wrapperRef=t},style:Object.assign({width:a,height:i},this.props.style),className:"scalable-component"},c.cloneElement(t,{style:s}))}}]),t}(c.Component))},1094:function(e,t,r){"use strict";var n=r(5),o=r(30),a=r(28),i=r(11),s=r(29),c=r(4),l=r.n(c),p=(r(1168),r(1111));function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var h=l.a.createElement("defs",null,l.a.createElement("path",{id:"trash-a",d:"M19.1022222,10.6666667 L28.8985185,10.6666667 L28.417037,9.22296296 C28.1140741,8.31407407 27.2666667,7.7037037 26.3088889,7.7037037 L21.6911111,7.7037037 C20.7333333,7.7037037 19.8866667,8.31407407 19.582963,9.22296296 L19.1022222,10.6666667 Z M14.3340741,40.2962963 L33.6659259,40.2962963 L35.0733333,12.1481481 L12.9274074,12.1481481 L14.3340741,40.2962963 Z M26.3088889,6.22222222 C27.9059259,6.22222222 29.3177778,7.24 29.822963,8.75481481 L30.46,10.6666667 L38.8148148,10.6666667 L38.8148148,12.1481481 L36.5562963,12.1481481 L35.0748148,41.7777778 L12.9251852,41.7777778 L11.4437037,12.1481481 L9.18518519,12.1481481 L9.18518519,10.6666667 L17.5407407,10.6666667 L18.1777778,8.75481481 C18.682963,7.24 20.0948148,6.22222222 21.6911111,6.22222222 L26.3088889,6.22222222 Z M20.6661481,17.2995556 L19.1861481,17.366963 L19.9268889,33.6632593 L21.4068889,33.5958519 L20.6661481,17.2995556 Z M27.3342963,17.2995556 L26.5935556,33.5958519 L28.0735556,33.6632593 L28.8142963,17.366963 L27.3342963,17.2995556 Z"})),m=l.a.createElement("use",{fill:"#1F1F1F",fillRule:"evenodd",xlinkHref:"#trash-a"}),f=function(e){var t=e.svgRef,r=e.title,n=d(e,["svgRef","title"]);return l.a.createElement("svg",u({width:48,height:48,viewBox:"0 0 48 48",ref:t},n),r?l.a.createElement("title",null,r):null,h,m)},y=l.a.forwardRef((function(e,t){return l.a.createElement(f,u({svgRef:t},e))}));r.p;function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function b(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var g=l.a.createElement("title",null,"RHYME/SHAPES/48x48/Trim"),O=l.a.createElement("g",{id:"RHYME/SHAPES/48x48/Trim",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round"},l.a.createElement("path",{d:"M14.1212418,32.4102325 C16.5760566,32.4102325 18.5642047,34.3998622 18.5642047,36.854677 C18.5642047,39.3087511 16.5760566,41.2991214 14.1212418,41.2991214 C11.666427,41.2991214 9.67531586,39.3087511 9.67531586,36.854677 C9.67531586,34.3998622 11.666427,32.4102325 14.1212418,32.4102325 Z M33.8892,32.4102325 C36.3425333,32.4102325 38.3336444,34.4006029 38.3336444,36.854677 C38.3336444,39.3087511 36.3440148,41.2991214 33.8892,41.2991214 C31.4329037,41.2991214 29.4447556,39.3087511 29.4447556,36.854677 C29.4447556,34.3998622 31.4329037,32.4102325 33.8892,32.4102325 Z M30.1111111,39.2222222 L14.5555556,7 M17.8888889,39.2222222 L33.4444444,7",id:"Scissors-Shape",stroke:"#1F1F1F",strokeWidth:1.5})),k=function(e){var t=e.svgRef,r=e.title,n=b(e,["svgRef","title"]);return l.a.createElement("svg",v({width:"48px",height:"48px",viewBox:"0 0 48 48",ref:t},n),void 0===r?g:r?l.a.createElement("title",null,r):null,O)},C=l.a.forwardRef((function(e,t){return l.a.createElement(k,v({svgRef:t},e))})),w=(r.p,r(1112)),j=r(1050),E=r.n(j),_=r(8),S=r(1060),D=r(133),P=(r(1176),function(e){function t(){var e,r;Object(n.a)(this,t);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return(r=Object(o.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(s)))).state={tooltipVisible:!1,tooltipTimestamp:0,thumbDragging:!1,trimDragging:!1,skipOddFrames:!0},r._trackRef=c.createRef(),r._trackRect={left:0,width:0},r._resizeObserver=new S.a((function(){return r.updateTrackRect()})),r.updateTrackRect=function(){if(r._trackRef.current){var e=r._trackRef.current.getBoundingClientRect(),t=e.left,n=e.width;r._trackRect={left:t,width:n}}else r._trackRect={left:0,width:0};var o=r._trackRect.width<480;r.state.skipOddFrames!==o&&r.setState({skipOddFrames:o})},r.onProgressClick=function(e){var t=e.clientX;if(isFinite(r.props.totalDuration)){var n=r._trackRect,o=n.left,a=n.width,i=t-o;r._onSeek(r.props.totalDuration*(i/a))}},r.onShowToolTip=function(e){var t=e.clientX;r.updateTrackRect(),r.setState({tooltipVisible:!0,tooltipTimestamp:r._calculateTooltipTimestamp(t)})},r.onHideToolTip=function(){r.state.thumbDragging||r.setState({tooltipVisible:!1})},r.onThumbMouseDown=function(){r.setState({thumbDragging:!0}),document.body.style.cursor="grabbing"},r.onTrimThumbMouseDown=function(){r.props.trimDisabled||(r.setState({trimDragging:!0}),document.body.style.cursor="grabbing")},r._docMouseMove=function(e){var t=e.clientX;if(r.state.thumbDragging||r.state.trimDragging){var n=r._trackRect,o=(t-n.left)/n.width,a=r.props.totalDuration*o;0<=a&&a<=r.props.totalDuration&&(r.state.thumbDragging&&(r.props.onThumbDrag(),r._onSeek(a)),r.state.trimDragging&&r.props.onTrimDrag(a))}r.state.tooltipVisible&&r.setState({tooltipTimestamp:r._calculateTooltipTimestamp(t)})},r._docMouseUp=function(){r.state.thumbDragging&&r.props.onThumbRelease(),r.state.trimDragging&&r.props.onTrimRelease(),r.setState({thumbDragging:!1,trimDragging:!1,tooltipVisible:!1}),document.body.style.cursor="default"},r}return Object(s.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this._docMouseMove),document.addEventListener("mouseup",this._docMouseUp),this._trackRef.current&&this._resizeObserver.observe(this._trackRef.current)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this._docMouseMove),document.removeEventListener("mouseup",this._docMouseUp),this._resizeObserver.disconnect()}},{key:"render",value:function(){var e=this._durationPercent(this.props.currentTime),t=this.props.totalDuration-this.props.trimEndDuration,r=this._durationPercent(t),n=t/this.props.totalDuration<.9;return c.createElement("div",{className:"trim-progress-bar"},c.createElement("div",{className:E()("track-cont",this.props.trimActive&&"trim-active")},c.createElement("div",{className:E()("tooltip",this.state.tooltipVisible&&"visible"),style:{left:this._durationPercent(this.state.tooltipTimestamp)}},Object(D.d)(this.props.startOffsetTime+this.state.tooltipTimestamp)),c.createElement("div",{className:"start-label"},Object(D.d)(this.props.startOffsetTime)),n&&c.createElement("div",{className:"end-label",style:{left:"100%"}},Object(D.d)(this.props.startOffsetTime+this.props.totalDuration)),c.createElement("div",{className:"trim-label",style:{left:r}},Object(D.d)(this.props.startOffsetTime+t)),c.createElement("div",{className:"track",ref:this._trackRef,onClick:this.onProgressClick,onMouseEnter:this.onShowToolTip,onMouseLeave:this.onHideToolTip},this.visibleFrames.map((function(e){return c.createElement("img",{key:e.durationFraction,src:e.url,className:"keyframe",style:{left:100*e.durationFraction+"%"}})}))),c.createElement("div",{className:"trim-box"},c.createElement("div",{className:"trim-window",style:{width:r}}),c.createElement("div",{className:"trim-dim",style:{left:r}})),c.createElement("div",{className:E()("trim-thumb",this.state.trimDragging&&"hold",this.props.trimDisabled&&"disabled"),style:{left:r},onMouseDown:this.onTrimThumbMouseDown},!this.props.trimDisabled&&c.createElement("div",{className:"trim-handle"})),c.createElement("div",{style:{left:e},className:E()("thumb",this.state.thumbDragging&&"hold"),onMouseEnter:this.onShowToolTip,onMouseLeave:this.onHideToolTip,onMouseDown:this.onThumbMouseDown})))}},{key:"_durationPercent",value:function(e){return e/this.props.totalDuration*100+"%"}},{key:"_calculateTooltipTimestamp",value:function(e){if(this._trackRect.width){var t=this._trackRect.width,r=this._trackRect.left,n=Math.max(e-r,0)/t;return Math.round(this.props.totalDuration*n*1e3)/1e3}return 0}},{key:"_onSeek",value:function(e){this.props.disabled||this.props.onSeek(e)}},{key:"visibleFrames",get:function(){return this.props.frames?this.state.skipOddFrames?this.props.frames.filter((function(e,t){return t%2===0})):this.props.frames:Object(_.List)()}}]),t}(c.PureComponent));r.d(t,"a",(function(){return T}));var T=function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(o.a)(this,Object(a.a)(t).call(this,e))).state={playing:!1,currentTime:0,trimEndDuration:0},r._controlsService=void 0,r._draggingWhilePlaying=void 0,r.onPlayerTimeUpdated=function(e){var t=r.trimTimestamp;e>r.trimTimestamp?(r._controlsService.onPause(),r._controlsService.onSeek(t)):r.setState({currentTime:e})},r.onPlay=function(){r.disabled||r._controlsService.onPlay()},r.onPause=function(){r.disabled||r._controlsService.onPause()},r.onSeek=function(e){r.disabled||r._controlsService.onSeek(e)},r.onThumbDrag=function(){r.state.playing&&(r._controlsService.onPause(),r._draggingWhilePlaying=!0)},r.onTrimDrag=function(e){r.state.playing&&(r._controlsService.onPause(),r._draggingWhilePlaying=!0),e=Math.max(e,1),r.setState({trimEndDuration:r.duration-e})},r.onThumbRelease=function(){r._draggingWhilePlaying&&(r._draggingWhilePlaying=!1,r._controlsService.onPlay())},r.onTrimRelease=function(){var e=Math.max(0,r.trimTimestamp-3);e<r.state.currentTime&&r._controlsService.onSeek(e),r._draggingWhilePlaying&&(r._draggingWhilePlaying=!1,r._controlsService.onPlay())},r.onTrim=function(){r.trimActive&&(r.state.playing&&r._controlsService.onPause(),r.props.onTrim(1e3*r.trimTimestamp))},r.onDelete=function(){r.state.playing&&r._controlsService.onPause(),r.props.onDelete()},r._controlsService=new p.b(r.props.dispatch,{currentChapter:null,course:null}),r._controlsService.onPlayerPlaying((function(e){return r.setState({playing:e})})),r._controlsService.onPlayerTimeUpdated(r.onPlayerTimeUpdated),r}return Object(s.a)(t,e),Object(i.a)(t,[{key:"disabled",get:function(){return!(this.props.videoPlayer&&this.props.canPlayVideo)}},{key:"duration",get:function(){return this.props.videoPlayer?this.props.videoPlayer.duration:0}},{key:"trimTimestamp",get:function(){return Math.max(0,this.duration-this.state.trimEndDuration)}},{key:"trimDisabled",get:function(){return this.props.trimDisabled}},{key:"trimActive",get:function(){return!this.props.trimDisabled&&!(this.state.trimEndDuration<.1)}}]),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.videoPlayer!==e.videoPlayer&&this._controlsService.setRefs(this.props.videoPlayer),this.props.canPlayVideo&&!e.canPlayVideo&&(this.setState({trimEndDuration:0,currentTime:0}),this.props.autoPlay&&this._controlsService.onPlay())}},{key:"render",value:function(){return c.createElement("div",{className:"edit-video-controls "+(this.disabled?" disabled":"")},c.createElement("div",{className:"progress-container"},c.createElement(w.a,{playing:this.state.playing,onClick:this.state.playing?this.onPause:this.onPlay}),c.createElement(P,{disabled:this.disabled,onSeek:this.onSeek,startOffsetTime:this.props.startOffsetTime,totalDuration:this.duration,currentTime:this.state.currentTime,trimDisabled:this.trimDisabled,trimActive:this.trimActive,onThumbDrag:this.onThumbDrag,onThumbRelease:this.onThumbRelease,trimEndDuration:this.state.trimEndDuration,onTrimDrag:this.onTrimDrag,onTrimRelease:this.onTrimRelease,frames:this.props.frames})),c.createElement("div",{className:"buttons"},c.createElement("button",{disabled:!this.trimActive,onClick:this.onTrim},c.createElement(C,null),c.createElement("span",null,"TRIM")),c.createElement("button",{disabled:!this.props.canPlayVideo,onClick:this.onDelete},c.createElement(y,null),c.createElement("span",null,"DELETE"))))}}]),t}(c.Component)},1095:function(e,t,r){"use strict";var n,o,a,i=r(5),s=r(11),c=r(30),l=r(28),p=r(29),u=r(90),d=r(4),h=(r(1257),r(91)),m=r.n(h),f=r(54),y=r(62),v=r(71),b=r(12),g=r(22),O=r(21),k=r(1061),C=(r(1047),r(1298),r(1045)),w=r(289),j=(n=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"closeModal",value:function(){this.props.onToggle(!1)}},{key:"logout",value:function(){Object(O.b)().logout()}},{key:"render",value:function(){return d.createElement(w.a,{title:"Are you sure?",visible:this.props.visible,onToggle:this.props.onToggle},d.createElement("div",{className:"logout-modal form-styles"},d.createElement("p",{className:"text"},"Are you sure you want to log out?"),d.createElement("div",null,d.createElement(C.a,{onClick:this.closeModal,className:"short-btn"},"No, Stay")),d.createElement("div",null,d.createElement(C.a,{onClick:this.logout,className:"short-btn empty"},"Yes, Logout")),d.createElement("i",{className:"fa fa-power-off"})))}}]),t}(d.Component),Object(u.a)(n.prototype,"closeModal",[m.a],Object.getOwnPropertyDescriptor(n.prototype,"closeModal"),n.prototype),Object(u.a)(n.prototype,"logout",[m.a],Object.getOwnPropertyDescriptor(n.prototype,"logout"),n.prototype),n),E=(r(1324),o=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"close",value:function(){this.props.onToggle(!1)}},{key:"discard",value:function(){this.close(),this.props.onDiscard()}},{key:"render",value:function(){return d.createElement("div",{className:"unsaved-session-modal form-styles"},d.createElement(w.a,{title:"Are you sure?",visible:this.props.visible,onToggle:this.props.onToggle},d.createElement("p",{className:"text"},"You have not finished creating the session. So, it will be discarded."),d.createElement("div",{className:"row"},d.createElement(C.a,{onClick:this.close},"No, Stay"),d.createElement(C.a,{onClick:this.discard,className:"empty"},"Yes, Discard")),d.createElement("div",{className:"trash-icon"})))}}]),t}(d.Component),Object(u.a)(o.prototype,"close",[m.a],Object.getOwnPropertyDescriptor(o.prototype,"close"),o.prototype),Object(u.a)(o.prototype,"discard",[m.a],Object.getOwnPropertyDescriptor(o.prototype,"discard"),o.prototype),o);r.d(t,"a",(function(){return S}));var _=(a=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={menuVisible:!1,logoutModalVisible:!1,unsavedModalVisible:!1},r._docClickCb=void 0,r._stopPropagation=void 0,r._root=void 0,r._headerLine=void 0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docClickCb=function(){e._stopPropagation||e.setState({menuVisible:!1}),e._stopPropagation=!1}),this._root=document.getElementById("root"),this._root&&(this._headerLine=document.createElement("div"),this._headerLine.className="header-line",this._root.appendChild(this._headerLine))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docClickCb),this._root&&this._root.removeChild(this._headerLine)}},{key:"toggleMenu",value:function(e){this.setState({menuVisible:!this.state.menuVisible}),this._stopPropagation=!0}},{key:"navigateToMySessions",value:function(){this.props.location.pathname.startsWith(b.E)?this.toggleUnsavedModal(!0):this.goToDashboard()}},{key:"navigateToAdmin",value:function(){window.location.href=b.a+"?token="+Object(O.b)().getJwt()}},{key:"goToDashboard",value:function(){this.props.redirectTo(b.qb)}},{key:"logout",value:function(){this.toggleLogoutModal(!0)}},{key:"toggleLogoutModal",value:function(e){this.setState({logoutModalVisible:e})}},{key:"toggleUnsavedModal",value:function(e){this.setState({unsavedModalVisible:e})}},{key:"authLayout",value:function(){return d.createElement("div",{className:"menu"+(this.state.menuVisible?" visible":"")},d.createElement("div",{className:"avatar-wrapper",onClick:this.toggleMenu},d.createElement(k.a,{source:this.props.user})),d.createElement("ul",null,d.createElement("li",{onClick:this.navigateToMySessions},"Dashboard"),this.props.canAccessAdminPanel&&d.createElement("li",{onClick:this.navigateToAdmin},"Admin Panel"),d.createElement("li",{onClick:this.logout},"Logout")),d.createElement(j,{visible:this.state.logoutModalVisible,onToggle:this.toggleLogoutModal}),d.createElement(E,{visible:this.state.unsavedModalVisible,onToggle:this.toggleUnsavedModal,onDiscard:this.goToDashboard}))}},{key:"unauthLayout",value:function(){return d.createElement("div",{className:"links"},d.createElement("a",{href:b.db},"Home"))}},{key:"render",value:function(){return d.createElement("header",{className:"app-header"},d.createElement("a",{href:b.db},d.createElement("div",{className:"logo"})),Object(O.b)().isAuthorized()?this.authLayout():this.unauthLayout())}}]),t}(d.Component),Object(u.a)(a.prototype,"toggleMenu",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"toggleMenu"),a.prototype),Object(u.a)(a.prototype,"navigateToMySessions",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"navigateToMySessions"),a.prototype),Object(u.a)(a.prototype,"navigateToAdmin",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"navigateToAdmin"),a.prototype),Object(u.a)(a.prototype,"goToDashboard",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"goToDashboard"),a.prototype),Object(u.a)(a.prototype,"logout",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"logout"),a.prototype),Object(u.a)(a.prototype,"toggleLogoutModal",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"toggleLogoutModal"),a.prototype),Object(u.a)(a.prototype,"toggleUnsavedModal",[m.a],Object.getOwnPropertyDescriptor(a.prototype,"toggleUnsavedModal"),a.prototype),a),S=Object(v.g)(Object(y.c)((function(e){return{user:e.user,canAccessAdminPanel:Object(g.a)(e)}}),(function(e){return{redirectTo:function(t){return e(Object(f.g)(t))}}}))(_))},1097:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,o=r(51),a=r(5),i=r(11),s=r(30),c=r(28),l=r(29),p=r(90),u=r(4),d=(r(1311),r(91)),h=r.n(d),m=r(1150),f=r(291),y=(n=function(e){function t(e){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(c.a)(t).call(this,e)))._selectLock=void 0,r._isInputChanged=void 0,r._docKeydownEventCb=void 0,r._docClickEventCb=void 0,r._listRef=void 0,r._inputRef=void 0,r.state={visible:!1,focused:!1,highlighted:null,selected:r._getSelectedOption(e.children,e.value),inputValue:e.value?e.value:""},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this._docKeydownEventCb=function(t){return e._keyboardControl(t)}),document.addEventListener("click",this._docClickEventCb=function(){return e._unfocusComponent()})}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&(this.setState({selected:this._getSelectedOption(e.children,e.value)}),this._isInputChanged=!1),e.value!==this.state.inputValue&&this.setState({inputValue:e.value?e.value:""}),e.children!==this.props.children&&this.setState({selected:this._getSelectedOption(e.children,e.value)})}},{key:"componentDidUpdate",value:function(e,t){this.state.visible&&this.state.visible!==t.visible&&this.props.value&&(this.scrollToOption(this.props.value),this.props.onShowOptions&&this.props.onShowOptions()),this.state.focused&&this.state.focused!==t.focused&&this._inputRef.focus()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._docKeydownEventCb),document.removeEventListener("click",this._docClickEventCb)}},{key:"selectOption",value:function(e){for(var t=e.target;t&&!t.hasAttribute("data-value");)t=t.parentElement;if(t){var r=t.getAttribute("data-value"),n=this.props.children.find((function(e){return e.props.value===r}));n&&!n.props.disabled&&this._updateSelected(n)}}},{key:"toggleOptions",value:function(){this._selectLock=!0;var e=!this.state.visible;this.props.editable&&e&&this._focusInput(),this.setState({visible:e,focused:e})}},{key:"onInputChange",value:function(e){this._isInputChanged=!0;var t=e.target.value;this.setState({inputValue:t})}},{key:"onBlur",value:function(e){this.props.onBlur&&this.props.onBlur(e),this.props.editable&&this._isInputChanged&&this._updateWithInputValue(e.target)}},{key:"onFocus",value:function(e){this.props.disabled||(this.props.onFocus&&this.props.onFocus(e),this.setState({focused:!0,visible:!0}))}},{key:"renderSelected",value:function(){var e=this.props.selectedFilter?this.props.selectedFilter:function(e){return e};return this.state.selected?e(this.state.selected.props.children):this.props.deletedOnMissingOption?"- Deleted -":this.props.value?e(this.props.value):this.props.placeholder?this.props.placeholder:""}},{key:"scrollToOption",value:function(e){var t=this._listRef.querySelector('li[data-value="'.concat(e,'"]')),r=t?t.offsetTop:0;this._listRef.scrollTop=r}},{key:"render",value:function(){var e=this,t=this._updateChildrenProps(),r=this.renderSelected();return u.createElement("div",{className:"rhyme-select"+(this.props.className?" ".concat(this.props.className):"")+(this.state.visible?" visible":"")+(this.state.focused?" focused":"")+(this.props.dirty?" dirty":"")+(this.props.editable?" editable":"")+(this.props.disabled?" disabled":""),"data-value":r},u.createElement("input",{ref:function(t){return e._inputRef=t},className:"focus",value:this.state.inputValue,onChange:this.onInputChange,onFocus:this.onFocus,onBlur:this.onBlur}),u.createElement("div",{className:"selected",onClick:this.toggleOptions},this.props.label&&u.createElement("span",{className:"label"},this.props.label),u.createElement("div",{className:"value"},r)),u.createElement("ul",{ref:function(t){return e._listRef=t},className:"options",onClick:this.selectOption},t),u.createElement("div",{className:"arrow",onClick:this.toggleOptions}))}},{key:"_updateSelected",value:function(e){this.setState({selected:e}),this.props.onChange(e.props.value)}},{key:"_keyboardControl",value:function(e){if(this.state.focused){[f.e,f.b,f.g].forEach((function(t){t===e.keyCode&&e.preventDefault()}));var t=this.state.highlighted,r=this.props.children;switch(e.keyCode){case f.b:this._showOptionsIfHidden(),this.setState({highlighted:Object(m.a)(r,t,0,r.length-1)});break;case f.e:this._showOptionsIfHidden(),this.setState({highlighted:Object(m.a)(r,t,r.length-1,0)});break;case f.g:this.props.editable&&this._isInputChanged?this._updateWithInputValue(e.target):t&&this._updateSelected(t),this._unfocusComponent();break;case f.h:case f.m:this._unfocusComponent()}}}},{key:"_showOptionsIfHidden",value:function(){this.state.visible||this.setState({visible:!0})}},{key:"_unfocusComponent",value:function(){this._selectLock||this.setState({focused:!1,visible:!1}),this._selectLock=!1}},{key:"_updateChildrenProps",value:function(){var e=this;return u.Children.map(this.props.children,(function(t){var r=Object(o.a)({},t.props);return t===e.state.highlighted&&(r.highlighted=!0),e.state.selected&&t.props.value===e.state.selected.props.value&&(r.selected=!0),u.cloneElement(t,r)}))}},{key:"_focusInput",value:function(){this._inputRef.focus();var e=this._inputRef.value.length-2;this._inputRef.setSelectionRange(e,e)}},{key:"_updateWithInputValue",value:function(e){var t=e.value;this.props.onChange(t)}},{key:"_getSelectedOption",value:function(e,t){return e.find((function(e){return e.props.value===t}))||null}}]),t}(u.Component),Object(p.a)(n.prototype,"selectOption",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"selectOption"),n.prototype),Object(p.a)(n.prototype,"toggleOptions",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"toggleOptions"),n.prototype),Object(p.a)(n.prototype,"onInputChange",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"onInputChange"),n.prototype),Object(p.a)(n.prototype,"onBlur",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"onBlur"),n.prototype),Object(p.a)(n.prototype,"onFocus",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"onFocus"),n.prototype),n)},1098:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=(r(1336),function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:this.className,onClick:this.props.onClick,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut,"data-name":this.props.attribute},this.props.children)}},{key:"className",get:function(){var e="rhyme-bc";return this.props.className&&(e+=" "+this.props.className),this.props.border&&(e+=" border"),this.props.disabled&&(e+=" disabled"),e}}]),t}(c.Component))},1099:function(e,t,r){"use strict";r(1100),r(1101);var n=r(1102);r.d(t,"createExpandModeCodec",(function(){return n.a}))},1100:function(e,t){},1101:function(e,t){},1102:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(3),o=r(1058),a=r(1080),i=Object(n.a)({},a.b,(function(){return new a.a})),s=function(e){var t=Object(o.b)(e),r=i[t];if(!r)throw new Error("ExpandModeCodec with version ".concat(t," not supported"));return r()}},1103:function(e,t){},1105:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=(r(1163),function(e){var t=e.width,r=e.height,o=e.x,a=e.y,i=o-(t=isNaN(t)?0:t)/2,s=a-(r=isNaN(r)?0:r)/2;i=Math.max(i,0),s=Math.max(s,0);var c={width:t,height:r,left:i=Math.min(i,e.maxWidth-t)||0,top:s=Math.min(s,e.maxHeight-r)||0};return n.createElement("div",{className:"sc-zoom-pointer"+(e.isExpanded?" expanded":""),style:c})})},1106:function(e,t,r){"use strict";r.d(t,"b",(function(){return y})),r.d(t,"a",(function(){return v}));var n,o,a,i=r(5),s=r(11),c=r(30),l=r(28),p=r(29),u=r(90),d=r(91),h=r.n(d),m=r(50),f=r(4),y=function(){var e=new m.EventEmitter;return{emitTrackEvent:function(t){return e.emit("cuechange",t)},subscribeToTrack:function(t){return e.on("cuechange",t),function(){return e.off("cuechange",t)}}}},v=(a=o=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o))))._track=null,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return f.createElement("track",{ref:this._onTrackRef,kind:this.props.kind,srcLang:this.props.srcLang,default:this.props.default,src:this.props.url})}},{key:"_onCueChange",value:function(e){this.props.onCueChange&&this.props.onCueChange(e)}},{key:"_onTrackRef",value:function(e){this._track&&this._track.removeEventListener("cuechange",this._onCueChange),this._track=e,this._track&&this._track.addEventListener("cuechange",this._onCueChange)}}]),t}(f.PureComponent),o.defaultProps={kind:"metadata",default:!0},n=a,Object(u.a)(n.prototype,"_onCueChange",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"_onCueChange"),n.prototype),Object(u.a)(n.prototype,"_onTrackRef",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"_onTrackRef"),n.prototype),n)},1111:function(e,t,r){"use strict";r(1094);var n,o,a=r(5),i=r(11),s=r(30),c=r(28),l=r(29),p=r(90),u=r(91),d=r.n(u),h=r(4),m=r.n(h),f=r(133),y=(r(1169),function(e){return h.createElement("div",{className:"cc-toggle-button ".concat(e.showCC?"":"disabled"),onClick:e.onCCToggle,title:"Toggle captions"})}),v=r(1112),b=r(3),g=(r(1171),r(134)),O=r(1065),k=(n={},Object(b.a)(n,O.a.x025,"0.2x"),Object(b.a)(n,O.a.x050,"0.5x"),Object(b.a)(n,O.a.x075,"0.7x"),Object(b.a)(n,O.a.x100,"1x"),Object(b.a)(n,O.a.x125,"1.2x"),Object(b.a)(n,O.a.x150,"1.5x"),Object(b.a)(n,O.a.x200,"2x"),n),C=Object.values(O.a),w=(o=function(e){function t(){var e,r;Object(a.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(r=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={visible:!1},r._keyboardActionHandlers={"video.speedUp":r._changePlaybackRate(1),"video.speedDown":r._changePlaybackRate(-1)},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return h.createElement("div",{className:"playback-rate-button"+(this.props.hidden?" hidden":"")},h.createElement(g.Hotkeys,{handlers:this._keyboardActionHandlers}),h.createElement("ul",{className:"list"+(this.state.visible?" visible":"")},C.map((function(t){return h.createElement("li",{onClick:function(){return e.props.onPlaybackRateChange(t)},key:t},k[t])}))),h.createElement("span",{className:"open",onClick:this._open},k[this.props.playbackRate]))}},{key:"_open",value:function(){var e=this;this.state.visible||this.setState({visible:!0},(function(){return document.addEventListener("click",e._close)}))}},{key:"_close",value:function(){var e=this;this.state.visible&&this.setState({visible:!1},(function(){return document.removeEventListener("click",e._close)}))}},{key:"_changePlaybackRate",value:function(e){var t=this;return function(){var r=C.findIndex((function(e){return parseFloat(e)===parseFloat(t.props.playbackRate)})),n=Math.max(0,Math.min(r+e,C.length-1)),o=C[n];o&&t.props.onPlaybackRateChange(o)}}}]),t}(h.PureComponent),Object(p.a)(o.prototype,"_open",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"_open"),o.prototype),Object(p.a)(o.prototype,"_close",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"_close"),o.prototype),Object(p.a)(o.prototype,"_changePlaybackRate",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"_changePlaybackRate"),o.prototype),o);r(1172);function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function E(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var _,S=m.a.createElement("defs",null,m.a.createElement("polygon",{id:"path-next-icon",points:"35.7090909 0 35.7090909 13.2781818 15.3054545 0 15.3054545 9.96 0 0 0 26.8781818 15.3054545 16.9145455 15.3054545 26.8781818 35.7090909 13.5981818 35.7090909 26.8781818 40 26.8781818 40 0"})),D=m.a.createElement("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},m.a.createElement("g",{transform:"translate(-3341.000000, -1182.000000)",id:"Icons"},m.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},m.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},m.a.createElement("g",{id:"Icons/Next",transform:"translate(0.000000, 392.000000)"},m.a.createElement("g",{id:"Colors/Grey",transform:"translate(0.000000, 6.000000)"},m.a.createElement("mask",{id:"mask-next-icon",fill:"white"},m.a.createElement("use",{xlinkHref:"#path-next-icon"})),m.a.createElement("use",{id:"Mask",fill:"#fff",xlinkHref:"#path-next-icon"}),m.a.createElement("g",{mask:"url(#mask-next-icon)",fill:"#fff",id:"Rectangle"},m.a.createElement("g",{transform:"translate(0.000000, -6.000000)"},m.a.createElement("rect",{x:0,y:0,width:40,height:40}))))))))),P=function(e){var t=e.svgRef,r=e.title,n=E(e,["svgRef","title"]);return m.a.createElement("svg",j({viewBox:"0 0 40 27",ref:t},n),r?m.a.createElement("title",null,r):null,S,D)},T=m.a.forwardRef((function(e,t){return m.a.createElement(P,j({svgRef:t},e))})),R=(r.p,_=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"onClick",value:function(){this.props.disabled||this.props.onClick()}},{key:"render",value:function(){return h.createElement("div",{className:this.className,onClick:this.props.onClick},h.createElement(T,null))}},{key:"className",get:function(){var e="prev-next-button";switch(this.props.type){case"next":e+=" next";break;case"prev":e+=" prev"}return this.props.disabled&&(e+=" disabled"),this.props.hidden&&(e+=" hidden"),e}}]),t}(h.PureComponent),Object(p.a)(_.prototype,"onClick",[d.a],Object.getOwnPropertyDescriptor(_.prototype,"onClick"),_.prototype),_);r(1173);function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var M,V,A,I,U=m.a.createElement("defs",null),L=m.a.createElement("path",{fill:"#fff",d:"M28.37,27.09,19,27.5a27,27,0,1,1,6.61,27.16A4,4,0,0,0,20,60.31a35,35,0,1,0,.07-49.5,36.35,36.35,0,0,0-9.43,16.47,1.37,1.37,0,0,0-.07.49l-7.71.35a2.93,2.93,0,0,0-2,.84,2.7,2.7,0,0,0-.71,1.13A3.06,3.06,0,0,0,1,33.35L14.27,45.53a3,3,0,0,0,4.24-.14L30.69,32.11a3.16,3.16,0,0,0,.5-3.32A3,3,0,0,0,28.37,27.09Z"}),F=function(e){var t=e.svgRef,r=e.title,n=N(e,["svgRef","title"]);return m.a.createElement("svg",x({id:"Layer_1","data-name":"Layer 1",viewBox:"0 0 79.51 70.7",ref:t},n),r?m.a.createElement("title",null,r):null,U,L)},B=m.a.forwardRef((function(e,t){return m.a.createElement(F,x({svgRef:t},e))})),z=(r.p,M=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"onClick",value:function(){this.props.disabled||this.props.onClick()}},{key:"render",value:function(){return h.createElement("div",{className:"repeat-button","data-time":this.props.predefinedTime,onClick:this.props.onClick},h.createElement(B,null))}}]),t}(h.PureComponent),Object(p.a)(M.prototype,"onClick",[d.a],Object.getOwnPropertyDescriptor(M.prototype,"onClick"),M.prototype),M),H=(r(1174),V=function(e){function t(e){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(c.a)(t).call(this,e)))._track=void 0,r._trackRect={left:0,width:0},r._docMouseMove=void 0,r._docMouseUp=void 0,r.state={tooltipVisible:!1,tooltipTimestamp:0,tipHold:!1},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._onMouseMove(),this._onTipRelease()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this._docMouseMove),document.removeEventListener("mouseup",this._docMouseUp)}},{key:"onProgressClick",value:function(e){var t=e.clientX;if(this._track&&isFinite(this.props.duration)){var r=this._track.getBoundingClientRect(),n=r.left,o=r.width,a=t-n;this._onSeek(this.props.duration*(a/o))}}},{key:"onMouseEnter",value:function(e){var t=e.clientX;this._trackRect=this._getTrackRect(),this.setState({tooltipVisible:!0,tooltipTimestamp:this._calculateTooltipTimestamp(t)})}},{key:"onMouseLeave",value:function(){this.state.tipHold||this.setState({tooltipVisible:!1})}},{key:"onTipHold",value:function(){this.setState({tipHold:!0}),this._trackRect=this._getTrackRect(),document.body.style.cursor="grabbing"}},{key:"render",value:function(){var e=this;return h.createElement("div",{className:"video-progress-bar"},h.createElement("div",{className:"tooltip"+(this.state.tooltipVisible?" visible":""),style:{left:this._durationPerc(this.state.tooltipTimestamp)}},Object(f.d)(this.state.tooltipTimestamp)),h.createElement("div",{className:"track-cont"},h.createElement("div",{className:"track",ref:function(t){return e._track=t},onClick:this.onProgressClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},h.createElement("div",{style:{width:this._durationPerc(this.props.currentTime)},className:"progress"},h.createElement("div",{className:"tip"+(this.state.tipHold?" hold":""),onMouseDown:this.onTipHold})))))}},{key:"_durationPerc",value:function(e){return e/this.props.duration*100+"%"}},{key:"_calculateTooltipTimestamp",value:function(e){if(this._track){var t=this._track.clientWidth,r=this._trackRect.left,n=Math.max(e-r,0)/t;return Math.round(this.props.duration*n*1e3)/1e3}return 0}},{key:"_onMouseMove",value:function(){var e=this;document.addEventListener("mousemove",this._docMouseMove=function(t){var r=t.clientX;if(e.state.tipHold){var n=e._trackRect,o=(r-n.left)/n.width,a=e.props.duration*o;0<=a&&a<=e.props.duration&&(e.props.onDrag(),e._onSeek(a))}e.state.tooltipVisible&&e.setState({tooltipTimestamp:e._calculateTooltipTimestamp(r)})})}},{key:"_onTipRelease",value:function(){var e=this;document.addEventListener("mouseup",this._docMouseUp=function(){e.setState({tipHold:!1,tooltipVisible:!1}),document.body.style.cursor="default",e.props.onRelease()})}},{key:"_getTrackRect",value:function(){if(this._track){var e=this._track.getBoundingClientRect();return{left:e.left,width:e.width}}return{left:0,width:0}}},{key:"_onSeek",value:function(e){this.props.disabled||this.props.onSeek(e)}}]),t}(h.PureComponent),Object(p.a)(V.prototype,"onProgressClick",[d.a],Object.getOwnPropertyDescriptor(V.prototype,"onProgressClick"),V.prototype),Object(p.a)(V.prototype,"onMouseEnter",[d.a],Object.getOwnPropertyDescriptor(V.prototype,"onMouseEnter"),V.prototype),Object(p.a)(V.prototype,"onMouseLeave",[d.a],Object.getOwnPropertyDescriptor(V.prototype,"onMouseLeave"),V.prototype),Object(p.a)(V.prototype,"onTipHold",[d.a],Object.getOwnPropertyDescriptor(V.prototype,"onTipHold"),V.prototype),V),W=(r(1175),A=function(e){function t(){var e,r;Object(a.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(r=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o))))._draggingWhilePlaying=void 0,r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"onPlay",value:function(){this.props.disableAll||this.props.onPlay()}},{key:"onPause",value:function(){this.props.disableAll||this.props.onPause()}},{key:"onPredefinedBackward",value:function(){this.props.onSeek(Math.max(this.props.currentTime-15,0))}},{key:"onBackward",value:function(){this.props.backwardDisabled||this.props.navigationHidden||this.props.disableAll||this.props.onBackward()}},{key:"onForward",value:function(){this.props.forwardDisabled||this.props.navigationHidden||this.props.disableAll||this.props.onForward()}},{key:"onProgressDrag",value:function(){this.props.playing&&(this._draggingWhilePlaying=!0,this.props.onPause())}},{key:"onProgressRelease",value:function(){this._draggingWhilePlaying&&(this._draggingWhilePlaying=!1,this.props.onPlay())}},{key:"render",value:function(){return h.createElement("div",{className:this.className},h.createElement(H,{currentTime:this.props.currentTime,duration:this.props.duration,onSeek:this.props.onSeek,onDrag:this.onProgressDrag,onRelease:this.onProgressRelease,disabled:this.props.disableAll}),h.createElement("div",{className:"buttons"},h.createElement("nav",{className:"video-nav"},h.createElement(v.a,{playing:this.props.playing,onClick:this.props.playing?this.onPause:this.onPlay}),h.createElement(R,{type:"prev",disabled:this.props.backwardDisabled,hidden:this.props.navigationHidden,onClick:this.onBackward}),h.createElement(z,{predefinedTime:15,onClick:this.onPredefinedBackward}),h.createElement(R,{type:"next",disabled:this.props.forwardDisabled,hidden:this.props.navigationHidden,onClick:this.onForward}),h.createElement("div",{className:"label"},Object(f.d)(this.props.currentTime)+" / "+Object(f.d)(this.props.duration))),h.createElement("div",{className:"video-settings"},(this.props.onCCToggle,h.createElement(y,{showCC:this.props.showCC,onCCToggle:this.props.onCCToggle})),h.createElement(w,{playbackRate:this.props.playbackRate,onPlaybackRateChange:this.props.onPlaybackRateChange}))))}},{key:"className",get:function(){var e="video-controls "+(this.props.className||"")+(this.props.disableAll?" disabled":"");switch(this.props.theme){case"dark":e+=" dark-theme"}return e}}]),t}(h.PureComponent),Object(p.a)(A.prototype,"onPlay",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onPlay"),A.prototype),Object(p.a)(A.prototype,"onPause",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onPause"),A.prototype),Object(p.a)(A.prototype,"onPredefinedBackward",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onPredefinedBackward"),A.prototype),Object(p.a)(A.prototype,"onBackward",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onBackward"),A.prototype),Object(p.a)(A.prototype,"onForward",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onForward"),A.prototype),Object(p.a)(A.prototype,"onProgressDrag",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onProgressDrag"),A.prototype),Object(p.a)(A.prototype,"onProgressRelease",[d.a],Object.getOwnPropertyDescriptor(A.prototype,"onProgressRelease"),A.prototype),A),K=r(50),Y=r(2),G=r(0),q=Symbol("PlayerPlaying"),J=Symbol("PlayerTimeUpdated"),X=Symbol("PlayerCompleted"),Z=(I=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(a.a)(this,e),this._dispatch=t,this._props=r,this._hooks=n,this._emitter=new K.EventEmitter,this._interval=void 0,this._player=void 0}return Object(i.a)(e,[{key:"destroy",value:function(){this._dispatch(new Y.mb),this.clearInterval()}},{key:"setRefs",value:function(e){e&&(this._player=e)}},{key:"updateProps",value:function(e){this._props=e}},{key:"clearInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){clearInterval(this._interval)}))},{key:"onPlayerPlaying",value:function(e){this._emitter.addListener(q,e)}},{key:"onPlayerTimeUpdated",value:function(e){this._emitter.addListener(J,e)}},{key:"onPlayerCompleted",value:function(e){this._emitter.addListener(X,e)}},{key:"onPause",value:function(){this._player&&(clearInterval(this._interval),this._emitter.emit(q,!1),this._player.pause())}},{key:"onPlay",value:function(){var e=this;if(this._player){clearInterval(this._interval),this._interval=setInterval(this._emitPlayerTimeAndPauses,50);var t=this._player.play();t?t.then(this._onSuccessfulPlay).catch((function(){e._emitter.emit(q,!1)})):this._onSuccessfulPlay()}}},{key:"onPlaybackRateChange",value:function(e){this._player&&this._player.changePlaybackRate(e)}},{key:"onSeek",value:function(e){this._player&&(this._emitter.emit(J,e),this._player.setCurrentTime(e))}},{key:"onForward",value:function(){this.nextChapter&&this._selectChapter(this.nextChapter)}},{key:"onBackward",value:function(){this.prevChapter&&this._selectChapter(this.prevChapter)}},{key:"_selectChapter",value:function(e){this._dispatch(new Y.wb(e)),this._emitter.emit(J,0)}},{key:"_onSuccessfulPlay",value:function(){this._emitter.emit(q,!0),this._hooks.onPlay&&this._hooks.onPlay()}},{key:"_emitPlayerTimeAndPauses",value:function(){this._player&&(this._emitter.emit(J,this._player.currentTime),this._player.currentTime===this._player.duration&&this._player.canPlay?(this.onPause(),this._emitter.emit(X)):this._player.playing||this.onPause())}},{key:"chapters",get:function(){return this._props.course.chapters.filter((function(e){if(!e)return!1;var t=!(e instanceof G.g)||e.paid;return!!e.videoUrl||!t})).toList()}},{key:"nextChapter",get:function(){var e=this.chapters,t=e.indexOf(this._props.currentChapter),r=t+1;return-1===t||r>=e.size?null:e.get(r)}},{key:"prevChapter",get:function(){var e=this.chapters,t=e.indexOf(this._props.currentChapter)-1;if(!(t<0))return e.get(t)}},{key:"hasNextChapter",get:function(){return!!this.nextChapter}},{key:"hasPrevChapter",get:function(){return!!this.prevChapter}}]),e}(),Object(p.a)(I.prototype,"onPause",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onPause"),I.prototype),Object(p.a)(I.prototype,"onPlay",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onPlay"),I.prototype),Object(p.a)(I.prototype,"onPlaybackRateChange",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onPlaybackRateChange"),I.prototype),Object(p.a)(I.prototype,"onSeek",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onSeek"),I.prototype),Object(p.a)(I.prototype,"onForward",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onForward"),I.prototype),Object(p.a)(I.prototype,"onBackward",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"onBackward"),I.prototype),Object(p.a)(I.prototype,"_onSuccessfulPlay",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"_onSuccessfulPlay"),I.prototype),Object(p.a)(I.prototype,"_emitPlayerTimeAndPauses",[d.a],Object.getOwnPropertyDescriptor(I.prototype,"_emitPlayerTimeAndPauses"),I.prototype),I);r.d(t,"a",(function(){return W})),r.d(t,"b",(function(){return Z}))},1112:function(e,t,r){"use strict";var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(90),l=r(91),p=r.n(l),u=r(1050),d=r.n(u),h=r(4),m=r.n(h),f=(r(1170),r(134));function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function v(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var b=m.a.createElement("desc",null,"Created with Sketch."),g=m.a.createElement("defs",null,m.a.createElement("path",{d:"M23.7696833,0 L33.3864253,0 L33.3864253,40 L23.7696833,40 L23.7696833,0 Z M0,0 L9.61674208,0 L9.61674208,40 L0,40 L0,0 Z",id:"path-pause-icon"})),O=m.a.createElement("g",{id:"Style-Guide",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},m.a.createElement("g",{transform:"translate(-3667.000000, -1105.000000)",id:"Icons"},m.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},m.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},m.a.createElement("g",{id:"Icons/Pause",transform:"translate(323.000000, 321.000000)"},m.a.createElement("g",{id:"Colors/Grey",transform:"translate(3.000000, 0.000000)"},m.a.createElement("mask",{id:"mask-pause-icon",fill:"white"},m.a.createElement("use",{xlinkHref:"#path-pause-icon"})),m.a.createElement("use",{id:"Mask",fill:"#fff",xlinkHref:"#path-pause-icon"}),m.a.createElement("g",{mask:"url(#mask-pause-icon)",fill:"#fff",id:"Rectangle"},m.a.createElement("g",{transform:"translate(-3.000000, 0.000000)"},m.a.createElement("rect",{x:0,y:0,width:40,height:40}))))))))),k=function(e){var t=e.svgRef,r=e.title,n=v(e,["svgRef","title"]);return m.a.createElement("svg",y({viewBox:"0 0 34 40",ref:t},n),r?m.a.createElement("title",null,r):null,b,g,O)},C=m.a.forwardRef((function(e,t){return m.a.createElement(k,y({svgRef:t},e))}));r.p;function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function j(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var E,_=m.a.createElement("defs",null,m.a.createElement("polygon",{id:"path-play-icon",points:"0 0 0 40 30.7275192 20"})),S=m.a.createElement("g",{id:"Style-Guide",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},m.a.createElement("g",{transform:"translate(-3596.000000, -1103.000000)",id:"Icons"},m.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},m.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},m.a.createElement("g",{id:"Icons/Play",transform:"translate(250.000000, 319.000000)"},m.a.createElement("g",{id:"Colors/Grey",transform:"translate(5.000000, 0.000000)"},m.a.createElement("mask",{id:"mask-play-icon",fill:"white"},m.a.createElement("use",{xlinkHref:"#path-play-icon"})),m.a.createElement("use",{id:"Mask",fill:"#fff",xlinkHref:"#path-play-icon"}),m.a.createElement("g",{mask:"url(#mask-play-icon)",fill:"#fff",id:"Rectangle"},m.a.createElement("g",{transform:"translate(-5.000000, 0.000000)"},m.a.createElement("rect",{x:0,y:0,width:40,height:40}))))))))),D=function(e){var t=e.svgRef,r=e.title,n=j(e,["svgRef","title"]);return m.a.createElement("svg",w({viewBox:"0 0 31 40",ref:t},n),r?m.a.createElement("title",null,r):null,_,S)},P=m.a.forwardRef((function(e,t){return m.a.createElement(D,w({svgRef:t},e))}));r.p;r.d(t,"a",(function(){return T}));var T=(E=function(e){function t(){var e,r;Object(n.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(r=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s))))._keyboardActionHandlers={"video.togglePlay":r._onClick},r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return h.createElement("div",{className:d()("play-pause-button",this.props.disabled&&"disabled",this.props.playing?" pause-btn":" play-btn"),onClick:this._onClick},h.createElement(f.Hotkeys,{handlers:this._keyboardActionHandlers}),this.props.playing?h.createElement(C,null):h.createElement(P,null))}},{key:"_onClick",value:function(){this.props.disabled||this.props.onClick()}}]),t}(h.PureComponent),Object(c.a)(E.prototype,"_onClick",[p.a],Object.getOwnPropertyDescriptor(E.prototype,"_onClick"),E.prototype),E)},1113:function(e,t,r){"use strict";var n,o,a,i,s=r(51),c=r(5),l=r(11),p=r(30),u=r(28),d=r(290),h=r(29),m=r(90),f=r(91),y=r.n(f),v=r(210),b=r.n(v),g=r(2),O=r(0),k=r(107),C=r(291),w=r(1074),j=r(1051),E=(r(1180),r(47)),_=r(4),S=(r(1181),[{width:800,height:600},{width:1024,height:768},{width:1280,height:960},{width:1400,height:1050},{width:1600,height:1200}]),D=[{width:800,height:600},{width:1024,height:768},{width:1280,height:960}],P=[{width:1280,height:960}],T=function(e,t){return e.width*e.height-t.width*t.height},R=(n=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(p.a)(this,Object(u.a)(t).call(this,e)))._responseTimeout=void 0,r.state={updatingResolution:!1},r}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){this.state.updatingResolution&&!this._resolutionEquals(e.vm)&&(clearTimeout(this._responseTimeout),this.setState({updatingResolution:!1}))}},{key:"componentWillUnmount",value:function(){clearTimeout(this._responseTimeout)}},{key:"increaseResolution",value:function(){this.isMaxRes||this._changeResolution(1)}},{key:"decreaseResolution",value:function(){this.isMinRes||this._changeResolution(-1)}},{key:"render",value:function(){return _.createElement("div",{className:"screen-controls"},_.createElement("div",{className:"resolution"+(this.disabled?" disabled":"")},_.createElement("span",{className:"btn"+(this.isMinRes?" disabled":""),onClick:this.decreaseResolution},"-"),this.state.updatingResolution?_.createElement(j.a,null):_.createElement("span",null,this.props.vm.width," x ",this.props.vm.height),_.createElement("span",{className:"btn"+(this.isMaxRes?" disabled":""),onClick:this.increaseResolution},"+")))}},{key:"_changeResolution",value:function(e){var t=this,r=this.props,n=r.dispatch,o=r.asyncActions,a=r.vm;this.setState({updatingResolution:!0}),this._responseTimeout=setTimeout((function(){return t.setState({updatingResolution:!1})}),3e4);var i=this._getNeighborResolution(e);n(o.changeVMResolution(a,i)).catch((function(){clearTimeout(t._responseTimeout),t.setState({updatingResolution:!1})}))}},{key:"_resolutionEquals",value:function(e){return t=this.props.vm,r=e,t.width===r.width&&t.height===r.height;var t,r}},{key:"_getNeighborResolution",value:function(e){var t=this,r=this.resolutions.map((function(e,t){return[e,t]})).find((function(e){var r=Object(E.a)(e,1)[0];return t._resolutionEquals(r)}));if(r){var n=Object(E.a)(r,2)[1];return this.resolutions[n+e]}var o=this.props.vm,a=this.resolutions.map((function(e){return{difference:T(e,o),resolution:e}})).filter((function(t){return e>0?t.difference>0:t.difference<0})).sort((function(t,r){return e>0?r.difference-t.difference:t.difference-r.difference})).pop();return a?a.resolution:{width:o.width,height:o.height}}},{key:"resolutions",get:function(){switch(this.props.template.os){case O.L.Win:return S;case O.L.Docker:return P;case O.L.Linux:default:return D}}},{key:"isMaxRes",get:function(){var e=this.resolutions[this.resolutions.length-1];return this._resolutionEquals(e)||T(e,this.props.vm)<0}},{key:"isMinRes",get:function(){var e=this.resolutions[0];return this._resolutionEquals(e)||T(e,this.props.vm)>0}},{key:"disabled",get:function(){return this.state.updatingResolution||this.props.disabled}}]),t}(_.Component),Object(m.a)(n.prototype,"increaseResolution",[y.a],Object.getOwnPropertyDescriptor(n.prototype,"increaseResolution"),n.prototype),Object(m.a)(n.prototype,"decreaseResolution",[y.a],Object.getOwnPropertyDescriptor(n.prototype,"decreaseResolution"),n.prototype),n),x=r(1105),N=r(293),M=r(299),V=r(211),A=r(14),I=r(134);r.d(t,"a",(function(){return U}));var U=(i=a=function(e){function t(){var e,r;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).wrapper=void 0,r.body=void 0,r.displayScale=1,r.client=void 0,r.state={loading:!r.props.vmAccessLimitReached,zoomPointerCenter:{x:0,y:0},filter:void 0},r._controlsBound=!1,r._mouseenter=!1,r._modifierHandler=void 0,r._mouseMoveLock=void 0,r._disconnectHandler=void 0,r._connectHandler=void 0,r._reconnectionTimeout=void 0,r._screenshotCanvas=document.createElement("canvas"),r._moveZoomPointerCenter=Object(w.b)(Object(d.a)(r)).moveCenter,r._handlers={"cloudDesktop.loseFocus":r._lockFor1Second},r}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this._modifierHandler=function(t){return t.keyCode!==C.j&&t.keyCode!==C.i&&t.keyCode!==C.m||!e._controlsBound||(console.log("prevent default",t.keyCode),t.preventDefault(),!1)}),!this.props.readOnly&&this.props.onReadWriteInit&&this.props.onReadWriteInit(),this._initClient(this.props)}},{key:"componentWillReceiveProps",value:function(e){if(e.cursorPosition){var t=e.cursorPosition,r=this.props.vm.width/this.props.width,n=t.x/r,o=t.y/r;this._setCursorPosition({x:n,y:o})}e.vm.connection.connectionId!==this.props.vm.connection.connectionId&&e.vm.state===O.kb.Ready&&this._initClient(e)}},{key:"componentDidUpdate",value:function(e){this.props.cameraStream===e.cameraStream&&this.props.width===e.width&&this.props.height===e.height||this._handleCamera(),e.readOnly!==this.props.readOnly&&(this.props.readOnly?this._unbindControls():this._bindControls());var t=!Object(k.b)(e.vm.state)&&Object(k.b)(this.props.vm.state),r=!Object(k.c)(e.vm.state)&&Object(k.c)(this.props.vm.state);!t&&!r||this.props.vmAccessLimitReached||(this._removeScreenContent(),this._destroyCurrentClient(),this.setState({loading:!0}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._modifierHandler),this._destroyCurrentClient()}},{key:"mousemove",value:function(e){var t=this;this.props.showViewbox&&this._moveZoomPointerCenter(e),!this._mouseMoveLock&&this.props.emitCursor&&(setTimeout((function(){return t._mouseMoveLock=!1}),this.props.mouseMoveLockInterval),this.props.dispatch(new g.V(e.x,e.y)),this._mouseMoveLock=!0)}},{key:"isScreenActive",value:function(){return this._controlsBound}},{key:"getBodyRef",value:function(e){e&&(this.body=e)}},{key:"takeScreenshot",value:function(){if(!this.body)return null;var e=null;if(this.isBroadcastingCamera){var t=this.body.getElementsByTagName("video")[0];if(t)this._screenshotCanvas.width=this.props.width,this._screenshotCanvas.height=this.props.height,this._screenshotCanvas.getContext("2d").drawImage(t,0,0,this.props.width,this.props.height),e=this._screenshotCanvas.toDataURL("image/png")}else{var r=Object(M.a)().getRemoteClient(this.props.vm.id);r&&(e=r.toDataURL("image/png",1,this.props.width,this.props.height,!1))}var n=null;return e&&(n=new Blob([V.a.toArrayBuffer(e)],{type:"image/png"})),n}},{key:"onMouseEnter",value:function(){this._mouseenter=!0,this._controlsBound||this.state.loading||(this.props.onScreenFocus&&this.props.onScreenFocus(),this._bindControls()),this.setState({filter:this._keyboardShortcutFilter})}},{key:"onMouseLeave",value:function(){this._mouseenter=!1,this.props.onScreenBlur&&this.props.onScreenBlur(),this._unbindControls(),this.setState({filter:void 0})}},{key:"render",value:function(){var e=this,t="sc-screen",r=this.props.showViewbox&&!this.props.readOnly;this.isScreenActive()||(t+=" sc-screen-no-cursor"),this.state.loading&&(t+=" loading");var n=Object.assign({},this.props.style,{width:this.props.width,height:this.props.height}),o=this.props.vm.id&&this.props.vm.state===O.kb.Ready,a=this.state.loading||r||this.props.vmAccessLimitReached?"sc-screen-overlay":"";this.state.loading&&o?a+=" loading":o&&!this.props.vmAccessLimitReached||(a+=" pending");var i="screen-wrapper";this.props.readOnly&&(i+=" read-only");var s=o&&r&&this.props.viewboxSize?this._renderViewbox():null;return _.createElement(I.Hotkeys,{handlers:this._handlers,filter:this.state.filter},_.createElement(_.Fragment,null,_.createElement("div",{className:i,style:n,ref:function(t){return e.wrapper=t},onClick:this.props.onClick},_.createElement("div",{className:a},this.isVmStarting&&[_.createElement(j.a,{key:"loader"}),_.createElement("p",{key:"loader-title"},"Starting your cloud workspace"),_.createElement("p",{key:"loader-sub-title"},"Please wait!")],this.props.vmAccessLimitReached?_.createElement("p",{key:"loader-title"},"You will no longer be assigned a cloud workspace"):Object(k.c)(this.props.vm.state)?_.createElement("p",{key:"loader-title"},"Your cloud workspace has been terminated"):null),_.createElement("div",{ref:this.getBodyRef,className:t}),s),this.showControls&&_.createElement(R,{asyncActions:this.props.asyncActions,dispatch:this.props.dispatch,disabled:this.state.loading,vm:this.props.vm,template:this.props.template})))}},{key:"_renderViewbox",value:function(){return _.createElement(x.a,Object.assign({isExpanded:this.props.isViewExpanded||!1,maxWidth:this.props.width,maxHeight:this.props.height},this.zoomPointerDimensions,this.state.zoomPointerCenter))}},{key:"_bindControls",value:function(){this.client?this.props.readOnly||(this._bindMouseHandler(),this.client.unlockMouse(),this.isBroadcastingCamera||(this._bindKeyboardHandler(),this.client.unlockKeyboard()),this._controlsBound=!0,this.setState({filter:this._keyboardShortcutFilter})):console.error("Failed to set control of client input")}},{key:"_unbindControls",value:function(){this.client?(this._unbindMouseHandler(),this._unbindKeyboardHandler(),this.client.lockMouse(),this.client.lockKeyboard(),this._controlsBound=!1,this.setState({filter:void 0})):console.error("Failed to unset control of client input")}},{key:"_setCursorPosition",value:function(e){if(this.client){var t=this.client.getDisplay();if(t){t.moveCursor(e.x,e.y);var r=t.getCursorLayer().getElement(),n=this.props.cursorScale||1;t.getCursorLayer().distort(n,0,0,n,0,0),r.style.transformOrigin="0 0"}}}},{key:"_destroyCurrentClient",value:function(){this._unbindControls(),this.client&&(this.client.off(N.b,this._disconnectHandler),this.client.off(N.a,this._connectHandler),this.client.disconnect(),this.client=null)}},{key:"_initClient",value:function(e){var t=this;if(e.vm){this.client&&this._destroyCurrentClient();var r=e.vm.connection;if(r.connectionId){var n=Object(M.a)();this.client=n.createRemoteClient(e.vm.id,r),this.client.on(N.a,this._connectHandler=function(){t.props.dispatch(new g.b(e.vm.connection)),e.onConnect&&e.onConnect(t.client),t._attachScreen(t.client),t._handleCamera(),t.setState({loading:!1},(function(){!t._controlsBound&&t._mouseenter?t._bindControls():t._unbindControls()}))}),this.client.on(N.b,this._disconnectHandler=function(){console.log("DISCONNECTED event fired"),e.onDisconnect&&e.onDisconnect(),t.setState({loading:!0}),t._unbindControls(),clearTimeout(t._reconnectionTimeout),t._reconnectionTimeout=setTimeout((function(){t.client&&t.client.reconnect()}),A.a.RemoteMachineReconnectionTimeout)}),this.client.connected()?console.log("Client already connected"):(this.client&&this.client.connect(),this.setState({loading:!0}))}}else console.error("No cloud workspace data")}},{key:"_attachScreen",value:function(e){if(this.body&&this.wrapper){for(var t=this.body,r=Array.prototype.slice.call(t.children);r.length;){var n=r.pop();n.parentNode.removeChild(n)}this.wrapper.onmouseenter=this.onMouseEnter,this.wrapper.onmouseleave=this.onMouseLeave;var o=e.getDisplay();if(o){var a=this.props.width/this.props.vm.width;o.scale(a),this.displayScale=o.getScale(),o.onresize=this._updateResolution;var i=o.getWidth(),s=o.getHeight();this._updateResolution(i,s);var c=o.getElement();this._removeScreenContent(),t.appendChild(c)}}else console.error("Failed to obtain reference of body and/or wrapper")}},{key:"_handleCamera",value:function(){if(this.body)if(this.isBroadcastingCamera){var e=this.body.getElementsByTagName("video")[0],t=e?e.parentElement:null;e&&t&&t.removeChild(e);var r=this._createVideoElement(),n=r?this.body.getElementsByTagName("canvas")[0]:null,o=n?n.parentElement:null;o&&r&&(r.width=this.props.width,r.height=this.props.height,o.appendChild(r)),this.client&&this.client.lockKeyboard()}else{var a=this.body.getElementsByTagName("video")[0],i=a?a.parentElement:null;i&&a&&i.removeChild(a)}}},{key:"_createVideoElement",value:function(){if(!this.props.cameraStream)return null;var e=document.createElement("video");return e.autoplay=!0,e.srcObject=this.props.cameraStream,e}},{key:"_bindKeyboardHandler",value:function(){this.client?(this.client.on(N.d,this._onKeyDown),this.client.on(N.e,this._onKeyUp),console.log("Bind keyboard handler")):console.error("Failed to bind keyboard handler to null remote client")}},{key:"_unbindKeyboardHandler",value:function(){this.client?(this.client.off(N.d,this._onKeyDown),this.client.off(N.e,this._onKeyUp),console.log("Unbind keyboard handler")):console.warn("Failed to unbind keyboard handler from a null remote client")}},{key:"_bindMouseHandler",value:function(){this.client?(this.client.on(N.f,this._mouseHandler),this.client.on(N.h,this._mouseHandler),this.client.on(N.g,this._mouseHandler)):console.error("Failed to bind mouse handler to null remote client")}},{key:"_unbindMouseHandler",value:function(){this.client?(this.client.off(N.f,this._mouseHandler),this.client.off(N.h,this._mouseHandler),this.client.off(N.g,this._mouseHandler)):console.warn("Failed to unbind mouse handler from a null remote client")}},{key:"_updateResolution",value:function(e,t){this.props.vm.id&&this.props.dispatch(new g.Rb(this.props.vm.id,e,t))}},{key:"_keyboardShortcutFilter",value:function(e,t,r){return this._mouseenter&&"ctrl ctrl"!==r&&"ctrl"!==r}},{key:"_onKeyDown",value:function(e){this.props.onKeyDown&&this.props.onKeyDown(e),this._onKey(!0,e)}},{key:"_onKeyUp",value:function(e){this.props.onKeyUp&&this.props.onKeyUp(e),this._onKey(!1,e)}},{key:"_onKey",value:function(e,t){if((this.props.disableKeys||[]).indexOf(t)>=0)console.log("Key is disabled",t);else if(this.client){var r=this.client.getKeyboard();r?(r.modifiers.ctrl||r.modifiers.meta)&&r.modifiers.shift&&65505===t?console.log("HOTKEY detected (pressed: ".concat(e,")")):!r.modifiers.alt||65289!==t&&96!==t?this.client.sendKeyEvent(e,t):console.log("SWITCH TAB combination (pressed: ".concat(e,")")):console.log("Guac keyboard is not defined")}else console.error("Failed to send key over null client (pressed: ".concat(e,")"),t)}},{key:"_mouseHandler",value:function(e){if(this.props.onMouseEvent&&this.props.onMouseEvent(e),this.props.mouseDisabled)console.log("Mouse is disabled. Skip send mouse event");else if(this.client){var t=Object(s.a)({x:1,y:1},e);this.isBroadcastingCamera&&(t.left=!1,t.right=!1,t.middle=!1);var r=this.client.getDisplay(),n=r?r.getScale():1,o=n,a=n;this.props.scaleRatio&&(o=this.props.scaleRatio.scaleX,a=this.props.scaleRatio.scaleY),this.client.scaleX=o,this.client.scaleY=a,t.x/=o,t.y/=a,this.mousemove(t),t.x>this.props.width||t.y>this.props.height||t.x<0||t.y<0||this.client.sendMouseState(t)}else console.error("Failed to send mouse state over null client")}},{key:"_lockFor1Second",value:function(){var e=this;this._mouseenter&&(this._unbindControls(),setTimeout((function(){e._mouseenter&&e._bindControls()}),1e3))}},{key:"_removeScreenContent",value:function(){if(this.body)for(var e=0;e<this.body.children.length;e+=1)this.body.removeChild(this.body.children[e])}},{key:"isBroadcastingCamera",get:function(){return!!this.props.cameraStream}},{key:"isVmStarting",get:function(){return!this.props.vmAccessLimitReached&&(Object(k.a)(this.props.vm.state)||Object(k.b)(this.props.vm.state))}},{key:"showControls",get:function(){return!this.props.vmAccessLimitReached&&!Object(k.c)(this.props.vm.state)&&!this.isBroadcastingCamera&&this.props.controls&&this.props.asyncActions&&this.props.template&&this.props.template.os!==O.L.Docker&&(this.props.template.defaultTemplate||this.props.template.createdAt.getTime()>new Date(2018,8,1).getTime())}},{key:"zoomPointerDimensions",get:function(){if(!this.props.viewboxSize)return{width:0,height:0};var e=this.props.width/this.props.viewboxSize.width,t=this.props.height/this.props.viewboxSize.height;return{width:this.props.vm.width/e,height:this.props.vm.height/t}}}]),t}(_.Component),a.defaultProps={disableKeys:[],mouseMoveLockInterval:100,onScreenBlur:b.a,onScreenFocus:b.a,cursorScale:1,mouseDisabled:!1},o=i,Object(m.a)(o.prototype,"getBodyRef",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"getBodyRef"),o.prototype),Object(m.a)(o.prototype,"onMouseEnter",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"onMouseEnter"),o.prototype),Object(m.a)(o.prototype,"onMouseLeave",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"onMouseLeave"),o.prototype),Object(m.a)(o.prototype,"_updateResolution",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"_updateResolution"),o.prototype),Object(m.a)(o.prototype,"_keyboardShortcutFilter",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"_keyboardShortcutFilter"),o.prototype),Object(m.a)(o.prototype,"_onKeyDown",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"_onKeyDown"),o.prototype),Object(m.a)(o.prototype,"_onKeyUp",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"_onKeyUp"),o.prototype),Object(m.a)(o.prototype,"_mouseHandler",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"_mouseHandler"),o.prototype),Object(m.a)(o.prototype,"_lockFor1Second",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"_lockFor1Second"),o.prototype),o)},1114:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props;return c.createElement("li",{"data-value":e.value,"data-disabled":e.disabled,"data-selected":e.selected,"data-highlighted":e.highlighted,"data-deleted":e.deleted,"data-text":e.text},e.children)}}]),t}(c.Component)},1115:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=r(91),d=r.n(u),h=r(1045),m=r(289),f=(r(1047),r(1317),n=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={isDeleting:!1},r}return Object(c.a)(t,e),Object(a.a)(t,[{key:"delete",value:function(e){var t=this;e.preventDefault(),this.setState({isDeleting:!0}),this.props.onDelete().finally((function(){return t.setState({isDeleting:!1})}))}},{key:"render",value:function(){return p.createElement("div",{className:"delete-confirmation-modal form-styles"},p.createElement(m.a,{title:this.props.title,visible:this.props.visible,onToggle:this.props.onClose},this.props.messages.map((function(e,t){return p.createElement("p",{className:"text",key:t},e)})),p.createElement("div",{className:"row"},p.createElement(h.a,{className:"short-btn",onClick:this.props.onClose,disabled:this.state.isDeleting},"No, keep it"),p.createElement(h.a,{className:"short-btn empty",onClick:this.delete,loading:this.state.isDeleting},"Yes"))))}}]),t}(p.Component),Object(l.a)(n.prototype,"delete",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"delete"),n.prototype),n)},1117:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=r(91),d=r.n(u),h=r(1085),m=r(289),f=(n=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(a.a)(t,[{key:"cancel",value:function(){this.props.onToggle(!1)}},{key:"resolveAndExit",value:function(){var e=this;this.props.onResolve().then((function(){return e.props.onToggle(!1)}))}},{key:"render",value:function(){return p.createElement(m.a,{title:"Are you sure?",visible:this.props.visible,onToggle:this.props.onToggle},p.createElement("div",{className:"leave-modal form-styles"},p.createElement("p",{className:"text"},this.props.text?"".concat(this.props.text," "):null,"Are you sure you want to leave?"),p.createElement("div",null,p.createElement(h.a,{onClick:this.cancel,className:"short-btn stay-btn"},"No")),p.createElement("div",null,p.createElement(h.a,{onClick:this.resolveAndExit,className:"short-btn empty leave-btn"},"Leave"))))}}]),t}(p.PureComponent),Object(l.a)(n.prototype,"cancel",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"cancel"),n.prototype),Object(l.a)(n.prototype,"resolveAndExit",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"resolveAndExit"),n.prototype),n)},1118:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(91),u=r.n(p),d=r(4),h=r(1060),m=r(1089),f=function(e){return parseInt(e.replace("px","")||"0",10)},y=(n=function(e){function t(){var e,r;Object(o.a)(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(r=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a))))._splitter=void 0,r._leftCont=void 0,r._initialLayoutPerformed=!1,r._resizeObserver=void 0,r}return Object(c.a)(t,e),Object(a.a)(t,[{key:"componentWillUnmount",value:function(){this._leftCont&&this._resizeObserver.unobserve(this._leftCont)}},{key:"onLeftContRef",value:function(e){e&&e instanceof Element&&(this._leftCont=e,this._resizeObserver=new h.a(this.adjustLayout),this._resizeObserver.observe(e))}},{key:"adjustLayout",value:function(){if(this._leftCont){var e=window.getComputedStyle(this._leftCont),t=f(e.width||"")-this._horizontalPadding,r=f(e.height||"")-this._verticalPadding,n=t/r,o=this._screenWidth/this._screenHeight,a=0,i=0;n<o?i=(a=Math.max(t,400*o))/o:a=(i=Math.max(r,400))*o;var s=a/this._screenWidth;this.setState({width:a,height:i,scaleX:s,scaleY:s}),this._initialLayoutPerformed||(this._initialLayoutPerformed=!0)}}},{key:"_horizontalPadding",get:function(){return 35}},{key:"_verticalPadding",get:function(){return 35}},{key:"rightPanelSize",get:function(){if(this._initialLayoutPerformed)return 0;var e=window.document.body,t=e.clientWidth,r=e.clientHeight;if(t-m.b<m.a)return t-m.a;var n=Math.max(r,400)*(this._screenWidth/this._screenHeight)-70+10;return Math.max(m.b,t-n)}}]),t}(d.PureComponent),Object(l.a)(n.prototype,"onLeftContRef",[u.a],Object.getOwnPropertyDescriptor(n.prototype,"onLeftContRef"),n.prototype),Object(l.a)(n.prototype,"adjustLayout",[u.a],Object.getOwnPropertyDescriptor(n.prototype,"adjustLayout"),n.prototype),n)},1119:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(19),o=r.n(n),a=r(47),i=r(44),s=r(45),c=r(98),l=r(296),p=r(215),u=function(e){return new Promise((function(t,r){return e.onstatechange=function(e){switch(e){case c.a.Connected:return t();case c.a.Disconnecting:case c.a.Disconnected:return r(new Error("Client could not connect. State ".concat(e)))}}}))},d=function(e){return new Promise((function(t){return e.onfilesystem=function(e,r){return t(new l.a(e,r))}}))},h=function(){var e=Object(i.a)(o.a.mark((function e(t){var r,n,i,c,l,h,m,f,y=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.length>1&&void 0!==y[1]?y[1]:0,n=y.length>2&&void 0!==y[2]?y[2]:0,e.next=4,Object(p.a)(t);case 4:return i=e.sent,c=new s.WebSocketTunnel(Object(p.b)(t,i,r,n)),(l=new s.Client(c)).connect(),e.next=10,Promise.all([u(l),d(l)]);case 10:return h=e.sent,m=Object(a.a)(h,2),f=m[1],e.abrupt("return",{client:l,tunnel:c,token:i,filesystem:f});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},1128:function(e,t,r){"use strict";var n,o,a,i=r(3),s=r(51),c=r(122),l=r(5),p=r(11),u=r(30),d=r(28),h=r(29),m=r(90),f=r(4),y=r(91),v=r.n(y),b=r(8),g=r(1475),O=r(2),k=r(0),C=r(168),w=r(1076),j=r(291),E=r(1077),_=r(1152),S=r(1045),D=r(1115),P=(r(1047),r(1318),n={},Object(i.a)(n,k.s.Instruction,"Normal instruction task that learner will watch and follow along"),Object(i.a)(n,k.s.ChallengeSelfApproval,"Learners can self-approve the challenge solution"),Object(i.a)(n,k.s.ChallengePeerApproval,"Peers (other learners) can approve the challenge solution"),Object(i.a)(n,k.s.ChallengeHostApproval,"Only hosts can approve the challenge solution"),n),T=(o=function(e){function t(e){var r;return Object(l.a)(this,t),(r=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={isExpanded:!e.chapter.id||!e.chapter.videoUrl,deleteConfirmationModalVisible:!1,isPreparingToRecord:!1},r}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.props.onExpand(e.props.chapter.key,e.state.isExpanded)}))}},{key:"toggle",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.state.isExpanded;this.setState({isExpanded:t},(function(){e.props.onExpand(e.props.chapter.key,t)}))}},{key:"updateChapter",value:function(e,t){var r=t.target.value,n=this.props.chapter.set(e,r);this.props.onChange(n)}},{key:"onTypeChange",value:function(e){this.updateChapter("type",{target:{value:e}})}},{key:"onFocus",value:function(e,t){this.toggle(!0),this.props.onFocus&&this.props.onFocus(e,t)}},{key:"onBlur",value:function(e,t){this.props.onBlur&&this.props.onBlur(e,t)}},{key:"toggleDeleteConfirmationModal",value:function(){this.setState({deleteConfirmationModalVisible:!this.state.deleteConfirmationModalVisible})}},{key:"onConfirmDeletion",value:function(){return this.props.onDeleteChapter()}},{key:"record",value:function(e){var t=this;e.preventDefault(),this.setState({isPreparingToRecord:!0}),this.props.onRecord().finally((function(){return t.setState({isPreparingToRecord:!1})}))}},{key:"preview",value:function(e){e.preventDefault(),this.props.onPreview()}},{key:"render",value:function(){var e=this;return f.createElement("div",{className:"chapter-details form-styles"+this.className,"data-name":this.props.chapter.name},f.createElement(_.a,{expanded:this.state.isExpanded,expandHeader:this.renderExpandHeader(),collapseHeader:this.renderCollapseHeader(),onToggle:this.toggle,errored:!!this.props.errors||!this.isRecorded,errorMessage:this.isRecorded?"":"This task has not been recorded yet"},f.createElement("div",{className:"row"},f.createElement(S.y,{className:"chapter-type",value:this.props.chapter.type,label:"".concat(this.props.label," Type"),onChange:this.onTypeChange,onFocus:function(t){return e.onFocus(t,"type")},onBlur:function(t){return e.onBlur(t,"type")}},f.createElement(S.n,{value:k.s.Instruction},"Instruction"),f.createElement(S.n,{value:k.s.ChallengeSelfApproval},"Challenge: Self approval"),f.createElement(S.n,{value:k.s.ChallengePeerApproval,disabled:!0},"Challenge: Peer approval"),f.createElement(S.n,{value:k.s.ChallengeHostApproval,disabled:!0},"Challenge: Host approval")),f.createElement("p",{className:"field-info"},P[this.props.chapter.type])),f.createElement(S.k,{className:"chapter-name",value:this.props.chapter.name,label:"".concat(this.props.label," Name"),error:this.props.errors?this.props.errors.name:void 0,disabled:this.props.disabled,onChange:function(t){return e.updateChapter("name",t)},onFocus:function(t){return e.onFocus(t,"name")},onBlur:function(t){return e.onBlur(t,"name")},onKeyDown:this._handleEnter}),f.createElement("div",{className:"row"},f.createElement(S.z,{className:"chapter-description",value:this.props.chapter.description,label:"".concat(this.props.label," Description"),error:this.props.errors?this.props.errors.description:void 0,disabled:this.props.disabled,onChange:function(t){return e.updateChapter("description",t)},onFocus:function(t){return e.onFocus(t,"description")},onBlur:function(t){return e.onBlur(t,"description")}}),f.createElement("div",{className:"field-info"},f.createElement("div",null,this.props.chapter.type===k.s.Instruction?"Make your recording's landing page more descriptive. ":"Help learners better understand the challenge. ",f.createElement("a",{href:"https://www.markdownguide.org/basic-syntax/",target:"_blank"},"Markdown supported")))),f.createElement("div",{className:"row"},f.createElement("div",{className:"form-actions"+(this.props.chapter.videoUrl?"":" record")},this.props.chapter.videoUrl?f.createElement(f.Fragment,null,f.createElement("div",{className:"duration","data-duration":Math.floor(this.props.chapter.duration/1e3)},"Duration: ",Object(E.a)(this.props.chapter.duration)," mins"),f.createElement("div",{className:"buttons"},f.createElement(S.a,{className:"empty small purple preview-btn",onClick:this.preview,disabled:this.state.isPreparingToRecord,type:"button"},"Preview"),f.createElement(S.a,{className:"empty small purple rerecord-btn",onClick:this.record,loading:this.state.isPreparingToRecord,type:"button"},"Re-Record"))):f.createElement(S.a,{className:"small record-btn",onClick:this.record,disabled:!this.props.valid,loading:this.state.isPreparingToRecord,type:"button"},"Record")),f.createElement("p",{className:"field-info delete"},f.createElement("a",{href:"javascript:void(0);",onClick:this.toggleDeleteConfirmationModal},"Delete "+this.props.label)))),f.createElement(D.a,{visible:this.state.deleteConfirmationModalVisible,title:"Delete Task",messages:[this.deleteMessage],onClose:this.toggleDeleteConfirmationModal,onDelete:this.onConfirmDeletion}))}},{key:"renderCollapseHeader",value:function(){return f.createElement("div",{className:"collapse-header"},this.props.label?f.createElement("div",{className:"label"},this.props.label,Object(w.f)(this.props.chapter)?f.createElement("i",{className:"fa fa-trophy"}):null):null,f.createElement("div",{className:"name"},this.props.chapter.name))}},{key:"renderExpandHeader",value:function(){return f.createElement("div",{className:"expand-header"},this.props.chapter.id?"Edit":"Add"," ",this.props.label)}},{key:"_handleEnter",value:function(e){e.keyCode===j.g&&(e.stopPropagation(),this.record(e))}},{key:"className",get:function(){var e="";return this.props.className&&(e+=" ".concat(this.props.className)),this.props.errors&&(e+=" error"),e}},{key:"deleteMessage",get:function(){var e="Are you sure you want to delete ";return this.props.chapter.name?"".concat(e,' task "').concat(this.props.chapter.name,'"?'):"".concat(e," ").concat(this.props.label,"?")}},{key:"isRecorded",get:function(){return this.props.chapter.videoUrl}}]),t}(f.Component),Object(m.a)(o.prototype,"toggle",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"toggle"),o.prototype),Object(m.a)(o.prototype,"updateChapter",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"updateChapter"),o.prototype),Object(m.a)(o.prototype,"onTypeChange",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"onTypeChange"),o.prototype),Object(m.a)(o.prototype,"onFocus",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"onFocus"),o.prototype),Object(m.a)(o.prototype,"onBlur",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"onBlur"),o.prototype),Object(m.a)(o.prototype,"toggleDeleteConfirmationModal",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"toggleDeleteConfirmationModal"),o.prototype),Object(m.a)(o.prototype,"onConfirmDeletion",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"onConfirmDeletion"),o.prototype),Object(m.a)(o.prototype,"record",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"record"),o.prototype),Object(m.a)(o.prototype,"preview",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"preview"),o.prototype),Object(m.a)(o.prototype,"_handleEnter",[v.a],Object.getOwnPropertyDescriptor(o.prototype,"_handleEnter"),o.prototype),o),R=r(1078),x=r(1085);r(1319);r.d(t,"a",(function(){return V}));var N,M;!function(e){e.Instruction="Instruction",e.Challenge="Challenge"}(N||(N={})),function(e){e.Record="record",e.Preview="preview",e.Add="add",e.Delete="delete"}(M||(M={}));var V=(a=function(e){function t(e){var r;Object(l.a)(this,t),(r=Object(u.a)(this,Object(d.a)(t).call(this,e)))._chapterDetailsRefs=[],r._dragTimeout=void 0,r._initialValue=void 0,r._initialValue=e.input.value;var n=[];return e.input.value.forEach((function(e){n.push({name:{active:!1,dirty:!1},description:{active:!1,dirty:!1},type:{active:!1,dirty:!1}})})),r.state={componentsFieldsState:Object(b.List)(n),expandedItems:Object(b.Map)([[]])},r}return Object(h.a)(t,e),Object(p.a)(t,[{key:"showValidation",value:function(){var e=this,t=this.state.componentsFieldsState.map((function(e){return e.name.dirty=!0,e.description.dirty=!0,e.type.dirty=!0,e}));this.setState({componentsFieldsState:Object(b.List)(t)},(function(){var t=[];e._chapterDetailsRefs.forEach((function(e){e&&e.props.errors&&(e.setState({isExpanded:!0}),t.push(e.props.chapter.key))})),e.onChapterItemExpand(t,!0)}))}},{key:"onChapterChange",value:function(e,t){var r=this.chapters.get(t);if(e.videoUrl&&e.type!==r.type&&(e.type===k.s.Instruction||r.type===k.s.Instruction)){var n=r.type===k.s.Instruction?N.Instruction:N.Challenge,o=e.type===k.s.Instruction?N.Instruction:N.Challenge;this.props.actionDispatch(new O.i(new k.J({type:k.K.Info,title:"Re-record task?",text:'You just changed your task from type "'.concat(n,'" to type "').concat(o,'". In that case, you may want to re-record the task')})))}var a=this.chapters.set(t,e);this.props.input.onChange(a)}},{key:"onFocus",value:function(e,t,r){this._updateComponentActiveFields(r,t,!0)}},{key:"onBlur",value:function(e,t,r){this._updateComponentActiveFields(r,t,!1),this.props.input.onBlur(this.chapters)}},{key:"onAddChapter",value:function(e){if(e.preventDefault(),this._validateAction(M.Add)){var t=this.chapters.count()?this.chapters.last().order+1:1,r=this.chapters.sort((function(e,t){return t.key-e.key})).first(),n=r?r.key+1:0,o=this.chapters.push(new k.q({order:t,key:n}));this.props.input.onChange(o);var a=this.state.componentsFieldsState.push({name:{active:!1,dirty:!1},description:{active:!1,dirty:!1},type:{active:!1,dirty:!1}});this.setState({componentsFieldsState:a})}}},{key:"deleteChapter",value:function(e){var t=this;if(!this._validateAction(M.Delete))return Promise.reject("Deleting a task is not allowed");var r=this.chapters.get(e);return 1===this.chapters.filter((function(e){return!!e.videoUrl})).count()&&r.videoUrl&&Object(R.e)(this.props.course,this.props.rooms)?(this.props.actionDispatch(new O.i(new k.J({type:k.K.Error,title:"Used in session",text:"You cannot delete the last recorded task because this recording is used in a session"}))),Promise.reject("Cannot delete last recorded task")):r.id?this.props.actionDispatch(this.props.asyncActions.deleteChapter(this.props.course,r)).then((function(){return t._deleteChapter(e)})):(this._deleteChapter(e),Promise.resolve())}},{key:"onRecordOrPreview",value:function(e,t){var r=this,n=e===M.Record;if(n&&!Object(C.b)(window.navigator.userAgent))return this.props.onRecordUnsupported(),Promise.reject("Recording is not supported on this browser");var o=this.chapters.get(t);if(n){if(!this.template||this.template.state===k.bb.Deleted)return this.props.actionDispatch(new O.i(new k.J({type:k.K.Error,title:"Deleted cloud workspace",text:"The cloud workspace used for this recording has been deleted. Please use a different cloud workspace"}))),Promise.reject("Cloud workspace is deleted");if(this.template.state!==k.bb.Ready)return this.props.actionDispatch(new O.i(new k.J({type:k.K.Info,title:"Your cloud workspace is on the way",text:"Please wait a few minutes or record the task later"}))),Promise.reject("Cloud workspace is not ready")}return this._preserveChapterBeforeRecord(o).then((function(n){var o=r.chapters.set(t,n);if(r.props.input.onChange(o.map((function(e,t){return e.set("key",t)}))),e===M.Record){if(!r._validateAction(e))return;r.props.onRecordChapter(n)}else r.props.onPreviewChapter(n)}))}},{key:"onChapterItemDragStart",value:function(){var e=this,t=arguments[5];this._dragTimeout=setTimeout((function(){e._chapterDetailsRefs.forEach((function(e){return e.toggle(!1)})),t.style.transform="rotate(1deg)";var r=t.querySelector(".expandable-container");r&&(r.style.borderColor="#4a4a4a")}),300)}},{key:"onChapterItemDragStop",value:function(){var e=arguments[5];e.style.transform="",e.style.border="";var t=e.querySelector(".expandable-container");t&&(t.style.borderColor=""),clearTimeout(this._dragTimeout)}},{key:"onChapterItemExpand",value:function(e,t){var r=this.state.expandedItems.withMutations((function(r){var n=r;e.forEach((function(e){return n=n.set(e.toString(),t)}))}));this.setState({expandedItems:r})}},{key:"onGridLayoutChange",value:function(e){var t={};e.forEach((function(e){return t[e.i]=e.y}));var r=this.chapters.sort((function(e,r){return t[e.key]-t[r.key]})).map((function(e,t){return e.set("order",t+1)}));this.props.input.onChange(r)}},{key:"generateGridLayout",value:function(){var e=this;return this.chapters.map((function(t,r){return{i:t.key.toString(),x:1,y:r,w:1,h:e._isChapterExpanded(t)?5.75:1}})).toArray()}},{key:"render",value:function(){var e=this;this._chapterDetailsRefs=[];var t=this.props,r=t.input,n=t.meta,o=Object(c.a)(t,["input","meta"]),a=n.error?JSON.parse(n.error):[],i=r.value;return f.createElement("div",{className:"redux-form-chapters-list"},f.createElement("div",{className:"fill-items"},i.map((function(t,r){return f.createElement("div",{className:"f-item",key:"fi-"+r,style:{height:e._isChapterExpanded(t)?406:50}})}))),f.createElement(g,{className:"grid-layout",draggableHandle:".cdi-handle",layout:this.generateGridLayout(),cols:1,width:520,rowHeight:50,margin:[0,25],isResizable:!1,useCSSTransforms:!1,onDragStart:this.onChapterItemDragStart,onDragStop:this.onChapterItemDragStop,onLayoutChange:this.onGridLayoutChange},i.map((function(t,r){var i=a[r],s=e.state.componentsFieldsState.get(r),c=!i||0===Object.keys(i).length,l=n.error?e._getComponentErrors(i,s):null;return f.createElement("div",{key:t.key},f.createElement("div",{className:"cdi-handle"}),f.createElement(T,Object.assign({ref:function(t){t&&e._chapterDetailsRefs.push(t)},label:"Task ".concat(r+1),chapter:t,errors:l,valid:c,onChange:function(t){return e.onChapterChange(t,r)},onFocus:function(t,n){return e.onFocus(t,n,r)},onBlur:function(t,n){return e.onBlur(t,n,r)},onDeleteChapter:function(){return e.deleteChapter(r)},onRecord:function(){return e.onRecordOrPreview(M.Record,r)},onPreview:function(){return e.onRecordOrPreview(M.Preview,r)},onExpand:function(t,r){return e.onChapterItemExpand([t],r)}},o)))}))),f.createElement("div",{className:"row"},f.createElement(x.a,{className:"empty purple-empty-hover small add-button",onClick:this.onAddChapter,type:"button"},"Add Task ",i.count()+1),f.createElement("p",{className:"field-info"},"Recommended duration 5-7 mins")))}},{key:"_updateComponentActiveFields",value:function(e,t,r){var n=this.state.componentsFieldsState.get(e),o=r,a=!(n[t].dirty||!n[t].active||r),c=this.state.componentsFieldsState.set(e,Object(s.a)({},n,Object(i.a)({},t,{active:o,dirty:a})));this.setState({componentsFieldsState:c})}},{key:"_getComponentErrors",value:function(e,t){var r=!t.name.active&&t.name.dirty&&!!e.name,n=!t.description.active&&t.description.dirty&&!!e.description;return r||n?{name:r?e.name:void 0,description:n?e.description:void 0}:null}},{key:"_deleteChapter",value:function(e){var t=this.chapters.delete(e);this.props.input.onChange(t);var r=this.state.componentsFieldsState.delete(e);this.setState({componentsFieldsState:r})}},{key:"_validateAction",value:function(e,t){var r;if((e===M.Add||e===M.Delete||e===M.Record)&&(Object(R.d)(this.props.course,this.props.rooms)?r="already running":Object(R.c)(this.props.course,this.props.rooms)&&(r="about to start"),r))return this.props.actionDispatch(new O.i(new k.J({type:k.K.Error,title:"Running session",text:"You cannot ".concat(e," a task because this recording is used in a session that is ").concat(r)}))),!1;return!0}},{key:"_preserveChapterBeforeRecord",value:function(e){if(e.id){var t=this._initialValue.find((function(t){return t.id===e.id}));return t&&(e=e.set("order",t.order)),this.props.actionDispatch(this.props.asyncActions.updateChapter(this.props.course,e.id,e))}return this.props.actionDispatch(this.props.asyncActions.createChapter(this.props.course,e))}},{key:"_isChapterExpanded",value:function(e){return this.state.expandedItems.get(e.key.toString())}},{key:"chapters",get:function(){return this.props.input.value}},{key:"template",get:function(){return this.props.templates.get(this.props.course.templateId)}}]),t}(f.Component),Object(m.a)(a.prototype,"onChapterChange",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onChapterChange"),a.prototype),Object(m.a)(a.prototype,"onFocus",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onFocus"),a.prototype),Object(m.a)(a.prototype,"onBlur",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onBlur"),a.prototype),Object(m.a)(a.prototype,"onAddChapter",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onAddChapter"),a.prototype),Object(m.a)(a.prototype,"deleteChapter",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"deleteChapter"),a.prototype),Object(m.a)(a.prototype,"onRecordOrPreview",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onRecordOrPreview"),a.prototype),Object(m.a)(a.prototype,"onChapterItemDragStart",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onChapterItemDragStart"),a.prototype),Object(m.a)(a.prototype,"onChapterItemDragStop",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onChapterItemDragStop"),a.prototype),Object(m.a)(a.prototype,"onChapterItemExpand",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onChapterItemExpand"),a.prototype),Object(m.a)(a.prototype,"onGridLayoutChange",[v.a],Object.getOwnPropertyDescriptor(a.prototype,"onGridLayoutChange"),a.prototype),a)},1129:function(e,t,r){"use strict";var n,o=r(19),a=r.n(o),i=r(44),s=r(5),c=r(11),l=r(30),p=r(28),u=r(29),d=r(90),h=r(91),m=r.n(h),f=r(210),y=r.n(f),v=r(4),b=r(2),g=r(50),O=r(1119),k=r(123),C=function(){function e(t,r,n,o,a,i){Object(s.a)(this,e),this._guac=t,this._tunnelUUID=r,this._authToken=n,this._protocol=o,this._host=a,this._file=i,this._emitter=new g.EventEmitter,this._xhr=void 0}return Object(c.a)(e,[{key:"start",value:function(){var e=this,t=this._guac.createFileStream("application/zip",this._file.name);t.onack=function(){e._uploadFile(t),t.onack=null}}},{key:"onProgress",value:function(e){this._emitter.on(k.a.Progress,e)}},{key:"onCompleted",value:function(e){this._emitter.on(k.a.Completed,e)}},{key:"onError",value:function(e){this._emitter.on(k.a.Error,e)}},{key:"destroy",value:function(){this._emitter.off(k.a.Error),this._emitter.off(k.a.Completed),this._emitter.off(k.a.Progress),this._cancel()}},{key:"_uploadFile",value:function(e){var t=this,r=this._protocol+"://"+this._host+"/api/session/tunnels/"+this._tunnelUUID+"/streams/"+encodeURIComponent(e.index)+"/"+encodeURIComponent(Object(k.d)(this._file.name))+"?token="+encodeURIComponent(this._authToken),n=new XMLHttpRequest;n.withCredentials=!0,this._xhr=n,n.upload&&n.upload.addEventListener("progress",(function(e){t._emitter.emit(k.a.Progress,{current:e.loaded,total:t._file.size})})),n.onreadystatechange=function(){4===n.readyState&&(n.status>=200&&n.status<300?(t._guac.endStream(e.index),t._emitter.emit(k.a.Completed)):"application/json"===n.getResponseHeader("Content-Type")?t._emitter.emit(k.a.Error,n.responseText):n.status>=400&&n.status<500?t._emitter.emit(k.a.Error,"Stream error"):t._emitter.emit(k.a.Error,"HTTP "+n.status))},n.open("POST",r,!0),n.setRequestHeader("content-type","application/zip"),n.send(this._file)}},{key:"_cancel",value:function(){this._xhr&&this._xhr.abort()}}]),e}(),w=function(){var e=Object(i.a)(a.a.mark((function e(t,r,n){var o,i,s,c,l,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.a)(t);case 2:return o=e.sent,i=o.client,s=o.tunnel,c=o.token,(l=new C(i,s.uuid,c,t.protocol,t.host,r)).onProgress(n||y.a),l.start(),p=new Promise((function(e,t){l.onCompleted((function(){i.disconnect(),e()})),l.onError((function(e){i.disconnect(),t(new Error(e))}))})),e.abrupt("return",{promise:p,abort:function(){return l.destroy()}});case 11:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),j=r(0),E=r(1136);r.d(t,"a",(function(){return _}));var _=(n=function(e){function t(){var e,r;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={files:[],currentFile:0,currentProgress:0,inProgress:!1,done:!1,abortUpload:y.a},r._fileUploader=void 0,r._onUploadError=function(){r.props.dispatch(new b.i(new j.J({type:j.K.Error,ttl:1e4,title:"Error",text:'Something went wrong while uploading your files. Please, try again. If the issue persists, you can try [ufile.io](https://ufile.io){target="_blank"}'}))),r.props.onError&&r.props.onError()},r._trackUploadProgress=function(e){var t=new Array(e).fill(0);return function(e){return function(n){t[e]=n.current/n.total;var o=t.reduce((function(e,t){return e+t}))/t.length;r.setState({currentProgress:o}),r.props.onProgress&&r.props.onProgress(n)}}},r}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return v.createElement(E.a,{ref:function(t){return e._fileUploader=t},currentFile:this.state.currentFile,currentProgress:this.state.currentProgress,uploadIcon:this.props.uploadIcon,done:this.state.done,files:this.state.files,label:this.props.label,disabled:this.props.disabled,dispatch:this.props.dispatch,filters:{maxSize:104857600,minSize:1},onCancel:this._cancel,onFiles:this._onFiles})}},{key:"_onFiles",value:function(e){var t=this;this.props.onUploadStart&&this.props.onUploadStart(),this.setState({files:this.state.files.concat(e)},(function(){t.state.inProgress||t._nextFile()})),console.log("Uploading %d files",e.length)}},{key:"_nextFile",value:function(){var e=this,t=this.state.currentFile;if(t<this.state.files.length){var r=function(){return e._uploadFile(e.state.files[t]).then((function(){setTimeout((function(){return e._nextFile()}),1e3)}))};this.state.done?this.setState({done:!1},r):r()}else this.setState({done:!0}),this._fileUploader&&this._fileUploader.resetUploadArea(),this.props.onCompleted&&this.props.onCompleted(),this.props.dispatch(new b.i(new j.J({type:j.K.General,title:"Files uploaded",text:"Your files were successfully uploaded"})))}},{key:"_uploadFile",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,o,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({currentProgress:0,inProgress:!0,currentFile:this.state.currentFile+1}),e.prev=1,e.next=4,"function"===typeof this.props.vms?this.props.vms():this.props.vms;case 4:return r=e.sent,n=this._trackUploadProgress(r.length),e.next=8,Promise.all(r.map((function(e,r){return w(e.connection,t,n(r))})));case 8:return o=e.sent,i=o.reduce((function(e,t){var r=t.promise;return e.then((function(){return r}))}),Promise.resolve()),s=function(){return o.forEach((function(e){return e.abort()}))},this.setState({inProgress:!1,abortUpload:s}),e.next=14,i;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),this._onUploadError();case 19:case"end":return e.stop()}}),e,this,[[1,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_cancel",value:function(){this.state.abortUpload(),this.setState({files:[],inProgress:!1,currentFile:0,currentProgress:0}),this._fileUploader&&this._fileUploader.resetUploadArea(),this.props.onCompleted&&this.props.onCompleted()}}]),t}(v.PureComponent),Object(d.a)(n.prototype,"_onFiles",[m.a],Object.getOwnPropertyDescriptor(n.prototype,"_onFiles"),n.prototype),Object(d.a)(n.prototype,"_cancel",[m.a],Object.getOwnPropertyDescriptor(n.prototype,"_cancel"),n.prototype),n)},1130:function(e,t,r){"use strict";var n,o,a,i=r(47),s=r(5),c=r(11),l=r(30),p=r(28),u=r(29),d=r(90),h=r(3),m=r(4),f=(r(1210),r(91)),y=r.n(f),v=r(2),b=r(14),g=r(0),O=r(133),k=r(1045),C=r(1064),w={incomplete_number:"Your card number is incomplete.",incomplete_expiry:"Your card's expiration date is incomplete.",invalid_number:"The card number is not a valid credit card number.",invalid_expiry_month:"The card's expiration month is invalid.",invalid_expiry_year:"The card's expiration year is invalid.",invalid_cvc:"The card's security code is invalid.",invalid_swipe_data:"The card's swipe data is invalid.",incorrect_number:"The card number is incorrect.",expired_card:"The card has expired.",incorrect_cvc:"The card's security code is incorrect.",incorrect_zip:"The card's zip code failed validation.",card_declined:"The card was declined.",missing:"There is no card on a customer that is being charged.",processing_error:"An error occurred while processing the card."};r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return S})),function(e){e[e.CreditCard=0]="CreditCard",e[e.RhymeCard=1]="RhymeCard"}(a||(a={}));var j=function(e){return"99"===e.substr(0,2)?a.RhymeCard:a.CreditCard},E=" ".concat("/"," "),_=(n={},Object(h.a)(n,g.m.Visa,m.createElement("div",{className:"card-icon cc-visa"})),Object(h.a)(n,g.m.MasterCard,m.createElement("div",{className:"card-icon cc-mastercard"})),Object(h.a)(n,g.m.Amex,m.createElement("div",{className:"card-icon cc-amex"})),Object(h.a)(n,g.m.DinersClub,m.createElement("div",{className:"card-icon cc-diners"})),Object(h.a)(n,g.m.Discover,m.createElement("div",{className:"card-icon cc-discover"})),Object(h.a)(n,g.m.JCB,m.createElement("div",{className:"card-icon cc-jcb"})),Object(h.a)(n,g.m.Rhyme,m.createElement("div",{className:"card-icon rhyme-card"})),Object(h.a)(n,g.m.Unknown,null),n),S=(o=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(l.a)(this,Object(p.a)(t).call(this,e)))._cardType=a.CreditCard,r._cardMonth=void 0,r._cardYear=void 0,r._startCaretPosCache=0,r._initialCardNumber=void 0,r._initialCardExpiry=void 0,r._removableLeadZero=void 0,r.state={brand:g.m.Unknown,loading:!1,cardNumber:"",cardExpiry:"",cardType:a.CreditCard,validNumber:!1,validExpiry:!1,numberFocus:!1,expiryFocus:!1,numberDirty:!1,expiryDirty:!1},r}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){Stripe.setPublishableKey(b.a.StripeKey),this.props.onRef&&this.props.onRef(this),this.props.card&&this._setCardFromProps(this.props.card)}},{key:"componentWillReceiveProps",value:function(e){var t=e.card;!t||this._initialCardNumber||this._initialCardExpiry||this._setCardFromProps(t)}},{key:"onCardNumberChange",value:function(e){var t=this._clearIfFromProps(e.target.value),r=this._formatCardNumber(t);this.setState({cardNumber:r});var n=e.target,o=n.selectionStart,s=n.selectionEnd;e.target.value=r,this._updateCaret(4," ".length,e.target,o,s);var c,l=j(r);this.props.onCardTypeChange&&l!==this._cardType&&(this.props.onCardTypeChange(l),this._cardType=l);var p=this.state.cardExpiry.split(E),u=Object(i.a)(p,2),d=u[0],h=u[1],m=Stripe.card.validateExpiry(d,h);switch(m||(c=!0),l){case a.CreditCard:default:this.setState({numberDirty:!0,expiryDirty:c||this.state.expiryDirty,validNumber:Stripe.card.validateCardNumber(r),validExpiry:m,brand:Stripe.card.cardType(r)},this._onUpdate);break;case a.RhymeCard:var f=!Object(C.o)({card:r}).card;this.setState({numberDirty:!0,expiryDirty:c||this.state.expiryDirty,validNumber:f,validExpiry:m,brand:g.m.Rhyme},this._onUpdate)}}},{key:"onCardExpiryChange",value:function(e){var t=e.target.value,r=this._leadingZeroExpiry(t,this._removableLeadZero);if(r){t=r.value,this._removableLeadZero=r.removable;var n=this._formatCardExpiry(t),o=e.target;this.setState({cardExpiry:n});var s=o.selectionStart,c=o.selectionEnd;o.value=n,this._updateCaret(2,E.length+1,o,s,c);var l=n.split(E),p=Object(i.a)(l,2),u=p[0],d=p[1];this._cardMonth=u,this._cardYear=d;var h=this.state.cardNumber,m=j(h)===a.CreditCard?Stripe.card.validateCardNumber(h):Object(C.o)(h);this.setState({expiryDirty:!0,numberDirty:!0,validExpiry:Stripe.card.validateExpiry(this._cardMonth,this._cardYear),validNumber:m},this._onUpdate)}}},{key:"submitInfo",value:function(e){e.preventDefault(),this.submit()}},{key:"submit",value:function(e){switch(j(this.state.cardNumber)){case a.CreditCard:default:this._submitCreditCard(e);break;case a.RhymeCard:this._submitRhymeCard(e)}}},{key:"clear",value:function(){this.setState({brand:g.m.Unknown,cardNumber:"",cardExpiry:""})}},{key:"reset",value:function(){this.props.card?this._setCardFromProps(this.props.card):this.clear()}},{key:"renderCCBrand",value:function(){var e=_[this.state.brand],t=this.props.card,r=this.state.brand===g.m.Rhyme&&this.state.cardNumber.startsWith("**")&&!this.isExpired;return m.createElement(m.Fragment,null,e,t&&t.id&&r?m.createElement("div",{className:"card-amount"},"Balance: $",Object(O.b)(t.amount)):null)}},{key:"numberError",value:function(){var e="";return this.isNumberInvalid?e="Invalid number":this.isExpired&&(e=" "),e}},{key:"expiryError",value:function(){var e="";return this.isExpiryInvalid?e="Invalid expiry":this.isExpired&&(e="Card expired"),e}},{key:"focusNumber",value:function(){this.setState({numberFocus:!0})}},{key:"blurNumber",value:function(){this.setState({numberFocus:!1})}},{key:"focusExpiry",value:function(){this.setState({expiryFocus:!0})}},{key:"blurExpiry",value:function(){this.setState({expiryFocus:!1})}},{key:"render",value:function(){return m.createElement("div",{className:"universal-card-form"},m.createElement("form",{onSubmit:this.submitInfo},m.createElement("div",null,m.createElement(k.k,{type:"text",label:"Card Number",name:"card",autoComplete:"off",onChange:this.onCardNumberChange,onFocus:this.focusNumber,onBlur:this.blurNumber,value:this.state.cardNumber,placeholder:"1234 1234 1234 1234",maxLength:19,ignoreLastPass:!0,error:this.numberError()}),m.createElement(k.k,{type:"text",label:"Card Expiry",name:"expiry",autoComplete:"off",onChange:this.onCardExpiryChange,onFocus:this.focusExpiry,onBlur:this.blurExpiry,value:this.state.cardExpiry,placeholder:"MM / YY",ignoreLastPass:!0,error:this.expiryError()})),!this.props.hideSaveButton&&m.createElement(k.a,{loading:this.state.loading,disabled:!this.isFormValid},"Save")),this.renderCCBrand())}},{key:"_formatCardNumber",value:function(e){return e=e.replace(/[^0-9]/g,""),Object(O.e)(e,4," ")}},{key:"_formatCardExpiry",value:function(e){return 3===(e=e.replace(/[^0-9/]/g,"")).length&&"/"===e[2]?e.substr(0,2)+E:(e=e.replace(/[^0-9]/g,""),Object(O.e)(e,2,E))}},{key:"_submitCreditCard",value:function(e){var t=this;this.setState({loading:!0});var r=this.state.cardNumber.replace(/\s/g,"");Stripe.card.createToken({number:r,exp_month:this._cardMonth,exp_year:this._cardYear},(function(r,n){if(n.error)t.props.dispatch(new v.i(new g.J({type:g.K.Error,text:w[n.error.code]||n.error.message}))),t.props.onStripeError&&t.props.onStripeError(),t.setState({loading:!1});else{var o=t._createCard(n);t.props.onCardSave(o,!!e).catch((function(){return t.setState({loading:!1})}))}}))}},{key:"_submitRhymeCard",value:function(e){var t=this,r=this.state.cardNumber.replace(/\s/g,""),n={last4:r.substring(r.length-4,r.length),exp_month:parseInt(this._cardMonth,10),exp_year:parseInt("20"+this._cardYear,10),brand:g.m.Rhyme},o=this._createCard({id:r,card:n});this.props.onCardSave(o,!!e).catch((function(){return t.setState({loading:!1})}))}},{key:"_updateCaret",value:function(e,t,r,n,o){for(var a=0,i=e+=1;i<n+e;i+=e)n<this._startCaretPosCache&&n===i+t-1?a=-1*t:n===i&&(a=t);this._startCaretPosCache=n,r.setSelectionRange(n+a,o+a)}},{key:"_onUpdate",value:function(e,t){this.props.onUpdate&&this.props.onUpdate({card:this.state.cardNumber,expiry:this.state.cardExpiry,valid:e||this.isFormValid,pristine:t||this.pristine,brand:this.state.brand})}},{key:"_createCard",value:function(e){var t=e.id,r=e.card;return new g.l({customer:t,lastFour:r.last4,brand:r.brand,expiryMonth:r.exp_month,expiryYear:r.exp_year})}},{key:"_setCardFromProps",value:function(e){this._initialCardNumber="**** **** **** ".concat(e.lastFour),this._initialCardExpiry=function(e,t){var r=e.toString();return 1===r.length&&(r="0"+r),r+" / "+t.toString().substr(2,2)}(e.expiryMonth,e.expiryYear),this._cardMonth=e.expiryMonth.toString(),this._cardYear=e.expiryYear.toString().substr(2,2),this.setState({cardNumber:this._initialCardNumber,cardExpiry:this._initialCardExpiry,brand:e.brand,validNumber:!0,validExpiry:!0,numberDirty:!1,expiryDirty:!1})}},{key:"_clearIfFromProps",value:function(e){return-1!==e.indexOf("*")?"":e}},{key:"_leadingZeroExpiry",value:function(e,t){if(e.length>7){if("0"!==e[0]||!t)return null;var r=e.split("");r.shift(),e=r.join("")}else 3===e.length&&"0"!==e[0]&&"/"!==e[2]?(e="0"+e,t=!0):2===e.length&&"/"===e[1]?e="0"+e:e||(t=!1);return{value:e,removable:t}}},{key:"isFormValid",get:function(){return this.state.validNumber&&this.state.validExpiry}},{key:"isNumberInvalid",get:function(){var e=this.state;return e.numberDirty&&!e.numberFocus&&!e.validNumber}},{key:"isExpiryInvalid",get:function(){var e=this.state;return e.expiryDirty&&!e.expiryFocus&&!e.validExpiry}},{key:"isExpired",get:function(){var e=this.props.card;if(e&&this.pristine){var t=new Date(e.expiryYear,e.expiryMonth).getTime();return Date.now()>t}return!1}},{key:"pristine",get:function(){var e=this.state.cardNumber!==this._initialCardNumber,t=this.state.cardExpiry!==this._initialCardExpiry;return!(e||e&&t)}}]),t}(m.Component),Object(d.a)(o.prototype,"onCardNumberChange",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"onCardNumberChange"),o.prototype),Object(d.a)(o.prototype,"onCardExpiryChange",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"onCardExpiryChange"),o.prototype),Object(d.a)(o.prototype,"submitInfo",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"submitInfo"),o.prototype),Object(d.a)(o.prototype,"focusNumber",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"focusNumber"),o.prototype),Object(d.a)(o.prototype,"blurNumber",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"blurNumber"),o.prototype),Object(d.a)(o.prototype,"focusExpiry",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"focusExpiry"),o.prototype),Object(d.a)(o.prototype,"blurExpiry",[y.a],Object.getOwnPropertyDescriptor(o.prototype,"blurExpiry"),o.prototype),o)},1131:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return s}));var n,o,a=r(3);!function(e){e[e.NA=0]="NA",e[e.Weak=1]="Weak",e[e.Safe=2]="Safe",e[e.Good=3]="Good",e[e.Great=4]="Great"}(o||(o={}));var i=function(e){var t=o.NA;return e.length>20?t=o.Great:e.length>15?t=o.Good:e.length>10?t=o.Safe:6<=e.length&&e.length<=10&&(t=o.Weak),t},s=(n={},Object(a.a)(n,o.NA,""),Object(a.a)(n,o.Weak,"Your password is weak."),Object(a.a)(n,o.Safe,"Your password is safe."),Object(a.a)(n,o.Good,"Your password is good."),Object(a.a)(n,o.Great,"Your password is great."),n)},1132:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,o=r(51),a=r(5),i=r(11),s=r(30),c=r(28),l=r(29),p=r(90),u=r(4),d=(r(1177),r(91)),h=r.n(d),m=(n=function(e){function t(e){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(c.a)(t).call(this,e)))._mouseStart=0,r.state={pulled:!0,pulling:!1},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this._onDocumentMouseMove),document.addEventListener("mouseup",this._onDocumentMouseUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this._onDocumentMouseMove),document.removeEventListener("mouseup",this._onDocumentMouseUp)}},{key:"onPullerMouseDown",value:function(e){this._mouseStart=e.clientY,this.setState({pulling:!0})}},{key:"render",value:function(){return u.createElement("div",{className:"bottom-bar"+(this.state.pulled?" pulled":"")+(this.props.width&&this.props.width<250?" hidden":""),onMouseDown:function(e){return e.stopPropagation()}},u.createElement("div",{className:"frame"}),u.createElement("div",{className:"container",style:Object(o.a)({},this.props.width?{width:this.props.width+2}:{})},u.createElement("div",{className:"puller"+(this.state.pulling?" pulling":""),onMouseDown:this.onPullerMouseDown}),u.createElement("div",{className:"content"},u.createElement("div",{className:"logo"}),u.createElement("div",{className:"children"+(this.state.pulled?" visible":"")},this.props.children))))}},{key:"_onDocumentMouseMove",value:function(e){if(this.state.pulling){var t=e.clientY-this._mouseStart;t>=30?this.setState({pulled:!1}):t<=-30&&this.setState({pulled:!0})}}},{key:"_onDocumentMouseUp",value:function(e){var t=e.clientY-this._mouseStart===0;this.setState({pulling:!1,pulled:t?!this.state.pulled:this.state.pulled})}}]),t}(u.PureComponent),Object(p.a)(n.prototype,"onPullerMouseDown",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"onPullerMouseDown"),n.prototype),Object(p.a)(n.prototype,"_onDocumentMouseMove",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"_onDocumentMouseMove"),n.prototype),Object(p.a)(n.prototype,"_onDocumentMouseUp",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"_onDocumentMouseUp"),n.prototype),n)},1133:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=r(97),p=(r(1178),function(e){function t(){var e,r;Object(n.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(r=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).state={keys:[],down:{}},r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"onKey",value:function(e){if(e){var t=l.a.fromKeySym(e.keyCode);if(t)if(e.down){var r=this.state,n=r.keys,o=r.down;n.push(t),n.length>50&&n.shift(),o[e.keyCode]=[t,Date.now()],this.setState({keys:n,down:o})}else{var a=this.state.down;a[e.keyCode]&&(delete a[e.keyCode],this.setState({down:a}))}}}},{key:"reset",value:function(){this.setState({keys:[],down:{}})}},{key:"render",value:function(){return c.createElement("div",{className:"caption-player"},c.createElement("div",{className:"caption-wrapper"},this.caption),this.keysDown.length?c.createElement("div",{className:"pinned"},this.keysDown):null,c.createElement("div",{className:"keyboard tooltip rel l","data-tooltip":this.props.tooltip||"The keys being pressed in the task video"}))}},{key:"keysDown",get:function(){var e=Date.now(),t=this.state.down;return Object.keys(t).map((function(e){return t[e]})).filter((function(t){return t[1]<e-500})).map((function(e,t){return c.createElement("span",{key:"pk-"+t},e[0].label)}))}},{key:"caption",get:function(){return this.state.keys.map((function(e,t){return c.createElement("span",{key:"ck-"+t},e.label)}))}}]),t}(c.Component))},1134:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=(r(1183),function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e={width:100*this.progress+"%",backgroundColor:this.props.color};return c.createElement("div",{className:"progress-bar-wrapper  "+this.props.type+(this.props.className||"")},c.createElement("div",{style:e,className:"progress-bar-progress"}))}},{key:"progress",get:function(){return this.props.progress<1?this.props.progress:1}}]),t}(c.Component));l.defaultProps={type:"regular"}},1135:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=(r(1188),r(91)),d=r.n(u),h=r(14),m=r(1092),f=r(1113),y=r(1118),v=r(1089),b=(n=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this,e)))._overlayCont=void 0,r.state={width:400,height:400,scaleX:1,scaleY:1,detailsInitialSize:370,overlayContHasChildren:!1},r}return Object(c.a)(t,e),Object(a.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.vm,n=t.controls,o=e.vm,a=e.controls;if((r&&(r&&!o||o&&r.width!==o.width||o&&r.height!==o.height)||n&&!a)&&this.adjustLayout(),this._overlayCont){var i=this._overlayCont.childNodes.length>0;this.setState({overlayContHasChildren:i})}}},{key:"onResize",value:function(e,t){this.adjustLayout(),this.props.onResize&&this.props.onResize(e,t)}},{key:"render",value:function(){var e=this;return p.createElement(v.c,{ref:function(t){return e._splitter=t},onResize:this.onResize,onResizeStart:this.props.onResizeStart,onResizeEnd:this.props.onResizeEnd,onPanelsRefs:this.props.onPanelsRefs,rightPanelInitialSize:this.rightPanelSize,className:"split-screen"+(this.props.className?" "+this.props.className:"")},this.props.vm?p.createElement(p.Fragment,null,p.createElement("div",{className:"balance"}),p.createElement("div",{className:"left-container",ref:this.onLeftContRef},this.props.overlay&&p.createElement("div",{ref:function(t){return e._overlayCont=t},className:"overlay-cont"+(this.state.overlayContHasChildren?" has-children":""),style:{width:this.state.width,height:this.state.height}},this.props.overlay),p.createElement(m.a,{originalWidth:this.props.vm.width,originalHeight:this.props.vm.height,scaledWidth:this.state.width-8},p.createElement(f.a,{onKeyDown:this.props.onEvent,onKeyUp:this.props.onEvent,onMouseEvent:this.props.onEvent,vm:this.props.vm,template:this.props.template,isViewExpanded:this.props.isViewExpanded,showViewbox:this.props.showViewbox,viewboxSize:this.props.viewboxSize,width:this.props.vm.width,height:this.props.vm.height,cursorPosition:this.props.cursorPosition,emitCursor:this.props.emitCursor,scaleRatio:{scaleX:this.state.scaleX,scaleY:this.state.scaleY},onReadWriteInit:this.props.onReadWriteInit,onConnect:this.props.onConnect,onDisconnect:this.props.onDisconnect,readOnly:this.props.readOnly,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,controls:this.props.controls,cameraStream:this.props.cameraStream,vmAccessLimitReached:this.props.vmAccessLimitReached}))),this.props.leftPanelChildren?this.props.leftPanelChildren:p.createElement("div",{className:"balance"})):null,p.createElement(p.Fragment,null,this.props.children))}},{key:"_screenWidth",get:function(){return this.props.vm?this.props.vm.width:h.a.DefaultScreenWidth}},{key:"_screenHeight",get:function(){return this.props.vm?this.props.vm.height:h.a.DefaultScreenHeight}},{key:"_verticalPadding",get:function(){return 75}}]),t}(y.a),Object(l.a)(n.prototype,"onResize",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"onResize"),n.prototype),n)},1136:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=(r(1189),r(91)),d=r.n(u),h=r(2),m=r(0),f=r(1134),y=r(1137),v={minSize:{msg:function(e){return"the minimal file size is ".concat(e/1048576,"MB")},filter:function(e,t){return e.size<t}},maxSize:{msg:function(e){return"the maximal file size is ".concat(e/1048576,"MB")},filter:function(e,t){return e.size>t}},types:{msg:function(e){return"the allowed file type".concat(1!==e.length?"s":""," ").concat(1!==e.length?"are":"is"," ")+"".concat(e.map((function(e){return e.split("/").pop()})).join(", "))},filter:function(e,t){return-1===t.indexOf(e.type)}}},b=(n=function(e){function t(){var e,r;Object(o.a)(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(r=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a))))._uploadArea=void 0,r}return Object(c.a)(t,e),Object(a.a)(t,[{key:"resetUploadArea",value:function(){this._uploadArea&&this._uploadArea.reset()}},{key:"onFiles",value:function(e){if(!this.props.disabled&&e&&e.length){var t,r=[].slice.call(e),n=(t=this.props.dispatch,function(e,r){t(new h.i(new m.J({type:m.K.Error,ttl:1e4,title:e,text:r})))}),o=this.props.fileLimit;if(void 0!==o&&r.length>o)n("File number limit reached","You cannot upload more than ".concat(o," file").concat(1!==o?"s":""));else{var a=this.props.filters;if(a){var i=[];Object.keys(a).forEach((function(e){var t=a[e];if(void 0!==t){var r=v[e],n={filter:function(e){return r.filter(e,t)},msg:r.msg(t)};i.push(n)}}));var s=function(e){return function(t){return e.map((function(e){return e(t)})).reduce((function(e,t){return e||t}))}}(i.map((function(e){return e.filter}))),c=r.filter(s).map((function(e){return i.map((function(t){return t.filter(e)?t.msg:void 0})).filter((function(e){return!!e}))})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e,t,r){return r.indexOf(e)===t}));if(c.length)return void n("Cannot upload file".concat(1!==r.length?"s":""),"Because "+c.join("; "))}this.props.onFiles(r)}}}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"file-uploader"+(this.props.disabled?" disabled":"")},p.createElement(y.a,{ref:function(t){return e._uploadArea=t},allowSameFileSelection:!0,uploadIcon:this.props.uploadIcon,onFiles:this.onFiles},this.props.files.length&&!this.props.done?p.createElement("div",null,"File ",this.props.currentFile,"/",this.props.files.length,p.createElement(f.a,{className:this.props.onCancel?"":" full-width",progress:this.props.currentProgress}),this.props.onCancel&&p.createElement("i",{className:"fa fa-times cancel",onClick:this.props.onCancel})):p.createElement("div",null,this.props.done?this.props.filesUploadedLabel||"All files uploaded":this.props.label||"Upload files here")))}}]),t}(p.PureComponent),Object(l.a)(n.prototype,"onFiles",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"onFiles"),n.prototype),n)},1137:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=(r(1190),r(91)),d=r.n(u),h=function(){},m=(n=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this,e)))._input=void 0,r.state={dragOver:!1},r}return Object(c.a)(t,e),Object(a.a)(t,[{key:"onFilesFromDrop",value:function(e){this.onDragLeave(e),this.props.onFiles(e.dataTransfer.files)}},{key:"onDragOver",value:function(e){e.preventDefault(),this.setState({dragOver:!0})}},{key:"onDragLeave",value:function(e){e.preventDefault(),this.setState({dragOver:!1})}},{key:"onFilesFromInput",value:function(e){this.props.onFiles(e.target.files)}},{key:"reset",value:function(){this._input&&(this._input.value="")}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"drop-upload-area"+(this.state.dragOver?" active":""),onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onFilesFromDrop},p.createElement("input",{ref:function(t){return e._input=t},className:"area",type:"file",onChange:this.onFilesFromInput,onClick:this.props.allowSameFileSelection?this.reset:h}),this.props.uploadIcon?this.props.uploadIcon:p.createElement("div",{className:"upload-icon"}),p.createElement("span",{className:"ua-content"},this.props.children))}}]),t}(p.Component),Object(l.a)(n.prototype,"onFilesFromDrop",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"onFilesFromDrop"),n.prototype),Object(l.a)(n.prototype,"onDragOver",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"onDragOver"),n.prototype),Object(l.a)(n.prototype,"onDragLeave",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"onDragLeave"),n.prototype),Object(l.a)(n.prototype,"onFilesFromInput",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"onFilesFromInput"),n.prototype),Object(l.a)(n.prototype,"reset",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"reset"),n.prototype),n)},1138:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=r(91),d=r.n(u),h=r(1348),m=(r(1195),n=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this,e)))._clipboard=void 0,r._button=void 0,r.state={showTooltip:!1},r}return Object(c.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._clipboard||(this._clipboard=new h(this._button,{text:function(){return e.props.value}}),this._clipboard.on("success",(function(t){e.setState({showTooltip:!0}),t.clearSelection()})))}},{key:"componentWillUnmount",value:function(){this._clipboard&&(this._clipboard.destroy(),this._clipboard=null)}},{key:"render",value:function(){return p.createElement("div",{ref:this._onButtonRef,className:this.className,onMouseLeave:this._onMouseLeave,"aria-label":"Copied!","data-tooltip":"Copied!"},this.props.children)}},{key:"_onButtonRef",value:function(e){this._button=e}},{key:"_onMouseLeave",value:function(){this.setState({showTooltip:!1})}},{key:"className",get:function(){var e="clipboard";return this.props.className&&(e+=" ".concat(this.props.className)),this.state.showTooltip&&(e+=" tooltip rel r"),this.props.disabled&&(e+=" disabled"),e}}]),t}(p.PureComponent),Object(l.a)(n.prototype,"_onButtonRef",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"_onButtonRef"),n.prototype),Object(l.a)(n.prototype,"_onMouseLeave",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"_onMouseLeave"),n.prototype),n)},1149:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(4),o=r(62),a=r(2),i=(r(1256),function(){var e=Object(o.e)((function(e){return e.backendState.connectivityState})),t=Object(o.d)(),r=n.useCallback((function(){return t(new a.tb("unknown"))}),[t]),i=Object(o.e)((function(e){return e.backendState.offlineModeViews>0}));return"offline"!==e?null:n.createElement("div",{className:"backend-failure"},n.createElement("div",{className:"box"},i&&n.createElement("div",{className:"modal-close"},n.createElement("div",{onClick:r})),n.createElement("h3",null,n.createElement("i",{className:"fa fa-meh-o"})," Oops!"),"There is an issue with our services."," ",i?"Please, retry your last action in a minute.":"Please, visit us later."))})},1150:function(e,t,r){"use strict";function n(e,t,r,n){var o=1;if(r>n&&(o=-1),!t||e[n]===t)return e[r];for(var a=r;o>0?a<n:a>n;a+=o)if(e[a]===t&&e[a+o])return e[a+o];return null}r.d(t,"a",(function(){return n}))},1152:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=(r(1316),r(91)),d=r.n(u),h=(n=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(a.a)(t,[{key:"toggle",value:function(){this.props.onToggle(!this.props.expanded)}},{key:"render",value:function(){return p.createElement("div",{className:this.className,"data-error-msg":this.props.errorMessage},p.createElement("div",{className:"header",onClick:this.toggle},p.createElement("div",{className:"expanded"},p.createElement("div",{className:"header-content"},this.props.expandHeader),p.createElement("div",{className:"collapse-icon"})),p.createElement("div",{className:"collapsed"},p.createElement("div",{className:"header-content"},this.props.collapseHeader),p.createElement("div",{className:"expand-icon"}))),p.createElement("div",{className:"cont-content"},this.props.children))}},{key:"className",get:function(){var e="expandable-container";return this.props.expanded&&(e+=" expanded"),this.props.errored&&(e+=" errored"),e}}]),t}(p.Component),Object(l.a)(n.prototype,"toggle",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"toggle"),n.prototype),n)},1153:function(e,t,r){},1154:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=r(91),d=r.n(u),h=r(1079),m=(r(1155),r(1156)),f=r(1157),y=(n=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={backgroundWrapper:void 0},r}return Object(c.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return p.createElement(p.Fragment,null,p.createElement("div",{className:"unsupported-recording",ref:this._onWrapperRef},p.createElement("div",{className:"content"},p.createElement("div",{className:"header"},p.createElement("div",{className:"logo"}),this.props.onBack&&p.createElement("h2",null,p.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.props.onBack}))),p.createElement("div",{className:"view"},p.createElement("h1",null,this.props.title),p.createElement("p",{className:"sub-title"},this.props.description),p.createElement("div",{className:"browsers"},p.createElement("a",{href:"https://www.google.com/chrome/browser/desktop/index.html",target:"_blank"},p.createElement("span",{className:"title"},"Chrome"),p.createElement("img",{src:m}),p.createElement("span",{className:"ver"},"59+")),p.createElement("a",{href:"https://www.mozilla.org/en-US/firefox/",target:"_blank"},p.createElement("span",{className:"title"},"Firefox"),p.createElement("img",{src:f}),p.createElement("span",{className:"ver"},"54+"))),this.props.onBack&&p.createElement("a",{href:"javascript:void(0);",className:"go-back",onClick:this.props.onBack},"Go Back"))),p.createElement("div",{className:"header-separator"})),this.state.backgroundWrapper?p.createElement(h.a,{overflow:"hidden",wrapper:this.state.backgroundWrapper}):null)}},{key:"_onWrapperRef",value:function(e){!this.state.backgroundWrapper&&e&&this.setState({backgroundWrapper:e})}}]),t}(p.Component),Object(l.a)(n.prototype,"_onWrapperRef",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"_onWrapperRef"),n.prototype),n)},1155:function(e,t,r){},1156:function(e,t,r){e.exports=r.p+"static/media/Chrome.f3b6c54c.svg"},1157:function(e,t,r){e.exports=r.p+"static/media/Firefox.e037fac5.svg"},1163:function(e,t,r){},1164:function(e,t,r){},1165:function(e,t,r){},1166:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return y}));var n,o,a=r(5),i=r(11),s=r(30),c=r(28),l=r(29),p=r(90),u=r(4),d=(r(1167),r(91)),h=r.n(d),m=r(1045),f=r(1051);!function(e){e[e.DisabledCamera=0]="DisabledCamera",e[e.EnabledCamera=1]="EnabledCamera",e[e.BroadcastedCamera=2]="BroadcastedCamera"}(o||(o={}));var y=(n=function(e){function t(e){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(c.a)(t).call(this,e)))._video=void 0,r.state={isLoadingCamera:!1},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.cameraStream!==e.cameraStream&&this._video&&(this._video.srcObject=this.props.cameraStream)}},{key:"onDisabledCameraAction",value:function(){this.setState({isLoadingCamera:!0}),this.props.onDisabledCameraAction()}},{key:"onVideoRef",value:function(e){this._video=e}},{key:"render",value:function(){return u.createElement("div",{className:"webcam-thumb"},u.createElement("div",{className:"thumb"},this.renderThumb()),this.thumbLabel&&u.createElement("div",{className:"label"},this.thumbLabel))}},{key:"renderThumb",value:function(){switch(this.props.view){case o.DisabledCamera:return this.renderDisabledCamera();case o.EnabledCamera:return this.renderCamera();case o.BroadcastedCamera:return this.renderBroadcastedCamera();default:return null}}},{key:"renderDisabledCamera",value:function(){return u.createElement(u.Fragment,null,u.createElement(m.b,{className:"empty enable-webcam-btn",disabled:this.props.disabled,onClick:this.onDisabledCameraAction},this.props.labels.disabledCameraButton),this.props.error?u.createElement("span",{className:"webcam-error"},this.props.error):u.createElement(u.Fragment,null,u.createElement("span",{className:"description"+(this.props.disabled?" disabled":"")},this.props.labels.disabledCameraDescription),this.props.disabled?u.createElement("span",{className:"disabled-label"},this.props.labels.disabledLabel):null))}},{key:"renderCamera",value:function(){return this.props.cameraStream?u.createElement(u.Fragment,null,u.createElement(f.a,null),u.createElement("video",{ref:this.onVideoRef,autoPlay:!0,onLoadedMetadata:this._onLoadedMetadata}),this.state.isLoadingCamera?null:u.createElement("div",{className:"camera-options"},u.createElement(m.b,{className:"empty broadcast-webcam-btn",disabled:this.props.disabled,onClick:this.props.onEnabledCameraAction},this.props.labels.enabledCameraButton),u.createElement("span",{className:"description"},this.props.labels.enabledCameraDescription))):null}},{key:"renderBroadcastedCamera",value:function(){return u.createElement(u.Fragment,null,u.createElement(m.b,{className:"empty broadcast-vm-btn",disabled:this.props.disabled,onClick:this.props.onBroadcastedCameraAction},this.props.labels.broadcastedCameraButton),u.createElement("span",{className:"description"},this.props.labels.broadcastedCameraDescription))}},{key:"_onLoadedMetadata",value:function(){this.setState({isLoadingCamera:!1})}},{key:"thumbLabel",get:function(){switch(this.props.view){case o.DisabledCamera:return this.props.labels.disabledCameraLabel;case o.EnabledCamera:return this.props.labels.enabledCameraLabel;case o.BroadcastedCamera:return this.props.labels.broadcastedCameraLabel;default:return""}}}]),t}(u.PureComponent),Object(p.a)(n.prototype,"onDisabledCameraAction",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"onDisabledCameraAction"),n.prototype),Object(p.a)(n.prototype,"onVideoRef",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"onVideoRef"),n.prototype),Object(p.a)(n.prototype,"_onLoadedMetadata",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"_onLoadedMetadata"),n.prototype),n)},1167:function(e,t,r){},1168:function(e,t,r){},1169:function(e,t,r){},1170:function(e,t,r){},1171:function(e,t,r){},1172:function(e,t,r){},1173:function(e,t,r){},1174:function(e,t,r){},1175:function(e,t,r){},1176:function(e,t,r){},1177:function(e,t,r){},1178:function(e,t,r){},1179:function(e,t,r){},1180:function(e,t,r){},1181:function(e,t,r){},1182:function(e,t,r){},1183:function(e,t,r){},1184:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=r(1065),p=(r(1185),function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(a.a)(this,Object(i.a)(t).call(this,e)))._player=void 0,r.state={input:void 0,expandModeData:void 0,loading:!1},r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.chapter,t=e.inputUrl,r=e.expandModeUrl;this._loadData(t,r)}},{key:"componentDidUpdate",value:function(e){this.props.chapter.inputUrl===e.chapter.inputUrl||this.props.chapter.expandModeUrl===e.chapter.expandModeUrl&&this.props.chapter.expandModeUrl||this._loadData(this.props.chapter.inputUrl,this.props.chapter.expandModeUrl)}},{key:"play",value:function(){return this._player?this._player.play():Promise.reject()}},{key:"pause",value:function(){this._player&&this._player.pause()}},{key:"changePlaybackRate",value:function(e){this._player&&this._player.changePlaybackRate(e)}},{key:"toggleViewbox",value:function(){if(this._player)return this._player.toggleViewbox()}},{key:"setCurrentTime",value:function(e){this._player&&this._player.setCurrentTime(e)}},{key:"learnerChangedSidebarMode",value:function(){this._player&&this._player.learnerChangedSidebarMode()}},{key:"takeScreenshot",value:function(){return this._player?this._player.takeScreenshot():null}},{key:"render",value:function(){var e=this;return c.createElement("div",{className:"chapter-player"},this.state.loading?this.renderLoading():null,c.createElement(l.b,{ref:function(t){return e._player=t},mp4:this.props.chapter.cdnMp4Url,webm:this.props.chapter.cdnWebmUrl,src:this.props.chapter.videoUrl,dispatch:this.props.dispatch,onKeyboardFrame:this.props.onKeyboardFrame,onMouseFrame:this.props.onMouseFrame,captionPlayer:this.props.captionPlayer,mouse:this.props.mouse,autoPlay:this.props.autoPlay||!1,input:this.state.input,expandModeData:this.state.expandModeData,controls:this.props.controls,viewboxSize:this.props.viewboxSize,showViewbox:this.props.showViewbox,isViewExpanded:this.props.isViewExpanded,onViewboxToggle:this.props.onViewboxToggle,onCanPlay:this.props.onCanPlay,onReadyMetadata:this.props.onReadyMetadata,className:this.state.loading?"hidden":void 0,annotations:this.props.chapter.annotations,subtitles:this.props.chapter.subtitles,subtitleLang:this.props.language,onVideoDimmensions:this.props.onVideoDimmensions,onExpandModeChange:this.props.onExpandModeChange,onCueChange:this.props.onCueChange,errorContainer:this.props.errorContainer}))}},{key:"renderLoading",value:function(){return"Buffering..."}},{key:"_loadData",value:function(e,t){var r=this;this.setState({loading:!0}),Promise.all([this._fetchResource(e),this._fetchResource(t)]).then((function(e){var t=e[0],n=e[1];r.setState({input:t,expandModeData:n,loading:!1})})).catch((function(){return r.setState({loading:!1})}))}},{key:"_fetchResource",value:function(e){return e?new Promise((function(t,r){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.onreadystatechange=function(e){4===n.readyState&&(200===n.status?t(n.response):r())},n.open("get",e,!0),n.send()})):Promise.resolve(void 0)}},{key:"playing",get:function(){return!!this._player&&this._player.playing}},{key:"playbackRate",get:function(){return this._player?this._player.playbackRate:l.a.x100}},{key:"canPlay",get:function(){return!!this._player&&this._player.canPlay}},{key:"currentTime",get:function(){return this._player?this._player.currentTime:0}},{key:"duration",get:function(){return this._player?this._player.duration:0}}]),t}(c.PureComponent))},1185:function(e,t,r){},1186:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=(r(1187),function(e){function t(){var e,r;Object(n.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(r=Object(a.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).props=void 0,r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=["cc-container",this.props.hidden&&"hidden",this.props.className||""].filter(Boolean).join(" "),t=this.props.dir||"ltr";return c.createElement("div",{className:e},this.props.children,"string"===typeof this.props.text?this.props.text&&c.createElement("span",{dir:t,className:"cc-text"},this.props.text):this.props.text)}}]),t}(c.PureComponent))},1187:function(e,t,r){},1188:function(e,t,r){},1189:function(e,t,r){},1190:function(e,t,r){},1191:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=(r(1192),function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(a.a)(this,Object(i.a)(t).call(this,e)))._docClickCb=void 0,r._clickFlag=void 0,r._onMouseEnter=function(){r.props.showOnMouseEnter&&r.show()},r._onMouseLeave=function(){r.props.showOnMouseEnter&&r.hide()},r.state={visible:!1},r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docClickCb=function(){e._clickFlag||e.hide(),e._clickFlag=!1})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docClickCb)}},{key:"show",value:function(){this._clickFlag=!0,this.setState({visible:!0})}},{key:"hide",value:function(){this.setState({visible:!1})}},{key:"render",value:function(){return c.createElement("span",{className:"rhyme-tooltip "+(this.props.className||""),onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave},this.state.visible&&c.createElement("span",{className:"rt-content"},this.props.children[0]),this.props.children[1])}}]),t}(c.Component))},1192:function(e,t,r){},1193:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return y}));var n,o,a=r(5),i=r(11),s=r(30),c=r(28),l=r(29),p=r(90),u=r(4),d=(r(1047),r(1194),r(91)),h=r.n(d),m=r(1045),f=r(289);!function(e){e.End="End",e.Delete="Delete"}(o||(o={}));var y=(n=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return u.createElement(f.a,{visible:this.props.visible,onToggle:this.props.onToggle,title:"Long Running Session",size:"small"},u.createElement("div",{className:"form-styles lrs-end-modal"},u.createElement("p",{className:"text"},this._firstSentence," ",this._secondSentence),u.createElement("div",{className:"button-sequence"},u.createElement(m.b,{className:"short-btn",onClick:this._close},"OK"))))}},{key:"_close",value:function(){this.props.onToggle(!1)}},{key:"_firstSentence",get:function(){return this.props.type===o.Delete?"You cannot delete a long running session.":"You cannot end a long running session."}},{key:"_secondSentence",get:function(){return this.props.type===o.Delete?u.createElement(u.Fragment,null,"To delete such a session,",u.createElement("br",null),"please contact the administrator."):u.createElement(u.Fragment,null,"To end such a session,",u.createElement("br",null),"please contact the administrator.")}}]),t}(u.PureComponent),Object(p.a)(n.prototype,"_close",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"_close"),n.prototype),n)},1194:function(e,t,r){},1195:function(e,t,r){},1210:function(e,t,r){},1216:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=[r(1259),r(1260),r(1261),r(1262),r(1263),r(1264),r(1265),r(1266),r(1267),r(1268),r(1269),r(1270),r(1271),r(1272),r(1273),r(1274),r(1275),r(1276),r(1277),r(1278),r(1279),r(1280),r(1281),r(1282),r(1283),r(1284),r(1285),r(1286),r(1287),r(1288),r(1289),r(1290),r(1291),r(1292),r(1293),r(1294),r(1295),r(1296),r(1297)]},1218:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){var t=0,r=0,n=0,o=e.split(":").map((function(e){return parseInt(e,10)})).filter((function(e){return!Number.isNaN(e)}));return 3===o.length?(t=o[0],r=o[1],n=o[2]):2===o.length&&(r=o[0],n=o[1]),60*t*60*1e3+60*r*1e3+1e3*n}},1219:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",r="asc"===t?-1:1;return function(t,n){var o=e(t),a=e(n);return(Number(o<a)-.5)*r}}},1222:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=(r(1337),function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:"scrollable-container "+(this.props.className?this.props.className:"")},c.createElement("div",{className:"content"},this.props.children))}}]),t}(c.Component))},1223:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=(r(1340),r(1557)),p=r(0),u=r(1045),d=function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=c.createElement(c.Fragment,null,c.createElement("legend",null,"Estimates"),c.createElement("div",{className:"field-info"},"These estimates help us give your learners a better experience"),c.createElement("div",{className:"row learners-number-row"},c.createElement(l.a,Object.assign({name:this.props.customersNumName,component:u.u,disabled:this.props.disabled},{label:"Number of Learners"}),c.createElement(u.n,{value:p.B.One},"1 (collaborate on same cloud workspace)"),c.createElement(u.n,{value:p.B.OneToFour},"1-4"),c.createElement(u.n,{value:p.B.FiveToNine},"5-9"),c.createElement(u.n,{value:p.B.TenToNineteen},"10-19"),c.createElement(u.n,{value:p.B.TwentyPlus,disabled:!0},"20-2000 (contact us: help@rhyme.com)"))),c.createElement("div",{className:"row learners-location-row"},c.createElement(l.a,Object.assign({name:this.props.regionName,component:u.u,disabled:this.props.disabled},{label:"Learners' Locations"}),c.createElement(u.n,{value:p.P.USAOnly},"North America Only"),c.createElement(u.n,{value:p.P.EuropeOnly},"Europe Only"),c.createElement(u.n,{value:p.P.AsiaOnly},"Asia Only"),c.createElement(u.n,{value:p.P.Global,disabled:!0},"Global (contact us: help@rhyme.com)"))));return this.props.fieldset?c.cloneElement(this.props.fieldset,{className:"estimates"},e):c.createElement("fieldset",{className:"estimates"},e)}}]),t}(c.PureComponent);d.defaultProps={customersNumName:"customersNum",regionName:"region"}},1224:function(e,t,r){},1256:function(e,t,r){},1257:function(e,t,r){},1258:function(e,t,r){},1259:function(e,t,r){e.exports=r.p+"static/media/Avatar00001.f9e88744.jpg"},1260:function(e,t,r){e.exports=r.p+"static/media/Avatar00002.2b79a56a.jpg"},1261:function(e,t,r){e.exports=r.p+"static/media/Avatar00003.0a263350.jpg"},1262:function(e,t,r){e.exports=r.p+"static/media/Avatar00004.1fa579be.jpg"},1263:function(e,t,r){e.exports=r.p+"static/media/Avatar00005.fab97250.jpg"},1264:function(e,t,r){e.exports=r.p+"static/media/Avatar00006.f9d2eaeb.jpg"},1265:function(e,t,r){e.exports=r.p+"static/media/Avatar00007.2d26ba8f.jpg"},1266:function(e,t,r){e.exports=r.p+"static/media/Avatar00008.d9426af2.jpg"},1267:function(e,t,r){e.exports=r.p+"static/media/Avatar00009.aa0b6701.jpg"},1268:function(e,t,r){e.exports=r.p+"static/media/Avatar00010.d07f5608.jpg"},1269:function(e,t,r){e.exports=r.p+"static/media/Avatar00012.230ad4fb.jpg"},1270:function(e,t,r){e.exports=r.p+"static/media/Avatar00013.3cfad125.jpg"},1271:function(e,t,r){e.exports=r.p+"static/media/Avatar00014.cea5fcdd.jpg"},1272:function(e,t,r){e.exports=r.p+"static/media/Avatar00015.bd6ea4d2.jpg"},1273:function(e,t,r){e.exports=r.p+"static/media/Avatar00016.433ebe2d.jpg"},1274:function(e,t,r){e.exports=r.p+"static/media/Avatar00017.5aadb091.jpg"},1275:function(e,t,r){e.exports=r.p+"static/media/Avatar00018.70eba844.jpg"},1276:function(e,t,r){e.exports=r.p+"static/media/Avatar00019.6a960cce.jpg"},1277:function(e,t,r){e.exports=r.p+"static/media/Avatar00020.215d799b.jpg"},1278:function(e,t,r){e.exports=r.p+"static/media/Avatar00021.0ce3a9ca.jpg"},1279:function(e,t,r){e.exports=r.p+"static/media/Avatar00022.292d7b6f.jpg"},1280:function(e,t,r){e.exports=r.p+"static/media/Avatar00023.68610b3b.jpg"},1281:function(e,t,r){e.exports=r.p+"static/media/Avatar00024.c6a20455.jpg"},1282:function(e,t,r){e.exports=r.p+"static/media/Avatar00025.1a91f5fe.jpg"},1283:function(e,t,r){e.exports=r.p+"static/media/Avatar00026.684e5ad9.jpg"},1284:function(e,t,r){e.exports=r.p+"static/media/Avatar00027.5ce90830.jpg"},1285:function(e,t,r){e.exports=r.p+"static/media/Avatar00028.57e8897c.jpg"},1286:function(e,t,r){e.exports=r.p+"static/media/Avatar00029.bd1c70de.jpg"},1287:function(e,t,r){e.exports=r.p+"static/media/Avatar00030.a0ff2d3f.jpg"},1288:function(e,t,r){e.exports=r.p+"static/media/Avatar00031.fd748b3b.jpg"},1289:function(e,t,r){e.exports=r.p+"static/media/Avatar00032.eccc9dc5.jpg"},1290:function(e,t,r){e.exports=r.p+"static/media/Avatar00033.e9562fc5.jpg"},1291:function(e,t,r){e.exports=r.p+"static/media/Avatar00034.eb1b7360.jpg"},1292:function(e,t,r){e.exports=r.p+"static/media/Avatar00035.f3c575f6.jpg"},1293:function(e,t,r){e.exports=r.p+"static/media/Avatar00036.321728ae.jpg"},1294:function(e,t,r){e.exports=r.p+"static/media/Avatar00037.f9f98e2f.jpg"},1295:function(e,t,r){e.exports=r.p+"static/media/Avatar00038.3bb3b97b.jpg"},1296:function(e,t,r){e.exports=r.p+"static/media/Avatar00039.2cdb0016.jpg"},1297:function(e,t,r){e.exports=r.p+"static/media/Avatar00040.fc382775.jpg"},1298:function(e,t,r){},1299:function(e,t,r){},1300:function(e,t,r){},1301:function(e,t,r){},1302:function(e){e.exports=JSON.parse('["gmail.com","hotmail.com","outlook.com","yahoo.com","icloud.com","live.com","me.com","msn.com","aol.com","att.net","alice.it","aol.it","arnet.com.ar","bellsouth.net","blueyonder.co.uk","bol.com.br","bt.com","btinternet.com","comcast.net","charter.net","cox.net","daum.net","email.com","email.it","earthlink.net","facebook.com","fastmail.fm","free.fr","fibertel.com.ar","freeserve.co.uk","gmx.com","gmx.de","gmx.fr","gmx.net","games.com","globo.com","globomail.com","google.com","hotmail.co.uk","hotmail.com.br","hotmail.com.mx","hotmail.de","hotmail.es","hotmail.fr","hotmail.it","hanmail.net","hush.com","hushmail.com","inbox.com","ig.com.br","iname.com","itelefonica.com.br","juno.com","live.co.uk","live.com.ar","live.com.mx","live.de","live.fr","live.it","laposte.net","lavabit.com","libero.it","list.ru","live.be","love.com","mac.com","mail.com","mail.ru","nate.com","naver.com","neuf.fr","ntlworld.com","outlook.com.br","o2.co.uk","orange.fr","orange.net","oi.com.br","online.de","pobox.com","poste.it","prodigy.net.mx","protonmail.com","qq.com","rocketmail.com","r7.com","rambler.ru","rhyme.com","sbcglobal.net","sky.com","safe-mail.net","sfr.fr","sina.com","skynet.be","speedy.com.ar","t-online.de","talktalk.co.uk","telenet.be","teletu.it","terra.com.br","tin.it","tiscali.co.uk","tiscali.it","tvcablenet.be","uol.com.br","verizon.net","virgin.net","virginmedia.com","virgilio.it","voo.be","wanadoo.co.uk","wanadoo.fr","web.de","wow.com","yahoo.co.in","yahoo.co.jp","yahoo.co.kr","yahoo.co.uk","yahoo.com.ar","yahoo.com.br","yahoo.com.mx","yahoo.de","yahoo.fr","yahoo.it","yandex.com","yandex.ru","ya.ru","ygm.com","ymail.com","zipmail.com.br","zoho.com"]')},1303:function(e,t,r){},1304:function(e,t,r){},1305:function(e,t,r){},1306:function(e,t,r){},1307:function(e,t,r){},1308:function(e,t,r){},1309:function(e,t,r){},1310:function(e,t,r){},1311:function(e,t,r){},1312:function(e,t,r){},1313:function(e,t,r){},1314:function(e,t,r){},1316:function(e,t,r){},1317:function(e,t,r){},1318:function(e,t,r){},1319:function(e,t,r){},1320:function(e,t,r){},1321:function(e,t,r){},1322:function(e,t,r){},1323:function(e,t,r){},1324:function(e,t,r){},1325:function(e,t,r){},1334:function(e,t,r){},1335:function(e,t,r){},1336:function(e,t,r){},1337:function(e,t,r){},1338:function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=(r(1047),r(1339),r(91)),d=r.n(u),h=r(54),m=r(62),f=r(1557),y=r(1558),v=r(1559),b=r(0),g=r(1045),O=r(1064),k=r(1223),C="liveSessionDetails",w=(n=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(a.a)(t,[{key:"saveDetails",value:function(e){var t=new b.x({name:this.props.courseName,description:this.props.description,type:this.props.customersNum===b.B.One?b.y.Collaboration:b.y.Live}),r=new b.Q({region:this.props.region,expectedAttendees:this.props.customersNum});this.props.onSessionDetailsSubmit(t,r),e.preventDefault()}},{key:"back",value:function(){this.props.dispatch(Object(h.d)())}},{key:"render",value:function(){return p.createElement("div",{className:"live-session-details form-styles"},p.createElement("h2",null,p.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),"Session Details"),p.createElement("p",{className:"text"},"Please give your learners (and us) more details about the session"),p.createElement("form",{name:C,onSubmit:this.saveDetails},p.createElement("fieldset",null,p.createElement("legend",null,"Basics"),p.createElement(f.a,Object.assign({name:"courseName",component:g.s,autoComplete:"off",type:"text"},{label:"Session Name"})),p.createElement(f.a,Object.assign({name:"description",component:g.v,rows:5},{label:"Session Description"}))),p.createElement(k.a,null),p.createElement(g.a,{disabled:!this.props.valid},"Save")))}}]),t}(p.Component),Object(l.a)(n.prototype,"saveDetails",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"saveDetails"),n.prototype),Object(l.a)(n.prototype,"back",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"back"),n.prototype),n),j=Object(y.a)({form:C,validate:O.r})(w),E=Object(v.a)(C),_=Object(m.c)((function(e,t){return{courseName:E(e,"courseName"),description:E(e,"description"),customersNum:E(e,"customersNum"),region:E(e,"region"),initialValues:{courseName:t.data.course?t.data.course.name:"",description:t.data.course?t.data.course.description:"",customersNum:t.data.room?t.data.room.expectedAttendees:b.B.OneToFour,region:t.data.room?t.data.room.region:b.P.USAOnly}}}))(j)},1339:function(e,t,r){},1340:function(e,t,r){},1341:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,o=r(51),a=r(5),i=r(11),s=r(30),c=r(28),l=r(29),p=r(90),u=r(4),d=(r(1047),r(1342),r(91)),h=r.n(d),m=r(54),f=r(8),y=r(62),v=r(1557),b=r(1558),g=r(1559),O=r(0),k=r(1045),C=r(1064),w="recordedSessionDetails",j=(n=function(e){function t(){return Object(a.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"saveDetails",value:function(e){e.preventDefault();var t=this.props.course?this.props.course.chapters:Object(f.List)([]),r=new O.x(Object(o.a)({},this.props.course?this.props.course.toJS():{},{type:O.y.Recorded,name:this.props.courseName,description:this.props.description,language:this.props.courseLanguage,chapters:t}));this.props.onSessionDetailsSubmit(r)}},{key:"back",value:function(){this.props.dispatch(Object(m.d)())}},{key:"render",value:function(){return u.createElement("div",{className:"recorded-session-details form-styles"},u.createElement("h2",null,this.props.hideBack?null:u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),"New Recording"),u.createElement("p",{className:"text"},"Help learners understand what the recording is about"),u.createElement("form",{name:w,onSubmit:this.saveDetails},u.createElement("div",{className:"row"},u.createElement(v.a,Object.assign({name:"courseName",component:k.s,autoComplete:"off",type:"text"},{label:"Recording Name"})),u.createElement("p",{className:"field-info"},"All sessions of this recording will use this recording name and description")),u.createElement("div",{className:"row"},u.createElement(v.a,Object.assign({name:"description",component:k.v,rows:5},{label:"Recording Description"}))),u.createElement("div",{className:"row"},u.createElement(v.a,{name:"courseLanguage",component:k.x,label:"Recording Language"}),u.createElement("p",{className:"field-info"},"We'll use that to generate closed captions for your chapters")),u.createElement(k.a,{disabled:!this.props.valid},"Save")),u.createElement("i",{className:"fa fa-video-camera","aria-hidden":"true"}))}}]),t}(u.Component),Object(p.a)(n.prototype,"saveDetails",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"saveDetails"),n.prototype),Object(p.a)(n.prototype,"back",[h.a],Object.getOwnPropertyDescriptor(n.prototype,"back"),n.prototype),n),E=Object(b.a)({form:w,validate:C.r})(j),_=Object(g.a)(w),S=Object(y.c)((function(e,t){return{courseName:_(e,"courseName"),description:_(e,"description"),courseLanguage:_(e,"courseLanguage"),initialValues:{courseName:t.course?t.course.name:"",description:t.course?t.course.description:"",courseLanguage:O.Y.enUS}}}))(E)},1342:function(e,t,r){},1343:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(5),o=r(11),a=r(30),i=r(28),s=r(29),c=r(4),l=r(54),p=function(e){function t(e){var r;if(Object(n.a)(this,t),r=Object(a.a)(this,Object(i.a)(t).call(this,e)),e.condition){var o=e.redirectPath,s=o?Object(l.g)(o):Object(l.d)();e.dispatch(s)}return r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return this.props.condition?null:this.props.children}}]),t}(c.Component)},1344:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n,o=r(5),a=r(11),i=r(30),s=r(28),c=r(29),l=r(90),p=r(4),u=(r(1224),r(1345),r(91)),d=r.n(u),h=r(54),m=r(12),f=r(0),y=r(16),v=r(1045),b=(n=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this,e)))._queryParams=void 0,r._queryParams=new m.fb(e.location),Object(y.c)(y.a.SessionCreationRoom),r}return Object(c.a)(t,e),Object(a.a)(t,[{key:"live",value:function(){var e=m.kb;this.props.tryFlow&&(e=m.y),this.props.dispatch(Object(m.Kb)(e))}},{key:"recorded",value:function(){var e;e=this.props.tryFlow?m.z:this.props.courses.find((function(e){return e.type===f.y.Recorded}))?"true"===this._queryParams.params.schedule?m.L:Object(m.Mb)(!0):"true"===this._queryParams.params.schedule?m.T:Object(m.Rb)(!0),this.props.dispatch(Object(m.Kb)(e))}},{key:"back",value:function(){this.props.dispatch(Object(h.d)())}},{key:"render",value:function(){return p.createElement("div",{className:"session-type split-screen-layout"},p.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),p.createElement("div",{className:"cont live"},p.createElement("h2",null,"Live session"),p.createElement("div",{className:"illustration"}),p.createElement("p",{className:"sub-title"},"If you will ..."),p.createElement("p",null,"live broadcast your cloud workspace",p.createElement("br",null),"that learners can watch & follow in real-time"),p.createElement(v.a,{className:"ssl-button",onClick:this.live},"Start")),p.createElement("div",{className:"cont recorded"},p.createElement("h2",null,"Recorded session"),p.createElement("div",{className:"illustration"}),p.createElement("p",{className:"sub-title"},"If you will ..."),p.createElement("p",null,"create a recording of using your cloud workspace",p.createElement("br",null),"that learners can watch & follow later"),p.createElement(v.a,{className:"ssl-button",onClick:this.recorded},"Start")))}},{key:"tryFlow",get:function(){return this.props.tryFlow&&!this.props.courses}}]),t}(p.PureComponent),Object(l.a)(n.prototype,"live",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"live"),n.prototype),Object(l.a)(n.prototype,"recorded",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"recorded"),n.prototype),Object(l.a)(n.prototype,"back",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"back"),n.prototype),n)},1345:function(e,t,r){},1470:function(e,t,r){"use strict";var n,o,a=r(5),i=r(11),s=r(30),c=r(28),l=r(29),p=r(90),u=r(91),d=r.n(u),h=r(4),m=(r(1047),r(1334),r(62)),f=r(1557),y=r(1558),v=r(1559),b=r(2),g=r(0),O=r(1045),k=r(289),C=(r(1335),r(54)),w=r(1560),j=r(1561),E=r(12),_=r(21),S=r(1131),D=(n=function(e){function t(e){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={loading:!1},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"onToggle",value:function(){this.props.onToggle(!this.props.visible),this.props.reset()}},{key:"resendCode",value:function(){var e=this.props,t=e.asyncActions,r=e.dispatch;r(t.sendForgottenPasswordCode(this.props.email)).then((function(){r(new b.i(new g.J({type:g.K.General,text:"We have emailed you a security code"})))}))}},{key:"changePassword",value:function(e){var t=this;this.setState({loading:!0});var r=this.props,n=r.asyncActions,o=r.dispatch,a=new g.eb({email:this.props.email,password:this.props.newPassword});o(n.updateForgottenPassword(a,this.props.securityCode)).then((function(){Object(_.b)().login(a).then((function(){return o(Object(C.g)(E.qb))}))}),(function(){return t.setState({loading:!1})})),e.preventDefault()}},{key:"render",value:function(){return h.createElement(k.a,{size:"small",title:"New Password",visible:this.props.visible,hideClose:this.state.loading,closeWithEsc:!this.state.loading,onToggle:this.onToggle},h.createElement("div",{className:"change-pass-modal form-styles"},h.createElement("form",{name:"changePass",onSubmit:this.changePassword},h.createElement("p",{className:"text"},"Please check your email at ",h.createElement("strong",null,this.props.email)," to find the security code"),h.createElement("div",{className:"row"},h.createElement(f.a,Object.assign({name:"securityCode",className:"security-code",maxLength:O.l.securityCode.max,component:O.s,type:"text",autoFocus:!0},{label:"Security code"}))),h.createElement("div",{className:"row"},h.createElement(f.a,Object.assign({name:"newPassword",component:O.s,type:"password"},{label:"New password"})),this.isPasswordValid&&h.createElement("p",{className:"description"},"Long passwords are safer. ",S.a[Object(S.b)(this.props.newPassword||"")])),h.createElement("div",{className:"row"},h.createElement(f.a,Object.assign({name:"repeatPassword",component:O.s,type:"password"},{label:"Repeat password"}))),h.createElement(O.b,{loading:this.state.loading,disabled:!this.props.valid},"Save"),h.createElement("div",{className:"row resend"},h.createElement("a",{href:"javascript:void(0);",onClick:this.resendCode},"Resend Code")))))}},{key:"isPasswordValid",get:function(){if(this.props.formMeta&&this.props.errors){var e=this.props.formMeta.newPassword,t=this.props.errors.newPassword;if(e)return!(e.touched&&this.props.newPassword&&t&&!e.active)}return!0}}]),t}(h.Component),Object(p.a)(n.prototype,"onToggle",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"onToggle"),n.prototype),Object(p.a)(n.prototype,"resendCode",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"resendCode"),n.prototype),Object(p.a)(n.prototype,"changePassword",[d.a],Object.getOwnPropertyDescriptor(n.prototype,"changePassword"),n.prototype),n),P=Object(y.a)({form:"changePass",validate:O.D})(D),T=Object(v.a)("changePass"),R=Object(m.c)((function(e){return{securityCode:T(e,"securityCode"),newPassword:T(e,"newPassword"),repeatPassword:T(e,"repeatPassword"),errors:Object(w.a)("changePass")(e),formMeta:Object(j.a)("changePass")(e)}}))(P);r.d(t,"a",(function(){return V}));var x=(o=function(e){function t(e){var r;return Object(a.a)(this,t),(r=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={loading:!1,changePassVisible:!1},r}return Object(l.a)(t,e),Object(i.a)(t,[{key:"onToggle",value:function(){this.props.onToggle(!this.props.visible),this.props.reset()}},{key:"updateChangePassVisibility",value:function(e){var t=this;this.setState({changePassVisible:e},(function(){e&&t.props.onToggle(!1)}))}},{key:"sendSecurityCode",value:function(e){var t=this,r=this.props,n=r.asyncActions,o=r.dispatch;this.setState({loading:!0}),o(n.sendForgottenPasswordCode(this.props.email)).then((function(){o(new b.i(new g.J({type:g.K.General,text:"We have emailed you a security code"}))),t.updateChangePassVisibility(!0),t.setState({loading:!1})}),(function(){return t.setState({loading:!1})})),e.preventDefault()}},{key:"render",value:function(){return h.createElement("div",{className:"forgot-pass-modal form-styles"},h.createElement(k.a,{size:"small",title:"Forgot Password?",visible:this.props.visible,hideClose:this.state.loading,closeWithEsc:!this.state.loading,onToggle:this.onToggle},h.createElement("form",{name:"forgotPass",onSubmit:this.sendSecurityCode},h.createElement("p",{className:"text"},"We will email you a security code which will allow you to set a new password"),h.createElement("div",{className:"row"},h.createElement(f.a,{name:"email",component:O.f,autoFocus:!0})),h.createElement(O.b,{disabled:!this.valid,loading:this.state.loading},"Send Code"))),h.createElement(R,{email:this.props.email||"",visible:this.state.changePassVisible,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,onToggle:this.updateChangePassVisibility}))}},{key:"valid",get:function(){return this.props.valid&&this.props.email}}]),t}(h.Component),Object(p.a)(o.prototype,"onToggle",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"onToggle"),o.prototype),Object(p.a)(o.prototype,"updateChangePassVisibility",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"updateChangePassVisibility"),o.prototype),Object(p.a)(o.prototype,"sendSecurityCode",[d.a],Object.getOwnPropertyDescriptor(o.prototype,"sendSecurityCode"),o.prototype),o),N=Object(y.a)({form:"forgotPass",validate:function(e){return Object(O.F)(e,"email")}})(x),M=Object(v.a)("forgotPass"),V=Object(m.c)((function(e){return{email:M(e,"email")}}))(N)},1674:function(e,t,r){},1675:function(e,t,r){},1676:function(e,t,r){},1677:function(e,t,r){},1678:function(e,t,r){},1679:function(e,t,r){},1680:function(e,t,r){},1681:function(e,t,r){},1682:function(e,t,r){e.exports=r.p+"static/media/Pause.af51b8fe.svg"},1683:function(e,t,r){},1684:function(e,t,r){},1685:function(e,t,r){},1686:function(e,t,r){},1687:function(e,t,r){},1688:function(e,t,r){},1689:function(e,t,r){},1690:function(e,t,r){},1691:function(e,t,r){},1692:function(e,t,r){},1693:function(e,t,r){},1694:function(e,t,r){e.exports=r.p+"static/media/Screenshot.a3a0ae80.svg"},1695:function(e,t,r){},1696:function(e,t,r){},1697:function(e,t,r){},1698:function(e,t,r){},1699:function(e,t,r){},1700:function(e,t,r){},1701:function(e,t,r){e.exports=r.p+"static/media/UploadFiles.bfe08601.svg"},1702:function(e,t,r){},1703:function(e,t,r){e.exports=r.p+"static/media/Configure.3e19da79.svg"},1704:function(e,t,r){e.exports=r.p+"static/media/ApplyLicenses.bec2a03f.svg"},1705:function(e,t,r){e.exports=r.p+"static/media/InstallSoftware.1f112818.svg"},1706:function(e,t,r){},1707:function(e,t,r){},1708:function(e,t,r){},1709:function(e,t,r){},1710:function(e,t,r){},1711:function(e,t,r){},1712:function(e,t,r){},1713:function(e,t,r){},1717:function(e,t,r){},1718:function(e,t,r){},1719:function(e,t,r){},1720:function(e,t,r){},1721:function(e,t,r){},1722:function(e,t,r){},1723:function(e,t,r){},1724:function(e,t,r){},1725:function(e,t,r){},1733:function(e,t,r){},1734:function(e,t,r){},1735:function(e,t,r){},1736:function(e,t,r){},1737:function(e,t,r){},1919:function(e,t,r){},1965:function(e,t,r){},1966:function(e,t,r){},1967:function(e,t,r){},1969:function(e,t,r){},1970:function(e,t,r){},1971:function(e,t,r){},1972:function(e,t,r){},1973:function(e,t,r){},1974:function(e,t,r){},1975:function(e,t,r){},1976:function(e,t,r){},1977:function(e,t,r){},1978:function(e,t,r){},1979:function(e,t,r){},1980:function(e,t,r){},1981:function(e,t,r){},1982:function(e,t,r){},1983:function(e,t,r){},1984:function(e,t,r){},1985:function(e,t,r){},1986:function(e,t,r){},1987:function(e,t,r){},1988:function(e,t,r){},1989:function(e,t,r){},1990:function(e,t,r){},1991:function(e,t,r){},1992:function(e,t,r){},1993:function(e,t,r){},1994:function(e,t,r){},1995:function(e,t,r){},1996:function(e,t,r){},2003:function(e,t,r){"use strict";r.r(t);var n,o,a,i=r(5),s=r(11),c=r(30),l=r(28),p=r(29),u=r(4),d=r.n(u),h=(r(1673),r(54)),m=r(166),f=r.n(m),y=r(71),v=r(2),b=r(21),g=r(1062),O=r(16),k=r(90),C=r(91),w=r.n(C),j=r(62),E=r(1037),_=r(1557),S=r(1558),D=r(1559),P=r(0),T=r(1045),R=r(289),x=(r(1674),r(133)),N=function(e){function t(e){var r;Object(i.a)(this,t);var n=(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._groupCosts(e.cost);return r.state={leftColSize:r._determineColSizes(n.length),groupedCosts:n},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.props.cost.costs!==e.cost.costs){var t=this._groupCosts(this.props.cost),r=this._determineColSizes(t.length);this.setState({groupedCosts:t,leftColSize:r})}}},{key:"render",value:function(){return u.createElement("div",{className:"cost-table"},this.renderTable(0,Math.min(this.state.leftColSize,this.state.groupedCosts.length)),this.renderTable(this.state.leftColSize,this.state.groupedCosts.length,!0))}},{key:"renderTable",value:function(e,t,r){for(var n=[],o=e;o<t;o+=1){var a=this.state.groupedCosts[o];n.push(u.createElement("tr",{key:"tr-"+o+e},u.createElement("td",null,a.attendeesCount," ",a.isGuide&&"(host)"),u.createElement("td",null,a.duration.toFixed(2)),u.createElement("td",null,this.currency,Object(x.b)(this.props.cost.rate,!0)," x ",a.attendeesCount," x ",a.duration.toFixed(2)," ="," ",this.currency,Object(x.b)(a.amount))))}return r&&n.push([u.createElement("tr",{key:"tr-empty"},u.createElement("td",null,"Credit card processing"),u.createElement("td",null),u.createElement("td",null,this.currency,Object(x.b)(this.props.cost.processingFee))),u.createElement("tr",{key:"tr-total"},u.createElement("td",null),u.createElement("td",null,u.createElement("strong",null,"Total Cost")),u.createElement("td",null,u.createElement("strong",null,this.currency,Object(x.b)(this.props.cost.total))))]),u.createElement("table",null,u.createElement("thead",null,u.createElement("tr",null,u.createElement("th",null,"Learners"),u.createElement("th",null,"Hours"),u.createElement("th",null,"Cost"))),u.createElement("tbody",null,n))}},{key:"_determineColSizes",value:function(e){var t=e+2;return Math.ceil(t/2)}},{key:"_groupCosts",value:function(e){var t=this,r=[];return e.costs.groupBy((function(e){return t._calculateDuration(e.seconds)})).forEach((function(t,n){var o=t.filter((function(t){return!e.guides.has(t.id)})),a=o.map((function(e){return e.amount})).reduce((function(e,t){return e+t}));void 0!==a&&r.push({isGuide:!1,duration:n,attendeesCount:o.size,amount:a}),r=r.concat(t.filter((function(t){return e.guides.has(t.id)})).map((function(e){return{isGuide:!0,duration:n,attendeesCount:1,amount:e.amount}})).toArray())})),r.sort((function(e,t){return e.isGuide&&!t.isGuide?-1:!e.isGuide&&t.isGuide?1:t.duration-e.duration}))}},{key:"_calculateDuration",value:function(e){var t=0;if(e>this.props.cost.freeTimeSecs){t=Math.ceil(e/this.props.cost.unitDurationSecs)*(this.props.cost.unitDurationSecs*(1/.6/60)/100)}return t}},{key:"currency",get:function(){return x.a[this.props.cost.currency]}}]),t}(u.Component),M=(r(1047),r(1675),n=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={visible:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.cost;t.costs.size&&!this.state.visible?this.toggle(!0):!t.costs.size&&this.state.visible&&this.toggle(!1)}},{key:"toggle",value:function(e){var t=this;this.setState({visible:e},(function(){e||t.props.dispatch(new v.lb)}))}},{key:"onFeedbackSend",value:function(e){var t=this;e.preventDefault(),this.props.feedbackText&&this.props.dispatch(this.props.asyncActions.sendFeedback(this.props.user,new P.C({type:P.D.CostDetails,text:this.props.feedbackText,roomId:this.props.cost.roomId,vmId:this.props.cost.vmId}))).then((function(){t.props.dispatch(Object(E.b)("feedbackText"));var e=new P.J({type:P.K.General,text:"Thank you for your feedback!"});t.props.dispatch(new v.i(e))}))}},{key:"close",value:function(){this.props.dispatch(new v.lb)}},{key:"render",value:function(){return u.createElement("div",{className:"cost-details-modal"},u.createElement(R.a,{title:this.title,visible:this.state.visible,onToggle:this.toggle},u.createElement("div",{className:"form-styles"},u.createElement("section",{className:"text-content"},u.createElement("div",{className:"cost-content"},this.props.cost.estimated?u.createElement("div",{className:"cost-estimate"},"Cost values are estimates"):null,u.createElement(N,{cost:this.props.cost})),u.createElement("form",{className:"feedback",name:"feedbackText",onSubmit:this.onFeedbackSend},u.createElement("p",null,"Send feedback to us"),u.createElement("span",null,u.createElement("i",{className:"fa fa-comment-o"}),u.createElement(_.a,{name:"feedbackText",component:T.s,placeholder:"Type feedback",alwaysShowPlaceholder:!0}),u.createElement(T.a,{disabled:!this.props.valid,className:"btn small"},"Send")))),u.createElement("section",{className:"controls"},u.createElement(T.a,{className:"short-btn",onClick:this.close},"Done")))))}},{key:"costLoaded",get:function(){return!!this.props.cost.costs.size}},{key:"costCurrency",get:function(){return this.props.cost.currency}},{key:"attendeesNumber",get:function(){return this.props.cost.costs.size}},{key:"title",get:function(){return"Session Cost"}}]),t}(u.Component),Object(k.a)(n.prototype,"toggle",[w.a],Object.getOwnPropertyDescriptor(n.prototype,"toggle"),n.prototype),Object(k.a)(n.prototype,"onFeedbackSend",[w.a],Object.getOwnPropertyDescriptor(n.prototype,"onFeedbackSend"),n.prototype),Object(k.a)(n.prototype,"close",[w.a],Object.getOwnPropertyDescriptor(n.prototype,"close"),n.prototype),n),V=Object(S.a)({form:"feedbackText",validate:T.I})(M),A=Object(D.a)("feedbackText"),I=Object(j.c)((function(e){return{feedbackText:A(e,"feedbackText")}}))(V),U=r(1149),L=r(1095),F=r(165),B=(r(1676),["purple","red","blue","green"]),z=["big","big","medium","medium","medium","small","small","small","small","small"],H=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._lastShape=void 0,r.state={shapes:[]},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.predefined||this._createShapes()}},{key:"render",value:function(){var e=this.state.shapes;return u.createElement("div",{className:"rhyme-bg"},this.props.predefined?u.createElement(u.Fragment,null,u.createElement("div",{className:"s oval purple medium",style:{right:"-3%",top:"30%"}}),u.createElement("div",{className:"s oval purple big",style:{left:"40%",bottom:"-5%"}}),u.createElement("div",{className:"s oval green small",style:{left:"25%",top:"-1%"}}),u.createElement("div",{className:"s rect blue big",style:{left:"-3%",top:"40%",transform:"rotate(35deg)"}}),u.createElement("div",{className:" rect green medium",style:{right:"20%",bottom:"-5%",transform:"rotate(45deg)"}})):e.map((function(e,t){return u.createElement("div",{className:["s",e.shape,e.color,e.size].join(" "),style:{left:"".concat(e.x,"%"),top:"".concat(e.y,"px"),transform:"rotate(".concat(e.rotation,"deg) translate(-50%, -50%)")},key:"rbs-"+t})})),u.createElement("div",{className:"last-rel-element",style:{marginTop:e.length?e[e.length-1].y:0}}))}},{key:"_createShapes",value:function(){for(var e=[],t=Math.round(document.body.scrollHeight/this._yPixelFreq),r=0;r<t;r+=1)e.push(this._createShape(r));this.setState({shapes:e})}},{key:"_createShape",value:function(e){var t,r=this._rand(0,360),n=300*e,o=this._lastShape&&this._lastShape.x>50?this._rand(0,this._xPercOffset+1):this._rand(100-this._xPercOffset,101);do{t={shape:this._lastShape&&"oval"===this._lastShape.shape?"rect":"oval",color:B[this._rand(0,B.length)],size:z[this._rand(0,z.length)],rotation:r,x:o,y:n}}while(this._lastShape&&this._areShapesSimilar(this._lastShape,t));return this._lastShape=t,t}},{key:"_rand",value:function(e,t){return Math.floor(Math.random()*(t-e)+e)}},{key:"_areShapesSimilar",value:function(e,t){return[e.size===t.size,e.color===t.color,e.shape===t.shape].map((function(e){return e?1:0})).reduce((function(e,t){return e+t}))>=2}},{key:"_xPercOffset",get:function(){return this.props.percentFromSideEdges||15}},{key:"_yPixelFreq",get:function(){return this.props.yFrequency||300}}]),t}(u.Component),W=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._bgContainer=void 0,r._appendBackground(),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return null}},{key:"componentWillUnmount",value:function(){(this.props.wrapper?this.props.wrapper:document.body).removeChild(this._bgContainer)}},{key:"_appendBackground",value:function(){this._bgContainer=document.createElement("div"),(this.props.wrapper?this.props.wrapper:document.body).appendChild(this._bgContainer),F.render(u.createElement(H,this.props),this._bgContainer)}}]),t}(u.Component),K=r(1344),Y=(r(1224),r(1677),r(12)),G=r(1068),q=(r(1678),2*T.l.inviteCode.max-1),J=(o=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={active:!1,code:""},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"updateCode",value:function(e){var t=e.target.value.replace(/\s/g,"").split("").join(" ");this.setState({code:t})}},{key:"buttonAction",value:function(){this.state.active?this._joinSession():this.setState({active:!0})}},{key:"render",value:function(){return u.createElement("div",{className:"join-button"+(this.state.active?" active":"")+(this.disabled?" disabled":"")},u.createElement(T.a,{onClick:this.buttonAction,disabled:this.disabled},"Join"),u.createElement("input",{type:"text",maxLength:q,placeholder:"C O D E",value:this.state.code,onChange:this.updateCode}))}},{key:"_joinSession",value:function(){var e=Object(Y.Ub)(this.trimmedCode);this.props.dispatch(Object(h.g)(e))}},{key:"disabled",get:function(){var e=this.trimmedCode.length;return this.state.active&&e!==T.l.inviteCode.max&&e!==T.l.inviteCode.min}},{key:"trimmedCode",get:function(){return this.state.code.replace(/\s/g,"")}}]),t}(u.Component),Object(k.a)(o.prototype,"updateCode",[w.a],Object.getOwnPropertyDescriptor(o.prototype,"updateCode"),o.prototype),Object(k.a)(o.prototype,"buttonAction",[w.a],Object.getOwnPropertyDescriptor(o.prototype,"buttonAction"),o.prototype),o),X=(a=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createSession",value:function(){this.props.dispatch(Object(h.g)(Y.pb))}},{key:"render",value:function(){return u.createElement("div",{className:"create-or-join split-screen-layout"},u.createElement("div",{className:"cont join"},u.createElement("h2",null,"Join a session"),u.createElement("div",{className:"illustration"}),u.createElement("p",{className:"sub-title"},"If you got an invite code to ..."),u.createElement("p",null,"see a demo or learn about a software"),u.createElement("div",{className:"join-button-wrapper"},u.createElement(J,{dispatch:this.props.dispatch}),u.createElement(G.a,null,"If someone gave you an invite code to see a software demo or ",u.createElement("br",null),"to learn how to use a software, please enter the code here."))),u.createElement("div",{className:"cont create"},u.createElement("h2",null,"Create a session"),u.createElement("div",{className:"illustration"}),u.createElement("p",{className:"sub-title"},"If you want to ..."),u.createElement("p",null,"demo or teach your software"),u.createElement(T.a,{className:"ssl-button",onClick:this.createSession},"Create")))}}]),t}(u.Component),Object(k.a)(a.prototype,"createSession",[w.a],Object.getOwnPropertyDescriptor(a.prototype,"createSession"),a.prototype),a),Z=r(290),Q=r(3),$=r(8),ee=r(1154),te=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement(ee.a,{title:"Unsupported Browser for Recording",description:"This browser is not supported for creating recordings. Please use one of these browsers:",onBack:this.props.onBack})}}]),t}(u.PureComponent),re=r(19),ne=r.n(re),oe=r(44),ae=r(1065),ie=r(1069),se=r(160),ce=r(291);r(1679);function le(e){return d.a.createElement("div",{className:"slide-in "+(e.open?"opened":"closed")},d.a.createElement("h2",{className:"title"},e.title),d.a.createElement("div",{className:"content"},e.children))}var pe=r(14),ue=r(1050),de=r.n(ue);r(1680);function he(e){var t=e.disabled||!e.onSplitClicked,r=e.recordings,n=e.insertIndex;e.currentRec&&(r=r.splice(e.insertIndex,0,{id:"recording in progress",duration:e.currentRec.duration}).toList(),n++);var o=r.reduce((function(e,t){return e+t.duration}),0),a=Math.max(o,42e4),i=[0];r.forEach((function(e){return i.push(i[i.length-1]+e.duration)}));var s={left:"".concat(3e5/a*100,"%")},c={left:"".concat(42e4/a*100,"%")};return d.a.createElement("span",{className:"tl-root ".concat(e.disabled?"disabled":"")},d.a.createElement("span",{className:"track",key:"timeline-track"}),d.a.createElement("span",{className:"suggested-min tl-tooltip","data-tooltip":"Ideal length: 5-7 mins",key:"suggested-min-marker",style:s},d.a.createElement("div",{className:"dash-line"})),d.a.createElement("span",{className:"suggested-max tl-tooltip","data-tooltip":"Ideal length: 5-7 mins",key:"suggested-max-marker",style:c},d.a.createElement("div",{className:"dash-line"})),r.map((function(t,r){var n={left:"".concat(i[r]/a*100,"%"),width:"".concat(t.duration/a*100,"%")},o=de()("chunk",{"chunk-selected":e.selectAll||t===e.selectedRecording,"tl-tooltip":e.segmentTooltip});return d.a.createElement("span",{key:t.id,"data-index":r,"data-tooltip":e.segmentTooltip,onClick:function(){return!e.disabled&&e.onRecordingClicked(t)},className:o,style:n})})),i.map((function(o,i){var s={left:"".concat(o/a*100,"%")},c=r.get(i),l=i===r.size?"last-rec":c.id,p=de()({"insert-split":i===n,split:i!==n,"tl-tooltip":e.splitTooltip,"split-active":!t}),u=i===r.size||i===n,h=i===n&&e.currentRec;return d.a.createElement(d.a.Fragment,{key:"split-frag-".concat(l)},d.a.createElement("span",{key:"split-".concat(l),"data-tooltip":e.splitTooltip,onClick:function(){return!t&&e.onSplitClicked&&e.onSplitClicked(i)},className:p,style:s}),u&&d.a.createElement("span",{key:"split-lbl-".concat(l),className:de()("split-label",{rec:h}),style:s},function(e){var t=f.a.duration(e,"ms");return f.a.utc(t.asMilliseconds()).format("mm:ss")}(o)))})))}var me,fe=r(299),ye=r(49);!function(e){e.Default="default",e.Disabled="disabled"}(me||(me={}));var ve,be,ge,Oe,ke,Ce,we,je,Ee,_e=function(){return Object(ye.d)(ye.a.RecordingSettings)||{noiseSuppression:me.Default}},Se=(r(1681),r(1682)),De=(ve=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._recorder=null,r._keydownCallback=void 0,r._keyupCallback=void 0,r._shiftPressed=!1,r._altPressed=!1,r._audio=void 0,r._onDataInterval=void 0,r.state={recording:"not-initialized"},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._keydownCallback),document.removeEventListener("keyup",this._keyupCallback),this._resetRecorder(),this._audio&&this._audio.getAudioTracks().forEach((function(e){return e.stop()}))}},{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this._keydownCallback=function(t){t.keyCode===ce.l&&(e._shiftPressed=!0),t.keyCode===ce.a&&(e._altPressed=!0),t.keyCode===ce.k&&e._altPressed&&e._shiftPressed&&!e.disabled&&e.toggleRecording()}),document.addEventListener("keyup",this._keyupCallback=function(t){16===t.keyCode&&(e._shiftPressed=!1),18===t.keyCode&&(e._altPressed=!1)})}},{key:"componentDidUpdate",value:function(e){this.props.webcamStream!==e.webcamStream&&this._recorder&&this._recorder.updateStream(this.props.webcamStream||null),!e.disabled&&this.props.disabled&&"recording"===this.state.recording&&(this._showNotificationError("Recording stopped"),this._processRecording())}},{key:"toggleRecording",value:function(){var e=this;if(!this.disabled)switch(this.state.recording){case"not-initialized":this._initializeRecorder();break;case"stopped":this.setState({recording:"recording"}),this.props.onStartRecording().then((function(){e._recorder&&(e._recorder.start(),e._resetCaptionPlayer(),e._startOnDataPolling())}));break;case"recording":this._processRecording();break;case"processing":case"initializing":default:return}}},{key:"onKeyboardEventRecorded",value:function(e){this.props.captionPlayer&&this.props.captionPlayer.onKey(e)}},{key:"render",value:function(){var e=de()("recording-button",{disabled:this.disabled||"processing"===this.state.recording,active:"recording"===this.state.recording||"processing"===this.state.recording});return u.createElement("div",{className:"video-recorder"},u.createElement("div",{onClick:this.toggleRecording,className:e},this._renderButtonContent()))}},{key:"_processRecording",value:function(){var e=Object(oe.a)(ne.a.mark((function e(){var t,r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._stopOnDataPolling(),this._recorder){e.next=4;break}return this.setState({recording:"not-initialized"}),e.abrupt("return");case 4:return this.setState({recording:"processing"}),e.prev=5,e.next=8,this._recorder.stop();case 8:t=e.sent,this.props.onRecordingAvailable(new P.N(t)),this._resetRecorder(),e.next=20;break;case 13:e.prev=13,e.t0=e.catch(5),console.warn("Error processing recording: ".concat(e.t0)),r=e.t0.notificationText||"Could not process recording",this._showNotificationError(r),this._resetRecorder(),this.props.onRecordingProcessingError();case 20:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_renderButtonContent",value:function(){switch(this.state.recording){case"processing":case"initializing":return u.createElement("i",{className:"fa fa-circle-o-notch fa-spin fa-fw"});case"recording":return u.createElement("img",{src:Se,width:26,height:30});case"not-initialized":case"stopped":default:return u.createElement(u.Fragment,null,"REC")}}},{key:"_resetRecorder",value:function(){this.setState({recording:"not-initialized"}),this._recorder&&this._recorder.isRecording&&this._recorder.stop(),this._recorder=null,this._stopOnDataPolling()}},{key:"_initializeRecorder",value:function(){var e=this;this._resetCaptionPlayer(),this.setState({recording:"initializing"});var t=function(e){if("disabled"===e)return!1}(_e().noiseSuppression);navigator.mediaDevices.getUserMedia({audio:{noiseSuppression:t,echoCancellation:t}}).then((function(t){e._audio=t;var r=Object(fe.a)().getRemoteClient(e.props.vm.id);if(!r)throw new Error("Invalid remote client");e._recorder=e._createScreenRecorder(r,t),e.props.onStartRecording().then((function(){e._recorder&&(e.props.webcamStream&&e._recorder.updateStream(e.props.webcamStream),e._recorder.start(),e.setState({recording:"recording"}),e._startOnDataPolling())}))}),(function(){e.setState({recording:"not-initialized"}),e._showNotificationError("Refused microphone access or not found audio device during recording")})).catch((function(t){console.error(t),e._resetRecorder(),e._showNotificationError("An error occurred while setting up the video recorder")}))}},{key:"_createScreenRecorder",value:function(e,t){var r={width:this.props.vm.width||pe.a.DefaultScreenWidth,height:this.props.vm.height||pe.a.DefaultScreenHeight};return new ie.j(new ie.i(e,t,r),new ie.g(e,this.onKeyboardEventRecorded),new ie.c(this.props.expandModeSource))}},{key:"_startOnDataPolling",value:function(){var e=this;this.props.onData({size:0,duration:0}),this._onDataInterval=setInterval((function(){e._recorder&&e.props.onData&&e.props.onData({size:e._recorder.size,duration:e._recorder.duration})}),300)}},{key:"_stopOnDataPolling",value:function(){this._onDataInterval&&(clearInterval(this._onDataInterval),this._onDataInterval=null)}},{key:"_resetCaptionPlayer",value:function(){this.props.captionPlayer&&this.props.captionPlayer.reset()}},{key:"_showNotificationError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.K.Error;this.props.dispatch(new v.i(new P.J({type:t,text:e})))}},{key:"disabled",get:function(){return this.props.disabled}}]),t}(u.Component),Object(k.a)(ve.prototype,"toggleRecording",[w.a],Object.getOwnPropertyDescriptor(ve.prototype,"toggleRecording"),ve.prototype),Object(k.a)(ve.prototype,"onKeyboardEventRecorded",[w.a],Object.getOwnPropertyDescriptor(ve.prototype,"onKeyboardEventRecorded"),ve.prototype),ve),Pe=(r(1683),{First:.8*pe.a.FileSizeLimitVideo,Second:.96*pe.a.FileSizeLimitVideo,Third:pe.a.FileSizeLimitVideo}),Te=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._videoRecorder=void 0,r._expandModeSource=new ie.d,r.onRecordingAvailable=function(e){r.props.onRecording(e,r.state.recordingInsertIndex),r.props.onStopRecording(),r.setState({currentRecInfo:null,recordingInsertIndex:r.state.recordingInsertIndex+1})},r.onRecordingProcessingError=function(){r.props.onStopRecording(),r.setState({currentRecInfo:null})},r.onStartRecording=function(){return r.props.onStartRecording().then((function(){return r.setState({currentRecInfo:{duration:0,size:0}})}))},r.onData=function(e){var t=r.recordingsSize,n=t+e.size,o=t+(r.state.currentRecInfo?r.state.currentRecInfo.size:0),a=function(e){return o<e&&e<=n},i="";a(Pe.First)?i="The recording video file is too big and will soon exceed file size limit. Please stop and save the recording soon":a(Pe.Second)?i="The recording video file is about to exceed file size limit. Please stop and save recording immediately!":e.size>=Pe.Third&&r._videoRecorder&&r.isRecording&&r._videoRecorder.toggleRecording(),i&&r.props.dispatch(new v.i(new P.J({type:P.K.Error,title:"Video too big",text:i,ttl:1e4}))),r.setState({currentRecInfo:e})},r.toggleExpand=function(){r.state.isViewExpanded?(r._expandModeSource.didCollapse(),r.props.onExpandModeChange(ie.e.Collapse)):(r._expandModeSource.didExpand(),r.props.onExpandModeChange(ie.e.Expand)),r.setState({isViewExpanded:!r.state.isViewExpanded})},r.onSplitClicked=function(e){r.setState({recordingInsertIndex:e})},r.state={recordingInsertIndex:0,isViewExpanded:!1,currentRecInfo:null},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.recordings!==e.recordings&&this.setState({recordingInsertIndex:Math.min(this.state.recordingInsertIndex,this.props.recordings.count())})}},{key:"render",value:function(){var e=this,t=this.props.recordings.size>0||this.state.currentRecInfo;return u.createElement("div",{className:"video-record-controls"},u.createElement("div",{className:"timeline-wrapper"},t?u.createElement(he,{recordings:this.props.recordings,insertIndex:this.state.recordingInsertIndex,currentRec:this.state.currentRecInfo,onRecordingClicked:this.props.onSelectRecording,onSplitClicked:this.onSplitClicked,disabled:this.isRecording,segmentTooltip:"Edit",splitTooltip:"Record here"}):u.createElement(u.Fragment,null,u.createElement("div",{className:"ideal-length"},"Ideal task length: 5-7 mins"),u.createElement("div",{className:"rec-shortcut"},"Press Alt-Shift-R"))),u.createElement("div",{className:"main-controls"},this._renderLeftControls(),u.createElement(De,{ref:function(t){return e._videoRecorder=t},onRecordingAvailable:this.onRecordingAvailable,onRecordingProcessingError:this.onRecordingProcessingError,onStartRecording:this.onStartRecording,onData:this.onData,dispatch:this.props.dispatch,vm:this.props.vm,webcamStream:this.props.webcamStream,expandModeSource:this._expandModeSource,captionPlayer:this.props.captionPlayer,disabled:!this.props.isVmConnected||this.recordingsSize>=Pe.Third}),this._renderRightControls()),u.createElement("div",{className:"bottom-controls"},u.createElement("button",{onClick:this.props.onSettings,disabled:this.isRecording},"Audio Settings")))}},{key:"_renderLeftControls",value:function(){return u.createElement("div",{className:"left-controls"},this.props.canExpandView&&u.createElement("button",{className:"expand-btn",onClick:this.toggleExpand},this.state.isViewExpanded?"Collapse View":"Expand View"))}},{key:"_renderRightControls",value:function(){return u.createElement("div",{className:"right-controls"},this.props.recordings.size>0&&u.createElement("button",{className:"preview-btn",onClick:this.props.onEdit,disabled:this.isRecording},"Edit & Preview"))}},{key:"isRecording",get:function(){return!!this.state.currentRecInfo}},{key:"recordingsSize",get:function(){return this.props.recordings.reduce((function(e,t){return e+t.dataSize}),0)}}]),t}(u.PureComponent),Re=r(1166),xe={disabledCameraLabel:"",disabledCameraButton:"Enable Webcam",disabledCameraDescription:"Build a personal connection with your learners",enabledCameraLabel:"",enabledCameraButton:"Broadcast Your Webcam",enabledCameraDescription:"Build a personal connection with your learners",broadcastedCameraLabel:"",broadcastedCameraButton:"Broadcast Your Cloud Workspace",broadcastedCameraDescription:"Currently, learners cannot see your cloud workspace",disabledLabel:"Webcam can be enabled once your cloud workspace is ready"},Ne=(be=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={view:Re.b.DisabledCamera,cameraStream:null,error:null},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){this._stopRecording()}},{key:"enableCamera",value:function(){var e=this;this.setState({view:Re.b.EnabledCamera}),navigator.mediaDevices.getUserMedia({video:!0}).then((function(t){e.setState({cameraStream:t,error:null})})).catch((function(t){var r="An error occurred while enabling the webcam.";t&&t.name&&"NotAllowedError"===t.name&&(r="The webcam is blocked. Please, allow this page to access your webcam."),console.log(r),e.setState({view:Re.b.DisabledCamera,error:r})}))}},{key:"broadcastCamera",value:function(){this.state.cameraStream&&(this.props.onBroadcastCamera(this.state.cameraStream),this.setState({view:Re.b.BroadcastedCamera}))}},{key:"broadcastVM",value:function(){this.props.onStopBroadcastCamera(),this.setState({view:Re.b.DisabledCamera}),this._stopRecording()}},{key:"render",value:function(){return u.createElement(Re.a,{view:this.state.view,labels:xe,disabled:this.props.disabled,error:this.state.error,cameraStream:this.state.cameraStream,onDisabledCameraAction:this.enableCamera,onEnabledCameraAction:this.broadcastCamera,onBroadcastedCameraAction:this.broadcastVM})}},{key:"_stopRecording",value:function(){this.state.cameraStream&&(this.state.cameraStream.getVideoTracks().forEach((function(e){return e.stop()})),this.setState({cameraStream:null}))}}]),t}(u.Component),Object(k.a)(be.prototype,"enableCamera",[w.a],Object.getOwnPropertyDescriptor(be.prototype,"enableCamera"),be.prototype),Object(k.a)(be.prototype,"broadcastCamera",[w.a],Object.getOwnPropertyDescriptor(be.prototype,"broadcastCamera"),be.prototype),Object(k.a)(be.prototype,"broadcastVM",[w.a],Object.getOwnPropertyDescriptor(be.prototype,"broadcastVM"),be.prototype),be),Me=(r(1684),r(22)),Ve=r(1094),Ae=r(1115),Ie=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={deleteConfirmationModalVisible:!1,trimConfirmationModalVisible:!1,confirmTrimDuration:0,isMergingRecording:!1},r._recEditor=new ie.h,r.openDeleteConfirmationModal=function(){r.setState({deleteConfirmationModalVisible:!0})},r.closeDeleteConfirmationModal=function(){r.setState({deleteConfirmationModalVisible:!1})},r.onConfirmDeletion=function(){if(r.props.previewMergedRecording)r.props.onResetRecordings();else if(r.props.currentRecording){var e=r.props.recordings.findIndex((function(e){return e===r.props.currentRecording}));if(e>=0&&r.props.recordings.size>1){var t=0===e?1:e-1,n=r.props.recordings.get(t);r.props.onSetCurrentRecording(n),r.props.onSetVideoPlayerRecording(n)}r.props.onRemoveRecording(r.props.currentRecording)}return r.closeDeleteConfirmationModal(),Promise.resolve()},r.onPreviewAll=Object(oe.a)(ne.a.mark((function e(){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.props.mergedRecording){e.next=13;break}return r.setState({isMergingRecording:!0}),e.prev=3,e.t0=P.N,e.next=7,r._recEditor.merge(r.props.recordings);case 7:e.t1=e.sent,t=new e.t0(e.t1);case 9:return e.prev=9,r.setState({isMergingRecording:!1}),e.finish(9);case 12:r.props.onSetMergedRecording(t);case 13:r.props.onSetVideoPlayerRecording(t),r.props.onSetPreviewMergedRecording();case 15:case"end":return e.stop()}}),e,null,[[3,,9,12]])}))),r.onTrim=function(){var e=Object(oe.a)(ne.a.mark((function e(t){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&r.props.currentRecording&&r.setState({confirmTrimDuration:t,trimConfirmationModalVisible:!0});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.onConfirmTrim=Object(oe.a)(ne.a.mark((function e(){var t,n,o;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.closeTrimConfirmationModal(),!(t=r.state.confirmTrimDuration)||!r.props.currentRecording){e.next=12;break}return n=r.props.currentRecording,e.t0=P.N,e.next=7,r._recEditor.trim(r.props.currentRecording,t);case 7:e.t1=e.sent,o=new e.t0(e.t1),r.props.onReplaceRecording(n,o),r.props.onSetCurrentRecording(o),r.props.onSetVideoPlayerRecording(o);case 12:case"end":return e.stop()}}),e)}))),r.closeTrimConfirmationModal=function(){r.setState({trimConfirmationModalVisible:!1})},r.onSelectRecording=function(e){r.state.isMergingRecording&&r.setState({isMergingRecording:!1}),r.props.onSetCurrentRecording(e),r.props.onSetVideoPlayerRecording(e)},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){0===this.props.recordings.size&&this.props.onEndEdit(),this.props.currentRecording!==e.currentRecording&&this.setState({isMergingRecording:!1})}},{key:"render",value:function(){return u.createElement("div",{className:"recordings-editor"},u.createElement(he,{selectedRecording:this.props.currentRecording,recordings:this.props.recordings,onRecordingClicked:this.onSelectRecording,selectAll:this.props.previewMergedRecording||this.state.isMergingRecording,insertIndex:-1,currentRec:null,disabled:!1,segmentTooltip:"Select"}),u.createElement(T.b,{className:"empty preview-all",loading:this.state.isMergingRecording,onClick:this.onPreviewAll,disabled:this.props.previewMergedRecording},"Preview All"),u.createElement(Ve.a,{dispatch:this.props.dispatch,startOffsetTime:this.startOffsetTime,videoPlayer:this.props.videoPlayer,autoPlay:this.props.previewMergedRecording,canPlayVideo:this.props.canPlayVideo,trimDisabled:this.props.previewMergedRecording,onTrim:this.onTrim,onDelete:this.openDeleteConfirmationModal,frames:this.props.previewFrames}),u.createElement(T.b,{className:"end-edit",onClick:this.props.onEndEdit},"End Edit"),u.createElement(Ae.a,{visible:this.state.deleteConfirmationModalVisible,title:"Delete Recording",messages:["Are you sure you want to delete the selected recording?"],onClose:this.closeDeleteConfirmationModal,onDelete:this.onConfirmDeletion}),u.createElement(Ae.a,{visible:this.state.trimConfirmationModalVisible,title:"Trim Recording",messages:[this.confirmTrimMessage],onClose:this.closeTrimConfirmationModal,onDelete:this.onConfirmTrim}))}},{key:"recordingToPreview",get:function(){return this.props.previewMergedRecording?this.props.mergedRecording:this.props.currentRecording}},{key:"startOffsetTime",get:function(){var e=this;return this.props.previewMergedRecording||!this.props.currentRecording?0:this.props.recordings.takeUntil((function(t){return t===e.props.currentRecording})).reduce((function(e,t){return e+t.duration}),0)/1e3}},{key:"confirmTrimMessage",get:function(){if(this.state.confirmTrimDuration&&this.props.currentRecording){var e=(this.props.currentRecording.duration-this.state.confirmTrimDuration)/1e3;return"Are you sure you want to remove the last ".concat(e.toFixed(2)," seconds of the selected recording?")}return""}}]),t}(u.Component),Ue=Object(j.c)((function(e){return{recordings:e.recordingState.recordings,currentRecording:e.recordingState.currentRecording,mergedRecording:e.recordingState.mergedRecording,previewMergedRecording:e.recordingState.previewMergedRecording,previewFrames:Object(Me.i)(e)}}),(function(e){return{dispatch:e,onResetRecordings:function(){e(new v.pb)},onReplaceRecording:function(t,r){e(new v.gb(t,r))},onRemoveRecording:function(t){e(new v.eb(t))},onSetCurrentRecording:function(t){e(new v.xb(t))},onSetMergedRecording:function(t){e(new v.Bb(t))},onSetPreviewMergedRecording:function(t){e(new v.Cb(!0))}}}))(Ie),Le=r(47),Fe=(r(1685),function(e){var t=e.onClose,r=Object(u.useState)((function(){return _e().noiseSuppression})),n=Object(Le.a)(r,2),o=n[0],a=n[1],i=Object(u.useCallback)((function(){var e,t=o===me.Disabled?me.Default:me.Disabled;e={noiseSuppression:t},Object(ye.e)(ye.a.RecordingSettings,e),a(t)}),[o,a]),s=o===me.Disabled?"Noise Cancellation is disabled":"Noise Cancellation is enabled (browser default)";return d.a.createElement("div",{className:"recording-settings"},d.a.createElement("p",{className:"info"},"It is recommended to use the default browser settings for recording as they produce best results in most cases. However, if you experience drop in recording audio quality when there is background noise or while typing while talking - you can try to disable ",d.a.createElement("b",null,"Noise Cancellation"),"."),d.a.createElement("p",{className:"setting-label"},s),d.a.createElement(T.b,{className:"empty settings-btn",onClick:i},o===me.Disabled?"Enable":"Disable"),d.a.createElement("div",{className:"expand"}),d.a.createElement(T.b,{className:"back-btn",onClick:t},"Back"))}),Be=(r(1686),ge=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={webcamStream:null,isRecording:!1,isSettingsVisible:!1},r._recEditor=new ie.h,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){Object(se.b)(),window.addEventListener("beforeunload",this.onBeforeUnload),window.addEventListener("keydown",this.onDocumentKeyDown)}},{key:"componentDidUpdate",value:function(e){this.props.isPreviewing!==e.isPreviewing&&this.props.captionPlayer&&this.props.captionPlayer.reset()}},{key:"componentWillUnmount",value:function(){this.props.onResetRecordings(),window.removeEventListener("beforeunload",this.onBeforeUnload),window.removeEventListener("keydown",this.onDocumentKeyDown)}},{key:"onBeforeUnload",value:function(e){this.props.recordings.size>0&&(e.preventDefault(),e.returnValue="Are you sure you want to leave this page? You recoding will be lost.")}},{key:"onDocumentKeyDown",value:function(e){this.props.recordings.size>0&&e.keyCode===ce.f&&e.preventDefault()}},{key:"onBroadcastCamera",value:function(e){this.setState({webcamStream:e}),this.props.onBroadcastCamera&&this.props.onBroadcastCamera(e)}},{key:"onStopBroadcastCamera",value:function(){this.setState({webcamStream:null}),this.props.onStopBroadcastCamera&&this.props.onStopBroadcastCamera()}},{key:"onStartRecording",value:function(){return this.setState({isRecording:!0}),this.props.onStartRecording()}},{key:"onStopRecording",value:function(){this.setState({isRecording:!1})}},{key:"onSave",value:function(){var e=Object(oe.a)(ne.a.mark((function e(){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.mergedRecording){e.next=7;break}return e.t0=P.N,e.next=5,this._recEditor.merge(this.props.recordings);case 5:e.t1=e.sent,t=new e.t0(e.t1);case 7:this.props.onSaveMedia(t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onEditLastRecording",value:function(){var e=this.props.currentRecording||this.props.recordings.last();e&&this.onEditRecording(e)}},{key:"onShowSettings",value:function(){this.setState({isSettingsVisible:!0})}},{key:"onCloseSettings",value:function(){this.setState({isSettingsVisible:!1})}},{key:"onEditRecording",value:function(e){this.props.onSetCurrentRecording(e),this.props.onSetVideoPlayerRecording(e)}},{key:"onRecording",value:function(e,t){this.props.onAddRecording(e,t),this.props.onSetCurrentRecording(e)}},{key:"render",value:function(){return u.createElement("div",{className:"chapter-recorder-sidebar"},u.createElement("div",{className:"sidebar-content"},u.createElement("div",{className:"header"},u.createElement("h2",{className:"title"},"Record"),u.createElement("div",{className:"chapter-number"},this.chapterNumber,":"),u.createElement("div",{className:"chapter-name"},this.props.chapter.name),u.createElement("div",{className:"timer"},this.totalDurationFormatted)),u.createElement("div",{className:"camera"},u.createElement(Ne,{disabled:!this.props.isVmConnected,onBroadcastCamera:this.onBroadcastCamera,onStopBroadcastCamera:this.onStopBroadcastCamera})),u.createElement("div",{className:"recording-controls"},u.createElement(Te,{resourceLabel:"task",canExpandView:!0,vm:this.props.vm,isVmConnected:this.props.isVmConnected,dispatch:this.props.dispatch,webcamStream:this.state.webcamStream,captionPlayer:this.props.captionPlayer,recordings:this.props.recordings,onExpandModeChange:this.props.onExpandModeChange,onStartRecording:this.onStartRecording,onStopRecording:this.onStopRecording,onRecording:this.onRecording,onEdit:this.onEditLastRecording,onSettings:this.onShowSettings,onSelectRecording:this.onEditRecording}),u.createElement("div",{className:"actions"},u.createElement(T.b,{className:"empty",disabled:this.state.isRecording,onClick:this.props.onCancel},"Cancel"),u.createElement(T.b,{disabled:this.state.isRecording||0===this.props.recordings.size,onClick:this.onSave},"Save")))),u.createElement(le,{title:"Edit & Preview",open:this.props.isPreviewing},u.createElement(Ue,{canPlayVideo:this.props.canPlayVideo,videoPlayer:this.props.videoPlayer,onSetVideoPlayerRecording:this.props.onSetVideoPlayerRecording,onEndEdit:this.props.onPreviewDone})),u.createElement(le,{title:"Audio Settings",open:this.state.isSettingsVisible},u.createElement(Fe,{onClose:this.onCloseSettings})))}},{key:"chapterNumber",get:function(){return"Ch"+this.props.chapter.order}},{key:"totalDuration",get:function(){return this.props.recordings.reduce((function(e,t){return e+t.duration}),0)}},{key:"totalDurationFormatted",get:function(){return m.utc(this.totalDuration).format("mm:ss")}}]),t}(u.Component),Object(k.a)(ge.prototype,"onBeforeUnload",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onBeforeUnload"),ge.prototype),Object(k.a)(ge.prototype,"onDocumentKeyDown",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onDocumentKeyDown"),ge.prototype),Object(k.a)(ge.prototype,"onBroadcastCamera",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onBroadcastCamera"),ge.prototype),Object(k.a)(ge.prototype,"onStopBroadcastCamera",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onStopBroadcastCamera"),ge.prototype),Object(k.a)(ge.prototype,"onStartRecording",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onStartRecording"),ge.prototype),Object(k.a)(ge.prototype,"onStopRecording",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onStopRecording"),ge.prototype),Object(k.a)(ge.prototype,"onSave",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onSave"),ge.prototype),Object(k.a)(ge.prototype,"onEditLastRecording",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onEditLastRecording"),ge.prototype),Object(k.a)(ge.prototype,"onShowSettings",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onShowSettings"),ge.prototype),Object(k.a)(ge.prototype,"onCloseSettings",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onCloseSettings"),ge.prototype),Object(k.a)(ge.prototype,"onEditRecording",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onEditRecording"),ge.prototype),Object(k.a)(ge.prototype,"onRecording",[w.a],Object.getOwnPropertyDescriptor(ge.prototype,"onRecording"),ge.prototype),ge),ze=Object(j.c)((function(e){return{recordings:e.recordingState.recordings,currentRecording:e.recordingState.currentRecording,mergedRecording:e.recordingState.mergedRecording}}),(function(e){return{dispatch:e,onSetCurrentRecording:function(t){e(new v.xb(t))},onAddRecording:function(t,r){e(new v.j(r,t))},onResetRecordings:function(){e(new v.pb)}}}))(Be),He=r(211),We=r(42),Ke=r(1132),Ye=r(1117),Ge=function(){var e=Object(j.d)();return u.useEffect((function(){return e(new v.cb),function(){e(new v.Jb)}}),[]),null},qe=r(1133),Je=r(1092),Xe=r(1113),Ze=r(1118),Qe=r(1089),$e=r(1086),et=(r(1687),r(1134)),tt=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"upload-progress"},u.createElement("span",{className:"label"},"Saving Progress:"),u.createElement(et.a,{type:"thin",color:"#1B3262",progress:this.props.progress}),u.createElement("span",null,Math.round(100*this.props.progress),"%"))}}]),t}(u.PureComponent),rt=(r(1688),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement(R.a,{title:"Save as One Video",visible:this.props.visible,hideClose:!0,closeWithEsc:!1,size:"small"},u.createElement("div",{className:"confirm-save-modal form-styles"},u.createElement("p",{className:"text"},"Once this video is saved, you will be unable to edit individual recorded segments. Be sure to preview your video before saving."),u.createElement("div",{className:"confirm-save-row",style:{visibility:this.props.isSaving?"visible":"hidden"}},u.createElement(tt,{progress:this.props.progress})),u.createElement("div",{className:"confirm-save-row actions"},u.createElement($e.a,{disabled:this.props.isSaving,onClick:this.props.onCancel,className:"empty"},"Cancel"),u.createElement($e.a,{disabled:this.props.isSaving,onClick:this.props.onConfirm},"Save"))))}}]),t}(u.Component)),nt=(Oe=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){Object(O.h)(O.a.NotifiedAboutInputRecording,!0),this.props.onClose()}},{key:"render",value:function(){return u.createElement(R.a,{title:"Note",visible:this.props.visible,hideClose:!0,closeWithEsc:!1,size:"small"},u.createElement("div",{className:"input-recording-modal form-styles"},u.createElement("p",{className:"text"},"The learner will see all the keys you press in this recording. If you are entering sensitive information (e.g., passwords), please pause the recording"),u.createElement($e.a,{onClick:this.onClick,className:"short-btn"},"Okay")))}}]),t}(u.PureComponent),Object(k.a)(Oe.prototype,"onClick",[w.a],Object.getOwnPropertyDescriptor(Oe.prototype,"onClick"),Oe.prototype),Oe),ot=(r(1689),ke=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._chapterScreenshot=null,r._gtmVmLaunchTime=null,r._captionPlayer=void 0,r._resolveInputRecordingNotify=void 0,r.state={connected:!1,canPlayVideo:!1,isPreviewViewExpanded:!1,isRecordingViewExpanded:!1,recording:void 0,videoPlayer:null,screen:null,previewViewboxVisible:!0,width:0,height:0,scaleX:0,scaleY:0,bottomBarWidth:0,videoDimm:{width:pe.a.DefaultScreenWidth,height:pe.a.DefaultScreenHeight},broadcastedCameraStream:null,isLeaveModalVisible:!1,isInputRecordingNotifyModalVisible:!1,isUploading:!1,uploadProgress:0,isConfirmSaveVisible:!1,recordingToUpload:null},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){this.adjustLayout()}},{key:"onSaveMedia",value:function(){var e=Object(oe.a)(ne.a.mark((function e(t){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({recordingToUpload:t,isConfirmSaveVisible:!0});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onSaveCancel",value:function(){this.setState({recordingToUpload:null,isConfirmSaveVisible:!1})}},{key:"onSaveConfirm",value:function(){var e=Object(oe.a)(ne.a.mark((function e(){var t,r,n,o,a,i,s=this;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.recordingToUpload){e.next=4;break}return console.error("No recording to upload"),e.abrupt("return");case 4:return r=this.props.chapter,this.setState({isUploading:!0}),e.prev=6,o=(n=function(e,t){return function(r,n){var o=(e+n/r*(t-e))/100;s.setState({uploadProgress:o})}})(10,80),e.next=11,this._uploadVideo(r,t.videoTrack,o);case 11:return r=e.sent,o=n(80,85),a=new Blob([t.inputTrackBuffer]),e.next=16,this._uploadInput(r,a,o);case 16:return r=e.sent,o=n(85,90),i=new Blob([t.expandTrackBuffer]),e.next=21,this._uploadExpandModeData(r,i,o);case 21:return r=e.sent,o=n(90,95),e.next=25,this._updateScreenshot(r,this._chapterScreenshot,o);case 25:return r=e.sent,e.next=28,this._updateDuration(r,t.duration);case 28:r=e.sent,this.setState({isUploading:!1}),this.props.onExit(),e.next=37;break;case 33:e.prev=33,e.t0=e.catch(6),this.setState({isUploading:!1}),console.error(e.t0);case 37:case"end":return e.stop()}}),e,this,[[6,33]])})));return function(){return e.apply(this,arguments)}}()},{key:"onCancel",value:function(){this.onToggleLeaveModal(!0)}},{key:"onToggleLeaveModal",value:function(e){this.setState({isLeaveModalVisible:e})}},{key:"onVmInit",value:function(){var e=this.props,t=e.course,r=e.chapter,n=e.vm;this._gtmVmLaunchTime=We.a.recordingVmLaunchTime(t.id,r.id,n.id)}},{key:"onVmConnect",value:function(){this.setState({connected:!0}),this._gtmVmLaunchTime&&(this._gtmVmLaunchTime(),this._gtmVmLaunchTime=null)}},{key:"onVmDisconnect",value:function(){this.setState({connected:!1})}},{key:"onPreviewRecording",value:function(e){this.setState({recording:e,isPreviewViewExpanded:!1})}},{key:"onVideoPlayerRef",value:function(e){this.setState({videoPlayer:e})}},{key:"onCaptionPlayerRef",value:function(e){this._captionPlayer=e}},{key:"onScreenRef",value:function(e){this.setState({screen:e})}},{key:"onPreviewViewboxToggle",value:function(e){this.setState({previewViewboxVisible:e})}},{key:"onVideoDimensions",value:function(e,t){this.setState({videoDimm:{width:e,height:t}})}},{key:"onStartRecording",value:function(){if(!this.props.chapter.screenshot&&!this._chapterScreenshot){var e=this.props.remoteClientManager.getRemoteClient(this.props.vm.id);if(e){var t=e.toDataURL("image/png",1,this.props.vm.width,this.props.vm.height,!1);this._chapterScreenshot=new Blob([He.a.toArrayBuffer(t)],{type:"image/png"})}}return this._notifyAboutInputRecordingIfNeeded()}},{key:"onResetRecording",value:function(){this._chapterScreenshot=null,this.setState({isRecordingViewExpanded:!1})}},{key:"onBroadcastCamera",value:function(e){this.setState({broadcastedCameraStream:e})}},{key:"onStopBroadcastCamera",value:function(){this.setState({broadcastedCameraStream:null})}},{key:"onPreviewDone",value:function(){this.setState({isPreviewViewExpanded:!1,canPlayVideo:!1,recording:void 0})}},{key:"toggleInputRecordingNotifyModal",value:function(e){this.setState({isInputRecordingNotifyModalVisible:e})}},{key:"onInputRecordingNotifyModalClose",value:function(){this.toggleInputRecordingNotifyModal(!1),this._resolveInputRecordingNotify()}},{key:"onCanPlay",value:function(e){this.setState({canPlayVideo:e})}},{key:"onPreviewExpandModeChange",value:function(e){this.setState({isPreviewViewExpanded:e===ie.e.Expand})}},{key:"onRecordingExpandModeChange",value:function(e){this.setState({isRecordingViewExpanded:e===ie.e.Expand})}},{key:"onExit",value:function(){return this.props.onExit(),Promise.resolve()}},{key:"onResize",value:function(e,t){this.adjustLayout(),this.setState({bottomBarWidth:e+pe.a.SplitterWidth})}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"recorder"},u.createElement(Ge,null),u.createElement(Qe.c,{rightPanelInitialSize:this.rightPanelSize,ref:function(t){return e._splitter=t},onResize:this.onResize,className:this.isCurrentViewExpanded?"expand-view-mode":""},u.createElement(u.Fragment,null,u.createElement("div",{className:"left-container",ref:this.onLeftContRef},u.createElement("div",{className:"screen-border"},this.isPreviewing&&this._renderPlayer(),this._renderScreen())),this._renderMessage(),u.createElement(Ke.a,{width:this.state.bottomBarWidth},u.createElement(qe.a,{ref:this.onCaptionPlayerRef,tooltip:"The keys pressed in this recording will be shown to the learners"}))),u.createElement(ze,{chapter:this.props.chapter,onSaveMedia:this.onSaveMedia,onSetVideoPlayerRecording:this.onPreviewRecording,onPreviewDone:this.onPreviewDone,onCancel:this.onCancel,vm:this.props.vm,isPreviewing:this.isPreviewing,course:this.props.course,videoPlayer:this.state.videoPlayer,captionPlayer:this._captionPlayer,screen:this.state.screen,canPlayVideo:this.state.canPlayVideo,isVmConnected:this.state.connected,onStartRecording:this.onStartRecording,onBroadcastCamera:this.onBroadcastCamera,onStopBroadcastCamera:this.onStopBroadcastCamera,onExpandModeChange:this.onRecordingExpandModeChange})),this._renderModals())}},{key:"_renderMessage",value:function(){var e=null;return this.state.connected&&(e=this.isCurrentViewExpanded?"Expand Mode: Learners see your full screen and can\u2019t follow along":"Collapse Mode: Learners can follow along by watching only the highlighted section of your cloud workspace"),u.createElement("div",{className:"upper-left-pane-message"},e)}},{key:"_renderScreen",value:function(){return u.createElement(Je.a,{originalWidth:this.props.vm.width,originalHeight:this.props.vm.height,scaledWidth:this.state.width,style:{display:this.isPreviewing?"none":"block"}},u.createElement(Xe.a,{ref:this.onScreenRef,width:this.props.vm.width,height:this.props.vm.height,scaleRatio:{scaleX:this.state.scaleX,scaleY:this.state.scaleY},viewboxSize:this.viewboxSize,showViewbox:!0,isViewExpanded:this.state.isRecordingViewExpanded,dispatch:this.props.dispatch,onReadWriteInit:this.onVmInit,onConnect:this.onVmConnect,onDisconnect:this.onVmDisconnect,vm:this.props.vm,cameraStream:this.state.broadcastedCameraStream,controls:!0,template:this.template,asyncActions:this.props.asyncActions}))}},{key:"_renderPlayer",value:function(){var e=this.state.recording;return u.createElement(u.Fragment,null,u.createElement(Je.a,{originalWidth:this.state.videoDimm.width,originalHeight:this.state.videoDimm.height,scaledWidth:this.state.width},u.createElement(ae.b,{ref:this.onVideoPlayerRef,dispatch:this.props.dispatch,viewboxSize:this.viewboxSize,showViewbox:this.state.previewViewboxVisible,isViewExpanded:this.state.isPreviewViewExpanded,onViewboxToggle:this.onPreviewViewboxToggle,controls:!1,autoPlay:!1,captionPlayer:this._captionPlayer,src:e.mediaUrl,input:e.inputTrackBuffer,expandModeData:e.expandTrackBuffer,className:this.isPreviewing?void 0:"hidden",annotations:void 0,onVideoDimmensions:this.onVideoDimensions,onCanPlay:this.onCanPlay,onExpandModeChange:this.onPreviewExpandModeChange})))}},{key:"_renderModals",value:function(){return u.createElement(u.Fragment,null,u.createElement(Ye.a,{visible:this.state.isLeaveModalVisible,onToggle:this.onToggleLeaveModal,onResolve:this.onExit}),u.createElement(nt,{visible:this.state.isInputRecordingNotifyModalVisible,onClose:this.onInputRecordingNotifyModalClose}),u.createElement(rt,{visible:this.state.isConfirmSaveVisible,onConfirm:this.onSaveConfirm,onCancel:this.onSaveCancel,isSaving:this.state.isUploading,progress:this.state.uploadProgress}))}},{key:"_uploadVideo",value:function(e,t,r){return this.props.dispatch(this.props.asyncActions.saveChapterVideo(this.props.course.id,e,new Blob([t],{type:"video/webm"}),(function(e,t){r(e,t),console.log("Video upload progress",t,e)})))}},{key:"_uploadInput",value:function(e,t,r){return this.props.dispatch(this.props.asyncActions.saveChapterInputRecord(this.props.course.id,e.id,new Blob([t],{type:"application/octet-stream"}),(function(e,t){r(e,t),console.log("Input upload progress",t,e)})))}},{key:"_uploadExpandModeData",value:function(e,t,r){return this.props.dispatch(this.props.asyncActions.saveChapterExpandModeRecord(this.props.course.id,e.id,new Blob([t],{type:"application/octet-stream"}),(function(e,t){r(e,t),console.log("Expand mode data upload progress",t,e)})))}},{key:"_updateScreenshot",value:function(e,t,r){return e.screenshot?Promise.resolve(e):this.props.dispatch(this.props.asyncActions.saveChapterScreenshot(this.props.course.id,e.id,t,(function(e,t){r(e,t),console.log("Screenshot upload progress",t,e)}),!1))}},{key:"_updateDuration",value:function(e,t){t=Math.floor(t);var r=e.set("duration",t);return this.props.dispatch(this.props.asyncActions.updateChapter(this.props.course,r.id,r))}},{key:"_notifyAboutInputRecordingIfNeeded",value:function(){var e=this;return Object(O.d)(O.a.NotifiedAboutInputRecording)?Promise.resolve():(this.toggleInputRecordingNotifyModal(!0),new Promise((function(t){return e._resolveInputRecordingNotify=t})))}},{key:"_screenWidth",get:function(){return this.isPreviewing||this.isBroadcastingCamera?this.state.videoDimm.width:this.props.vm.width}},{key:"_screenHeight",get:function(){return this.isPreviewing||this.isBroadcastingCamera?this.state.videoDimm.height:this.props.vm.height}},{key:"template",get:function(){return this.props.templates.get(this.props.vm.templateId)}},{key:"isPreviewing",get:function(){return!!this.state.recording}},{key:"isBroadcastingCamera",get:function(){return!!this.state.broadcastedCameraStream}},{key:"viewboxSize",get:function(){return{width:pe.a.Zoom.VisibleSize.Width*(this._screenWidth/pe.a.Zoom.Sizes[60].Width),height:pe.a.Zoom.VisibleSize.Height*(this._screenHeight/pe.a.Zoom.Sizes[60].Height)}}},{key:"isCurrentViewExpanded",get:function(){return this.isPreviewing?this.state.isPreviewViewExpanded:this.state.isRecordingViewExpanded}},{key:"_verticalPadding",get:function(){return 75}}]),t}(Ze.a),Object(k.a)(ke.prototype,"onSaveMedia",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onSaveMedia"),ke.prototype),Object(k.a)(ke.prototype,"onSaveCancel",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onSaveCancel"),ke.prototype),Object(k.a)(ke.prototype,"onSaveConfirm",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onSaveConfirm"),ke.prototype),Object(k.a)(ke.prototype,"onCancel",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onCancel"),ke.prototype),Object(k.a)(ke.prototype,"onToggleLeaveModal",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onToggleLeaveModal"),ke.prototype),Object(k.a)(ke.prototype,"onVmInit",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onVmInit"),ke.prototype),Object(k.a)(ke.prototype,"onVmConnect",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onVmConnect"),ke.prototype),Object(k.a)(ke.prototype,"onVmDisconnect",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onVmDisconnect"),ke.prototype),Object(k.a)(ke.prototype,"onPreviewRecording",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onPreviewRecording"),ke.prototype),Object(k.a)(ke.prototype,"onVideoPlayerRef",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onVideoPlayerRef"),ke.prototype),Object(k.a)(ke.prototype,"onCaptionPlayerRef",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onCaptionPlayerRef"),ke.prototype),Object(k.a)(ke.prototype,"onScreenRef",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onScreenRef"),ke.prototype),Object(k.a)(ke.prototype,"onPreviewViewboxToggle",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onPreviewViewboxToggle"),ke.prototype),Object(k.a)(ke.prototype,"onVideoDimensions",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onVideoDimensions"),ke.prototype),Object(k.a)(ke.prototype,"onStartRecording",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onStartRecording"),ke.prototype),Object(k.a)(ke.prototype,"onResetRecording",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onResetRecording"),ke.prototype),Object(k.a)(ke.prototype,"onBroadcastCamera",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onBroadcastCamera"),ke.prototype),Object(k.a)(ke.prototype,"onStopBroadcastCamera",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onStopBroadcastCamera"),ke.prototype),Object(k.a)(ke.prototype,"onPreviewDone",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onPreviewDone"),ke.prototype),Object(k.a)(ke.prototype,"toggleInputRecordingNotifyModal",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"toggleInputRecordingNotifyModal"),ke.prototype),Object(k.a)(ke.prototype,"onInputRecordingNotifyModalClose",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onInputRecordingNotifyModalClose"),ke.prototype),Object(k.a)(ke.prototype,"onCanPlay",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onCanPlay"),ke.prototype),Object(k.a)(ke.prototype,"onPreviewExpandModeChange",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onPreviewExpandModeChange"),ke.prototype),Object(k.a)(ke.prototype,"onRecordingExpandModeChange",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onRecordingExpandModeChange"),ke.prototype),Object(k.a)(ke.prototype,"onExit",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onExit"),ke.prototype),Object(k.a)(ke.prototype,"onResize",[w.a],Object.getOwnPropertyDescriptor(ke.prototype,"onResize"),ke.prototype),ke),at=(r(1690),r(134)),it=r(1184),st=r(210),ct=r.n(st),lt=r(1077),pt=r(1087),ut=(r(1691),r(1186));!function(e){e[e.InlineView=0]="InlineView",e[e.InlineEdit=1]="InlineEdit",e[e.AllEdit=2]="AllEdit"}(Ee||(Ee={}));var dt,ht,mt,ft,yt,vt,bt,gt,Ot,kt,Ct,wt,jt,Et,_t,St,Dt,Pt,Tt=(je=we=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={edits:Object($.Map)(),activeCue:void 0,mode:Ee.InlineView,invalidEditStartingTimes:Object($.Set)()},r._unsubscribeFromTrack=ct.a,r._focusInvalidInput=ct.a,r._entryIndex=r._entryIndicesByStartTime,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.subscribeToTrack!==this.props.subscribeToTrack&&(this._unsubscribeFromTrack(),this._subscribeToTrack()),e.subtitle!==this.props.subtitle&&(this._entryIndex=this._entryIndicesByStartTime)}},{key:"componentDidMount",value:function(){this._subscribeToTrack()}},{key:"componentWillUnmount",value:function(){this._unsubscribeFromTrack()}},{key:"renderTextarea",value:function(e){var t=e.content,r=e.startAt,n=e.id,o=void 0===n?"":n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.state,s=i.edits,c=i.invalidEditStartingTimes,l=s.get(r),p=l||t,d=c.has(r),h=d&&c.first()===r;return u.createElement("div",{className:"cc-input"},u.createElement("textarea",{key:"".concat(o).concat(p),ref:h?this._onInvalidInputRef:null,className:"cc-text",dir:Object(pt.b)(this.state.activeCue),"data-start":r,autoFocus:a,defaultValue:p,onBlur:this._applyEditToChunk}),d&&u.createElement("span",{className:"input-error-msg"},"Transcription cannot be empty or longer than 90 characters."))}},{key:"renderInlineEditor",value:function(e){return u.createElement(ut.a,{className:"inline-editor",text:this.renderTextarea(e,!0)},u.createElement("div",{className:"controls"},u.createElement($e.a,{className:"empty",onClick:this._clearEditsAndViewInline},"Cancel"),u.createElement($e.a,{onClick:this._onSaveAll},"Save")))}},{key:"renderAllEditor",value:function(){var e=this;return u.createElement("div",{className:"all-editor"},u.createElement("ol",{className:"cc-editable-entries"},this.props.subtitle.entries.map((function(t){return u.createElement("li",{key:t.startAt,className:"editable-entry"},u.createElement("time",null,Object(lt.a)(t.startAt)),e.renderTextarea(t))}))),u.createElement("div",{className:"controls"},u.createElement($e.a,{className:"empty",onClick:this._clearEditsAndViewInline},"Cancel"),u.createElement($e.a,{onClick:this._onSaveAll},"Save")))}},{key:"renderViewer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=null===e?u.createElement("span",{className:"cc-pending-message cc-placeholder-message"},"Your transcriptions will show here."):e;return u.createElement(ut.a,{dir:Object(pt.b)(this.state.activeCue),key:this.props.subtitle.id,className:"inline-viewer",text:t,hidden:this.props.hidden},u.createElement("div",{className:"controls"},u.createElement($e.a,{disabled:null===e,onClick:this._onInlineEdit},"Edit"),u.createElement($e.a,{onClick:this._onEditAll},"Edit all")))}},{key:"render",value:function(){if(Object(pt.c)(this.props.subtitle))return u.createElement(ut.a,{hidden:this.props.hidden,text:u.createElement("span",{className:"cc-pending-message"},"We're generating transcriptions for this video. They will be available shortly.")});if(this.state.mode===Ee.AllEdit)return this.renderAllEditor();if(!this.state.activeCue)return this.renderViewer();var e=Math.round(1e3*this.state.activeCue.startTime),t=this._entryContentAtStart(e,this.state.activeCue.text);switch(this.state.mode){case Ee.InlineView:return this.renderViewer(t);case Ee.InlineEdit:return this.renderInlineEditor({startAt:e,content:t});default:return null}}},{key:"_subscribeToTrack",value:function(){this._unsubscribeFromTrack=this.props.subscribeToTrack(this._onCueChange)}},{key:"_onInvalidInputRef",value:function(e){this._focusInvalidInput=function(){e.parentElement.scrollTo(),e.focus(),e.setSelectionRange(0,e.value.length)}}},{key:"_applyEditToChunk",value:function(e){var r=e.target;if(r.defaultValue!==r.value){var n=Number(r.getAttribute("data-start")),o=this.state.invalidEditStartingTimes;this.setState({edits:this.state.edits.set(n,r.value),invalidEditStartingTimes:t._isEditValid(r.value)?o.remove(n):o.add(n)})}}},{key:"_onSaveAll",value:function(){var e=Object(oe.a)(ne.a.mark((function e(){var t,r=this;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.invalidEditStartingTimes.size>0)){e.next=3;break}return this._focusInvalidInput(),e.abrupt("return");case 3:if(!this.state.edits.isEmpty()){e.next=5;break}return e.abrupt("return");case 5:return t=this.props.subtitle.entries.reduce((function(e,t){var n=r.state.edits.get(t.startAt);return n?e.push(t.set("content",n)):e}),Object($.List)()).toArray(),e.next=8,this.props.onCCEdit(t);case 8:this._clearEditsAndViewInline();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_clearEditsAndViewInline",value:function(){this._changeMode(Ee.InlineView),this.setState({edits:Object($.Map)()})}},{key:"_onInlineEdit",value:function(){this._changeMode(Ee.InlineEdit)}},{key:"_onEditAll",value:function(){this._changeMode(Ee.AllEdit)}},{key:"_onCueChange",value:function(e){var t=e.srcElement.track;this.setState({activeCue:t.activeCues[0]})}},{key:"_changeMode",value:function(e){var t=this;if(this.state.mode!==e){var r=this.state.mode;this.setState({mode:e},(function(){t.props.onModeChange&&t.props.onModeChange(e,r)}))}}},{key:"_entryContentAtStart",value:function(e,t){var r=this.state.edits.get(e);if(r)return r;var n=this._entryIndex.get(e),o=this.props.subtitle.entries.get(n);return void 0!==n&&o?o.content:(console.error("Couldn't lookup subtitle entry[".concat(n,"] for starting time ").concat(e)),t)}},{key:"_entryIndicesByStartTime",get:function(){return Object($.Map)(this.props.subtitle.entries.map((function(e,t){return[e.startAt,t]})))}}]),t}(u.PureComponent),we._isEditValid=function(e){return e.length>0&&e.length<90},Ce=je,Object(k.a)(Ce.prototype,"_onInvalidInputRef",[w.a],Object.getOwnPropertyDescriptor(Ce.prototype,"_onInvalidInputRef"),Ce.prototype),Object(k.a)(Ce.prototype,"_applyEditToChunk",[w.a],Object.getOwnPropertyDescriptor(Ce.prototype,"_applyEditToChunk"),Ce.prototype),Object(k.a)(Ce.prototype,"_onSaveAll",[w.a],Object.getOwnPropertyDescriptor(Ce.prototype,"_onSaveAll"),Ce.prototype),Object(k.a)(Ce.prototype,"_clearEditsAndViewInline",[w.a],Object.getOwnPropertyDescriptor(Ce.prototype,"_clearEditsAndViewInline"),Ce.prototype),Object(k.a)(Ce.prototype,"_onInlineEdit",[w.a],Object.getOwnPropertyDescriptor(Ce.prototype,"_onInlineEdit"),Ce.prototype),Object(k.a)(Ce.prototype,"_onEditAll",[w.a],Object.getOwnPropertyDescriptor(Ce.prototype,"_onEditAll"),Ce.prototype),Object(k.a)(Ce.prototype,"_onCueChange",[w.a],Object.getOwnPropertyDescriptor(Ce.prototype,"_onCueChange"),Ce.prototype),Ce),Rt=r(1106),xt=(r(1692),r(96)),Nt=r(1218),Mt=function(e){return Object(x.c)(e/1e3)},Vt=function(e){return new T.i({id:e.id,time:Mt(e.time),content:e.content})},At=function(e){return new P.b({id:e.id,time:Object(Nt.a)(e.time),content:e.content})},It=(dt=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._annotationsListRef=void 0,r._dirty=Object($.List)([]),r.state={loading:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.visible&&!e.visible&&this.addNewAnnotation(),!this.props.visible&&e.visible&&this.props.reset()}},{key:"onAnnotationDelete",value:function(e){var t=this,r=Promise.resolve(),n=!0;if(e.id){var o=At(e);n=!1,r=this.props.deleteAnnotation(o)}return r.then((function(){return t.props.showGeneralNotification("Annotation successfully deleted"),n}))}},{key:"onDirtyAnnotations",value:function(e){this._dirty=e}},{key:"onRef",value:function(e){this._annotationsListRef=e}},{key:"addNewAnnotation",value:function(e){var t=this;e&&e.preventDefault();var r=new T.i({time:Mt(this.props.currentTimestamp),content:""}),n=this.props.annotations.push(r);this.props.change("annotations",n),setTimeout((function(){t._annotationsListRef&&t._annotationsListRef.openLastAnnotation()}))}},{key:"saveAnnotations",value:function(e){var t=this;if(e.preventDefault(),this.props.annotations){this.setState({loading:!0});var r=[];this.props.annotations.forEach((function(e,n){t._dirty.indexOf(n)>-1&&r.push(t._saveAnnotation(e))})),Promise.all(r).then((function(){t._annotationsListRef&&t._annotationsListRef.cleanse(),t.props.showGeneralNotification("Annotation".concat(r.length>1?"s":""," successfully saved"))})).finally((function(){return t.setState({loading:!1})}))}}},{key:"render",value:function(){return u.createElement("div",{className:"annotations-modal form-styles"},u.createElement(R.a,{title:"Annotate Task",visible:this.props.visible,onToggle:this.props.onToggle,scrollable:!0,autoScrollToBottom:!0,size:"medium"},u.createElement("p",{className:"text"},"Show your learners annotations at these moments in the task"),u.createElement("form",{className:"annotations"},u.createElement(_.a,Object.assign({name:"annotations",component:T.o},{chapterDuration:this.props.duration,onDelete:this.onAnnotationDelete,onDirty:this.onDirtyAnnotations,onRef:this.onRef})),u.createElement("div",{className:"add-button",onClick:this.addNewAnnotation},"Add Annotation"),u.createElement(T.b,{onClick:this.saveAnnotations,loading:this.state.loading,disabled:!this.props.valid||this.props.pristine},"Save"))))}},{key:"_saveAnnotation",value:function(e){var t=At(e);return e.id?this.props.updateAnnotation(t):this.props.createAnnotation(t)}}]),t}(u.PureComponent),Object(k.a)(dt.prototype,"onAnnotationDelete",[w.a],Object.getOwnPropertyDescriptor(dt.prototype,"onAnnotationDelete"),dt.prototype),Object(k.a)(dt.prototype,"onDirtyAnnotations",[w.a],Object.getOwnPropertyDescriptor(dt.prototype,"onDirtyAnnotations"),dt.prototype),Object(k.a)(dt.prototype,"onRef",[w.a],Object.getOwnPropertyDescriptor(dt.prototype,"onRef"),dt.prototype),Object(k.a)(dt.prototype,"addNewAnnotation",[w.a],Object.getOwnPropertyDescriptor(dt.prototype,"addNewAnnotation"),dt.prototype),Object(k.a)(dt.prototype,"saveAnnotations",[w.a],Object.getOwnPropertyDescriptor(dt.prototype,"saveAnnotations"),dt.prototype),dt),Ut=Object(S.a)({form:"annotationsForm",validate:T.H,enableReinitialize:!0})(It),Lt=Object(D.a)("annotationsForm"),Ft=Object(j.c)((function(e,t){return{annotations:Lt(e,"annotations"),initialValues:{annotations:(r=t.chapter.annotations,r.sort((function(e,t){return e.time-t.time})).map(Vt).toList())}};var r}),(function(e,t){var r=t.course,n=t.chapter;return{createAnnotation:function(t){return e(xt.a.createAnnotation(r,n,t))},updateAnnotation:function(t){return e(xt.a.updateAnnotation(r,n,t))},deleteAnnotation:function(t){return e(xt.a.deleteAnnotation(r,n,t))},showGeneralNotification:function(t){return e(new v.i(new P.J({type:P.K.General,text:t})))}}}))(Ut),Bt=(r(1693),r(1051)),zt=r(1694),Ht=296,Wt=224,Kt={createLabel:"Take Screenshot",changeLabel:"Change Screenshot"},Yt=(ht=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onTakeScreenshot",value:function(e){e.preventDefault(),this.props.onTakeScreenshot()}},{key:"render",value:function(){var e=this.props.labels||Kt;return u.createElement("div",{className:"screenshot-picker"+(this.props.className?" ".concat(this.props.className):"")},this.props.image?u.createElement("div",{className:"screenshot-wrapper"+(this.props.disabled?" disabled":""),style:this.styles},u.createElement("img",{src:this.props.image,className:"screenshot",onClick:this.props.onTakeScreenshot}),u.createElement("div",{className:"change-layer"},u.createElement(T.b,{loading:this.props.loading,onClick:this.onTakeScreenshot,type:"button"},e.changeLabel))):u.createElement("div",{className:"shot",onClick:this.props.onTakeScreenshot,style:this.styles},this.props.loading?u.createElement(Bt.a,null):u.createElement(u.Fragment,null,u.createElement("img",{src:zt}),u.createElement(T.b,{className:"empty",onClick:function(e){return e.preventDefault()},type:"button"},e.createLabel))))}},{key:"styles",get:function(){var e=this.props,t=e.width,r=e.height;return{width:t||Ht,height:r||Wt}}}]),t}(u.PureComponent),Object(k.a)(ht.prototype,"onTakeScreenshot",[w.a],Object.getOwnPropertyDescriptor(ht.prototype,"onTakeScreenshot"),ht.prototype),ht),Gt=r(1111),qt=(r(1695),mt=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={playing:!1,currentTime:0,playerKeyhole:!0,playbackRate:r.props.videoPlayer?r.props.videoPlayer.playbackRate:ae.a.x100},r._controlsService=void 0,r._initControlsService(),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.chapter,n=t.course,o=t.canPlayVideo;this.props.videoPlayer!==e.videoPlayer&&this._controlsService.setRefs(this.props.videoPlayer),r===e.chapter&&n===e.course||this._controlsService.updateProps({currentChapter:r,course:n}),o&&!e.canPlayVideo&&this._controlsService.onPlay()}},{key:"componentWillUnmount",value:function(){this._controlsService.destroy()}},{key:"onPreviewDone",value:function(){this.props.onPreviewDone(),this.setState({currentTime:0,playing:!1})}},{key:"onAnnotationsEdit",value:function(){this._controlsService.onPause(),this.props.onAnnotationsEdit()}},{key:"onPreviewViewboxToggle",value:function(){if(this.props.videoPlayer){var e=this.props.videoPlayer.toggleViewbox();this.setState({playerKeyhole:e})}}},{key:"onPlaybackRateChange",value:function(e){this.props.videoPlayer&&(this.props.videoPlayer.changePlaybackRate(e),this.setState({playbackRate:e}))}},{key:"render",value:function(){return this.props.videoPlayer?u.createElement("div",{className:"chapter-previewer"},u.createElement(Gt.a,{theme:"dark",controls:{viewbox:!0},playing:this.state.playing,duration:this.props.videoPlayer.duration||0,currentTime:this.state.currentTime,playerKeyhole:this.state.playerKeyhole,playbackRate:this.state.playbackRate,showCC:this.props.showCC,backwardDisabled:!this._controlsService.hasPrevChapter,forwardDisabled:!this._controlsService.hasNextChapter,onPlay:this._controlsService.onPlay,onPause:this._controlsService.onPause,onSeek:this._controlsService.onSeek,onForward:this._controlsService.onForward,onBackward:this._controlsService.onBackward,onPreviewViewboxToggle:this.onPreviewViewboxToggle,onPlaybackRateChange:this.onPlaybackRateChange,navigationHidden:!this.props.chapterNavigation,disableAll:!this.props.canPlayVideo,onCCToggle:this.props.onCCToggle}),u.createElement("div",{className:"actions"},u.createElement(T.b,{className:"small empty annotate",onClick:this.onAnnotationsEdit},"Annotate"),u.createElement(T.b,{className:"small end-preview",onClick:this.onPreviewDone},"End Preview"))):null}},{key:"_initControlsService",value:function(){var e=this,t=this.props,r=t.chapter,n=t.course;this._controlsService=new Gt.b(this.props.dispatch,{currentChapter:r,course:n}),this._controlsService.onPlayerPlaying((function(t){return e.setState({playing:t})})),this._controlsService.onPlayerTimeUpdated((function(t){return e.setState({currentTime:t})}))}}]),t}(u.Component),Object(k.a)(mt.prototype,"onPreviewDone",[w.a],Object.getOwnPropertyDescriptor(mt.prototype,"onPreviewDone"),mt.prototype),Object(k.a)(mt.prototype,"onAnnotationsEdit",[w.a],Object.getOwnPropertyDescriptor(mt.prototype,"onAnnotationsEdit"),mt.prototype),Object(k.a)(mt.prototype,"onPreviewViewboxToggle",[w.a],Object.getOwnPropertyDescriptor(mt.prototype,"onPreviewViewboxToggle"),mt.prototype),Object(k.a)(mt.prototype,"onPlaybackRateChange",[w.a],Object.getOwnPropertyDescriptor(mt.prototype,"onPlaybackRateChange"),mt.prototype),mt),Jt=(r(1696),function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={isSavingScreenshot:!1},r.onTakeScreenshot=function(){var e=null;r.props.videoPlayer&&(e=r.props.videoPlayer.takeScreenshot()),e&&(r.setState({isSavingScreenshot:!0}),r.props.dispatch(r.props.asyncActions.saveChapterScreenshot(r.props.course.id,r.props.chapter.id,e,(function(e,t){console.log("Screenshot upload progress",e,t)}))).finally((function(){return r.setState({isSavingScreenshot:!1})})))},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"chapter-preview-sidebar"},u.createElement("div",{className:"sidebar-content"},u.createElement("div",{className:"header"},u.createElement("h2",{className:"title"},"Preview"),u.createElement("div",{className:"chapter-number"},this.chapterNumber,":"),u.createElement("div",{className:"chapter-name"},this.props.chapter.name),u.createElement("div",{className:"timer"},this.totalDuration)),u.createElement("div",{className:"screenshot"},u.createElement("div",{className:"screenshot-title"},"Preview"),u.createElement(Yt,{image:this.props.chapter.screenshot,onTakeScreenshot:this.onTakeScreenshot,loading:this.state.isSavingScreenshot}),u.createElement("div",{className:"screenshot-description"},"Take a relevant and interesting looking screenshot to make the task more attractive to learners")),u.createElement(qt,{chapter:this.props.chapter,course:this.props.course,asyncActions:this.props.asyncActions,dispatch:this.props.dispatch,chapterNavigation:!0,onPreviewDone:this.props.onPreviewDone,onAnnotationsEdit:this.props.onAnnotationsEdit,videoPlayer:this.props.videoPlayer,canPlayVideo:this.props.canPlayVideo,showCC:this.props.showCC,onCCToggle:this.props.onCCToggle})))}},{key:"chapterNumber",get:function(){return"Ch"+this.props.chapter.order}},{key:"totalDuration",get:function(){return f.a.utc(this.props.chapter.duration).format("mm:ss")}}]),t}(u.Component)),Xt=(vt=yt=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={minDetailsSize:0,bottomBarWidth:0,chapterPlayerRef:null,playerViewboxVisible:!0,annotationsModalVisible:!1,canPlayVideo:!1,isViewExpanded:!1,width:0,height:0,scaleX:0,scaleY:0,videoDimm:{width:pe.a.DefaultScreenWidth,height:pe.a.DefaultScreenHeight},showCC:!0},r._captionPlayer=void 0,r._videoTrackHub=Object(Rt.b)(),r._keyboardActionHandlers={"video.toggleCC":r.onTranscriptionsToggle},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._loadSubtitleEntries()}},{key:"componentDidUpdate",value:function(e){this.adjustLayout();var t=this._getCurrentChapter(e);this._getCurrentChapter(this.props).id!==t.id&&this.setState({isViewExpanded:!1})}},{key:"onPlayerRef",value:function(e){this.setState({chapterPlayerRef:e})}},{key:"onCaptionPlayerRef",value:function(e){this._captionPlayer=e}},{key:"onViewboxToggle",value:function(e){this.setState({playerViewboxVisible:e})}},{key:"onVideoDimmensions",value:function(e,t){this.setState({videoDimm:{width:e,height:t}})}},{key:"onCanPlay",value:function(e){this.setState({canPlayVideo:e})}},{key:"onToggleAnnotationsModal",value:function(e){this.setState({annotationsModalVisible:e})}},{key:"onExpandModeChange",value:function(e){this.setState({isViewExpanded:e===ie.e.Expand})}},{key:"onResize",value:function(e,t){this.adjustLayout(),this.setState({bottomBarWidth:e+pe.a.SplitterWidth})}},{key:"onTranscriptionsToggle",value:function(){this.setState({showCC:!this.state.showCC})}},{key:"onCCEdit",value:function(e){var t=this.props,r=t.dispatch,n=t.chapter,o=t.course,a=t.asyncActions,i=this.subtitle;if(i)return r(a.updateSubtitleEntries(o,n,i,e))}},{key:"onCCEditModeChanged",value:function(e){e!==Ee.InlineView&&this.state.chapterPlayerRef&&this.state.chapterPlayerRef.pause()}},{key:"renderCCEditor",value:function(){var e=this.subtitle;return e?u.createElement(Tt,{subtitle:e,hidden:!this.state.showCC,subscribeToTrack:this._videoTrackHub.subscribeToTrack,onCCEdit:this.onCCEdit,onModeChange:this.onCCEditModeChanged}):null}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"chapter-preview"},u.createElement(Ge,null),u.createElement(at.Hotkeys,{handlers:this._keyboardActionHandlers}),u.createElement(Qe.c,{ref:function(t){return e._splitter=t},rightPanelInitialSize:this.rightPanelSize,onResize:this.onResize,className:this.className},u.createElement(u.Fragment,null,u.createElement("div",{className:"left-container",ref:this.onLeftContRef},u.createElement("div",{className:"video-container"},u.createElement(Je.a,{originalWidth:this.state.videoDimm.width,originalHeight:this.state.videoDimm.height,scaledWidth:this.state.width},u.createElement(it.a,{captionPlayer:this._captionPlayer||void 0,viewboxSize:{width:pe.a.Zoom.VisibleSize.Width*(this.state.videoDimm.width/pe.a.Zoom.Sizes[60].Width),height:pe.a.Zoom.VisibleSize.Height*(this.state.videoDimm.height/pe.a.Zoom.Sizes[60].Height)},showViewbox:this.state.playerViewboxVisible,isViewExpanded:this.state.isViewExpanded,onViewboxToggle:this.onViewboxToggle,controls:!1,chapter:this.chapter,language:this.props.course.language,ref:this.onPlayerRef,dispatch:this.props.dispatch,onVideoDimmensions:this.onVideoDimmensions,onCanPlay:this.onCanPlay,onExpandModeChange:this.onExpandModeChange,onCueChange:this._videoTrackHub.emitTrackEvent,mouse:!0})))),this.renderCCEditor(),this._renderMessage(),u.createElement(Ke.a,{width:this.state.bottomBarWidth},u.createElement(qe.a,{ref:this.onCaptionPlayerRef,tooltip:"The keys pressed in this recording will be shown to the learners"}))),u.createElement("div",{className:"chapter-preview-side-panel"},u.createElement(Jt,{course:this.props.course,chapter:this.chapter,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,videoPlayer:this.state.chapterPlayerRef,onPreviewDone:this.props.onExit,onAnnotationsEdit:function(){return e.onToggleAnnotationsModal(!0)},canPlayVideo:this.state.canPlayVideo,onCCToggle:this.onTranscriptionsToggle,showCC:this.state.showCC}))),this.state.chapterPlayerRef&&u.createElement(Ft,{currentTimestamp:1e3*Math.round(this.state.chapterPlayerRef.currentTime),chapter:this.props.chapter,course:this.props.course,duration:this.state.chapterPlayerRef.duration,visible:this.state.annotationsModalVisible,onToggle:this.onToggleAnnotationsModal}))}},{key:"_loadSubtitleEntries",value:function(){var e=this.subtitle;if(e){var t=this.props,r=t.dispatch,n=t.chapter,o=t.course;r(t.asyncActions.loadChapterSubtitleEntries(o,n,e))}}},{key:"_renderMessage",value:function(){var e=null;return this.state.canPlayVideo&&(e=this.state.isViewExpanded?"Expand Mode: Learners see your full screen and can\u2019t follow along":"Collapse Mode: Learners can follow along by watching only the highlighted section of your cloud workspace"),u.createElement("div",{className:"upper-left-pane-message"},e)}},{key:"_getCurrentChapter",value:function(e){return e.course.chapters.find((function(t){return t.id===e.currentChapter}))||e.chapter}},{key:"className",get:function(){return"chapter-player-with-details"+(this.state.isViewExpanded?" expand-view-mode":"")}},{key:"chapter",get:function(){return this._getCurrentChapter(this.props)}},{key:"subtitle",get:function(){var e=this.props,t=e.chapter,r=e.subtitleLang;return t.subtitles.get(r)||t.subtitles.first()}},{key:"_screenWidth",get:function(){return this.state.videoDimm.width}},{key:"_screenHeight",get:function(){return this.state.videoDimm.height}},{key:"_verticalPadding",get:function(){return 75}}]),t}(Ze.a),yt.defaultProps={subtitleLang:P.Y.enUS},ft=vt,Object(k.a)(ft.prototype,"onPlayerRef",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onPlayerRef"),ft.prototype),Object(k.a)(ft.prototype,"onCaptionPlayerRef",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onCaptionPlayerRef"),ft.prototype),Object(k.a)(ft.prototype,"onViewboxToggle",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onViewboxToggle"),ft.prototype),Object(k.a)(ft.prototype,"onVideoDimmensions",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onVideoDimmensions"),ft.prototype),Object(k.a)(ft.prototype,"onCanPlay",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onCanPlay"),ft.prototype),Object(k.a)(ft.prototype,"onToggleAnnotationsModal",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onToggleAnnotationsModal"),ft.prototype),Object(k.a)(ft.prototype,"onExpandModeChange",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onExpandModeChange"),ft.prototype),Object(k.a)(ft.prototype,"onResize",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onResize"),ft.prototype),Object(k.a)(ft.prototype,"onTranscriptionsToggle",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onTranscriptionsToggle"),ft.prototype),Object(k.a)(ft.prototype,"onCCEdit",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onCCEdit"),ft.prototype),Object(k.a)(ft.prototype,"onCCEditModeChanged",[w.a],Object.getOwnPropertyDescriptor(ft.prototype,"onCCEditModeChanged"),ft.prototype),ft),Zt=function(){function e(t){Object(i.a)(this,e),this._instance=t}return Object(s.a)(e,[{key:"requestVm",value:function(){var e=this,t=this._instance,r=t.course,n=t.props;return r?n.dispatch(n.asyncActions.getCourseVMAndConnection(r,n.asyncActions)).then((function(t){var r;t instanceof P.lb?r=t:e._instance.course&&(r=e._instance.props.vms.get(e._instance.course.virtualMachineId)),r&&e._instance.setState({courseVmId:r.id})})):Promise.reject()}}]),e}(),Qt=(r(1697),r(1135)),$t=(r(1698),function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).diff=0,r.timerRef=void 0,r.state={timePassed:0},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.autoStart&&this.start(),this.props.onRef&&this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){this.stop(),this.props.onRef&&this.props.onRef(void 0)}},{key:"start",value:function(){var e=this,t=(new Date).getTime();!function r(){var n=(new Date).getTime()-t+e.diff;Math.round(t/1e3)!==Math.round(n/1e3)&&(e.setState({timePassed:n}),e.props.onTick&&e.props.onTick(n)),e.timerRef&&clearTimeout(e.timerRef),e.timerRef=setTimeout(r,100)}()}},{key:"stop",value:function(){this.diff=0,clearTimeout(this.timerRef)}},{key:"pause",value:function(){this.diff=this.state.timePassed,clearTimeout(this.timerRef)}},{key:"render",value:function(){var e=m.duration(this.state.timePassed),t=function(e){return 1===e.toString().length?"0"+e:e};return u.createElement("div",{className:"stopwatch tooltip rel b ra","data-tooltip":"Time spent using the cloud workspace"},u.createElement("div",{className:"clock"}),u.createElement("span",null,t(e.hours())+":"+t(e.minutes())+":"+t(e.seconds())))}}]),t}(u.Component)),er=(bt=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._stopwatch=void 0,r._gtmVmLaunchTime=null,r.state={connected:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onVmInit",value:function(){this._gtmVmLaunchTime=We.a.customizeVmLaunchTime(this.props.vm.id)}},{key:"onVmConnect",value:function(){this._stopwatch&&this._stopwatch.start(),this.setState({connected:!0}),this._gtmVmLaunchTime&&(this._gtmVmLaunchTime(),this._gtmVmLaunchTime=null)}},{key:"onVmDisconnect",value:function(){this._stopwatch&&this._stopwatch.pause(),this.setState({connected:!1})}},{key:"render",value:function(){var e=this,t=u.Children.map(this.props.children,(function(t){return u.cloneElement(t,{connected:e.state.connected})}));return u.createElement("div",{className:"customize-dashboard-vm"},u.createElement(Qt.a,{vm:this.props.vm,dispatch:this.props.dispatch,onReadWriteInit:this.onVmInit,onConnect:this.onVmConnect,onDisconnect:this.onVmDisconnect,controls:!0,asyncActions:this.props.asyncActions},u.createElement("div",{className:"cvm-wizard"},u.createElement("div",{className:"logo-container"},u.createElement("div",{className:"logo"}),u.createElement($t,{onRef:function(t){return e._stopwatch=t}})),u.createElement("h3",null,"Customize Cloud Workspace"),t)))}}]),t}(u.Component),Object(k.a)(bt.prototype,"onVmInit",[w.a],Object.getOwnPropertyDescriptor(bt.prototype,"onVmInit"),bt.prototype),Object(k.a)(bt.prototype,"onVmConnect",[w.a],Object.getOwnPropertyDescriptor(bt.prototype,"onVmConnect"),bt.prototype),Object(k.a)(bt.prototype,"onVmDisconnect",[w.a],Object.getOwnPropertyDescriptor(bt.prototype,"onVmDisconnect"),bt.prototype),bt),tr=(r(1699),gt=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._keyUpCb=void 0,r.state={stepIndex:0,completionInProgress:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keyup",this._keyUpCb=function(t){t.keyCode===ce.g&&e.state.stepIndex===e.props.children.length-1&&e.next()})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this._keyUpCb)}},{key:"prev",value:function(){this.state.stepIndex>0?this._changeStep(-1):this.props.onExit&&this.props.onExit()}},{key:"next",value:function(){var e=this;this.state.stepIndex<this.children.length-1?this._changeStep(1):this.props.onComplete&&(this.setState({completionInProgress:!0}),this.props.onComplete().catch((function(){e.setState({completionInProgress:!1})})))}},{key:"render",value:function(){var e=this.children.length,t=this.state.stepIndex,r=this.children[t];return u.createElement("div",{className:"step-wizard "+this.props.className},u.createElement("p",{className:"step-title"},this.children.length>1?"".concat(t+1,"/").concat(this.children.length,":"):""," ",r.props.title),this.children.map((function(e,r){return u.createElement("div",{key:"step-"+r,style:{display:t===r?"block":"none"}},e)})),u.createElement("div",{className:"controls"},u.createElement(T.b,{className:"btn small empty prev",onClick:this.prev,disabled:r.props.disablePrev||this.state.completionInProgress},0===t?"Cancel":"Back"),u.createElement(T.b,{className:"btn small next",onClick:this.next,disabled:r.props.disableNext,loading:this.state.completionInProgress},t===e-1?"Save":"Next")))}},{key:"_changeStep",value:function(e){var t=this;this.setState({stepIndex:this.state.stepIndex+e},(function(){t.props.onStepChange&&t.props.onStepChange(t.state.stepIndex)}))}},{key:"children",get:function(){return this.props.children instanceof Array?this.props.children:[this.props.children]}}]),t}(u.Component),Object(k.a)(gt.prototype,"prev",[w.a],Object.getOwnPropertyDescriptor(gt.prototype,"prev"),gt.prototype),Object(k.a)(gt.prototype,"next",[w.a],Object.getOwnPropertyDescriptor(gt.prototype,"next"),gt.prototype),gt),rr=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return this.props.children}}]),t}(u.Component),nr=(r(1700),r(1129)),or=r(1701),ar=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props;return u.createElement("div",{className:"custom-vm-file-uploader"},u.createElement(nr.a,{dispatch:e.dispatch,disabled:e.disabled,vms:[e.vm],remoteClientManager:e.remoteClientManager,label:u.createElement("span",{className:"ua-label"},u.createElement(T.b,{className:"empty"},"Upload file here"),u.createElement("p",{className:"size"},"Max 200MB")),uploadIcon:u.createElement("img",{src:or}),onFileUploadStart:e.onUploadStart,onCompleted:e.onUploadEnd,onError:e.onUploadEnd}))}}]),t}(u.PureComponent),ir=function(e){return u.createElement("div",{className:"file-upload-step step"},u.createElement(ar,{dispatch:e.dispatch,disabled:e.disabled,onUploadEnd:e.onUploadEnd,onUploadStart:e.onUploadStart,remoteClientManager:e.remoteClientManager,vm:e.vm}),u.createElement("ul",null,u.createElement("li",null,"Upload files you want learners to use during the session."),u.createElement("li",null,"You can also use any upload service like"," ",u.createElement("a",{href:"https://ufile.io",target:"_blank"},"ufile.io"),"."),u.createElement("li",null,"E.g., To teach Accounting, upload a sample statements file that you will ask learners to import to Excel.")))},sr=(r(1702),Ot=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={image:""},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.templateName===e.templateName&&this.props.valid===e.valid||!this.props.onTemplateNameUpdate||this.props.onTemplateNameUpdate(this.props.templateName||"",this.props.valid||!1)}},{key:"takeScreenshot",value:function(){var e=this,t=this.props.remoteClientManager.getRemoteClient(this.props.vm.id);if(t){var r=t.toDataURL("image/png",1,800,600,!1);r&&this.setState({image:r},(function(){e.props.onScreenshotUpdate(r)}))}}},{key:"render",value:function(){return u.createElement("div",{className:"step screenshot-step"},u.createElement(Yt,{image:this.state.image,onTakeScreenshot:this.takeScreenshot}),u.createElement("ul",null,u.createElement("li",null,"To make the cloud workspace easy to identify, set it in the right visual state and click \u201cTake Screenshot.\u201d"),u.createElement("li",null,"Finally, type a descriptive name and click \u201cSave.\u201d")),this.props.onTemplateNameUpdate&&u.createElement("h3",null,"Name This Cloud Workspace"),u.createElement("form",{name:"templateNameForm",style:{display:this.props.onTemplateNameUpdate?"block":"none"},onSubmit:function(e){return e.preventDefault()}},u.createElement(_.a,Object.assign({name:"templateName",type:"text",autoComplete:"off",component:T.s},{label:"Name"}))))}}]),t}(u.Component),Object(k.a)(Ot.prototype,"takeScreenshot",[w.a],Object.getOwnPropertyDescriptor(Ot.prototype,"takeScreenshot"),Ot.prototype),Ot),cr=Object(S.a)({form:"templateNameForm",validate:T.L})(sr),lr=Object(D.a)("templateNameForm"),pr=Object(j.c)((function(e){return{templateName:lr(e,"templateName")}}))(cr),ur=r(1703),dr=function(){return u.createElement("div",{className:"step"},u.createElement("div",{className:"image"},u.createElement("img",{src:ur})),u.createElement("ul",null,u.createElement("li",null,"Configure software (and Windows) so learners don\u2019t need to worry about it."),u.createElement("li",null,"E.g., Disable update prompts, set preferences, put files in Startup folder so they automatically open when session starts.")))},hr=r(1704),mr=function(){return u.createElement("div",{className:"step"},u.createElement("div",{className:"image"},u.createElement("img",{src:hr})),u.createElement("ul",null,u.createElement("li",null,"Use licenses that allow software to run on multiple instances."),u.createElement("li",null,"E.g., Use software with no install limits, use site-wide license, use per-user license, etc.")))},fr=r(1705),yr=function(){return u.createElement("div",{className:"step"},u.createElement("div",{className:"image"},u.createElement("img",{src:fr})),u.createElement("ul",null,u.createElement("li",null,"Install your software on the cloud workspace on the left."),u.createElement("li",null,"E.g., To teach Accounting, install Excel and Quickbooks."),u.createElement("li",null,"Click \u201cNext\u201d when done.")))},vr=(kt=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={image:""},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onScreenshotUpdate",value:function(e){this.setState({image:e})}},{key:"updateScreenshotAndExit",value:function(){var e=this;if(!this.props.template)return Promise.reject("Missing template");var t=new Blob([He.a.toArrayBuffer(this.state.image)],{type:"image/png"}),r=this.props.asyncActions.saveTemplateScreenshot(this.props.template,t);return this.props.dispatch(r).then((function(){e.props.dispatch(new v.i(new P.J({type:P.K.General,text:"Screenshot successfully updated"}))),e.exit()}))}},{key:"exit",value:function(){this.props.onExit()}},{key:"render",value:function(){return u.createElement(u.Fragment,null,u.createElement(tr,{className:"customize-vm-wizard",onComplete:this.updateScreenshotAndExit,onExit:this.exit},u.createElement(rr,{title:"Screenshot",disableNext:!this.state.image},u.createElement(pr,{dispatch:this.props.dispatch,remoteClientManager:this.props.remoteClientManager,vm:this.props.vm,onScreenshotUpdate:this.onScreenshotUpdate}))))}}]),t}(u.Component),Object(k.a)(kt.prototype,"onScreenshotUpdate",[w.a],Object.getOwnPropertyDescriptor(kt.prototype,"onScreenshotUpdate"),kt.prototype),Object(k.a)(kt.prototype,"updateScreenshotAndExit",[w.a],Object.getOwnPropertyDescriptor(kt.prototype,"updateScreenshotAndExit"),kt.prototype),Object(k.a)(kt.prototype,"exit",[w.a],Object.getOwnPropertyDescriptor(kt.prototype,"exit"),kt.prototype),kt),br=function(e){return u.createElement("div",{className:"step"},u.createElement(ar,{dispatch:e.dispatch,disabled:e.disabled,vm:e.vm,remoteClientManager:e.remoteClientManager,onUploadStart:e.onUploadStart,onUploadEnd:e.onUploadEnd}),u.createElement("ul",null,u.createElement("li",null,"Install software, upload files, modify software licenses, configure software or operating system, etc."),u.createElement("li",null,"You can also use any upload service like"," ",u.createElement("a",{href:"https://ufile.io",target:"_blank"},"ufile.io"),"."),u.createElement("li",null,"When you are done, click \u201cSave\u201d")))},gr=(Ct=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={uploading:!1,isLeaveModalVisible:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onUploadStart",value:function(){this.setState({uploading:!0})}},{key:"onUploadEnd",value:function(){this.setState({uploading:!1})}},{key:"updateAndExit",value:function(){var e=this;if(this.props.template){var t=this.props,r=t.dispatch,n=t.asyncActions;return r(n.updateTemplateImage(this.props.vm,this.props.template)).then((function(){r(new v.i(new P.J({type:P.K.General,text:"Cloud workspace succesfully updated"}))),e.props.onExit()}))}}},{key:"exit",value:function(){this.onToggleLeaveModal(!0)}},{key:"onToggleLeaveModal",value:function(e){this.setState({isLeaveModalVisible:e})}},{key:"onExit",value:function(){return this.props.onExit(),Promise.resolve()}},{key:"render",value:function(){return u.createElement(u.Fragment,null,u.createElement(tr,{className:"customize-vm-wizard",onComplete:this.updateAndExit,onExit:this.exit},u.createElement(rr,{title:this.props.template?this.props.template.name:"",disablePrev:this.state.uploading,disableNext:this.state.uploading||!this.props.connected},u.createElement(br,{dispatch:this.props.dispatch,disabled:!this.props.connected,remoteClientManager:this.props.remoteClientManager,vm:this.props.vm,onUploadStart:this.onUploadStart,onUploadEnd:this.onUploadEnd}))),u.createElement(Ye.a,{visible:this.state.isLeaveModalVisible,onToggle:this.onToggleLeaveModal,onResolve:this.onExit}))}}]),t}(u.Component),Object(k.a)(Ct.prototype,"onUploadStart",[w.a],Object.getOwnPropertyDescriptor(Ct.prototype,"onUploadStart"),Ct.prototype),Object(k.a)(Ct.prototype,"onUploadEnd",[w.a],Object.getOwnPropertyDescriptor(Ct.prototype,"onUploadEnd"),Ct.prototype),Object(k.a)(Ct.prototype,"updateAndExit",[w.a],Object.getOwnPropertyDescriptor(Ct.prototype,"updateAndExit"),Ct.prototype),Object(k.a)(Ct.prototype,"exit",[w.a],Object.getOwnPropertyDescriptor(Ct.prototype,"exit"),Ct.prototype),Object(k.a)(Ct.prototype,"onToggleLeaveModal",[w.a],Object.getOwnPropertyDescriptor(Ct.prototype,"onToggleLeaveModal"),Ct.prototype),Object(k.a)(Ct.prototype,"onExit",[w.a],Object.getOwnPropertyDescriptor(Ct.prototype,"onExit"),Ct.prototype),Ct),Or=r(1064),kr=r(1128),Cr=function(e,t){var r=[];if(e)for(var n=Er(e,t.chapters),o=0;o<e.count();o++){var a=n.get(o),i=e.get(o),s=wr(a,i);if(!i.id||s.length){var c=void 0;c=i.id?"Task ".concat(o+1," has changed ").concat(s.join(", ")):"Task ".concat(o+1," is not saved"),r.push({title:c})}}return r},wr=function(e,t){var r=["type","name","description"],n=[];return e?e.id&&t.id&&e.id!==t.id?n.push("order"):r.forEach((function(r){e[r]!==t[r]&&n.push(r)})):n.push.apply(n,r),n},jr=function(e,t){return e.find((function(e){return e.order===t}))},Er=function(e,t){var r;if(t.count()!==e.count()){for(var n=[],o=1;o<=e.count();o++){var a=jr(t,o);a||(a=e.get(o-1)),n.push(a)}r=Object($.List)(n)}else r=t;return r},_r=(r(1706),wt={},Object(Q.a)(wt,P.L.Linux,"Ubuntu 18.04 LTS"),Object(Q.a)(wt,P.L.Win,"Windows Server 2019"),Object(Q.a)(wt,P.L.Docker,"Virtual Browser"),wt),Sr=new Map([[P.L.Win,"Google Chrome, Firefox, Git, Github Desktop, Visual Studio Code, Sublime Text, Vim, Emacs, Python 3,\n    Ruby, NodeJS, R, R Studio, JDK 8, Java, Go, .NET, LibreOffice, VLC"],[P.L.Linux,"Google Chrome, Firefox, Chromium, Git, Visual Studio Code, Sublime Text, Vim, Emacs, Python 3, Ruby,\n    NodeJS, R, R Studio, JDK 8, Java, Go, .NET, LibreOffice, VLC"],[P.L.Docker,"Virtual Browser should be used for projects involving web applications only. \n    Virtual Browsers provide learners a faster and seamless learning experience with web \n    applications as opposed to the other cloud workspaces which are designed for projects involving desktop applications."]]),Dr=(jt=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"close",value:function(){this.props.onToggle(!1)}},{key:"render",value:function(){return u.createElement("div",{className:"software-details-modal"},u.createElement(R.a,{title:"".concat(this.props.template.name," Cloud Workspace").concat(this.props.template.os!==P.L.Docker?" - Installed Software":""),visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("div",{className:"software-list"},this.props.template.os!==P.L.Docker?" ".concat(_r[this.props.template.os]," with "):"",this._getDescription(this.props.template)),u.createElement(T.a,{onClick:this.close},"Okay")))}},{key:"_getDescription",value:function(e){return Sr.get(e.os)||""}}]),t}(u.Component),Object(k.a)(jt.prototype,"close",[w.a],Object.getOwnPropertyDescriptor(jt.prototype,"close"),jt.prototype),jt),Pr=(r(1707),Et=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={isSaving:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onPrimaryAction",value:function(){var e=this;this.props.saveable?(this.setState({isSaving:!0}),this.props.onSave().then((function(){return e.props.onToggle(!1)})).finally((function(){return e.setState({isSaving:!1})}))):this.props.onToggle(!1)}},{key:"onDiscard",value:function(){this.props.onDiscard(),this.props.onToggle(!1)}},{key:"render",value:function(){return u.createElement("div",{className:"unsaved-changes-modal form-styles"},u.createElement(R.a,{title:"Unsaved Changes",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("p",{className:"text"},this.props.saveable?u.createElement(u.Fragment,null,'Your "',this.props.title,'" has unsaved changes. Do you want to save them before leaving?'):u.createElement(u.Fragment,null,'Your "',this.props.title,'" has incomplete changes. Do you want to go back and complete them before leaving?')),!!this.props.changes.length&&u.createElement("ul",null,this.props.changes.map((function(e,t){return u.createElement("li",{key:"ucm-c-"+t},"Change ",e.title," ",e.content&&u.createElement(u.Fragment,null,"to ",u.createElement("strong",null,e.content)))})).slice(0,5)),u.createElement("div",{className:"row"},u.createElement(T.a,{onClick:this.onPrimaryAction,loading:this.state.isSaving},this.props.saveable?"Yes, Save":"Yes, Go Back"),u.createElement(T.a,{className:"empty",onClick:this.onDiscard,disabled:this.state.isSaving},"No, Discard")),u.createElement("div",{className:"trash-icon"})))}}]),t}(u.Component),Object(k.a)(Et.prototype,"onPrimaryAction",[w.a],Object.getOwnPropertyDescriptor(Et.prototype,"onPrimaryAction"),Et.prototype),Object(k.a)(Et.prototype,"onDiscard",[w.a],Object.getOwnPropertyDescriptor(Et.prototype,"onDiscard"),Et.prototype),Et),Tr=(r(1708),r(1078)),Rr=(r(1709),r(1470)),xr=(_t=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={forgotPassVisible:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"submit",value:function(e){this.props.onConfirm(this.props.confirmPassword||""),this.props.onToggle(!1),this.props.dispatch(Object(E.b)("confirmChanges")),e.preventDefault()}},{key:"forgotPassword",value:function(){this.toggleForgotPass(!0)}},{key:"toggleForgotPass",value:function(e){this.setState({forgotPassVisible:e})}},{key:"render",value:function(){return u.createElement("div",{className:"confirm-size-change-modal form-styles"},u.createElement(R.a,{title:"Confirm Changes",transparent:this.state.forgotPassVisible,visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("p",{className:"text"},"Your cloud workspace's hourly cost will change from $TODO to $TODO. Please confirm these changes"),u.createElement("form",{name:"confirmChanges",onSubmit:this.submit},u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"confirmPassword",type:"password",autoFocus:!0,component:T.s},{label:"Current Password"}))),u.createElement("div",{className:"row"},u.createElement(T.a,{disabled:!this.props.valid||!this.props.confirmPassword},"Save"))),u.createElement("a",{href:"javascript:void(0);",onClick:this.forgotPassword},"Forgot password?"),u.createElement("div",{className:"description"},"How will I be charged?",u.createElement("br",null),"You will be charged $TODO /hour for each cloud workspace you or your learners use. Time is measured in 15 mins multiples",u.createElement("br",null),u.createElement("br",null),"Example:",u.createElement("br",null),"For a 27 mins session with 2 learners, you pay: $TODO x 0.5 hours x ( 2 learners + 1 host ) +"," ",g.a," (credit card processing) = $TODO")),u.createElement(Rr.a,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,visible:this.state.forgotPassVisible,onToggle:this.toggleForgotPass}))}}]),t}(u.Component),Object(k.a)(_t.prototype,"submit",[w.a],Object.getOwnPropertyDescriptor(_t.prototype,"submit"),_t.prototype),Object(k.a)(_t.prototype,"forgotPassword",[w.a],Object.getOwnPropertyDescriptor(_t.prototype,"forgotPassword"),_t.prototype),Object(k.a)(_t.prototype,"toggleForgotPass",[w.a],Object.getOwnPropertyDescriptor(_t.prototype,"toggleForgotPass"),_t.prototype),_t),Nr=Object(S.a)({form:"confirmChanges",validate:T.E})(xr),Mr=Object(D.a)("confirmChanges"),Vr=Object(j.c)((function(e){return{confirmPassword:Mr(e,"confirmPassword")}}))(Nr),Ar=(r(1710),r(1711),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"changeView",value:function(e){this.props.onViewChange(e)}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"views-toolbar"},u.createElement("div",{className:"views"},this.props.views.map((function(t){return u.createElement("div",{key:t,className:e.props.view===t?"active":"",onClick:function(){return e.changeView(t)}},e.props.messages[t])}))))}}]),t}(u.Component)),Ir=(St={},Object(Q.a)(St,P.B.One,"1"),Object(Q.a)(St,P.B.OneToFour,"1-4"),Object(Q.a)(St,P.B.FiveToNine,"5-9"),Object(Q.a)(St,P.B.TenToNineteen,"10-19"),Object(Q.a)(St,P.B.TwentyPlus,"20+"),St),Ur=function(e,t){return e.startTime.getTime()-t.startTime.getTime()};!function(e){e.Upcoming="Upcoming",e.Past="Past"}(Pt||(Pt={}));var Lr,Fr,Br,zr,Hr=(Dt=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={view:Pt.Upcoming},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"changeView",value:function(e){this.setState({view:e})}},{key:"formatRoomTime",value:function(e){var t=e.startTime,r=e.endTime?e.endTime:e.expirationTime;return"".concat(m(t).format("h:mma")," - ").concat(m(r).format("h:mma"))}},{key:"formatRoomDay",value:function(e){return m(e.startTime).format("ddd MMM D")}},{key:"getTemplate",value:function(e){var t=this.props.courses.get(e.courseId);return this.props.templates.get(t.templateId)}},{key:"render",value:function(){var e=this;if(!this.props.rooms.size)return null;var t=this.upcomingRooms;return this.state.view===Pt.Past&&(t=this.passedRooms),u.createElement("div",{className:"related-sessions"},u.createElement("div",{className:"sep-line","data-text":"Related Sessions"}),u.createElement("div",null,u.createElement(Ar,{messages:Pt,views:[Pt.Upcoming,Pt.Past],view:this.state.view,onViewChange:this.changeView})),u.createElement("table",null,u.createElement("thead",null,u.createElement("tr",null,u.createElement("th",{colSpan:2},"Date & Time"),u.createElement("th",null,"Name"),u.createElement("th",null,"Learners"),u.createElement("th",null,"Rate"),u.createElement("th",null,"Cost"))),u.createElement("tbody",null,t.size?t.map((function(t,r){var n=e.getTemplate(t),o=e.props.templateTypes.find((function(e){return e.default===n.defaultTemplate&&e.os===n.os}))||new P.cb,a=o.ownPrice,i=o.currency;return u.createElement("tr",{key:"rd-"+r},u.createElement("td",null,e.formatRoomDay(t)),u.createElement("td",null,e.formatRoomTime(t)),u.createElement("td",null,e.props.courses.get(t.courseId).name),u.createElement("td",null,e._renderAttendees(t)),u.createElement("td",null,x.a[i]," ",Object(x.b)(a)),u.createElement("td",null,t.cost&&t.cost.total?"".concat(x.a[t.cost.currency]," ").concat(Object(x.b)(t.cost.total)):"-"))})):u.createElement("tr",null,u.createElement("td",{style:{textAlign:"center"},colSpan:6},"No sessions")))))}},{key:"_renderAttendees",value:function(e){return this.state.view===Pt.Upcoming?Ir[e.expectedAttendees]+" (expected)":e.cost?e.cost.costs.size:"Processing"}},{key:"upcomingRooms",get:function(){var e=new Date;return this.props.rooms.filter((function(t){return t.startTime>e})).sort(Ur)}},{key:"passedRooms",get:function(){return this.props.rooms.filter((function(e){return Object(Tr.h)(e)})).sort(Ur)}}]),t}(u.Component),Object(k.a)(Dt.prototype,"changeView",[w.a],Object.getOwnPropertyDescriptor(Dt.prototype,"changeView"),Dt.prototype),Dt),Wr=(Lr={},Object(Q.a)(Lr,P.L.Win,u.createElement("i",{className:"fa fa-windows"})),Object(Q.a)(Lr,P.L.Linux,u.createElement("div",{className:"ubuntu"})),Lr),Kr=(Fr={},Object(Q.a)(Fr,P.db.ThreeMonths,"3 months of no usage"),Object(Q.a)(Fr,P.db.SixMonths,"6 months of no usage"),Object(Q.a)(Fr,P.db.OneYear,"12 months of no usage"),Fr);!function(e){e.Customize="Customize",e.ChangeScreenshot="Change Screenshot"}(zr||(zr={}));var Yr,Gr,qr,Jr,Xr,Zr,Qr,$r=(Br=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._unsavedChangesAction=void 0,r._formRef=void 0,r.state={confirmChangesVisible:!1,confirmDeleteVisible:!1,unsavedChangesVisible:!1,loading:!1,isDuplicatedVM:!1,isPreparingToCustomize:!1,isPreparingToUpdateScreenshot:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.template.state!==P.bb.Ready&&e.visible&&this.props.onToggle(!1)}},{key:"submit",value:function(e){var t=this;return e&&(e.preventDefault(),e.persist()),this.props.template.templateSize!==this.props.size?(this.toggleConfirmChanges(!0),Promise.reject("Needs confirmation")):this.saveChanges().then((function(){e&&e.target===t._formRef&&t.props.onToggle(!1)}))}},{key:"saveChanges",value:function(e){var t=this,r=this.props.template.withMutations((function(e){return e.set("name",t.props.templateName).set("templateSize",t.props.size).set("terminateAfter",t.props.terminate)}));return this.state.isDuplicatedVM?this._duplicate(this.props.template.id,r):this._update(r,e)}},{key:"attemptDelete",value:function(){this.toggleConfirmDelete()}},{key:"deleteVm",value:function(){var e=this;return this.props.dispatch(this.props.asyncActions.deleteTemplate(this.props.template)).then((function(){e.props.dispatch(new v.i(new P.J({type:P.K.General,text:"Cloud workspace successfully deleted"}))),e.props.onToggle(!1)}))}},{key:"customize",value:function(){var e=this;this._validateAction(zr.Customize)&&(this._unsavedChangesAction=function(){return e.setState({isPreparingToCustomize:!0}),e.props.onCustomize(e.props.template).catch((function(){return e.setState({isPreparingToCustomize:!1})}))},this.props.pristine?this._unsavedChangesAction():this.toggleUnsavedChanges(!0))}},{key:"duplicate",value:function(){this.setState({isDuplicatedVM:!0}),this.props.dispatch(Object(E.a)("vmDetails","templateName",this.props.templateName+" - Duplicate"))}},{key:"screenshotUpdate",value:function(){var e=this;this._validateAction(zr.ChangeScreenshot)&&(this._unsavedChangesAction=function(){return e.setState({isPreparingToUpdateScreenshot:!0}),e.props.onScreenshotUpdate(e.props.template).catch((function(){return e.setState({isPreparingToUpdateScreenshot:!1})}))},this.props.pristine?this._unsavedChangesAction():this.toggleUnsavedChanges(!0))}},{key:"cancel",value:function(e){e.preventDefault(),this.props.dispatch(Object(E.b)("vmDetails")),this.props.onToggle(!1)}},{key:"toggleConfirmChanges",value:function(e){this.setState({confirmChangesVisible:e})}},{key:"toggleConfirmDelete",value:function(){this.setState({confirmDeleteVisible:!this.state.confirmDeleteVisible})}},{key:"toggleUnsavedChanges",value:function(e){this.setState({unsavedChangesVisible:e})}},{key:"unsavedChangesSave",value:function(){var e=this,t=this.submit();return t.then((function(){return e._unsavedChangesAction?e._unsavedChangesAction():Promise.resolve()})),t}},{key:"unsavedChangesDiscard",value:function(){this.props.reset(),this._unsavedChangesAction&&this._unsavedChangesAction()}},{key:"formChanges",value:function(){var e=[],t=this.props.initialValues;return t.templateName!==this.props.templateName&&e.push({title:"Name",content:this.props.templateName}),t.size!==this.props.size&&e.push({title:"Size",content:this.props.size}),t.terminate!==this.props.terminate&&e.push({title:"Terminate After",content:this.props.terminate?Kr[this.props.terminate]:""}),e}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"vm-details-modal form-styles"},u.createElement(R.a,{visible:this.props.visible,transparent:this.transparent,scrollable:!0,title:this.state.isDuplicatedVM?"Duplicate Cloud Workspace":"Cloud Workspace Details",onToggle:this.props.onToggle},u.createElement("div",{className:"vm-actions"},u.createElement(T.a,{className:"empty small purple",onClick:this.customize,disabled:this.state.isDuplicatedVM||this.state.isPreparingToUpdateScreenshot,loading:this.state.isPreparingToCustomize},"Customize"),u.createElement(T.a,{className:"empty small purple",onClick:this.duplicate,disabled:this.isDuplicateDisabled},"Duplicate")),u.createElement("div",{className:"os-logo"+(this.state.isDuplicatedVM?" duplicated":"")},Wr[this.props.template.os]),u.createElement("div",{className:"modal-content"},this.state.isDuplicatedVM?u.createElement("div",{className:"duplicate-message"},'Note: This duplicate cloud workspace is not saved yet. Please make any changes and click "Save"'):null,u.createElement("form",{name:"vmDetails",onSubmit:this.submit,ref:function(t){return e._formRef=t}},u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"templateName",component:T.s,autoComplete:"off"},{label:"Name"}))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"size",component:T.u},{label:"Size"},{disabled:!0}),u.createElement(T.n,{value:P.ab.Micro},Object(g.f)(P.ab.Micro,"???")),u.createElement(T.n,{value:P.ab.Small},Object(g.f)(P.ab.Small,"???")),u.createElement(T.n,{value:P.ab.Medium},Object(g.f)(P.ab.Medium,"???")),u.createElement(T.n,{value:P.ab.Large},Object(g.f)(P.ab.Large,"???")),u.createElement(T.n,{value:P.ab.XLarge},Object(g.f)(P.ab.XLarge,"???")),u.createElement(T.n,{value:P.ab.XXLarge},Object(g.f)(P.ab.XXLarge,"???")),u.createElement(T.n,{value:P.ab.GPUMicro},Object(g.f)(P.ab.GPUMicro,"???")),u.createElement(T.n,{value:P.ab.GPUSmall},Object(g.f)(P.ab.GPUSmall,"???")),u.createElement(T.n,{value:P.ab.GPUMedium},Object(g.f)(P.ab.GPUMedium,"???")),u.createElement(T.n,{value:P.ab.GPULarge},Object(g.f)(P.ab.GPULarge,"???")),u.createElement(T.n,{value:P.ab.MemMicro},Object(g.f)(P.ab.MemMicro,"???")),u.createElement(T.n,{value:P.ab.MemSmall},Object(g.f)(P.ab.MemSmall,"???")))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"terminate",component:T.u},{label:"Terminate After"}),u.createElement(T.n,{value:P.db.ThreeMonths},Kr[P.db.ThreeMonths]),u.createElement(T.n,{value:P.db.SixMonths},Kr[P.db.SixMonths]),u.createElement(T.n,{value:P.db.OneYear},Kr[P.db.OneYear])),u.createElement("p",{className:"field-info"},"Cloud workspace will be permanently terminated after no usage for this period")),u.createElement("div",{className:"row"},u.createElement(Yt,{image:this.props.template.screenshotUrl,onTakeScreenshot:this.screenshotUpdate,width:320,height:240,disabled:this.state.isDuplicatedVM||this.state.isPreparingToCustomize,loading:this.state.isPreparingToUpdateScreenshot})),u.createElement("div",{className:"row"},u.createElement("div",{className:"form-actions"},u.createElement(T.a,{className:"empty",onClick:this.cancel},"Cancel"),u.createElement(T.a,{disabled:this.formSaveable,loading:this.state.loading},"Save")),this.state.isDuplicatedVM?null:u.createElement("p",{className:"field-info delete"},u.createElement("a",{href:"javascript:void(0);",onClick:this.attemptDelete},"Delete Cloud Workspace")))),this.state.isDuplicatedVM?null:u.createElement(Hr,{rooms:this.templateRooms,courses:this.props.courses,templates:this.props.templates,templateTypes:this.props.templateTypes}))),u.createElement(Vr,{tempplate:this.props.template,newSize:this.props.size,visible:this.state.confirmChangesVisible,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,onToggle:this.toggleConfirmChanges,onConfirm:this.saveChanges}),u.createElement(Ae.a,{visible:this.state.confirmDeleteVisible,title:"Delete Cloud Workspace",messages:['Are you sure you want to delete cloud workspace "'.concat(this.props.template.name,'"?')],onClose:this.toggleConfirmDelete,onDelete:this.deleteVm}),u.createElement(Pr,{title:"Cloud Workspace Details",visible:this.state.unsavedChangesVisible,onToggle:this.toggleUnsavedChanges,changes:this.formChanges(),saveable:!this.formSaveable,onSave:this.unsavedChangesSave,onDiscard:this.unsavedChangesDiscard}))}},{key:"_update",value:function(e,t){var r=this;return this.setState({loading:!0}),this.props.dispatch(this.props.asyncActions.updateTemplate(e,t)).catch((function(){return r.setState({loading:!1})}))}},{key:"_duplicate",value:function(e,t){var r=this;return this.setState({loading:!0}),this.props.dispatch(this.props.asyncActions.duplicateTemplate(e,t)).then((function(){r.props.dispatch(new v.i(new P.J({type:P.K.General,text:"Cloud workspace successfully duplicated"})))})).finally((function(){return r.setState({loading:!1})}))}},{key:"_validateAction",value:function(e){var t;if(this.isTemplateUsedInAboutToStartSession?t="about to start":this.isTemplateUsedInRunningSession&&(t="already running"),t){var r=e===zr.Customize?"customize the cloud workspace":"change the cloud workspace's screenshot";return this.props.dispatch(new v.i(new P.J({type:P.K.Error,title:"Cannot ".concat(e),text:"Cannot ".concat(r,". It is used by a session that is ").concat(t)}))),!1}return!0}},{key:"transparent",get:function(){return this.state.confirmChangesVisible||this.state.confirmDeleteVisible||this.state.unsavedChangesVisible||this.props.transparent}},{key:"templateRooms",get:function(){return Object(Tr.b)(this.props.template,this.props.courses,this.props.rooms)}},{key:"formSaveable",get:function(){return!(this.props.valid&&!this.props.pristine)}},{key:"isTemplateUsedInAboutToStartSession",get:function(){return Object(Tr.j)(this.props.template,this.props.courses,this.props.rooms)}},{key:"isTemplateUsedInRunningSession",get:function(){return Object(Tr.k)(this.props.template,this.props.courses,this.props.rooms)}},{key:"isDuplicateDisabled",get:function(){return this.state.isDuplicatedVM||this.state.isPreparingToCustomize||this.state.isPreparingToUpdateScreenshot}}]),t}(u.Component),Object(k.a)(Br.prototype,"submit",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"submit"),Br.prototype),Object(k.a)(Br.prototype,"saveChanges",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"saveChanges"),Br.prototype),Object(k.a)(Br.prototype,"attemptDelete",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"attemptDelete"),Br.prototype),Object(k.a)(Br.prototype,"deleteVm",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"deleteVm"),Br.prototype),Object(k.a)(Br.prototype,"customize",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"customize"),Br.prototype),Object(k.a)(Br.prototype,"duplicate",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"duplicate"),Br.prototype),Object(k.a)(Br.prototype,"screenshotUpdate",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"screenshotUpdate"),Br.prototype),Object(k.a)(Br.prototype,"cancel",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"cancel"),Br.prototype),Object(k.a)(Br.prototype,"toggleConfirmChanges",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"toggleConfirmChanges"),Br.prototype),Object(k.a)(Br.prototype,"toggleConfirmDelete",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"toggleConfirmDelete"),Br.prototype),Object(k.a)(Br.prototype,"toggleUnsavedChanges",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"toggleUnsavedChanges"),Br.prototype),Object(k.a)(Br.prototype,"unsavedChangesSave",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"unsavedChangesSave"),Br.prototype),Object(k.a)(Br.prototype,"unsavedChangesDiscard",[w.a],Object.getOwnPropertyDescriptor(Br.prototype,"unsavedChangesDiscard"),Br.prototype),Br),en=Object(S.a)({form:"vmDetails",validate:T.L,enableReinitialize:!0})($r),tn=Object(D.a)("vmDetails"),rn=Object(j.c)((function(e,t){return{templateName:tn(e,"templateName"),size:tn(e,"size"),terminate:tn(e,"terminate"),initialValues:{templateName:t.template.name,size:t.template.templateSize,terminate:t.template.terminateAfter}}}))(en),nn=(Yr=function(){function e(t){Object(i.a)(this,e),this._instance=t}return Object(s.a)(e,[{key:"onRecordChapter",value:function(e){var t=this;this._instance.setState({chapterToBeRecorded:e},(function(){t._instance.hasUnsavedChanges?t._instance.onToggleUnsavedChangesModal():t._instance.recordChapter()}))}},{key:"onPreviewChapter",value:function(e){var t=this;this._instance.setState({chapterToBePreviewed:e},(function(){t._instance.hasUnsavedChanges?t._instance.onToggleUnsavedChangesModal():t._instance.previewChapter()}))}},{key:"onSaveUnsavedChanges",value:function(){var e=this;if(!this._instance.props.valid&&this.chaptersListRenderedComponent)return this.chaptersListRenderedComponent.showValidation(),this._instance.props.dispatch(new v.i(new P.J({type:P.K.Error,title:"Invalid fields",text:"The changes cannot be saved. Please verify all required fields have values"}))),this._instance.onToggleUnsavedChangesModal(),Promise.reject("The form is not valid");this._instance.setState({isSaving:!0});var t=this._instance.saveUnsavedChanges().then((function(){return e.proceedAction()}));return t.finally((function(){return e._instance.setState({isSaving:!1})})),t}},{key:"saveUnsavedChapters",value:function(){var e=[],t=this._chaptersToBeCreated(),r=this._chaptersToBeUpdated(),n=this._instance.props,o=n.asyncActions,a=n.course,i=n.dispatch;return t.count()&&e.push(i(o.createBatchChapters(a,t.toList()))),r.count()&&e.push(i(o.updateBatchChapters(a,r.toList()))),Promise.all(e)}},{key:"discardUnsavedChanges",value:function(){var e=this._chaptersToBeCreated(),t=this._instance.props,r=t.asyncActions,n=t.course,o=t.dispatch,a=t.initialValues;if(e.size>0){var i=a.chapters.toMap().mapEntries((function(e){var t=Object(Le.a)(e,2),r=(t[0],t[1]);return[r.id,r.order]})),s=this._chaptersToBeUpdated().sort((function(e,t){return e.order-t.order})).map((function(e,t){return e.set("order",t+1)})).filter((function(e){return e.order!==i.get(e.id)}));if(s.size)return o(r.updateBatchChapters(n,s))}else{var c=a.chapters.groupBy((function(e){return e.order})).find((function(e){return e.size>1}));if(c){var l=a.chapters.max((function(e,t){return e.order-t.order})).order,p=c.last().set("order",l+1);return o(r.updateBatchChapters(n,Object($.List)([p])))}}return Promise.resolve()}},{key:"proceedAction",value:function(){this._instance.state.chapterToBePreviewed?this._instance.previewChapter():this._instance.state.chapterToBeRecorded&&this._instance.recordChapter()}},{key:"_chaptersToBeCreated",value:function(){return this._instance.props.chapters.filter((function(e){return!e.id}))}},{key:"_chaptersToBeUpdated",value:function(){var e=this._instance.props.initialValues.chapters;return this._instance.props.chapters.filter((function(t,r){return t!==e.get(r)&&!!t.id}))}},{key:"chaptersListRenderedComponent",get:function(){return this._instance.chaptersListRef?this._instance.chaptersListRef.getRenderedComponent():null}}]),e}(),Object(k.a)(Yr.prototype,"onRecordChapter",[w.a],Object.getOwnPropertyDescriptor(Yr.prototype,"onRecordChapter"),Yr.prototype),Object(k.a)(Yr.prototype,"onPreviewChapter",[w.a],Object.getOwnPropertyDescriptor(Yr.prototype,"onPreviewChapter"),Yr.prototype),Object(k.a)(Yr.prototype,"onSaveUnsavedChanges",[w.a],Object.getOwnPropertyDescriptor(Yr.prototype,"onSaveUnsavedChanges"),Yr.prototype),Yr),on=r(1191),an=(Gr=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o))))._tooltipRef=void 0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onConfirm",value:function(){this._tooltipRef.hide(),this.props.onConfirm()}},{key:"onDecline",value:function(){this._tooltipRef.hide()}},{key:"onLinkClick",value:function(){this.props.skip?this.props.onConfirm():this._tooltipRef.show()}},{key:"render",value:function(){var e=this;return u.createElement(on.a,{className:"change-context-tooltip",ref:function(t){return e._tooltipRef=t}},u.createElement(u.Fragment,null,"There are unsaved changes that will be lost.",u.createElement("br",null),"Would you like to continue?"," ",u.createElement("a",{href:"javascript:void(0);",onClick:this.onDecline},"No")," ","/"," ",u.createElement("a",{href:"javascript:void(0);",onClick:this.onConfirm},"Yes")),u.createElement("a",{href:"javascript:void(0);",onClick:this.onLinkClick},this.props.children))}}]),t}(u.Component),Object(k.a)(Gr.prototype,"onConfirm",[w.a],Object.getOwnPropertyDescriptor(Gr.prototype,"onConfirm"),Gr.prototype),Object(k.a)(Gr.prototype,"onDecline",[w.a],Object.getOwnPropertyDescriptor(Gr.prototype,"onDecline"),Gr.prototype),Object(k.a)(Gr.prototype,"onLinkClick",[w.a],Object.getOwnPropertyDescriptor(Gr.prototype,"onLinkClick"),Gr.prototype),Gr),sn=(r(1712),qr=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onCancel",value:function(){this.props.onCancel(),this.props.onToggle(!1)}},{key:"onSave",value:function(){this.props.onSave(),this.props.onToggle(!1)}},{key:"render",value:function(){return u.createElement("div",{className:"chapters-order-modal form-styles"},u.createElement(R.a,{title:"Are you sure?",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("p",{className:"text"},"If you change the order of tasks, then the state of your cloud workspace students see may not match with the state of their own cloud workspaces. Are you sure you want to change the order?"),u.createElement("div",null,u.createElement(T.a,{onClick:this.onCancel,className:"short-btn"},"No, Cancel")),u.createElement("div",null,u.createElement(T.a,{onClick:this.onSave,className:"short-btn empty"},"Yes, Change")),u.createElement("i",{className:"fa fa-list-ol"})))}}]),t}(u.Component),Object(k.a)(qr.prototype,"onCancel",[w.a],Object.getOwnPropertyDescriptor(qr.prototype,"onCancel"),qr.prototype),Object(k.a)(qr.prototype,"onSave",[w.a],Object.getOwnPropertyDescriptor(qr.prototype,"onSave"),qr.prototype),qr),cn=(r(1713),r(1136)),ln=(Jr=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={done:!!r.props.course.resourcesUrl,progress:0,files:[]},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onFiles",value:function(e){var t=this;this.setState({files:e,done:!1});var r=e[0],n=r.name.split("."),o=n[n.length-1];this.props.dispatch(this.props.asyncActions.uploadCourseResources(this.props.course,r,o,(function(e,r){return t.setState({progress:r/e})}))).then((function(){t.props.dispatch(new v.i(new P.J({type:P.K.General,text:"File successfully uploaded"}))),t.setState({done:!0})}))}},{key:"render",value:function(){var e=this.props.course.resourcesUrl;return u.createElement("div",{className:"course-file-archive-uploader"},u.createElement(cn.a,{dispatch:this.props.dispatch,currentFile:1,currentProgress:this.state.progress,done:this.state.done,files:this.state.files,onFiles:this.onFiles,fileLimit:1,label:"Upload a resource file (e.g. zip) to email to learners",filesUploadedLabel:"Uploaded a resource file (e.g. zip) to email to learners. Re-upload?",filters:{maxSize:pe.a.FileSizeLimitCourseResource}}),u.createElement(G.a,{position:"left"},"On completion, auto-email learners with a resource file (e.g. zip)"),e&&u.createElement("p",{className:"file-link"},u.createElement("a",{href:e},"Download current resource file")))}}]),t}(u.Component),Object(k.a)(Jr.prototype,"onFiles",[w.a],Object.getOwnPropertyDescriptor(Jr.prototype,"onFiles"),Jr.prototype),Jr),pn=r(1714),un=r.n(pn),dn=r(437),hn=r(1137),mn=(r(1716),r(1717),pe.a.FileSizeLimitImage/1048576),fn={width:200,height:200},yn=600,vn=350,bn=(Xr=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._cropper=void 0,r.state={tracking:!1,loading:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.image&&!e.image&&this.props.faceRecognition&&this._performFaceRecognition(this.props.image)}},{key:"onFiles",value:function(e){var t=this;if(e&&this._validateFileNumber(e)&&this._validateFileType(e)&&this._validateFileSize(e)){var r=new FileReader;r.onload=function(){var e=r.result,n=new Image;n.onload=function(){t._validateImageSize(n)&&t.props.onImageLoad(n)},n.onerror=t._handleCorruptedImage.bind(t),n.src=e},r.readAsDataURL(e[0])}}},{key:"cropAndSave",value:function(){var e=this;if(this.setState({loading:!0}),this._cropper){var t=this._cropper.getCroppedCanvas();this.props.downscaleImage&&(t=Object(dn.a)(t,this.downscaleSize));var r=this.props,n=r.mimeType,o=r.quality;t.toBlob((function(t){e.props.onImageSave(t).catch((function(){return e.setState({loading:!1})}))}),n||"image/png",o||1)}else console.error("Cropper not initialized")}},{key:"cropperSize",value:function(e){var t=e.width,r=e.height,n=vn,o=t/r*n;return o>yn&&(n=r/t*(o=yn)),{width:o,height:n}}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"image-uploader"},this.props.image?u.createElement("div",{className:"cropper"},this.state.tracking&&u.createElement("div",{className:"tracking",style:this.cropperSize(this.props.image)},"Loading"),u.createElement(un.a,{ref:function(t){return e._cropper=t},src:this.props.image.src,style:this.cropperSize(this.props.image),zoomable:!1,aspectRatio:this.props.aspectRatio?this.props.aspectRatio:1}),u.createElement("div",{className:"cropper-actions"},u.createElement(T.a,{className:"empty",onClick:this.props.onCancel,disabled:this.state.loading||this.state.tracking},"Cancel"),u.createElement(T.a,{onClick:this.cropAndSave,loading:this.state.loading,disabled:this.state.tracking},"Save"))):u.createElement(hn.a,{onFiles:this.onFiles},u.createElement("span",null,this.props.message?this.props.message:"Upload your image")))}},{key:"_validateFileNumber",value:function(e){return!(e.length>1)||(this.props.dispatch(new v.i(new P.J({type:P.K.Error,text:"You can upload only 1 file at a time"}))),!1)}},{key:"_validateFileType",value:function(e){var t=e[0];return"image/png"===t.type||"image/jpeg"===t.type||(this.props.dispatch(new v.i(new P.J({type:P.K.Error,text:"You can upload only PNG and JPEG images"}))),!1)}},{key:"_validateFileSize",value:function(e){return!(e[0].size>1048576*this.sizeLimitInMb)||(this.props.dispatch(new v.i(new P.J({type:P.K.Error,text:"The image should be less than ".concat(this.sizeLimitInMb," MB").concat(1!==this.sizeLimitInMb?"s":"")}))),!1)}},{key:"_validateImageSize",value:function(e){return!(this.downscaleSize.width>e.width||this.downscaleSize.height>e.height)||(this.props.dispatch(new v.i(new P.J({type:P.K.Error,text:"The image should be at least ".concat(this.downscaleSize.width," x ").concat(this.downscaleSize.height," pixels")}))),!1)}},{key:"_handleCorruptedImage",value:function(){this.props.dispatch(new v.i(new P.J({type:P.K.Error,text:"Unable to open the image. Please, use another one"})))}},{key:"_performFaceRecognition",value:function(){var e=Object(oe.a)(ne.a.mark((function e(t){var n,o=this;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(14).then(r.t.bind(null,2001,7));case 2:return e.next=4,r.e(13).then(r.t.bind(null,2002,7));case 4:this.setState({tracking:!0}),(n=new tracking.ObjectTracker("face")).setStepSize(1.7),tracking.track(t,n),n.on("track",(function(e){var t=e.data[0];if(t){var r=t.width;t.width*=1.5;var n=(t.width-r)/2;if(t.x-=n,t.y-=n,!o._cropper)return void console.error("Cropper not initialized");o._cropper.setData(t)}o.setState({tracking:!1})}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"downscaleSize",get:function(){return this.props.downscaleSize||fn}},{key:"sizeLimitInMb",get:function(){return this.props.sizeLimitInMb||mn}}]),t}(u.Component),Object(k.a)(Xr.prototype,"onFiles",[w.a],Object.getOwnPropertyDescriptor(Xr.prototype,"onFiles"),Xr.prototype),Object(k.a)(Xr.prototype,"cropAndSave",[w.a],Object.getOwnPropertyDescriptor(Xr.prototype,"cropAndSave"),Xr.prototype),Xr),gn=(r(1718),Zr=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={image:null},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onImageLoad",value:function(e){this.setState({image:e})}},{key:"onImageSave",value:function(e){var t=this;return this.props.dispatch(xt.a.uploadHeroImage(this.props.course,e)).then((function(){t.props.onToggle(!1),t.setState({image:null})}))}},{key:"onCancel",value:function(){this.setState({image:null})}},{key:"render",value:function(){return u.createElement("div",{className:"hero-image-picker"},u.createElement(R.a,{title:this.state.image?"Adjust Hero Image":"Hero Image",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement(bn,{dispatch:this.props.dispatch,image:this.state.image,downscaleImage:!1,faceRecognition:!1,message:"Upload new hero image",onImageLoad:this.onImageLoad,onImageSave:this.onImageSave,onCancel:this.onCancel,aspectRatio:4/3,mimeType:"image/jpeg",quality:.8})))}}]),t}(u.Component),Object(k.a)(Zr.prototype,"onImageLoad",[w.a],Object.getOwnPropertyDescriptor(Zr.prototype,"onImageLoad"),Zr.prototype),Object(k.a)(Zr.prototype,"onImageSave",[w.a],Object.getOwnPropertyDescriptor(Zr.prototype,"onImageSave"),Zr.prototype),Object(k.a)(Zr.prototype,"onCancel",[w.a],Object.getOwnPropertyDescriptor(Zr.prototype,"onCancel"),Zr.prototype),Zr),On=(r(1719),function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={selectedPartnerId:null,isLoading:!1},r._onChangeSelectedPartner=function(e){return r.setState({selectedPartnerId:e.target.value})},r._onPublish=function(){if(r.state.selectedPartnerId){r.setState({isLoading:!0});var e=Number(r.state.selectedPartnerId);r.props.onPublish(e).finally((function(){r.setState({isLoading:!1}),r.props.onClose()}))}},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.partners;return u.createElement("div",{className:"partners-modal"},u.createElement(R.a,{title:"Enterprise Partners",visible:!0,onToggle:this.props.onClose,size:"small",scrollable:!0},u.createElement("p",null,"Select an enterprise partner to be used when publishing to Coursera"),u.createElement("div",{className:"partners-list"},t.keySeq().map((function(r){var n=t.get(r);return u.createElement("label",{key:n},u.createElement("input",{type:"radio",name:"partner",value:n,onChange:e._onChangeSelectedPartner}),r)}))),u.createElement("div",null,u.createElement(T.a,{className:"short-btn",onClick:this._onPublish,loading:this.state.isLoading,disabled:!this.state.selectedPartnerId},"Publish"))))}}]),t}(u.PureComponent)),kn=(r(1720),Qr=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={isSaving:!1,isPublishing:!1,isDeleteConfirmationModalVisible:!1,isDeleteHeroImageConfirmationModalVisible:!1,isVmDetailsModalVisible:!1,isDefaultVmDetailsModalVisible:!1,isUnsavedChangesModalVisible:!1,isChapterOrderModalVisible:!1,isHeroImageModalVisible:!1,chapterToBeRecorded:null,chapterToBePreviewed:null,formChanges:[],partners:null},r.chaptersListRef=void 0,r._recordingBuilder=new nn(Object(Z.a)(r)),r._onPublishCourse=function(){return r._publishCourse()},r._publishCourse=function(e){return r.setState({isPublishing:!0}),r.props.dispatch(r.props.asyncActions.publishCourse(r.props.course,e)).then((function(e){var t=e.courseraTeachUrl;t?window.location.href=t:r.setState({isPublishing:!1})})).catch((function(e){if(e.suggestions){var t=Object($.Map)(e.suggestions);r.setState({partners:t})}r.setState({isPublishing:!1})}))},r._hidePartnersModal=function(){return r.setState({partners:null})},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this)}},{key:"componentWillReceiveProps",value:function(e){e.courseName===this.props.courseName&&e.description===this.props.description&&e.templateId===this.props.templateId&&e.chapters===this.props.chapters&&e.virtualBrowserUrl===this.props.virtualBrowserUrl&&e.language===this.props.language||this.setState({formChanges:this._formChanges(e)})}},{key:"submit",value:function(e){e.preventDefault(),!function(e,t){var r=!1;return e.forEach((function(e,n){e.id!==t.get(n).id&&(r=!0)})),r}(this.props.initialValues.chapters,this.props.chapters)?this.save():this.toggleChaptersOrderModal(!0)}},{key:"save",value:function(){var e=this;this.setState({isSaving:!0}),this.saveUnsavedChanges().then((function(){return e.props.onToggle()})).catch((function(){return e.setState({isSaving:!1})}))}},{key:"cancel",value:function(e){e.preventDefault(),this.props.dispatch(Object(E.b)("recordingDetails")),this.props.onToggle()}},{key:"reorderChaptersBack",value:function(){var e=function(e,t){var r={};return e.forEach((function(e){return r[e.id]=e.order})),t.sort((function(e,t){return r[e.id]-r[t.id]})).map((function(e,t){return e.set("order",t+1)}))}(this.props.initialValues.chapters,this.props.chapters);this.props.change("chapters",e)}},{key:"toggleDeleteConfirmationModal",value:function(){this.setState({isDeleteConfirmationModalVisible:!this.state.isDeleteConfirmationModalVisible})}},{key:"toggleDeleteHeroImageConfirmationModal",value:function(){this.setState({isDeleteHeroImageConfirmationModalVisible:!this.state.isDeleteHeroImageConfirmationModalVisible})}},{key:"onConfirmDeletion",value:function(){return this._isDeletionAllowed()?this.props.dispatch(this.props.asyncActions.deleteCourse(this.props.course)).then(this.props.onToggle):Promise.reject("Deleting a recording is not allowed")}},{key:"onConfirmHeroImageDeletion",value:function(){return this.props.dispatch(this.props.asyncActions.deleteHeroImage(this.props.course)).then(this.toggleDeleteHeroImageConfirmationModal)}},{key:"toggleVMDetailsModal",value:function(e){this.setState({isVmDetailsModalVisible:e})}},{key:"toggleDefaultVMDetailsModal",value:function(e){this.setState({isDefaultVmDetailsModalVisible:e})}},{key:"toggleChaptersOrderModal",value:function(e){this.setState({isChapterOrderModalVisible:e})}},{key:"toggleHeroImageModal",value:function(e){this.setState({isHeroImageModalVisible:e})}},{key:"showVMDetails",value:function(){var e=Object(oe.a)(ne.a.mark((function e(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dispatch(Object(E.b)("recordingDetails"));case 2:if(this.template){e.next=4;break}return e.abrupt("return");case 4:if(this.props.showVmDetails){e.next=7;break}return this.props.onVmDetails&&this.props.onVmDetails(),e.abrupt("return");case 7:this.template.defaultTemplate||Object(g.d)(this.template)?this.toggleDefaultVMDetailsModal(!0):this.toggleVMDetailsModal(!0);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onRecordChapter",value:function(e){var t=this;this.props.user.creditCards.size?this._recordingBuilder.onRecordChapter(e):(this.props.cardModalCtrl.show(),this.props.cardModalCtrl.onSave().then((function(){return t._recordingBuilder.onRecordChapter(e)})))}},{key:"onToggleUnsavedChangesModal",value:function(){this.setState({isUnsavedChangesModalVisible:!this.state.isUnsavedChangesModalVisible})}},{key:"onDiscardUnsavedChanges",value:function(){var e=this;this._recordingBuilder.discardUnsavedChanges().then((function(){return e._recordingBuilder.proceedAction()}))}},{key:"onTemplateChange",value:function(e,t){var r=this.props.chapters.some((function(e){return!!e.videoUrl}));t!==this.props.course.templateId&&r&&this.props.dispatch(new v.i(new P.J({type:P.K.Info,title:"Are you sure?",text:"Your learners will get this new cloud workspace, but the recordings may have been created with the previous cloud workspace"})))}},{key:"saveUnsavedChanges",value:function(){var e=this;return this._recordingBuilder.saveUnsavedChapters().then((function(){var t=e.props.course.withMutations((function(t){return t.set("name",e.props.courseName).set("description",e.props.description).set("templateId",e.props.templateId).set("virtualBrowserUrl",e.props.virtualBrowserUrl).set("language",e.props.language)}));return e.props.dispatch(e.props.asyncActions.updateCourse(t))}))}},{key:"recordChapter",value:function(){this.state.chapterToBeRecorded&&this.props.onChapterRecord(this.state.chapterToBeRecorded)}},{key:"previewChapter",value:function(){this.state.chapterToBePreviewed&&this.props.onChapterPreview(this.state.chapterToBePreviewed)}},{key:"onTakeScreenshot",value:function(){this.toggleHeroImageModal(!0)}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"recording-details-modal form-styles"},u.createElement("div",{className:"modal"},u.createElement(R.a,{title:"Recording Details",visible:this.props.visible,transparent:this.isModalTransparent,onToggle:this.props.onToggle,scrollable:!0},u.createElement("div",{className:"recording-actions"},this.hasPermissionsToPublish&&(this.publishedCourseRoom?u.createElement("a",{href:this.publishedCourseRoom.courseraTeachUrl},u.createElement(T.a,{className:"empty small purple go-to-coursera-btn",loading:this.state.isPublishing},"Go to published project")):u.createElement(T.a,{className:"empty small purple publish-btn",loading:this.state.isPublishing,onClick:this._onPublishCourse},"Publish to Coursera"))),u.createElement("i",{className:"fa fa-video-camera","aria-hidden":"true"}),u.createElement("form",{name:"recordingDetails",className:"recording-details-form",onSubmit:this.submit},u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"courseName",component:T.s},{label:"Recording Name"})),u.createElement("p",{className:"field-info"},"All sessions of this recording will use this recording name and description")),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"description",component:T.v,rows:5},{label:"Recording Description"})),u.createElement("div",{className:"field-info"},u.createElement("div",null,"Make your recording's landing page more descriptive."," ",u.createElement("a",{href:"https://www.markdownguide.org/basic-syntax/",target:"_blank"},"Markdown supported")))),u.createElement("div",{className:"row"},u.createElement(_.a,{component:T.x,name:"language",label:"Course language"})),u.createElement("div",{className:"row vm-row"},this.disableVM?u.createElement("div",{className:"disable-message"},this._getDisableMessage()):null,u.createElement(_.a,Object.assign({name:"templateId",component:T.u,onChange:this.onTemplateChange,disabled:this.disableVM},{label:"Cloud Workspace",deletedOnMissingOption:!0}),this.availableTemplates.map((function(e){return u.createElement(T.n,{value:e.id,key:"vm-"+e.id,disabled:e.state!==P.bb.Ready||Object(g.d)(e),text:e.name},e.name,Object(g.d)(e)?" - Legacy":"")}))),u.createElement("p",{className:"field-info cloud-desktop-details-link"+(this.template&&this.template.state===P.bb.Ready?"":" disabled")},u.createElement(an,{skip:!this.hasUnsavedChanges,onConfirm:this.showVMDetails},"Cloud Workspace Details"))),this.isVirtualBrowser?u.createElement("div",{className:"row virtual-browser-url-row"},u.createElement(_.a,{name:"virtualBrowserUrl",component:T.s,label:"Launch URL"}),u.createElement("p",{className:"field-info"},"Specify the web address of the business application you'll be using in your project")):null,u.createElement(_.a,Object.assign({name:"chapters",component:T.q,ref:function(t){return e.chaptersListRef=t},forwardRef:!0},{asyncActions:this.props.asyncActions,course:this.props.course,templates:this.props.templates,rooms:this.props.rooms,onRecordChapter:this.onRecordChapter,onPreviewChapter:this._recordingBuilder.onPreviewChapter,onRecordUnsupported:this.props.onChapterRecordUnsupported,actionDispatch:this.props.dispatch})),u.createElement("div",{className:"row hero-image-row"},u.createElement(Yt,{image:this.props.course.imageUrl,onTakeScreenshot:this.onTakeScreenshot,width:320,height:240,labels:{createLabel:"Upload Hero Image",changeLabel:"Change Hero Image"}}),u.createElement("p",{className:"field-info"},"Hero Image: The first image shown on this recording\u2019s landing page"),u.createElement("p",{className:"field-info delete"},u.createElement("a",{href:"javascript:void(0);",onClick:this.toggleDeleteHeroImageConfirmationModal},"Delete Hero Image"))),u.createElement("div",{className:"row"},u.createElement(ln,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,course:this.props.course})),u.createElement("div",{className:"row"},u.createElement("div",{className:"form-actions recording-details-modal-form-actions"},u.createElement(T.a,{className:"empty",onClick:this.cancel,disabled:this.state.isSaving,type:"button"},"Cancel"),u.createElement(T.a,{disabled:!this.props.valid||!this.hasUnsavedChanges,loading:this.state.isSaving},"Save")),u.createElement("p",{className:"field-info delete"},u.createElement("a",{href:"javascript:void(0);",onClick:this.toggleDeleteConfirmationModal},"Delete Recording")))))),this.renderModals())}},{key:"renderModals",value:function(){return u.createElement(u.Fragment,null,u.createElement(Ae.a,{visible:this.state.isDeleteConfirmationModalVisible,title:"Delete Recording",messages:['Are you sure you want to delete recording "'.concat(this.props.course.name,'"?')],onClose:this.toggleDeleteConfirmationModal,onDelete:this.onConfirmDeletion}),u.createElement(Ae.a,{visible:this.state.isDeleteHeroImageConfirmationModalVisible,title:"Delete Hero Image",messages:["Are you sure you want to delete the hero image?","Note: Without a hero image, the landing page will show a task image or cloud workspace image"],onClose:this.toggleDeleteHeroImageConfirmationModal,onDelete:this.onConfirmHeroImageDeletion}),u.createElement(Pr,{title:"Recording Details",visible:this.state.isUnsavedChangesModalVisible,onToggle:this.onToggleUnsavedChangesModal,saveable:!(!this.props.valid||!this.hasUnsavedChanges),changes:this.state.formChanges,onDiscard:this.onDiscardUnsavedChanges,onSave:this._recordingBuilder.onSaveUnsavedChanges}),u.createElement(sn,{visible:this.state.isChapterOrderModalVisible,onToggle:this.toggleChaptersOrderModal,onSave:this.save,onCancel:this.reorderChaptersBack}),this.template&&this.props.showVmDetails&&(this.state.isVmDetailsModalVisible||this.state.isDefaultVmDetailsModalVisible)?u.createElement(u.Fragment,null,u.createElement(rn,{dispatch:this.props.dispatch,template:this.template,asyncActions:this.props.asyncActions,courses:this.props.courses,rooms:this.props.rooms,templates:this.props.templates,templateTypes:this.props.templateTypes,visible:this.state.isVmDetailsModalVisible,onToggle:this.toggleVMDetailsModal,onCustomize:this.props.onVmCustomize,onScreenshotUpdate:this.props.onVmScreenshotUpdate}),u.createElement(Dr,{template:this.template,visible:this.state.isDefaultVmDetailsModalVisible,onToggle:this.toggleDefaultVMDetailsModal})):null,u.createElement(gn,{visible:this.state.isHeroImageModalVisible,course:this.props.course,dispatch:this.props.dispatch,onToggle:this.toggleHeroImageModal}),this.state.partners&&u.createElement(On,{partners:this.state.partners,onClose:this._hidePartnersModal,onPublish:this._publishCourse}))}},{key:"_formChanges",value:function(e){var t=[],r=e.initialValues;e.courseName!==r.courseName&&t.push({title:"Name",content:e.courseName}),e.description!==r.description&&t.push({title:"Description",content:e.description}),e.templateId!==r.templateId&&t.push({title:"Cloud Workspace",content:e.templates.get(e.templateId).name}),e.virtualBrowserUrl!==r.virtualBrowserUrl&&t.push({title:"Virtual Browser Url",content:e.virtualBrowserUrl}),e.language!==r.language&&t.push({title:"Language",content:e.language});var n=Cr(e.chapters,r);return t=t.concat(n)}},{key:"_getDisableMessage",value:function(){return this.isCourseUsedInRunningSession?"Can't change because a session has started":this.isCourseUsedInAboutToStartSession?"Can't change because a session is starting":""}},{key:"_isDeletionAllowed",value:function(){var e;return this.isCourseUsedInRunningSession?e="A recording with currently running session cannot be deleted":this.isCourseUsedInAboutToStartSession?e="A recording with session that is about to start cannot be deleted":this.isCourseUsedInUpcomingSession&&(e="A recording with upcoming sessions cannot be deleted"),!e||(this.props.dispatch(new v.i(new P.J({type:P.K.Error,title:"Recording is in use",text:e}))),!1)}},{key:"template",get:function(){return this.props.templates.get(this.props.course.templateId)||null}},{key:"availableTemplates",get:function(){return Object(g.b)(this.props.templates,this.template)}},{key:"hasUnsavedChanges",get:function(){return!!this.state.formChanges.length}},{key:"isModalTransparent",get:function(){return this.props.transparent||this.props.cardModalVisible||this.state.isDeleteConfirmationModalVisible||this.state.isDeleteHeroImageConfirmationModalVisible||this.state.isUnsavedChangesModalVisible||this.state.isDefaultVmDetailsModalVisible||this.state.isVmDetailsModalVisible||this.state.isChapterOrderModalVisible||this.state.isHeroImageModalVisible}},{key:"isCourseUsedInRunningSession",get:function(){return Object(Tr.d)(this.props.course,this.props.rooms)}},{key:"isCourseUsedInAboutToStartSession",get:function(){return Object(Tr.c)(this.props.course,this.props.rooms)}},{key:"isCourseUsedInUpcomingSession",get:function(){return Object(Tr.f)(this.props.course,this.props.rooms)}},{key:"disableVM",get:function(){return this.isCourseUsedInRunningSession||this.isCourseUsedInAboutToStartSession}},{key:"isVirtualBrowser",get:function(){return!(!this.template||this.template.os!==P.L.Docker)}},{key:"hasPermissionsToPublish",get:function(){return this.props.user.permissions.contains(P.gb.PublishToCoursera)}},{key:"publishedCourseRoom",get:function(){return this.hasPermissionsToPublish?Object(Tr.a)(this.props.course,this.props.rooms):null}}]),t}(u.Component),Object(k.a)(Qr.prototype,"submit",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"submit"),Qr.prototype),Object(k.a)(Qr.prototype,"save",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"save"),Qr.prototype),Object(k.a)(Qr.prototype,"cancel",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"cancel"),Qr.prototype),Object(k.a)(Qr.prototype,"reorderChaptersBack",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"reorderChaptersBack"),Qr.prototype),Object(k.a)(Qr.prototype,"toggleDeleteConfirmationModal",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"toggleDeleteConfirmationModal"),Qr.prototype),Object(k.a)(Qr.prototype,"toggleDeleteHeroImageConfirmationModal",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"toggleDeleteHeroImageConfirmationModal"),Qr.prototype),Object(k.a)(Qr.prototype,"onConfirmDeletion",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"onConfirmDeletion"),Qr.prototype),Object(k.a)(Qr.prototype,"onConfirmHeroImageDeletion",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"onConfirmHeroImageDeletion"),Qr.prototype),Object(k.a)(Qr.prototype,"toggleVMDetailsModal",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"toggleVMDetailsModal"),Qr.prototype),Object(k.a)(Qr.prototype,"toggleDefaultVMDetailsModal",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"toggleDefaultVMDetailsModal"),Qr.prototype),Object(k.a)(Qr.prototype,"toggleChaptersOrderModal",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"toggleChaptersOrderModal"),Qr.prototype),Object(k.a)(Qr.prototype,"toggleHeroImageModal",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"toggleHeroImageModal"),Qr.prototype),Object(k.a)(Qr.prototype,"showVMDetails",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"showVMDetails"),Qr.prototype),Object(k.a)(Qr.prototype,"onRecordChapter",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"onRecordChapter"),Qr.prototype),Object(k.a)(Qr.prototype,"onToggleUnsavedChangesModal",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"onToggleUnsavedChangesModal"),Qr.prototype),Object(k.a)(Qr.prototype,"onDiscardUnsavedChanges",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"onDiscardUnsavedChanges"),Qr.prototype),Object(k.a)(Qr.prototype,"onTemplateChange",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"onTemplateChange"),Qr.prototype),Object(k.a)(Qr.prototype,"onTakeScreenshot",[w.a],Object.getOwnPropertyDescriptor(Qr.prototype,"onTakeScreenshot"),Qr.prototype),Qr),Cn=Object(D.a)("recordingDetails"),wn=Object(S.a)({form:"recordingDetails",validate:Or.m,enableReinitialize:!1})(kn),jn=Object(j.c)((function(e,t){return{courseName:Cn(e,"courseName"),description:Cn(e,"description"),templateId:Cn(e,"templateId"),chapters:Cn(e,"chapters"),language:Cn(e,"language"),virtualBrowserUrl:Cn(e,"virtualBrowserUrl"),initialValues:{courseName:t.course.name,description:t.course.description,templateId:t.course.templateId,virtualBrowserUrl:t.course.virtualBrowserUrl,language:t.course.language||"",chapters:t.course.chapters.map((function(e,t){return e.set("key",t)}))}}}))(wn),En=r(1098),_n=r(1114),Sn=r(1097);function Dn(){return(Dn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Pn(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var Tn=d.a.createElement("title",null,"Icons/Close"),Rn=d.a.createElement("desc",null,"Created with Sketch."),xn=d.a.createElement("defs",null,d.a.createElement("path",{d:"M0,3.70909091 C1.23636364,2.47272727 2.47272727,1.23636364 3.70909091,0 C9.14909091,5.37818182 14.5909091,10.82 19.9690909,16.26 C25.4090909,10.82 30.8509091,5.37818182 36.2909091,0 C37.5272727,1.23636364 38.7636364,2.47272727 40,3.70909091 C34.56,9.14909091 29.12,14.5909091 23.74,19.9690909 C29.12,25.4090909 34.56,30.8509091 40,36.2909091 C38.7636364,37.5272727 37.5272727,38.7636364 36.2909091,40 C30.8509091,34.56 25.4090909,29.12 19.9690909,23.74 C14.5909091,29.12 9.14909091,34.56 3.70909091,40 C2.47272727,38.7636364 1.23636364,37.5272727 0,36.2909091 C5.37818182,30.8509091 10.82,25.4090909 16.26,19.9690909 C10.82,14.5909091 5.37818182,9.14909091 0,3.70909091",id:"path-1"})),Nn=d.a.createElement("g",{id:"Style-Guide",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},d.a.createElement("g",{transform:"translate(-3742.000000, -945.000000)",id:"Icons"},d.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},d.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},d.a.createElement("g",{id:"Icons/Close",transform:"translate(401.000000, 161.000000)"},d.a.createElement("g",{id:"Colors/Grey"},d.a.createElement("mask",{id:"mask-2",fill:"white"},d.a.createElement("use",{xlinkHref:"#path-1"})),d.a.createElement("use",{id:"Mask",fill:"#A3A5AB",xlinkHref:"#path-1"}),d.a.createElement("g",{mask:"url(#mask-2)",fill:"#A3A5AB",id:"Rectangle"},d.a.createElement("rect",{x:0,y:0,width:40,height:40})))))))),Mn=function(e){var t=e.svgRef,r=e.title,n=Pn(e,["svgRef","title"]);return d.a.createElement("svg",Dn({width:"40px",height:"40px",viewBox:"0 0 40 40",ref:t},n),void 0===r?Tn:r?d.a.createElement("title",null,r):null,Rn,xn,Nn)},Vn=d.a.forwardRef((function(e,t){return d.a.createElement(Mn,Dn({svgRef:t},e))})),An=(r.p,r(1071));r(1721);function In(){return(In=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Un(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var Ln,Fn,Bn,zn,Hn=d.a.createElement("defs",null,d.a.createElement("path",{stroke:"#989898",strokeWidth:2.5,id:"search-a",d:"M18.8812955,7.65954906 C12.6931781,7.65954906 7.65954906,12.6931781 7.65954906,18.8812955 C7.65954906,25.0686667 12.6931781,30.103042 18.8812955,30.103042 C25.069413,30.103042 30.103042,25.0686667 30.103042,18.8812955 C30.103042,12.6931781 25.069413,7.65954906 18.8812955,7.65954906 L18.8812955,7.65954906 Z M40.7613504,41.7777778 L27.306001,28.3224284 C25.0664279,30.322447 22.1134152,31.5403688 18.8812955,31.5403688 C11.9006334,31.5403688 6.22222222,25.8612114 6.22222222,18.8812955 C6.22222222,11.9006334 11.9006334,6.22222222 18.8812955,6.22222222 C25.8619577,6.22222222 31.5403688,11.9006334 31.5403688,18.8812955 C31.5403688,22.1134152 30.322447,25.0664279 28.3224284,27.306001 L41.7777778,40.7613504 L40.7613504,41.7777778 Z"})),Wn=d.a.createElement("use",{fillRule:"evenodd",xlinkHref:"#search-a"}),Kn=function(e){var t=e.svgRef,r=e.title,n=Un(e,["svgRef","title"]);return d.a.createElement("svg",In({width:48,height:48,viewBox:"0 0 48 48",ref:t},n),r?d.a.createElement("title",null,r):null,Hn,Wn)},Yn=d.a.forwardRef((function(e,t){return d.a.createElement(Kn,In({svgRef:t},e))})),Gn=(r.p,function(e){var t=u.useCallback((function(t){return e.onChange(t.target.value)}),[e.onChange]),r=u.useCallback((function(){return e.onChange("")}),[e.onChange]);return u.createElement("div",{className:"search-input"},u.createElement(Yn,{className:"search-icon"}),u.createElement(An.a,Object.assign({},e,{onChange:t,alwaysShowPlaceholder:!0,placeholder:e.placeholder||"Search"})),e.value&&u.createElement(Vn,{className:"btn-clear",onClick:r}))}),qn=(r(1722),function(e){return u.createElement("div",{className:"list-controls"},void 0!==e.filter&&e.onFilterChange&&u.createElement(Gn,{onChange:e.onFilterChange,value:e.filter,placeholder:e.filterPlaceholder}),e.sortOptions&&e.sortBy&&e.onSortTypeChange&&u.createElement("div",{className:"control"},u.createElement(Sn.a,{value:e.sortBy,onChange:e.onSortTypeChange},Object.entries(e.sortOptions).map((function(e){var t=Object(Le.a)(e,2),r=t[0],n=t[1];return u.createElement(_n.a,{key:r,value:n},n)})))))}),Jn=r(1222),Xn=(r(1723),function(){return u.createElement("div",{className:"dashboard-loading"},u.createElement(Bt.a,null),u.createElement("div",null,"Loading"))}),Zn=(r(1724),Ln=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){this.props.onClick(this.props.course)}},{key:"onPreview",value:function(e){e.stopPropagation(),this.props.onPreview(this.props.course)}},{key:"render",value:function(){var e=this.props.course;return u.createElement(En.a,{className:"recorded-session"+(this.disabled?" disabled":""),onClick:this.onClick,attribute:e.name},this.disabled?u.createElement("div",{className:"cannot-schedule-message"},this.isTemplateDeleted&&"You cannot schedule a recording which uses a deleted cloud workspace.",!this.hasRecording&&"You cannot schedule a recording that does not have a recorded task."):null,u.createElement("div",{className:"header"},u.createElement("div",{className:"name"},e.name),u.createElement("div",{className:"duration"},!!this.totalDuration&&"(".concat(Object(lt.a)(this.totalDuration),")")),u.createElement("div",{className:"flex-separator"}),this.publishedCourseRoom&&u.createElement("div",{className:"published"},"Published")),u.createElement("div",{className:"screenshot",onClick:this.onPreview},u.createElement("div",{className:"translucent-layer"}),this.hasRecording?u.createElement("i",{className:"fa fa-play"}):null,u.createElement("img",{src:this.screenshot,width:"200",height:"150",alt:""})),u.createElement("div",{className:"info"},u.createElement("ul",null,e.chapters.map((function(e,t){return u.createElement("li",{className:"chapter-info",key:"chapter-"+t},u.createElement("span",null,t+1,". ",e.name),e.type===P.s.Instruction?u.createElement("span",{className:"duration","data-duration":Math.floor(e.duration/1e3)},Object(lt.a)(e.duration)):u.createElement("span",{className:"challenge-icon"},u.createElement("i",{className:"fa fa-trophy"})))})))))}},{key:"screenshot",get:function(){var e=this.props.templates.get(this.props.course.templateId);return Object(g.c)(this.props.templates,e)}},{key:"hasRecording",get:function(){return this.props.course.chapters.filter((function(e){return!!e.videoUrl})).size}},{key:"isTemplateDeleted",get:function(){var e=this,t=this.props.templates.find((function(t){return t.id===e.props.course.templateId}));return!t||t.state===P.bb.Deleted}},{key:"disabled",get:function(){return this.props.disableUnscheduleable&&(!this.hasRecording||this.isTemplateDeleted)}},{key:"totalDuration",get:function(){return this.props.course.chapters.map((function(e){return e.duration})).reduce((function(e,t){return e+t}),0)}},{key:"hasPermissionsToPublish",get:function(){return this.props.user.permissions.contains(P.gb.PublishToCoursera)}},{key:"publishedCourseRoom",get:function(){return this.hasPermissionsToPublish?Object(Tr.a)(this.props.course,this.props.rooms):null}}]),t}(u.Component),Object(k.a)(Ln.prototype,"onClick",[w.a],Object.getOwnPropertyDescriptor(Ln.prototype,"onClick"),Ln.prototype),Object(k.a)(Ln.prototype,"onPreview",[w.a],Object.getOwnPropertyDescriptor(Ln.prototype,"onPreview"),Ln.prototype),Ln),Qn=(r(1725),Fn=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={filter:""},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return u.createElement("div",{className:"recordings-list"},this.props.loadingInitialData?u.createElement(Xn,null):u.createElement(u.Fragment,null,u.createElement(qn,{filter:this.state.filter,onFilterChange:this._onFilterChange,filterPlaceholder:"Search recordings"}),u.createElement(Jn.a,null,u.createElement(En.a,{className:"new-recording",onClick:this._onNewRecording},u.createElement("div",{className:"create-icon"}),u.createElement("p",null,"Create New Recording")),this._sortedFilteredRecordings.map((function(t){return u.createElement(Zn,{user:e.props.user,course:t,rooms:e.props.rooms,templates:e.props.templates,disableUnscheduleable:e.props.disableUnscheduleable,dispatch:e.props.dispatch,key:"rs-"+t.id,onClick:e.props.onRecordingClick,onPreview:e.props.onRecordingPreviewClick})})))))}},{key:"_onNewRecording",value:function(){this.props.dispatch(Object(Y.Kb)(Y.T))}},{key:"_onFilterChange",value:function(e){this.setState({filter:e})}},{key:"_sortedFilteredRecordings",get:function(){var e=this.state.filter.toLowerCase();return this.props.recordings.filter((function(t){return t.name.toLowerCase().includes(e)}))}}]),t}(u.Component),Object(k.a)(Fn.prototype,"_onNewRecording",[w.a],Object.getOwnPropertyDescriptor(Fn.prototype,"_onNewRecording"),Fn.prototype),Object(k.a)(Fn.prototype,"_onFilterChange",[w.a],Object.getOwnPropertyDescriptor(Fn.prototype,"_onFilterChange"),Fn.prototype),Fn);!function(e){e[e.Update=0]="Update",e[e.Screenshot=1]="Screenshot"}(zn||(zn={}));var $n,eo=(Bn=function(e){function t(e){var r;Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._recordingDetails=void 0,r._chapterVmService=new Zt(Object(Z.a)(r));var n=new Y.fb(e.location);return r.state={courseId:n.params.course||null,selectedTemplate:null,vm:null,courseVmId:null,selectedChapterId:null},r._redirectIfNoData(),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onRecordingSelect",value:function(e){this.setState({courseId:e.id})}},{key:"onRecordingPreview",value:function(e){this.onRecordingSelect(e);var t=e.chapters.filter((function(e){return!!e.videoUrl}));if(t.count()){var r=t.first();this.onChapterPreview(r)}}},{key:"toggleRecordingDetailsModal",value:function(){this.recordingDetailsVisibility&&(this.setState({courseId:null}),this.props.dispatch(Object(h.h)(Y.bb)))}},{key:"customizeRecordingVm",value:function(e,t){var r=this;return this.setState({selectedTemplate:t}),this._createVmFromTemplate(t).then((function(){e===zn.Update?r.props.dispatch(Object(h.g)(Y.V)):e===zn.Screenshot&&r.props.dispatch(Object(h.g)(Y.U))}))}},{key:"endOfTemplateCustomization",value:function(){var e=this;this.props.dispatch(Object(h.g)(Y.bb)),this.setState({vm:new P.lb({}),selectedTemplate:null},(function(){e._recordingDetails&&e._recordingDetails.toggleVMDetailsModal(!0)}))}},{key:"onExitChapterRecordingOrPreview",value:function(){this.setState({selectedChapterId:null}),this.props.dispatch(Object(h.g)(Y.bb))}},{key:"onChapterRecord",value:function(e){var t=this;this.setState({selectedChapterId:e.id}),this._chapterVmService.requestVm().then((function(){return t.props.dispatch(Object(h.g)(Y.ab))}))}},{key:"onChapterPreview",value:function(e){this.setState({selectedChapterId:e.id}),this.props.dispatch(Object(h.g)(Y.Z))}},{key:"onChapterRecordUnsupported",value:function(){this.props.dispatch(Object(h.g)(Y.cb))}},{key:"onUnsupportedRecordingBack",value:function(){this.props.dispatch(Object(h.g)(Y.bb))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"recordings"},u.createElement(y.d,null,u.createElement(y.b,{path:Y.bb,exact:!0,render:function(){return u.createElement(u.Fragment,null,u.createElement(Qn,{user:e.props.user,recordings:e.recordedSessions,rooms:e.props.rooms,templates:e.props.templates,loadingInitialData:e.props.loadingInitialData,dispatch:e.props.dispatch,onRecordingClick:e.onRecordingSelect,onRecordingPreviewClick:e.onRecordingPreview}),e.course?u.createElement(jn,{onRef:function(t){return e._recordingDetails=t},course:e.course,visible:e.recordingDetailsVisibility,showVmDetails:!0,user:e.props.user,templates:e.props.templates,templateTypes:e.props.templateTypes,courses:e.props.courses,rooms:e.props.rooms,onToggle:e.toggleRecordingDetailsModal,onVmCustomize:function(t){return e.customizeRecordingVm(zn.Update,t)},onVmScreenshotUpdate:function(t){return e.customizeRecordingVm(zn.Screenshot,t)},onChapterRecord:e.onChapterRecord,onChapterPreview:e.onChapterPreview,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,cardModalCtrl:e.props.cardModalCtrl,cardModalVisible:e.props.cardModalVisible,onChapterRecordUnsupported:e.onChapterRecordUnsupported}):null)}}),u.createElement(y.b,{path:Y.V,exact:!0,render:function(){return e.state.vm&&e.state.selectedTemplate?u.createElement(er,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate},u.createElement(gr,{dispatch:e.props.dispatch,vm:e.state.vm,remoteClientManager:e.props.remoteClientManager,asyncActions:e.props.asyncActions,template:e.state.selectedTemplate,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.b,{path:Y.U,exact:!0,render:function(){return e.state.vm&&e.state.selectedTemplate?u.createElement(er,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate},u.createElement(vr,{dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.b,{path:Y.ab,exact:!0,render:function(){return e.course&&e.selectedChapter&&e.selectedCourseVm?u.createElement(ot,{dispatch:e.props.dispatch,vm:e.selectedCourseVm,course:e.course,chapter:e.selectedChapter,asyncActions:e.props.asyncActions,vms:e.props.vms,templates:e.props.templates,remoteClientManager:e.props.remoteClientManager,onExit:e.onExitChapterRecordingOrPreview}):null}}),u.createElement(y.b,{path:Y.Z,exact:!0,render:function(){return e.course&&e.selectedChapter?u.createElement(Xt,{course:e.course,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,chapter:e.selectedChapter,currentChapter:e.props.currentChapter,onExit:e.onExitChapterRecordingOrPreview}):null}}),u.createElement(y.b,{path:Y.cb,exact:!0,render:function(){return u.createElement(te,{onBack:e.onUnsupportedRecordingBack})}}),u.createElement(y.a,{to:Y.H})))}},{key:"_createVmFromTemplate",value:function(e){var t=this;return this.props.dispatch(this.props.asyncActions.getVMAndConnection(e,!0)).then((function(e){t.setState({vm:e})}))}},{key:"_redirectIfNoData",value:function(){var e=this.props.location,t=(Object(Y.Hb)(e,Y.ab)||Object(Y.Hb)(e,Y.Z))&&(!this.course||!this.state.selectedChapterId),r=(Object(Y.Hb)(e,Y.V)||Object(Y.Hb)(e,Y.U))&&(!this.state.vm||!this.state.selectedTemplate);(t||r)&&this.props.dispatch(Object(h.h)(Y.bb))}},{key:"recordedSessions",get:function(){return this.props.courses.filter((function(e){return e.type===P.y.Recorded})).toList()}},{key:"recordingDetailsVisibility",get:function(){return!!this.state.courseId}},{key:"course",get:function(){return this.props.courses.get(this.state.courseId||"")||null}},{key:"selectedChapter",get:function(){var e=this;return this.course&&this.state.selectedChapterId?this.course.chapters.find((function(t){return t.id===e.state.selectedChapterId})):null}},{key:"selectedCourseVm",get:function(){return this.course&&this.state.courseVmId?this.props.vms.get(this.state.courseVmId):null}}]),t}(u.Component),Object(k.a)(Bn.prototype,"onRecordingSelect",[w.a],Object.getOwnPropertyDescriptor(Bn.prototype,"onRecordingSelect"),Bn.prototype),Object(k.a)(Bn.prototype,"onRecordingPreview",[w.a],Object.getOwnPropertyDescriptor(Bn.prototype,"onRecordingPreview"),Bn.prototype),Object(k.a)(Bn.prototype,"toggleRecordingDetailsModal",[w.a],Object.getOwnPropertyDescriptor(Bn.prototype,"toggleRecordingDetailsModal"),Bn.prototype),Object(k.a)(Bn.prototype,"customizeRecordingVm",[w.a],Object.getOwnPropertyDescriptor(Bn.prototype,"customizeRecordingVm"),Bn.prototype),Object(k.a)(Bn.prototype,"endOfTemplateCustomization",[w.a],Object.getOwnPropertyDescriptor(Bn.prototype,"endOfTemplateCustomization"),Bn.prototype),Object(k.a)(Bn.prototype,"onExitChapterRecordingOrPreview",[w.a],Object.getOwnPropertyDescriptor(Bn.prototype,"onExitChapterRecordingOrPreview"),Bn.prototype),Object(k.a)(Bn.prototype,"onChapterRecord",[w.a],Object.getOwnPropertyDescriptor(Bn.prototype,"onChapterRecord"),Bn.prototype),Object(k.a)(Bn.prototype,"onChapterPreview",[w.a],Object.getOwnPropertyDescriptor(Bn.prototype,"onChapterPreview"),Bn.prototype),Object(k.a)(Bn.prototype,"onChapterRecordUnsupported",[w.a],Object.getOwnPropertyDescriptor(Bn.prototype,"onChapterRecordUnsupported"),Bn.prototype),Object(k.a)(Bn.prototype,"onUnsupportedRecordingBack",[w.a],Object.getOwnPropertyDescriptor(Bn.prototype,"onUnsupportedRecordingBack"),Bn.prototype),Bn),to=r(292),ro=r.n(to),no=r(1223),oo=r(1193),ao=r(1138),io=(r(1733),$n=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={showContent:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"toggleContent",value:function(){this.setState({showContent:!this.state.showContent})}},{key:"render",value:function(){var e=this.props.hidden&&!this.state.showContent?"*".repeat(40):this.props.data;return u.createElement("div",{className:"lti-item "+(this.props.className||"")},u.createElement("span",{className:"label"},this.props.label),u.createElement("div",{className:"data-wrapper"},u.createElement("div",{className:"data",onClick:this.toggleContent},e),u.createElement(ao.a,{className:"copy-button",value:this.props.data},"Copy")))}}]),t}(u.PureComponent),Object(k.a)($n.prototype,"toggleContent",[w.a],Object.getOwnPropertyDescriptor($n.prototype,"toggleContent"),$n.prototype),$n),so=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"lti-details"},u.createElement(io,{label:"Launch URL",className:"url",data:this.props.url}),u.createElement(io,{label:"Consumer Key",className:"key",data:this.props.consumerKey,hidden:!0}),u.createElement(io,{label:"Secret",className:"secret",data:this.props.secret,hidden:!0}))}}]),t}(u.PureComponent),co=(r(1734),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"room-link"},u.createElement("span",{className:"invite-link-label"},"Invite link:"),u.createElement("span",{className:"invite-link"},pe.a.ShortURL,"/",u.createElement("span",null,this.props.secret.toLowerCase())),u.createElement(ao.a,{className:"join-room-button",value:this.props.url,disabled:this.props.disabled},"Copy"),u.createElement(G.a,null,"Your learners can join this session using this invite link."))}}]),t}(u.PureComponent)),lo=pe.a.RoomStartDelay,po=pe.a.TemplateCopyDelay,uo=pe.a.RoomDurationLimit,ho=60*uo;function mo(e,t){var r=!!ro.a.tz.zone(t)?t:ro.a.tz.guess();return ro.a.tz(e.format("MM-DD-YYYY HH:mm"),"MM-DD-YYYY HH:mm",r)}function fo(e,t,r,n){var o=null,a=yo(t),i=ro()(),s=i.add(a,"minutes").startOf("minute").diff(ro()(e.startTime))>0;if(r&&r.startTime.getTime()!==e.startTime.getTime()&&i.diff(ro()(r.startTime))>0&&i.diff(ro()(r.expirationTime))<0)o=new P.J({type:P.K.Info,text:"The session start time cannot be changed while the session is running"});else if(r&&r.startTime.getTime()!==e.startTime.getTime()&&(i.diff(ro()(r.expirationTime))>0||r.endTime&&i.diff(ro()(r.endTime))>0))o=new P.J({type:P.K.Info,text:"The session time cannot be changed after it ended"});else if((r&&r.startTime.getTime()!==e.startTime.getTime()||!r)&&s){var c="Please set the start time";a>0&&(c+=" at least ".concat(a," minute").concat(1===a?"":"s")),c+=" in future.",o=new P.J({type:P.K.Info,text:c})}else if(n&&n>ro()(e.expirationTime).diff(ro()(e.startTime))){var l=Object(x.c)(Math.round(n/1e3));o=new P.J({type:P.K.Info,text:"The duration of the session cannot be shorter than the recording duration (".concat(l,")")})}else if(i.diff(ro()(e.expirationTime))>0)o=new P.J({type:P.K.Info,text:"The session end time cannot be in the past"});else if(ro()(e.expirationTime).subtract(2,"minute").diff(ro()(e.startTime))<0)o=new P.J({type:P.K.Info,text:"The session duration cannot be less than ".concat(2," minutes")});else if(r&&0!==ro()(r.expirationTime).diff(ro()(e.expirationTime))||!r){ro()(e.expirationTime).diff(ro()(e.startTime),"minutes")>ho&&(o=new P.J({type:P.K.Error,title:"Invalid duration",text:"The session cannot be longer than ".concat(uo," hours")}))}return{isValid:!o,notification:o}}function yo(e){var t=0;return e.state!==P.bb.Ready&&(t+=po),e.defaultTemplate||(t+=lo),e.defaultTemplate&&(t=0),t}function vo(e,t,r){var n=t.diff(e);return ro()(r).add(n,"ms")}function bo(e,t,r,n){var o=mo(t,n).toDate(),a=mo(r,n).toDate();return e.withMutations((function(e){return e.set("startTime",o).set("expirationTime",a)}))}var go,Oo,ko=function(e,t,r,n){var o;t.type===P.y.Recorded&&(o=t.chapters.map((function(e){return e.duration})).reduce((function(e,t){return e+t})));var a=fo(r,e.templates.get(t.templateId),n,o);return!a.isValid&&a.notification&&e.dispatch(new v.i(a.notification)),a.isValid},Co=(r(1735),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this._formatDuration();return u.createElement("div",{className:"active-session"},"00:00:00"!==e?u.createElement(u.Fragment,null,"This session will start in",u.createElement("div",{className:"duration"},this._formatDuration()),u.createElement("div",{className:"join-session-button",onClick:this.props.join},"Join")):u.createElement(u.Fragment,null,"The session is now running",u.createElement("div",{className:"join-session-button running",onClick:this.props.join},"Join")))}},{key:"_formatDuration",value:function(){return this.props.startsIn?m.utc(this.props.startsIn.as("milliseconds")).format("HH:mm:ss"):"00:00:00"}}]),t}(u.Component)),wo=(r(1736),function(e){var t=e.endedAt.format("MMM D, YYYY"),r=e.endedAt.format("h:mma"),n=to.tz(e.timezone).format("Z");return u.createElement("div",{className:"ended-session"},u.createElement("i",{className:"fa fa-calendar-times-o","aria-hidden":"true"}),u.createElement("span",null,"Ended on ",t," at ",r," (GMT ",n,")"))});r(1737);!function(e){e[e.None=0]="None",e[e.RecordingDetails=1]="RecordingDetails",e[e.SessionDetails=2]="SessionDetails"}(Oo||(Oo={}));var jo=to.tz.guess(),Eo=(go=function(e){function t(e){var r;Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._interval=void 0,r._minTimeInterval=void 0;var n=r.startsIn>0&&r.startsIn<=9e5;return r.state={isDuplicatedSession:!1,startsIn:n?r.startsInDuration:null,deleteConfirmationModalVisible:!1,isVmDetailsModalVisible:!1,isDefaultVmDetailsModalVisible:!1,isRecordingDetailsModalVisible:!1,isSaving:!1,isDeleting:!1,vmCustomizer:Oo.None,minTime:r.minTime},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.showJoin&&this.startsIn>0&&(this._interval=setInterval((function(){var t=e.startsInDuration;(!e.showJoin||e.startsIn<=0)&&clearInterval(e._interval),e.setState({startsIn:t})}),1e3)),this.props.onRef&&this.props.onRef(this),this._minTimeInterval=setInterval((function(){e.state.minTime.isSame(e.minTime,"minute")||e.setState({minTime:e.minTime})}),1e3)}},{key:"componentWillReceiveProps",value:function(e){if(e.startTime!==this.props.startTime&&this.props.expirationTime){var t=vo(this.props.startTime,this.props.expirationTime,e.startTime);this.props.change("expirationTime",t)}}},{key:"componentWillUnmount",value:function(){clearInterval(this._interval),clearInterval(this._minTimeInterval)}},{key:"save",value:function(e){e.preventDefault();var t=this.state.isDuplicatedSession,r=this._prepareCourse(t),n=this._prepareRoom(t);t?this._duplicateSession(this.course.type===P.y.Recorded?this.course:r,n):this._updateSession(r,n)}},{key:"toggleDeleteConfirmationModal",value:function(){this.setState({deleteConfirmationModalVisible:!this.state.deleteConfirmationModalVisible})}},{key:"toggleLRSEndModalVisible",value:function(e){this.setState({deleteConfirmationModalVisible:e})}},{key:"onConfirmDeletion",value:function(){return this._deleteSession(this.course,this.props.room)}},{key:"cancel",value:function(e){e.preventDefault(),this.props.dispatch(Object(E.b)("editSession")),this.props.onToggle()}},{key:"duplicate",value:function(){var e=this;if(this.course.deleted)this.props.dispatch(new v.i(new P.J({type:P.K.Error,text:"Cannot duplicate session. It uses a recording that is deleted"})));else{var t=function(){e._updateDateAndTimeFields(),e.setState({isDuplicatedSession:!0})};this.props.user.creditCards.size?t():(this.props.cardModalCtrl.show(),this.props.cardModalCtrl.onSave().then(t.bind(this)))}}},{key:"join",value:function(){var e=Object(Y.Ub)(this.props.room.secret);this.props.dispatch(Object(h.g)(e))}},{key:"requestRoomExtend",value:function(){this.props.dispatch(this.props.asyncActions.requestRoomExtend(this.props.room))}},{key:"onRecordingChange",value:function(e,t){var r=this.props.courses.get(t);this.props.dispatch(Object(E.a)("editSession","courseName",r.name)),this.props.dispatch(Object(E.a)("editSession","description",r.description)),this.props.dispatch(Object(E.a)("editSession","templateId",r.templateId))}},{key:"showRoomCost",value:function(){var e=this.props;(0,e.dispatch)(e.asyncActions.loadRoomCost(this.props.room))}},{key:"showVMDetails",value:function(e){this.template&&(this.setState({vmCustomizer:e}),this.template.defaultTemplate||Object(g.d)(this.template)?this.updateDefaultVMDetailsModalVisibility(!0):this.updateVMDetailsModalVisibility(!0))}},{key:"updateVMDetailsModalVisibility",value:function(e){e||this.setState({vmCustomizer:Oo.None}),this.setState({isVmDetailsModalVisible:e})}},{key:"updateDefaultVMDetailsModalVisibility",value:function(e){this.setState({isDefaultVmDetailsModalVisible:e})}},{key:"onVmCustomize",value:function(e){return this.state.vmCustomizer!==Oo.None?this.props.onVmCustomize(e,this.state.vmCustomizer):Promise.reject("Missing VM customizer")}},{key:"onVmScreenshotUpdate",value:function(e){return this.state.vmCustomizer!==Oo.None?this.props.onVmScreenshotUpdate(e,this.state.vmCustomizer):Promise.reject("Missing VM customizer")}},{key:"updateRecordingDetailsModalVisibility",value:function(){this.state.isRecordingDetailsModalVisible&&(this.props.dispatch(Object(E.a)("editSession","courseName",this.course.name)),this.props.dispatch(Object(E.a)("editSession","description",this.course.description)),this.props.dispatch(Object(E.a)("editSession","templateId",this.course.templateId))),this.setState({isRecordingDetailsModalVisible:!this.state.isRecordingDetailsModalVisible})}},{key:"openVMDetails",value:function(){var e=Object(oe.a)(ne.a.mark((function e(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dispatch(Object(E.b)("editSession"));case 2:this.showVMDetails(Oo.SessionDetails);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"openRecordingDetails",value:function(){var e=Object(oe.a)(ne.a.mark((function e(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dispatch(Object(E.b)("editSession"));case 2:this.updateRecordingDetailsModalVisibility();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.course.type===P.y.Recorded,r=this.isSessionAboutToStartOrRunning||this.isRoomExpiredOrEnded;return u.createElement("div",{className:"edit-session-modal"},u.createElement(R.a,{title:this.title,visible:this.props.visible,transparent:this.isModalTransparent,onToggle:this.props.onToggle,scrollable:!0},u.createElement("div",{className:"session-actions"},u.createElement(u.Fragment,null,u.createElement(T.a,{className:"empty small purple",onClick:this.duplicate,disabled:this.state.isDuplicatedSession},"Duplicate"),this.props.user.permissions.contains(P.gb.RequestRoomExtend)?u.createElement(T.a,{className:"empty small purple",onClick:this.requestRoomExtend},"Request Extend"):null,this.isRoomExpiredOrEnded?u.createElement(T.a,{className:"empty small purple",onClick:this.showRoomCost},"Costs"):null)),this.isRoomExpiredOrEnded?u.createElement(wo,{endedAt:this.endedAt,timezone:jo}):null,this.showJoin?u.createElement(Co,{join:this.join,startsIn:this.state.startsIn}):null,this.showRoomLink?u.createElement(co,{dispatch:this.props.dispatch,disabled:this.state.isDuplicatedSession,secret:this.props.room.secret,url:this.roomLink}):null,this.state.isDuplicatedSession?u.createElement("div",{className:"duplicate-message"},'Note: This duplicate session is not saved yet. Please make any changes and click "Save"'):null,u.createElement("form",{name:"editSession",className:"session-details-form form-styles",onSubmit:this.save},u.createElement(T.h,null,u.createElement("legend",null,"Basics"),t?u.createElement("div",{className:"row selected-recording-row"},this.isSessionAboutToStartOrRunning&&this._getDisableMessage(),this.course.deleted?u.createElement("div",{className:"deleted-field"},"Deleted"):null,u.createElement(_.a,Object.assign({name:"recording",onChange:this.onRecordingChange,component:T.u,disabled:r},{label:"Recording",deletedOnMissingOption:!0}),this.props.courses.filter((function(e){return e.type===P.y.Recorded})).toList().map((function(t){return u.createElement(T.n,{key:"r-"+t.id,value:t.id,deleted:t.deleted,disabled:!e._hasRecordedChapter(t)},t.name)}))),u.createElement("p",{className:"field-info edit-details"+(this.course.deleted?" disabled":"")},u.createElement(an,{skip:this.props.pristine,onConfirm:this.openRecordingDetails},"Recording Details"))):null,u.createElement("div",{className:"row session-name-row"},this.course.deleted?u.createElement("div",{className:"deleted-field"},"Deleted"):null,u.createElement(_.a,Object.assign({name:"courseName",component:T.s,type:"text",autoComplete:"off",disabled:this.isRoomExpiredOrEnded||t},{label:"Session Name"})),t?u.createElement("p",{className:"field-info edit-hint"+(this.course.delete?" disabled":"")},"Edit the name, description, and cloud workspace in recording details"):null),u.createElement("div",{className:"row description-row"},this.course.deleted?u.createElement("div",{className:"deleted-field"},"Deleted"):null,u.createElement(_.a,Object.assign({name:"description",component:T.v,rows:5,disabled:this.isRoomExpiredOrEnded||t},{label:"Session Description"})),!t&&u.createElement("div",{className:"field-info"},u.createElement("div",null,"Make your session's lobby page more descriptive."," ",u.createElement("a",{href:"https://www.markdownguide.org/basic-syntax/",target:"_blank"},"Markdown supported")))),u.createElement("div",{className:"row vm-row"},this.isSessionAboutToStartOrRunning&&!t&&this._getDisableMessage(),u.createElement(_.a,Object.assign({name:"templateId",component:T.u,disabled:this.disableVM},{label:"Cloud Workspace",deletedOnMissingOption:!0}),this.availableTemplates.map((function(e){return u.createElement(T.n,{value:e.id,key:"vm-"+e.id,disabled:e.state!==P.bb.Ready||Object(g.d)(e)},e.name,Object(g.d)(e)?" - Legacy":"")}))),u.createElement("p",{className:"field-info"+(this.template&&this.template.state===P.bb.Ready?"":" disabled")},u.createElement(an,{skip:this.props.pristine,onConfirm:this.openVMDetails},"Cloud Workspace Details"))),this.isVirtualBrowser?u.createElement("div",{className:"row virtual-browser-url-row"},u.createElement(_.a,{name:"virtualBrowserUrl",component:T.s,label:"Launch URL",disabled:this.isRoomExpiredOrEnded||t}),u.createElement("p",{className:"field-info"},"Specify the web address of the business application you'll be using in your project")):null),u.createElement(no.a,{fieldset:u.createElement(T.h,null),disabled:this.isRoomExpiredOrEnded}),u.createElement(T.h,null,u.createElement("legend",null,"Schedule"),u.createElement("div",{className:"row timezone-row"},r&&this._getDisableMessage(),u.createElement(_.a,Object.assign({name:"startTime",component:T.r,disabled:r},{label:"Start",minDate:this.state.minTime})),u.createElement("div",{className:"field-info"},u.createElement(_.a,{name:"timezone",component:T.w,disabled:this.isRoomExpiredOrEnded}))),u.createElement(_.a,Object.assign({name:"expirationTime",component:T.r,disabled:this.isRoomExpiredOrEnded},{label:"End",minDate:this.props.startTime}))),this.props.room.ltiURL?u.createElement(T.h,{className:"lti"},u.createElement("legend",null,"LTI Details"),u.createElement("div",{className:"row lti"},u.createElement(so,{url:this.props.room.ltiURL,consumerKey:this.props.room.ltiConsumerKey,secret:this.props.room.ltiSecret}),u.createElement("p",{className:"field-info"},"Use these values in the Coursera course's LTI Item settings"))):null,u.createElement("div",{className:"row"},u.createElement("div",{className:"form-actions"},u.createElement(T.a,{className:"empty",onClick:this.cancel,disabled:this.state.isSaving||this.state.isDeleting},"Cancel"),u.createElement(T.a,{disabled:this.isSaveButtonDisabled,loading:this.state.isSaving},"Save")),this.state.isDuplicatedSession?null:u.createElement("p",{className:"field-info delete"},u.createElement("a",{href:"javascript:void(0);",onClick:this.toggleDeleteConfirmationModal},"Delete Session"))))),this.renderModals())}},{key:"renderModals",value:function(){var e=this;return u.createElement(u.Fragment,null,this.props.room.longRunning?u.createElement(oo.a,{type:oo.b.Delete,visible:this.state.deleteConfirmationModalVisible,onToggle:this.toggleLRSEndModalVisible}):u.createElement(Ae.a,{visible:this.state.deleteConfirmationModalVisible,title:"Delete Session",messages:['Are you sure you want to delete session "'.concat(this.props.course.name,'"?')],onClose:this.toggleDeleteConfirmationModal,onDelete:this.onConfirmDeletion}),this.course.type===P.y.Recorded&&this.state.isRecordingDetailsModalVisible?u.createElement(jn,{visible:this.state.isRecordingDetailsModalVisible,transparent:this.state.isVmDetailsModalVisible||this.state.isDefaultVmDetailsModalVisible,onToggle:this.updateRecordingDetailsModalVisibility,course:this.course,templates:this.props.templates,templateTypes:this.props.templateTypes,courses:this.props.courses,rooms:this.props.rooms,user:this.props.user,vmDetailsHidden:!0,onVmDetails:this.openVMDetails,onVmCustomize:function(){},onVmScreenshotUpdate:function(){},onChapterRecord:function(t){return e.props.onChapterRecord(e.course,t)},onChapterPreview:function(t){return e.props.onChapterPreview(e.course,t)},onChapterRecordUnsupported:this.props.onChapterRecordUnsupported,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,cardModalCtrl:this.props.cardModalCtrl}):null,this.template&&(this.state.isVmDetailsModalVisible||this.state.isDefaultVmDetailsModalVisible)?u.createElement(u.Fragment,null,u.createElement(rn,{dispatch:this.props.dispatch,template:this.template,asyncActions:this.props.asyncActions,courses:this.props.courses,rooms:this.props.rooms,templates:this.props.templates,templateTypes:this.props.templateTypes,visible:this.state.isVmDetailsModalVisible,onToggle:this.updateVMDetailsModalVisibility,onCustomize:this.onVmCustomize,onScreenshotUpdate:this.onVmScreenshotUpdate}),u.createElement(Dr,{template:this.template,visible:this.state.isDefaultVmDetailsModalVisible,onToggle:this.updateDefaultVMDetailsModalVisibility})):null)}},{key:"_getDisableMessage",value:function(){return this.isSessionAboutToStartOrRunning?u.createElement("div",{className:"disable-message"},this.isSessionRunning?"Can't change because a session has started":this.isSessionAboutToStart?"Can't change because a session is starting":""):null}},{key:"_prepareCourse",value:function(e){var t=this;return e?new P.x({name:this.props.courseName,description:this.props.description,templateId:this.props.templateId,type:this.course.type,virtualBrowserUrl:this.course.virtualBrowserUrl}):this.course.withMutations((function(e){return e.set("name",t.props.courseName).set("description",t.props.description).set("templateId",t.props.templateId).set("virtualBrowserUrl",t.props.virtualBrowserUrl)}))}},{key:"_prepareRoom",value:function(e){var t=this,r=mo(this.props.startTime,this.props.timezone),n=mo(this.props.expirationTime,this.props.timezone);return e?new P.Q({region:this.props.region,expectedAttendees:this.props.customersNum,startTime:r.toDate(),expirationTime:n.toDate(),courseId:this.course.id,charge:this.props.charge,chargeAmount:this.props.chargeAmount}):this.props.room.withMutations((function(e){return e.set("region",t.props.region).set("expectedAttendees",t.props.customersNum).set("startTime",r.toDate()).set("expirationTime",n.toDate()).set("courseId",t.course.id).set("charge",t.props.charge).set("chargeAmount",t.props.chargeAmount)}))}},{key:"_updateDateAndTimeFields",value:function(){var e,t,r=(e=this.props.templates,!!(t=this.course)&&!e.find((function(e){return e.id===t.templateId&&e.defaultTemplate})))?pe.a.RoomStartDelay:5,n=this.props.expirationTime.diff(this.props.startTime),o=to().add(r,"m"),a=to(o).add(n,"ms");this.props.change("startTime",o),this.props.change("expirationTime",a)}},{key:"_updateSession",value:function(e,t){var r=this;if(this.template&&this.template.state!==P.bb.Deleted){if(this._validateTimeAndWarn(e,t,this.props.room)){var n=[this.props.dispatch(this.props.asyncActions.updateRoom(e,t))];e.type!==P.y.Recorded&&n.push(this.props.dispatch(this.props.asyncActions.updateCourse(e))),this.setState({isSaving:!0}),Promise.all(n).then((function(){return r.props.onToggle()})).catch((function(){return r.setState({isSaving:!1})}))}}else this.props.dispatch(new v.i(new P.J({type:P.K.Error,text:"Cannot update session. The selected cloud workspace was deleted. Please select a new one"})))}},{key:"_duplicateSession",value:function(e,t){var r=this;if(this.template&&this.template.state!==P.bb.Deleted){if(this._validateTimeAndWarn(e,t)){var n=Promise.resolve(e);e.type!==P.y.Recorded&&(n=this.props.dispatch(this.props.asyncActions.createCourse(new P.x({name:e.name,description:e.description,templateId:e.templateId,type:e.type})))),this.setState({isSaving:!0}),n.then((function(e){return r.props.dispatch(r.props.asyncActions.addRoom(e,t)).then((function(){return r.props.onToggle()}))})).catch((function(){return r.setState({isSaving:!1})}))}}else this.props.dispatch(new v.i(new P.J({type:P.K.Error,text:"Cannot save session. The selected cloud workspace was deleted. Please select a new one"})))}},{key:"_deleteSession",value:function(e,t){var r=this;this.setState({isDeleting:!0});var n=this.props.dispatch(this.props.asyncActions.deleteRoom(e,t)).then((function(){e.type===P.y.Live&&r.props.dispatch(r.props.asyncActions.deleteCourse(e)),r.props.onToggle()}));return n.catch((function(){return r.setState({isDeleting:!1})})),n}},{key:"_validateTimeAndWarn",value:function(e,t,r){return ko(this.props,e,t,r)}},{key:"_hasRecordedChapter",value:function(e){return e.chapters.filter((function(e){return!!e.videoUrl})).count()>0}},{key:"minTime",get:function(){return to().add(1,"minute").seconds(0)}},{key:"isRoomExpiredOrEnded",get:function(){return!this.state.isDuplicatedSession&&Object(Tr.h)(this.props.room)}},{key:"isSaveButtonDisabled",get:function(){return this.state.isDuplicatedSession?!this.props.valid:!this.props.valid||this.props.pristine||this.state.isDeleting}},{key:"endedAt",get:function(){var e=this.props.room.expirationTime,t=this.props.room.endTime;return to(t||e)}},{key:"roomLink",get:function(){return Object(Y.Fb)(this.props.room.secret)}},{key:"startsIn",get:function(){return this.props.room.startTime.getTime()-to.now()}},{key:"startsInDuration",get:function(){return to.duration(Math.max(this.startsIn,0))}},{key:"showJoin",get:function(){return this.startsIn<=9e5&&!this.isRoomExpiredOrEnded&&!this.state.isDuplicatedSession}},{key:"showRoomLink",get:function(){return this.props.room.secret&&!this.isRoomExpiredOrEnded&&!this.showJoin&&!this.state.isDuplicatedSession}},{key:"chaptersSize",get:function(){return this.props.course.chapters.filter((function(e){return!!e.videoUrl})).size}},{key:"course",get:function(){return this.props.recording?this.props.courses.get(this.props.recording):this.props.course}},{key:"template",get:function(){return this.props.templates.get(this.props.templateId||"")||null}},{key:"availableTemplates",get:function(){return Object(g.b)(this.props.templates,this.template)}},{key:"title",get:function(){return this.course.type===P.y.Live?this.state.isDuplicatedSession?"Duplicate Live Session":"Live Session Details":this.state.isDuplicatedSession?"Duplicate Recorded Session":"Recorded Session Details"}},{key:"isModalTransparent",get:function(){return!!this.props.cost.costs.size||this.props.cardModalVisible||this.state.deleteConfirmationModalVisible||this.state.isRecordingDetailsModalVisible||this.state.isVmDetailsModalVisible||this.state.isDefaultVmDetailsModalVisible}},{key:"isSessionRunning",get:function(){return Object(Tr.i)(this.props.room)}},{key:"isSessionAboutToStart",get:function(){return Object(Tr.g)(this.props.room)}},{key:"isSessionAboutToStartOrRunning",get:function(){return(this.isSessionAboutToStart||this.isSessionRunning)&&!this.state.isDuplicatedSession}},{key:"disableVM",get:function(){return this.isRoomExpiredOrEnded||this.course.type===P.y.Recorded||this.isSessionAboutToStartOrRunning}},{key:"isVirtualBrowser",get:function(){return!(!this.template||this.template.os!==P.L.Docker)}}]),t}(u.Component),Object(k.a)(go.prototype,"save",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"save"),go.prototype),Object(k.a)(go.prototype,"toggleDeleteConfirmationModal",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"toggleDeleteConfirmationModal"),go.prototype),Object(k.a)(go.prototype,"toggleLRSEndModalVisible",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"toggleLRSEndModalVisible"),go.prototype),Object(k.a)(go.prototype,"onConfirmDeletion",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"onConfirmDeletion"),go.prototype),Object(k.a)(go.prototype,"cancel",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"cancel"),go.prototype),Object(k.a)(go.prototype,"duplicate",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"duplicate"),go.prototype),Object(k.a)(go.prototype,"join",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"join"),go.prototype),Object(k.a)(go.prototype,"requestRoomExtend",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"requestRoomExtend"),go.prototype),Object(k.a)(go.prototype,"onRecordingChange",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"onRecordingChange"),go.prototype),Object(k.a)(go.prototype,"showRoomCost",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"showRoomCost"),go.prototype),Object(k.a)(go.prototype,"showVMDetails",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"showVMDetails"),go.prototype),Object(k.a)(go.prototype,"updateVMDetailsModalVisibility",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"updateVMDetailsModalVisibility"),go.prototype),Object(k.a)(go.prototype,"updateDefaultVMDetailsModalVisibility",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"updateDefaultVMDetailsModalVisibility"),go.prototype),Object(k.a)(go.prototype,"onVmCustomize",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"onVmCustomize"),go.prototype),Object(k.a)(go.prototype,"onVmScreenshotUpdate",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"onVmScreenshotUpdate"),go.prototype),Object(k.a)(go.prototype,"updateRecordingDetailsModalVisibility",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"updateRecordingDetailsModalVisibility"),go.prototype),Object(k.a)(go.prototype,"openVMDetails",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"openVMDetails"),go.prototype),Object(k.a)(go.prototype,"openRecordingDetails",[w.a],Object.getOwnPropertyDescriptor(go.prototype,"openRecordingDetails"),go.prototype),go),_o=Object(S.a)({form:"editSession",validate:Or.r,enableReinitialize:!0})(Eo),So=Object(D.a)("editSession"),Do=Object(j.c)((function(e,t){return{courseName:So(e,"courseName"),description:So(e,"description"),templateId:So(e,"templateId"),virtualBrowserUrl:So(e,"virtualBrowserUrl"),customersNum:So(e,"customersNum"),region:So(e,"region"),startTime:So(e,"startTime"),expirationTime:So(e,"expirationTime"),timezone:So(e,"timezone"),recording:So(e,"recording"),charge:So(e,"charge"),chargeAmount:So(e,"chargeAmount"),initialValues:{courseName:t.course.name,description:t.course.description,templateId:t.course.templateId,virtualBrowserUrl:t.course.virtualBrowserUrl,customersNum:t.room.expectedAttendees,region:t.room.region,recording:t.course.id,startTime:to(t.room.startTime),expirationTime:to(t.room.expirationTime),timezone:jo,charge:t.room.charge,chargeAmount:t.room.chargeAmount}}}))(_o),Po=r(51),To=r(1738),Ro=r.n(To);r(1916),r(1917),r(1918);function xo(e){var t=Object(Tr.h)(e),r=Object(Tr.i)(e);return t?e.cost?e.cost.costs.count():e.attendeesCount:r?e.attendeesCount:e.expectedAttendees===P.B.TwentyPlus?20:Number(e.expectedAttendees)}function No(e){return e&&e.state!==P.bb.Deleted?"".concat(e.name).concat(Object(g.d)(e)?" - Legacy":""):"- Deleted -"}function Mo(e){var t=e.course.name,r=function(e){return e.room.longRunning?"\ud83d\udd53":e.course.type===P.y.Recorded?"\ud83c\udfa5":""}(e);return r?"".concat(r," ").concat(t):t}r(1919);var Vo,Ao,Io,Uo,Lo,Fo=r(2006),Bo=r(1998),zo=r(1057),Ho=r(1120).isSelected,Wo=25,Ko=30,Yo=460,Go=1198,qo=230,Jo=610,Xo=160,Zo=80,Qo=120,$o=(Io=Ao=function(e){function t(e){var r;Object(i.a)(this,t);var n=(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._generateTableEvents(),o=r._calculateScroll(n);return r.state={tableEvents:n,scrollToIndex:o},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.props.events!==e.events){var t=this._generateTableEvents();this.setState({tableEvents:t})}if(this.props.events.length&&!e.events.length){var r=this._calculateScroll(this.state.tableEvents);this.setState({scrollToIndex:r})}}},{key:"render",value:function(){var e=this.props,t=e.events,r=e.localizer.messages;return u.createElement("div",{className:"agenda-view"},0!==t.length?u.createElement(u.Fragment,null,u.createElement("div",{className:"agenda-content"},u.createElement(Fo.a,{headerHeight:Wo,scrollToIndex:this.state.scrollToIndex,scrollToAlignment:"start",height:Math.min(Yo,this.state.tableEvents.length*Ko+Wo),width:Go,rowCount:this.state.tableEvents.length,rowHeight:Ko,rowGetter:this._rowGetter,rowRenderer:this._rowRenderer,gridStyle:{outline:"none"},className:"agenda-table",headerClassName:"agenda-header-cell"},u.createElement(Bo.a,{width:qo,label:"Date & Time",dataKey:""}),u.createElement(Bo.a,{width:Jo,label:"Name",dataKey:""}),u.createElement(Bo.a,{width:Xo,label:"Cloud Workspace",dataKey:""}),u.createElement(Bo.a,{width:Zo,label:"Learners",dataKey:""}),u.createElement(Bo.a,{width:Qo,label:"Cost",dataKey:""}))),u.createElement("div",{className:"agenda-description"},"Note: For upcoming sessions, the learners and cost values are estimates")):u.createElement("span",{className:"agenda-empty"},r.noEventsInRange))}},{key:"_rowGetter",value:function(e){return this.state.tableEvents[e.index]}},{key:"_rowRenderer",value:function(e){var t=this,r=e.rowData,n=r.event,o=r.rangeDate,a=r.showRangeDate,i=this.props,s=i.accessors,c=i.getters,l=i.selected,p=i.localizer,d=i.components,h=d.event,m=d.date,f=s.title(n),y=s.end(n),v=s.start(n),b=c.eventProp(n,v,y,Ho(n,l)),g=a&&p.format(o,"agendaDateFormat"),O=u.createElement("div",{className:"agenda-date-cell"},a?m?u.createElement(m,{day:o,label:g}):g:null),k=Object(Tr.h)(n.room),C=n.room.cost;return u.createElement("div",{key:e.index+"-"+n.room.id,className:b.className+" agenda-row",style:e.style,onClick:function(){return t.props.onSelectEvent(n)},"data-name":f},O,u.createElement("div",{className:"agenda-time-cell"},this._timeRangeLabel(o,n)),u.createElement("div",{className:"agenda-event-cell"},h?u.createElement(h,{event:n,title:f}):f),u.createElement("div",{className:"agenda-vm-cell"},No(n.template)),u.createElement("div",{className:"agenda-customers-cell"},xo(n.room)),u.createElement("div",{className:"agenda-cost-cell"},k&&C?u.createElement(u.Fragment,null,x.a[C.currency],Object(x.b)(C.total)," (",u.createElement("a",{href:"javascript:void(0);",onClick:function(e){e.stopPropagation(),t.props.onShowCost(n)}},"Details"),")"):u.createElement(u.Fragment,null,k?u.createElement(u.Fragment,null,u.createElement("i",{className:"fa fa-hourglass-half"})," ("):null,u.createElement("a",{href:"javascript:void(0);",onClick:function(e){e.stopPropagation(),t.props.onShowCost(n)}},"Estimate"),k?")":null)))}},{key:"_calculateScroll",value:function(e){if(!e.length)return 0;var t=new Date,r=zo.startOf(t,"day"),n=e.filter((function(e){return e.rangeDate.getTime()===r.getTime()})),o=0;if(n.length){var a=n.filter((function(e){return e.event.room.startTime<t&&e.event.room.expirationTime>t}));if(a.length)o=e.findIndex((function(e){return e===a[0]}));else{var i=n.find((function(e){return e.event.room.startTime>t}));if(i){o=e.findIndex((function(e){return e===i}))}else{var s=n[n.length-1],c=e.findIndex((function(e){return e===s}));o=c===e.length-1?e.length-1:c+1}}}else{var l=e.findIndex((function(e){return e.event.room.startTime>t}));o=l>=0?l:e.length-1}return o-3<0?0:o-3}},{key:"_timeRangeLabel",value:function(e,t){var r=this.props,n=r.accessors,o=r.components,a=r.localizer,i=o.time,s="",c=a.messages.allDay,l=n.end(t),p=n.start(t);return n.allDay(t)||(zo.eq(p,l,"day")?c=a.format({start:p,end:l},"agendaTimeRangeFormat"):zo.eq(e,p,"day")?c=a.format(p,"agendaTimeFormat"):zo.eq(e,l,"day")&&(c=a.format(l,"agendaTimeFormat"))),zo.gt(e,p,"day")&&(s="continues-prior"),zo.lt(e,l,"day")&&(s+=" continues-after"),u.createElement("span",{className:s.trim()},i?u.createElement(i,{event:t,day:e,label:c}):c)}},{key:"_generateRange",value:function(e){var t=new Set;return e.forEach((function(e){var r=zo.startOf(e.room.startTime,"day"),n=zo.startOf(e.room.expirationTime,"day");zo.range(r,n,"day").forEach((function(e){t.add(e.getTime())}))})),Array.from(t).map((function(e){return new Date(e)}))}},{key:"_getDateEvents",value:function(e,t,r){var n=zo.startOf(e,"day"),o=zo.endOf(e,"day");return t.filter((function(e){var t=r.end(e),a=r.start(e);return a>=n&&a<=o||t>=n&&t<=n||a<n&&t>=n}))}},{key:"_generateTableEvents",value:function(){var e=this,t=[];return this._generateRange(this.props.events).forEach((function(r){e._getDateEvents(r,e.props.events,e.props.accessors).forEach((function(e,n){return t.push({rangeDate:r,showRangeDate:0===n,event:e})}))})),t}}]),t}(u.PureComponent),Ao.title=function(){return null},Vo=Io,Object(k.a)(Vo.prototype,"_rowGetter",[w.a],Object.getOwnPropertyDescriptor(Vo.prototype,"_rowGetter"),Vo.prototype),Object(k.a)(Vo.prototype,"_rowRenderer",[w.a],Object.getOwnPropertyDescriptor(Vo.prototype,"_rowRenderer"),Vo.prototype),Vo),ea=(r(1965),r(84));function ta(e){return null}function ra(e){var t=e.data,r=e.className,n=e.filter,o=e.initialSortBy,a=e.initialSortOrder,i=e.onClick,s=e.classNameForRow,c=function(e){var t=[],r={};return d.a.Children.forEach(e,(function(e){var n=e.props.config;t.push(n.id),r[n.id]=n})),[t,r]}(e.children),l=Object(Le.a)(c,2),p=l[0],h=l[1],m=function(e,t,r,n){var o=n.toLowerCase();return Object(u.useMemo)((function(){return n?e.filter((function(e){return t.some((function(t){var n=e[t],a=(r[t]||{}).formatter;return!!a&&-1!==a(n).toLowerCase().indexOf(o)}))})):e}),[e,o])}(t,p,h,n),f=function(e,t,r){var n=Object(u.useState)(t),o=Object(Le.a)(n,2),a=o[0],i=o[1],s=Object(u.useState)(r),c=Object(Le.a)(s,2),l=c[0],p=c[1],d=Object(u.useCallback)((function(t){a===t?p(l===Lo.Ascending?Lo.Descending:Lo.Ascending):(i(t),p(e[t].defaultSortOrder||Lo.Ascending))}),[l,a]);return[a,l,d]}(h,o,a),y=Object(Le.a)(f,3),v=y[0],b=y[1],g=y[2],O=function(e,t,r,n){var o=n===Lo.Ascending?1:-1,a=t[r].comparator;return Object(u.useMemo)((function(){return Object(ea.a)(e).sort((function(e,t){return a(e[r],t[r])*o}))}),[e,r,n,a])}(m,h,v,b),k=function(e,t){return Object(u.useCallback)((function(r){if(t){var n=r.currentTarget.dataset.index,o=e[Number(n||"-1")];o&&t(o)}}),[e,t])}(O,i);return d.a.createElement("table",{className:r},d.a.createElement("thead",null,d.a.createElement("tr",null,p.map((function(e){return d.a.createElement("th",{key:e,onClick:function(){return g(e)},className:e===v?na[b]:""},h[e].header)})))),d.a.createElement("tbody",null,O.map((function(e,t){return d.a.createElement("tr",{"data-index":t,key:"row-".concat(t),className:s?s(e):"",onClick:k},p.map((function(r){return d.a.createElement("td",{key:"".concat(r,"-").concat(t)},h[r].formatter(e[r]))})))}))))}!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(Lo||(Lo={}));var na=(Uo={},Object(Q.a)(Uo,Lo.Descending,"sort-descending"),Object(Q.a)(Uo,Lo.Ascending,"sort-ascending"),Uo);var oa=function(e){var t=e.onSelectEvent,r=e.events,n=e.getters,o=function(e){return d.a.useMemo((function(){return e.filter((function(e){return e.room.longRunning})).map((function(e){return{title:Mo(e),startTime:e.room.startTime,expirationTime:e.room.endTime||e.room.expirationTime,template:No(e.template),attendeesCount:xo(e.room),event:e}}))}),[e])}(r),a=Object(u.useState)(""),i=Object(Le.a)(a,2),s=i[0],c=i[1],l=Object(u.useCallback)((function(e){return t&&t(e.event)}),[t]),p=function(e){return Object(u.useCallback)((function(t){return e.eventProp(t.event).className||""}),[e])}(n);return d.a.createElement("div",{className:"lrs-view"},d.a.createElement("div",{className:"filter"},d.a.createElement("label",{htmlFor:"lrs-view-filter"},"Filter: "),d.a.createElement("input",{id:"lrs-view-filter",type:"text",value:s,onChange:function(e){return c(e.target.value)}})),d.a.createElement(ra,{data:o,initialSortBy:"startTime",initialSortOrder:Lo.Descending,filter:s,onClick:l,classNameForRow:p},d.a.createElement(ta,{config:{id:"title",header:"Name",formatter:ia,comparator:sa}}),d.a.createElement(ta,{config:{id:"startTime",header:"Start Time",formatter:ca,comparator:la,defaultSortOrder:Lo.Descending}}),d.a.createElement(ta,{config:{id:"expirationTime",header:"Expiration Time",formatter:ca,comparator:la,defaultSortOrder:Lo.Descending}}),d.a.createElement(ta,{config:{id:"template",header:"Cloud Workspace",formatter:ia,comparator:sa}}),d.a.createElement(ta,{config:{id:"attendeesCount",header:"Learners",formatter:pa,comparator:ua,defaultSortOrder:Lo.Descending}})))},aa=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return d.a.createElement(oa,this.props)}}]),t}(d.a.PureComponent);aa.title=function(){return null};var ia=function(e){return e},sa=function(e,t){return e.localeCompare(t)},ca=function(e){return f()(e).format("ddd, D MMM, hh:mm a")},la=function(e,t){return e.getTime()-t.getTime()},pa=function(e){return e.toString()},ua=function(e,t){return e-t},da=(r(1966),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this._getDateLabel(this.props.date);return this.props.drilldownView?u.createElement("a",{href:"javascript:void(0);",onClick:this.props.onDrillDown},e):e}},{key:"_getDateLabel",value:function(e){var t=m(e),r=m(e).startOf("month"),n=m(e).endOf("month"),o=t.isSame(r,"dates"),a=t.isSame(n,"dates"),i=t.format("DD");if(o||a){var s=t.format("MMM");return u.createElement("span",{className:"date-label"},"".concat(s," ").concat(i))}return u.createElement("span",{className:"date-label"},i)}}]),t}(u.Component)),ha=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.event,t=m(e.room.startTime),r=m(e.room.endTime?e.room.endTime:e.room.expirationTime),n=t.isSame(r,"day")?"hh:mm a":"D MMM, hh:mm a",o="".concat(t.format(n)," - ").concat(r.format(n)),a=Mo(e);return u.createElement("div",null,o,": ",a)}}]),t}(u.Component),ma=(r(1967),r(1075).navigate),fa=r(1205),ya=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o))))._docKeydownEventCb=void 0,r._nextArrow=void 0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(document.addEventListener("keydown",this._docKeydownEventCb=function(t){return e._keyboardControl(t)}),this._nextArrow){var t=fa();this._nextArrow.style.right="".concat(t+5,"px")}}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._docKeydownEventCb)}},{key:"changeView",value:function(e){this.props.onView(e)}},{key:"navigate",value:function(e){this.props.onNavigate(e)}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"toolbar"},u.createElement("i",{className:"fa fa-caret-left navigation navigation-prev notification-"+this.props.view,onClick:function(){return e.navigate(ma.PREVIOUS)}}),u.createElement("div",{className:"views"},this.props.views.map((function(t){return u.createElement("div",{key:t,className:e.props.view===t?"active":"",onClick:function(){return e.changeView(t)}},e.props.localizer.messages[t])}))),u.createElement("i",{ref:function(t){return e._nextArrow=t},className:"fa fa-caret-right navigation navigation-next notification-"+this.props.view,onClick:function(){return e.navigate(ma.NEXT)}}))}},{key:"_keyboardControl",value:function(e){e.target===document.body&&(e.keyCode===ce.c?(e.preventDefault(),this.navigate(ma.PREVIOUS)):e.keyCode===ce.d&&(e.preventDefault(),this.navigate(ma.NEXT)))}}]),t}(u.Component),va=r(1968),ba=r(1244),ga=r(1075).navigate,Oa=r(1057),ka=r(1205),Ca=r(1232),wa=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o))))._allDayRowContent=void 0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._checkUpdateAllDayForScrolling()}},{key:"componentDidUpdate",value:function(){this._checkUpdateAllDayForScrolling()}},{key:"render",value:function(){var e=this.props.date,r=t.range(e,this.props);return u.createElement(ba,Object.assign({},this.props,{range:r,eventOffset:15}))}},{key:"_checkUpdateAllDayForScrolling",value:function(){var e=ka();if(!(e<=0)){this._allDayRowContent||(this._allDayRowContent=Ca(Object(F.findDOMNode)(this),".rbc-row-content")[0]);var t=this._allDayRowContent;t.scrollHeight>t.clientHeight&&""===t.style.marginRight?t.style.marginRight="-".concat(e,"px"):t.scrollHeight<=t.clientHeight&&""!==t.style.marginRight&&(t.style.marginRight="")}}}]),t}(u.Component);wa.range=function(e,t){var r=Oa.startOf(e,"day"),n=Oa.add(Oa.endOf(e,"day"),6,"day");return Oa.range(r,n)},wa.title=function(e,t){var r=t.localizer,n=wa.range(e,{localizer:r}),o=Object(va.a)(n),a=o[0],i=o.slice(1);return r.format({start:a,end:i.pop()},"dayRangeHeaderFormat")},wa.navigate=function(e,t){switch(t){case ga.PREVIOUS:return Oa.add(e,-7,"day");case ga.NEXT:return Oa.add(e,7,"day");default:return e}};r(1969);var ja,Ea=r(1911),_a=Ro.a.momentLocalizer(m),Sa=Ea(Ro.a),Da={event:function(e){return Mo(e.event)},toolbar:ya,month:{dateHeader:da,event:ha},timeGutterHeader:function(){return u.createElement("div",{className:"rbc-allday-text"},"all day")}},Pa=new Date,Ta=Math.max(Pa.getHours()-6+1,0),Ra=new Date;Ra.setHours(Ta,0,0);var xa,Na,Ma,Va=(ja=function(e){function t(e){var r;Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._eventStartAccessor=function(e){return e.room.startTime},r._eventEndAccessor=function(e){return e.room.endTime?e.room.endTime:e.room.expirationTime},r._eventTitleAccessor=function(e){return Mo(e)},r._eventAllDayAccessor=function(e){return e.room.longRunning};var n=r._getAllSessions(r.props.courses,r.props.rooms),o=r._getEvents(n);return r.state={sessions:n,events:o},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.props.courses!==e.courses||this.props.rooms!==e.rooms){var t=this._getAllSessions(this.props.courses,this.props.rooms),r=this._getEvents(t);this.setState({sessions:t,events:r})}}},{key:"eventProps",value:function(e){return{className:this.eventStyles(e)}}},{key:"eventStyles",value:function(e){var t=new Date,r="";return e.room.startTime<t&&t<e.room.expirationTime&&(r="event-running"),e.room.startTime<t&&e.room.expirationTime<t&&(r="event-expired"),e.room.endTime&&e.room.startTime<t&&e.room.endTime<t&&(r="event-ended"),e.currentlySaving&&(r+=" event-saving"),this._isSibling(e)||(r+=" event-single"),r}},{key:"onSelectSlot",value:function(e){var t=function(e){return"string"===typeof e?new Date(e):e},r=t(e.start),n=t(e.end);this.props.onSelectSlot(m(r),m(n))}},{key:"onSelectEvent",value:function(e){var t=this._getSessionByEventDetails(e);t&&this.props.onSelectEvent&&this.props.onSelectEvent(t.course,t.room)}},{key:"onShowCost",value:function(e){this.props.onCostDetails&&this.props.onCostDetails(e.room)}},{key:"onEventDrag",value:function(e){var t=this,r=e.start,n=e.end,o=e.event;this.props.onEventDrag&&this.setState((function(e){var a=e.events,i=a.map((function(e){return e.room.id===o.room.id?Object(Po.a)({},o,{start:r,end:n,currentlySaving:!0}):e})),s=t._getSessionByEventDetails(o);if(s&&t.props.onEventDrag){var c=s.room.withMutations((function(e){return e.set("startTime",r).set("expirationTime",n)}));t.props.onEventDrag(s.course,c).then((function(e){e||t.setState({events:a})}))}return{events:i}}))}},{key:"render",value:function(){return u.createElement("div",{className:"rhyme-calendar"},u.createElement(Sa,{localizer:_a,defaultView:"week",components:Da,defaultDate:Pa,scrollToTime:Ra,formats:{dayFormat:"ddd, D MMM",agendaDateFormat:"ddd, D MMM",agendaTimeRangeFormat:function(e,t,r){var n=e.start,o=e.end;return r.format(n,"hh:mm a",t)+" - "+r.format(o,"hh:mm a",t)},dayHeaderFormat:"ddd, D MMM",agendaHeaderFormat:function(){return"ddd, D MMM"},dayRangeHeaderFormat:function(e,t,r){var n=e.start,o=e.end;return r.format(n,"D MMM",t)+" - "+r.format(o,"D MMM",t)},timeGutterFormat:"ha"},selectable:!0,resizable:!1,showMultiDayTimes:!0,popup:!0,popupOffset:40,step:20,timeslots:3,views:{lrs:aa,agenda:$o,week:wa,month:!0},startAccessor:this._eventStartAccessor,endAccessor:this._eventEndAccessor,titleAccessor:this._eventTitleAccessor,tooltipAccessor:this._eventTitleAccessor,allDayAccessor:this._eventAllDayAccessor,events:this.state.events,eventPropGetter:this.eventProps,onSelectSlot:this.onSelectSlot,onSelectEvent:this.onSelectEvent,onEventDrop:this.onEventDrag,onShowCost:this.onShowCost,messages:{lrs:"Long Running",agenda:"List",week:"Week",month:"Month",noEventsInRange:"There are not created sessions"}}))}},{key:"_isSibling",value:function(e){return!!this.state.events.filter((function(t){return t.room.id!==e.room.id})).find((function(t){return e.room.expirationTime>t.room.startTime&&t.room.expirationTime>e.room.startTime}))}},{key:"_getAllSessions",value:function(e,t){return e.count()&&t.count()?t.map((function(t){var r=e.get(t.courseId);return r?{room:t,course:r}:null})).filter((function(e){return!!e})).toArray():[]}},{key:"_getEvents",value:function(e){var t=this;return e.map((function(e){var r=e.room,n=e.course;return{currentlySaving:!1,room:r,course:n,template:t.props.templates.get(n.templateId)}})).filter((function(e){return!!e})).sort((function(e,t){var r=e.room,n=r.startTime,o=r.endTime,a=r.expirationTime,i=t.room,s=i.startTime,c=i.endTime,l=i.expirationTime,p=n.getTime()-s.getTime();return 0===p?o&&c?o.getTime()-c.getTime():a.getTime()-l.getTime():p}))}},{key:"_getSessionByEventDetails",value:function(e){return this.state.sessions.find((function(t){var r=t.room,n=t.course;return r.id===e.room.id&&n.id===e.course.id}))||null}}]),t}(u.PureComponent),Object(k.a)(ja.prototype,"eventProps",[w.a],Object.getOwnPropertyDescriptor(ja.prototype,"eventProps"),ja.prototype),Object(k.a)(ja.prototype,"onSelectSlot",[w.a],Object.getOwnPropertyDescriptor(ja.prototype,"onSelectSlot"),ja.prototype),Object(k.a)(ja.prototype,"onSelectEvent",[w.a],Object.getOwnPropertyDescriptor(ja.prototype,"onSelectEvent"),ja.prototype),Object(k.a)(ja.prototype,"onShowCost",[w.a],Object.getOwnPropertyDescriptor(ja.prototype,"onShowCost"),ja.prototype),Object(k.a)(ja.prototype,"onEventDrag",[w.a],Object.getOwnPropertyDescriptor(ja.prototype,"onEventDrag"),ja.prototype),ja),Aa=(r(1970),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"create-session-btn"},u.createElement(T.a,{className:"create-button",onClick:this.props.onClick},"Create Session"),u.createElement("span",{className:"line-separator"}))}}]),t}(u.Component)),Ia=(r(1971),xa=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o))))._updateTimeout=void 0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.room.startTime.getTime()-(new Date).getTime();e>0&&(this._updateTimeout=setTimeout(this.forceUpdate.bind(this),e))}},{key:"componentWillUnmount",value:function(){this._updateTimeout&&clearTimeout(this._updateTimeout)}},{key:"joinSession",value:function(){var e=this.props.room.secret;this.props.dispatch(Object(h.g)(Object(Y.Ub)(e)))}},{key:"render",value:function(){if(!this.course)return null;var e=this.course.name;return u.createElement("div",{className:"join-session-btn"},u.createElement("div",{className:"cont"},u.createElement("p",{className:"title"},"Session \u201c",e.length<=50?e:e.substr(0,50)+"...","\u201d start",(new Date).getTime()>=this.props.room.startTime.getTime()?"ed":"s"," ","at ",this.startTime),u.createElement("div",null,u.createElement(T.a,{onClick:this.joinSession},"Join Session"),u.createElement("a",{href:"javascript:void(0);",onClick:this.props.onSessionCreate},"Create Another Session"))))}},{key:"course",get:function(){return this.props.courses.get(this.props.room.courseId)}},{key:"startTime",get:function(){var e=m.tz.guess();return m(this.props.room.startTime).tz(e).format("h:mma ([GMT] Z)")}}]),t}(u.Component),Object(k.a)(xa.prototype,"joinSession",[w.a],Object.getOwnPropertyDescriptor(xa.prototype,"joinSession"),xa.prototype),xa);!function(e){e[e.Loading=0]="Loading",e[e.Loaded=1]="Loaded",e[e.NoCourses=2]="NoCourses"}(Ma||(Ma={}));var Ua,La,Fa=(Na=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={loadState:e.loadingInitialData?Ma.Loading:Ma.Loaded},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.loadingInitialData!==e.loadingInitialData&&this.setState({loadState:this.props.loadingInitialData?Ma.Loading:Ma.Loaded})}},{key:"createSession",value:function(){this.props.dispatch(Object(h.g)(Y.pb))}},{key:"startScheduling",value:function(e,t){this.props.dispatch(Object(h.g)(Object(Y.Vb)(e.format(Y.eb),t.format(Y.eb))))}},{key:"onCostDetails",value:function(e){this.props.dispatch(this.props.asyncActions.loadRoomCost(e))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"sessions-list"},function(){switch(e.state.loadState){case Ma.Loading:default:return u.createElement(Xn,null);case Ma.Loaded:case Ma.NoCourses:return e.renderScheduler()}}())}},{key:"renderScheduler",value:function(){var e=this.upcomingSession;return u.createElement("div",null,e?u.createElement(Ia,{dispatch:this.props.dispatch,room:e,courses:this.props.courses,onSessionCreate:this.createSession}):u.createElement(Aa,{onClick:this.createSession}),u.createElement(Va,{rooms:this.props.rooms,courses:this.props.courses,templates:this.props.templates,onEventDrag:this._onEventDrag,onSelectEvent:this.props.onSessionSelect,onSelectSlot:this.startScheduling,onCostDetails:this.onCostDetails}))}},{key:"_onEventDrag",value:function(e,t){var r=this.props.rooms.find((function(e){return e.id===t.id}));if(ko(this.props,e,t,r)){var n=t.toJS();return this.props.dispatch(this.props.asyncActions.updateRoom(e,new P.Q(n))).then((function(){return!0})).catch((function(){return!1}))}return Promise.resolve(!1)}},{key:"upcomingSession",get:function(){var e=(new Date).getTime(),t=this.props.rooms.filter((function(t){return t.startTime.getTime()-6e5<=e&&e<(t.endTime||t.expirationTime).getTime()})).sort((function(e,t){return e.startTime.getTime()-t.startTime.getTime()})).first();return t&&this.props.courses.get(t.courseId)?t:null}}]),t}(u.Component),Object(k.a)(Na.prototype,"createSession",[w.a],Object.getOwnPropertyDescriptor(Na.prototype,"createSession"),Na.prototype),Object(k.a)(Na.prototype,"startScheduling",[w.a],Object.getOwnPropertyDescriptor(Na.prototype,"startScheduling"),Na.prototype),Object(k.a)(Na.prototype,"onCostDetails",[w.a],Object.getOwnPropertyDescriptor(Na.prototype,"onCostDetails"),Na.prototype),Object(k.a)(Na.prototype,"_onEventDrag",[w.a],Object.getOwnPropertyDescriptor(Na.prototype,"_onEventDrag"),Na.prototype),Na);r(1972);!function(e){e[e.Update=0]="Update",e[e.Screenshot=1]="Screenshot"}(La||(La={}));var Ba,za,Ha,Wa,Ka,Ya,Ga,qa,Ja,Xa=(Ua=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._sessionDetails=void 0,r._chapterVmService=new Zt(Object(Z.a)(r)),r.state={selectedSession:null,selectedTemplate:null,courseId:null,selectedChapterId:null,courseVmId:null,vm:null,vmCustomizer:null},r._redirectIfNoData(),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"showSessionDetails",value:function(e,t){this.setState({selectedSession:{courseId:e.id,roomId:t.id}})}},{key:"toggleSessionDetailsModal",value:function(){this.sessionDetailsVisibility&&this.setState({selectedSession:null})}},{key:"customizeSessionVm",value:function(e,t,r){var n=this;return this.setState({selectedTemplate:t,vmCustomizer:r}),this._createVmFromTemplate(t).then((function(){e===La.Update?n.props.dispatch(Object(h.g)(Y.mb)):e===La.Screenshot&&n.props.dispatch(Object(h.g)(Y.lb))}))}},{key:"endOfTemplateCustomization",value:function(){var e=this;this.props.dispatch(Object(h.g)(Y.qb)),this.setState({vm:new P.lb({}),selectedTemplate:null},(function(){e._sessionDetails&&e.state.vmCustomizer&&(e.state.vmCustomizer===Oo.SessionDetails?e._sessionDetails.updateVMDetailsModalVisibility(!0):(e._sessionDetails.updateRecordingDetailsModalVisibility(),e._sessionDetails.updateVMDetailsModalVisibility(!0)),e._sessionDetails.setState({vmCustomizer:e.state.vmCustomizer}))}))}},{key:"onChapterRecord",value:function(e,t){var r=this;this.setState({courseId:e.id,selectedChapterId:t.id},(function(){r._chapterVmService.requestVm().then((function(){return r.props.dispatch(Object(h.g)(Y.jb))}))}))}},{key:"onChapterPreview",value:function(e,t){this.setState({courseId:e.id,selectedChapterId:t.id}),this.props.dispatch(Object(h.g)(Y.hb))}},{key:"onChapterRecordUnsupported",value:function(){this.props.dispatch(Object(h.g)(Y.ib))}},{key:"reopenRecordingDetails",value:function(){var e=this;this.props.dispatch(Object(h.g)(Y.qb)),this.setState({courseId:null,selectedChapterId:null},(function(){e._sessionDetails&&e._sessionDetails.updateRecordingDetailsModalVisibility()}))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"sessions"},u.createElement(y.d,null,u.createElement(y.b,{path:Y.qb,exact:!0,render:function(){return u.createElement(u.Fragment,null,u.createElement(Fa,{courses:e.props.courses,rooms:e.props.rooms,templates:e.props.templates,user:e.props.user,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,loadingInitialData:e.props.loadingInitialData,onSessionSelect:e.showSessionDetails}),e.selectedSessionCourse&&e.selectedSessionRoom?u.createElement(Do,{onRef:function(t){return e._sessionDetails=t},course:e.selectedSessionCourse,room:e.selectedSessionRoom,courses:e.props.courses,templates:e.props.templates,templateTypes:e.props.templateTypes,rooms:e.props.rooms,cost:e.props.cost,visible:e.sessionDetailsVisibility,user:e.props.user,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,cardModalCtrl:e.props.cardModalCtrl,cardModalVisible:e.props.cardModalVisible,onToggle:e.toggleSessionDetailsModal,onVmCustomize:function(t,r){return e.customizeSessionVm(La.Update,t,r)},onVmScreenshotUpdate:function(t,r){return e.customizeSessionVm(La.Screenshot,t,r)},onChapterRecord:e.onChapterRecord,onChapterPreview:e.onChapterPreview,onChapterRecordUnsupported:e.onChapterRecordUnsupported}):null)}}),u.createElement(y.b,{path:Y.mb,exact:!0,render:function(){return e.state.vm&&e.state.selectedTemplate?u.createElement(er,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate},u.createElement(gr,{dispatch:e.props.dispatch,vm:e.state.vm,remoteClientManager:e.props.remoteClientManager,asyncActions:e.props.asyncActions,template:e.state.selectedTemplate,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.b,{path:Y.lb,exact:!0,render:function(){return e.state.vm&&e.state.selectedTemplate?u.createElement(er,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate},u.createElement(vr,{dispatch:e.props.dispatch,vm:e.state.vm,template:e.state.selectedTemplate,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.b,{path:Y.jb,exact:!0,render:function(){return e.course&&e.selectedChapter&&e.selectedRecordingVm?u.createElement(ot,{dispatch:e.props.dispatch,vm:e.selectedRecordingVm,course:e.course,chapter:e.selectedChapter,asyncActions:e.props.asyncActions,vms:e.props.vms,templates:e.props.templates,onExit:e.reopenRecordingDetails,remoteClientManager:e.props.remoteClientManager}):null}}),u.createElement(y.b,{path:Y.hb,exact:!0,render:function(){return e.course&&e.selectedChapter?u.createElement(Xt,{dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,course:e.course,chapter:e.selectedChapter,currentChapter:e.props.currentChapter,onExit:e.reopenRecordingDetails}):null}}),u.createElement(y.b,{path:Y.ib,exact:!0,render:function(){return u.createElement(te,{onBack:e.reopenRecordingDetails})}}),u.createElement(y.a,{to:Y.H})))}},{key:"_createVmFromTemplate",value:function(e){var t=this;return this.props.dispatch(this.props.asyncActions.getVMAndConnection(e,!0)).then((function(e){t.setState({vm:e})}))}},{key:"_redirectIfNoData",value:function(){var e=this.props.location,t=(Object(Y.Hb)(e,Y.jb)||Object(Y.Hb)(e,Y.hb))&&(!this.course||!this.selectedChapter),r=(Object(Y.Hb)(e,Y.mb)||Object(Y.Hb)(e,Y.lb))&&(!this.state.vm||!this.state.selectedTemplate);(t||r)&&this.props.dispatch(Object(h.h)(Y.qb))}},{key:"sessionDetailsVisibility",get:function(){return!!this.state.selectedSession}},{key:"selectedSessionCourse",get:function(){var e=this.state.selectedSession;return e?this.props.courses.get(e.courseId):null}},{key:"selectedSessionRoom",get:function(){var e=this.state.selectedSession;return e?this.props.rooms.find((function(t){return t.id===e.roomId})):null}},{key:"course",get:function(){return this.props.courses.get(this.state.courseId||"")}},{key:"selectedChapter",get:function(){var e=this;return this.course&&this.state.selectedChapterId?this.course.chapters.find((function(t){return t.id===e.state.selectedChapterId})):null}},{key:"selectedRecordingVm",get:function(){return this.course&&this.state.courseVmId?this.props.vms.get(this.state.courseVmId):null}}]),t}(u.Component),Object(k.a)(Ua.prototype,"showSessionDetails",[w.a],Object.getOwnPropertyDescriptor(Ua.prototype,"showSessionDetails"),Ua.prototype),Object(k.a)(Ua.prototype,"toggleSessionDetailsModal",[w.a],Object.getOwnPropertyDescriptor(Ua.prototype,"toggleSessionDetailsModal"),Ua.prototype),Object(k.a)(Ua.prototype,"customizeSessionVm",[w.a],Object.getOwnPropertyDescriptor(Ua.prototype,"customizeSessionVm"),Ua.prototype),Object(k.a)(Ua.prototype,"endOfTemplateCustomization",[w.a],Object.getOwnPropertyDescriptor(Ua.prototype,"endOfTemplateCustomization"),Ua.prototype),Object(k.a)(Ua.prototype,"onChapterRecord",[w.a],Object.getOwnPropertyDescriptor(Ua.prototype,"onChapterRecord"),Ua.prototype),Object(k.a)(Ua.prototype,"onChapterPreview",[w.a],Object.getOwnPropertyDescriptor(Ua.prototype,"onChapterPreview"),Ua.prototype),Object(k.a)(Ua.prototype,"onChapterRecordUnsupported",[w.a],Object.getOwnPropertyDescriptor(Ua.prototype,"onChapterRecordUnsupported"),Ua.prototype),Object(k.a)(Ua.prototype,"reopenRecordingDetails",[w.a],Object.getOwnPropertyDescriptor(Ua.prototype,"reopenRecordingDetails"),Ua.prototype),Ua),Za=(r(1973),r(1974),r(1127)),Qa=r(1131),$a=r(1130),ei=(r(1975),Ba=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onConfirm",value:function(e){this.props.onConfirm(this.props.confirmPassword),this.props.dispatch(Object(E.a)("confirmChanges","confirmPassword","")),this.props.onToggle(!1),e.preventDefault()}},{key:"render",value:function(){return u.createElement("div",{className:"confirm-changes-modal form-styles"},u.createElement(R.a,{title:"Confirm Changes",onToggle:this.props.onToggle,visible:this.props.visible},u.createElement("form",{name:"confirmChanges",onSubmit:this.onConfirm},u.createElement("p",{className:"text"},"Please enter your current password to confirm changes"),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"confirmPassword",type:"password",autoFocus:!0,component:T.s},{label:"Current Password"}))),u.createElement("div",{className:"row"},u.createElement(T.a,{disabled:!this.props.valid||!this.props.confirmPassword},"Save")))))}}]),t}(u.Component),Object(k.a)(Ba.prototype,"onConfirm",[w.a],Object.getOwnPropertyDescriptor(Ba.prototype,"onConfirm"),Ba.prototype),Ba),ti=Object(S.a)({form:"confirmChanges",validate:T.E})(ei),ri=Object(D.a)("confirmChanges"),ni=Object(j.c)((function(e){return{confirmPassword:ri(e,"confirmPassword")}}))(ti),oi=(za=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={isDeleting:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){!this.props.visible&&e.visible&&this.props.dispatch(Object(E.b)("deleteAccountForm"))}},{key:"onClose",value:function(){this.props.onToggle(!1)}},{key:"onDelete",value:function(){var e=this;this.props.securityCode&&(this.setState({isDeleting:!0}),this.props.onConfirm(this.props.securityCode).catch((function(){return e.setState({isDeleting:!1})})))}},{key:"render",value:function(){return u.createElement("div",{className:"delete-account-modal form-styles"},u.createElement(R.a,{title:"Delete Account",onToggle:this.props.onToggle,visible:this.props.visible},u.createElement("form",{name:"deleteAccountForm",onSubmit:function(e){return e.preventDefault()}},u.createElement("p",{className:"text"},"Please check your email to find the security code"),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"securityCode",type:"password",maxLength:T.l.securityCode.max,autoFocus:!0,component:T.s},{label:"Security code"}))),u.createElement("div",{className:"row"},u.createElement(T.a,{type:"button",className:"short-btn",onClick:this.onClose,disabled:this.state.isDeleting},"No, keep it"),u.createElement(T.a,{className:"short-btn empty",onClick:this.onDelete,disabled:!this.props.valid,loading:this.state.isDeleting},"Delete")))))}}]),t}(u.PureComponent),Object(k.a)(za.prototype,"onClose",[w.a],Object.getOwnPropertyDescriptor(za.prototype,"onClose"),za.prototype),Object(k.a)(za.prototype,"onDelete",[w.a],Object.getOwnPropertyDescriptor(za.prototype,"onDelete"),za.prototype),za),ai=Object(S.a)({form:"deleteAccountForm",validate:T.K})(oi),ii=Object(D.a)("deleteAccountForm"),si=Object(j.c)((function(e){return{securityCode:ii(e,"securityCode")}}))(ai),ci=(r(1976),Ha=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={isLoading:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),this.props.newPassword&&(this.setState({isLoading:!0}),this.props.onPassword(this.props.newPassword).then((function(){t.props.onToggle(!1),t.props.dispatch(Object(E.b)("setPassword"))})).finally((function(){return t.setState({isLoading:!1})})))}},{key:"render",value:function(){return u.createElement(R.a,{title:"Set Password",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("form",{name:"setPassword",className:"set-pass-modal",onSubmit:this.onSubmit},u.createElement("p",{className:"text"},"Please set a password to be able to confirm changes"),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"newPassword",type:"password",autoFocus:!0,component:T.s},{label:"Password"})),u.createElement("p",{className:"description"},"Long passwords are safer. ",Qa.a[Object(Qa.b)(this.props.newPassword||"")])),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"repeatPassword",type:"password",component:T.s},{label:"Repeat password"}))),u.createElement("div",{className:"row"},u.createElement(T.a,{disabled:!this.props.valid,loading:this.state.isLoading},"Save"))))}}]),t}(u.Component),Object(k.a)(Ha.prototype,"onSubmit",[w.a],Object.getOwnPropertyDescriptor(Ha.prototype,"onSubmit"),Ha.prototype),Ha),li=Object(S.a)({form:"setPassword",validate:T.J})(ci),pi=Object(D.a)("setPassword"),ui=Object(j.c)((function(e){return{newPassword:pi(e,"newPassword"),repeatPassword:pi(e,"repeatPassword")}}))(li),di=r(1160).default,hi=r(1159).default,mi=function(e){return Object.values(e).map((function(e){return u.createElement(_n.a,{value:e,key:e},e)}))},fi=(Wa=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._lastPassAutofilledPass=void 0,r._lastPasswordValue="",r._cardForm=void 0,r._cardSubmitResolve=void 0,r._cardSubmitReject=void 0,r._autofillTimeout=void 0,r._cardPromise=new Promise((function(e,t){r._cardSubmitResolve=e,r._cardSubmitReject=t})),r.state={loading:!1,isConfirmChangesVisible:!1,isSetPasswordVisible:!1,isDeleteAccountModalVisible:!1,ccValid:!0,ccPristine:!0,ccDelete:!1,ccUpdate:!1},r._updateCardBalance(),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._handleLastPassAutofill()}},{key:"componentWillUnmount",value:function(){clearTimeout(this._autofillTimeout)}},{key:"cancel",value:function(){this.props.dispatch(Object(E.b)("settings")),this._cardForm.reset()}},{key:"save",value:function(){var e=this,t=Promise.resolve();!this.state.ccPristine&&this.card&&(t=new Promise((function(t){return e.setState({ccDelete:!0,ccUpdate:!0},t)}))),t.then((function(){e.props.newPassword||e.props.email!==e.props.user.email||e.state.ccDelete&&!e.state.ccUpdate?e.props.user.hasPassword||e.props.newPassword?e.toggleConfirmChangesModal(!0):e.toggleSetPasswordModal(!0):e.updateData()}))}},{key:"deleteCard",value:function(){this.state.ccDelete||(this.setState({ccDelete:!0}),this.props.user.hasPassword?this.toggleConfirmChangesModal(!0):this.toggleSetPasswordModal(!0))}},{key:"cardSubmit",value:function(e,t){var r=this,n=t?this.props.asyncActions.editCreditCard(this.props.user,this.card.id,e):this.props.asyncActions.addCreditCard(this.props.user,e);return this.props.dispatch(n).then((function(){r._cardForm.reset(),r._cardSubmitResolve()}),(function(){return r._cardSubmitReject()}))}},{key:"onDeleteUser",value:function(){var e=this;this.props.dispatch(this.props.asyncActions.deleteUserConfirmation()).then((function(){return e.toggleDeleteAccountModal(!0)}))}},{key:"stopLoader",value:function(){this.setState({loading:!1})}},{key:"updateData",value:function(e){var t=this;this.setState({loading:!0}),Promise.all([this.state.ccDelete?Promise.resolve():this._updateSettings(this.props.newPassword,e),this._updateCard(e)]).then((function(){var e=new P.J({type:P.K.General,text:"Successfully updated"});t.props.dispatch(new v.i(e)),t.props.change("newPassword",""),t.setState({ccDelete:!1,ccUpdate:!1,ccPristine:!0,ccValid:!0})})).finally(this.stopLoader)}},{key:"deleteUser",value:function(e){var t=this;return this.props.dispatch(this.props.asyncActions.deleteUser(e)).then((function(){t.props.dispatch(new v.i(new P.J({type:P.K.General,title:"Account Deleted",text:"Your account was successfully deleted and all personally identifiable information removed"})))}))}},{key:"toggleConfirmChangesModal",value:function(e){var t=this;this.setState({isConfirmChangesVisible:e},(function(){e||t.setState({ccDelete:!1})}))}},{key:"toggleDeleteAccountModal",value:function(e){this.setState({isDeleteAccountModalVisible:e})}},{key:"toggleSetPasswordModal",value:function(e){this.setState({isSetPasswordVisible:e})}},{key:"onCardUpdate",value:function(e){var t=e.valid,r=e.pristine,n=r,o=!!r||t;this.setState({ccValid:o,ccPristine:n,ccDelete:!1})}},{key:"onPassChange",value:function(e){this._stopLastPassManipulations(e)}},{key:"onPasswordSet",value:function(e){var t=this,r=this._updateSettings(e,e);return this.state.ccDelete&&r.then((function(){return t.updateData(e)})),r}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"settings-form form-styles"},u.createElement("fieldset",{className:"no-border"},u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"name",component:T.s,type:"text"},{label:"Name"}))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"email",component:T.f,disabled:this.props.user.origin!==P.fb.Rhyme},{label:"Email"}))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"newPassword",autoComplete:"new-password",component:T.s,type:"password",onChange:this.onPassChange},{label:"Password",ignoreLastPass:!0})),u.createElement("p",{className:"field-info"},"Long passwords are safer. ",this.renderPassStrength()))),u.createElement("fieldset",null,u.createElement("legend",null,"Credit Card"),u.createElement($a.b,{card:this.card,dispatch:this.props.dispatch,hideSaveButton:!0,onRef:function(t){return e._cardForm=t},onCardSave:this.cardSubmit,onStripeError:this.stopLoader,onUpdate:this.onCardUpdate}),this.card&&u.createElement("a",{href:"javascript:void(0);",className:"delete-card",onClick:this.deleteCard},"Delete Card")),u.createElement("fieldset",null,u.createElement("legend",null,"SMS"),u.createElement("div",{className:"row"},u.createElement(_.a,{name:"cellNumber",component:T.p})),u.createElement("div",{className:"row"},u.createElement(_.a,{disabled:!this.props.cellNumber,name:"missedChat",label:"Message notifications preference",component:T.u},mi(P.I)),u.createElement("p",{className:"field-info"},"We will forward missed chat messages to the host by SMS")),u.createElement("div",{className:"row"},u.createElement(_.a,{disabled:!this.props.cellNumber,name:"sessionReminder",label:"Session reminders preference",component:T.u},mi(P.U)),u.createElement("p",{className:"field-info"},"We will remind the host of a session by SMS"))),u.createElement("fieldset",{className:"no-border"},u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"bio",type:"text",component:T.v},{label:"About You"})))),u.createElement("fieldset",null,u.createElement("legend",null,"Your Social Media Profiles"),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"twitterUrl",component:T.s,type:"text"},{label:"Twitter"})),u.createElement("p",{className:"field-info"},"Promote your social media profiles in the landing pages of your recordings and in your profile")),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"githubUrl",component:T.s,type:"text"},{label:"GitHub"}))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"linkedinUrl",component:T.s,type:"text"},{label:"LinkedIn"}))),u.createElement("div",{className:"row"},u.createElement(_.a,Object.assign({name:"facebookUrl",component:T.s,type:"text"},{label:"Facebook"})))),u.createElement("div",{className:"row"},u.createElement("div",{className:"action-btns"},u.createElement(T.a,{className:"empty",disabled:this.pristine,onClick:this.cancel},"Cancel"),u.createElement(T.a,{disabled:!this.valid,loading:this.state.loading,onClick:this.save},"Save")),u.createElement("p",{className:"field-info delete"},u.createElement("a",{href:"javascript:void(0);",onClick:this.onDeleteUser},"Delete Account"))),this.renderModals())}},{key:"renderModals",value:function(){return u.createElement(u.Fragment,null,u.createElement(ni,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,visible:this.state.isConfirmChangesVisible,onToggle:this.toggleConfirmChangesModal,onConfirm:this.updateData}),u.createElement(ui,{dispathc:this.props.dispatch,visible:this.state.isSetPasswordVisible,onToggle:this.toggleSetPasswordModal,onPassword:this.onPasswordSet}),u.createElement(si,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,visible:this.state.isDeleteAccountModalVisible,onToggle:this.toggleDeleteAccountModal,onConfirm:this.deleteUser}))}},{key:"renderPassStrength",value:function(){if(this.props.newPassword){var e=Object(Qa.b)(this.props.newPassword);return Qa.a[e]}return""}},{key:"_updateSettings",value:function(e,t){var r=this,n=Promise.resolve();if(!this.props.pristine||!this.props.user.hasPassword){var o=hi((function(e,t,r){return r.set(e,t)})),a=hi((function(e,t,r){return t?r.set(e,t):r})),i=this.props.cellNumber?Object(Za.a)(Object(Za.b)(this.props.cellNumber||""),"E.164"):"",s=this._formatSocialLink(this.props.twitterUrl,T.B),c=this._formatSocialLink(this.props.githubUrl,T.j),l=this._formatSocialLink(this.props.linkedinUrl,T.m),p=this._formatSocialLink(this.props.facebookUrl,T.g),u=di(a("name",this.props.name),a("email",this.props.email),a("password",t),a("newPassword",e),o("mobileNumber",i),o("bio",this.props.bio),o("twitterUrl",s),o("githubUrl",c),o("linkedinUrl",l),o("facebookUrl",p),(function(e){return e.set("settings",e.settings.set("missedChatNotifications",r.props.missedChat).set("sessionReminder",r.props.sessionReminder))})),d=this.props,h=d.asyncActions,m=d.dispatch,f=this.props.user.withMutations(u);n=m(h.updateUser(f))}return n}},{key:"_formatSocialLink",value:function(e,t){return e?e.trim().replace(t,(function(e,t,r){return r})):""}},{key:"_updateCard",value:function(e){var t=this,r=Promise.resolve();if(this.state.ccDelete&&!this.state.ccUpdate){var n=this.props.user.set("password",e||"");return this.props.dispatch(this.props.asyncActions.deleteCreditCard(n,this.card)).then((function(){t.state.ccUpdate||t._cardForm.clear()}),(function(e){throw t._cardForm.reset(),e}))}return this.state.ccPristine||(r=this._cardPromise,this._cardForm.submit(this.state.ccDelete&&this.state.ccUpdate)),r}},{key:"_updateCardBalance",value:function(){if(this.card&&this.card.brand===P.m.Rhyme){var e=this.props,t=e.asyncActions,r=e.dispatch,n=e.user;r(t.loadCreditCards(n))}}},{key:"_handleLastPassAutofill",value:function(){var e=this;this._autofillTimeout=setTimeout((function(){e.props.newPassword&&(e._lastPassAutofilledPass=e.props.newPassword,e.props.change("newPassword",""))}),1e3)}},{key:"_stopLastPassManipulations",value:function(e){var t=this,r=e.target.value;this._lastPassAutofilledPass&&this._lastPassAutofilledPass===r&&r.substr(0,r.length-1)!==this._lastPasswordValue?setTimeout((function(){return t.props.change("newPassword",t._lastPasswordValue)})):this._lastPasswordValue=r}},{key:"valid",get:function(){var e=!!this.props.valid&&!this.props.pristine,t=this.state.ccValid&&!this.state.ccPristine||this.state.ccDelete;return e||t}},{key:"pristine",get:function(){return!!this.props.pristine&&this.state.ccPristine}},{key:"card",get:function(){return this.props.user.creditCards.find((function(e){return e.primary}))}}]),t}(u.Component),Object(k.a)(Wa.prototype,"cancel",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"cancel"),Wa.prototype),Object(k.a)(Wa.prototype,"save",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"save"),Wa.prototype),Object(k.a)(Wa.prototype,"deleteCard",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"deleteCard"),Wa.prototype),Object(k.a)(Wa.prototype,"cardSubmit",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"cardSubmit"),Wa.prototype),Object(k.a)(Wa.prototype,"onDeleteUser",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"onDeleteUser"),Wa.prototype),Object(k.a)(Wa.prototype,"stopLoader",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"stopLoader"),Wa.prototype),Object(k.a)(Wa.prototype,"updateData",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"updateData"),Wa.prototype),Object(k.a)(Wa.prototype,"deleteUser",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"deleteUser"),Wa.prototype),Object(k.a)(Wa.prototype,"toggleConfirmChangesModal",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"toggleConfirmChangesModal"),Wa.prototype),Object(k.a)(Wa.prototype,"toggleDeleteAccountModal",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"toggleDeleteAccountModal"),Wa.prototype),Object(k.a)(Wa.prototype,"toggleSetPasswordModal",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"toggleSetPasswordModal"),Wa.prototype),Object(k.a)(Wa.prototype,"onCardUpdate",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"onCardUpdate"),Wa.prototype),Object(k.a)(Wa.prototype,"onPassChange",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"onPassChange"),Wa.prototype),Object(k.a)(Wa.prototype,"onPasswordSet",[w.a],Object.getOwnPropertyDescriptor(Wa.prototype,"onPasswordSet"),Wa.prototype),Wa),yi=Object(S.a)({form:"settings",validate:T.N,enableReinitialize:!0})(fi),vi=Object(D.a)("settings"),bi=Object(j.c)((function(e,t){var r=t.user;return{name:vi(e,"name"),email:vi(e,"email"),cellNumber:vi(e,"cellNumber"),newPassword:vi(e,"newPassword"),bio:vi(e,"bio"),twitterUrl:vi(e,"twitterUrl"),githubUrl:vi(e,"githubUrl"),linkedinUrl:vi(e,"linkedinUrl"),facebookUrl:vi(e,"facebookUrl"),missedChat:vi(e,"missedChat"),sessionReminder:vi(e,"sessionReminder"),initialValues:{sessionReminder:r.settings.sessionReminder,missedChat:r.settings.missedChatNotifications,name:r.name,email:r.email,cellNumber:r.mobileNumber,bio:r.bio,twitterUrl:r.twitterUrl,githubUrl:r.githubUrl,linkedinUrl:r.linkedinUrl,facebookUrl:r.facebookUrl}}}))(yi),gi=(r(1977),r(1978),r(1216)),Oi=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.user;return u.createElement("div",{className:"default-avatar-picker"},gi.a.map((function(r,n){return u.createElement("div",{className:"d-avatar"+(t.avatarUrl||t.photo!==n+1?"":" selected"),key:"da-"+n,onClick:function(){return e.props.onAvatarPick(n+1)}},u.createElement("img",{src:r,width:80,height:80}))})))}}]),t}(u.Component),ki=(Ka=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={image:null},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onImageLoad",value:function(e){this.setState({image:e})}},{key:"onImageSave",value:function(e){var t=this,r=this.props.asyncActions.uploadAvatar(this.props.user,e);return this.props.dispatch(r).then((function(){t.props.dispatch(new v.i(new P.J({type:P.K.General,text:"Photo successfully updated"}))),t.props.onToggle(!1),t.setState({image:null})}))}},{key:"cancel",value:function(){this.setState({image:null})}},{key:"onDefaultAvatar",value:function(e){var t=this.props.user.set("photo",e).set("avatarUrl","");this.props.dispatch(this.props.asyncActions.updateUser(t)),this.props.onToggle(!1)}},{key:"render",value:function(){return u.createElement("div",{className:"avatar-picker"},u.createElement(R.a,{title:this.state.image?"Adjust Photo":"Your Photo",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("div",{className:"picker"},u.createElement(bn,{dispatch:this.props.dispatch,image:this.state.image,downscaleImage:!0,downscaleSize:{width:200,height:200},faceRecognition:!0,message:"Upload your photo",onImageLoad:this.onImageLoad,onImageSave:this.onImageSave,onCancel:this.cancel}),this.state.image?null:u.createElement(u.Fragment,null,u.createElement("div",{className:"sep-line","data-text":"Or"}),u.createElement("h3",null,"Choose a standard photo"),u.createElement(Oi,{user:this.props.user,onAvatarPick:this.onDefaultAvatar})))))}}]),t}(u.Component),Object(k.a)(Ka.prototype,"onImageLoad",[w.a],Object.getOwnPropertyDescriptor(Ka.prototype,"onImageLoad"),Ka.prototype),Object(k.a)(Ka.prototype,"onImageSave",[w.a],Object.getOwnPropertyDescriptor(Ka.prototype,"onImageSave"),Ka.prototype),Object(k.a)(Ka.prototype,"cancel",[w.a],Object.getOwnPropertyDescriptor(Ka.prototype,"cancel"),Ka.prototype),Object(k.a)(Ka.prototype,"onDefaultAvatar",[w.a],Object.getOwnPropertyDescriptor(Ka.prototype,"onDefaultAvatar"),Ka.prototype),Ka),Ci=r(1061),wi=(Ya=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={avatarPickerVisible:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"changeAvatar",value:function(){this.updateAvatarPickerVisibility(!0)}},{key:"updateAvatarPickerVisibility",value:function(e){this.setState({avatarPickerVisible:e})}},{key:"render",value:function(){return u.createElement("div",{className:"update-avatar"},u.createElement(Ci.a,{source:this.props.user,width:150,height:150,fontSize:62}),u.createElement("div",{className:"update",onClick:this.changeAvatar},"Change"),u.createElement(ki,{user:this.props.user,asyncActions:this.props.asyncActions,dispatch:this.props.dispatch,visible:this.state.avatarPickerVisible,onToggle:this.updateAvatarPickerVisibility}))}}]),t}(u.Component),Object(k.a)(Ya.prototype,"changeAvatar",[w.a],Object.getOwnPropertyDescriptor(Ya.prototype,"changeAvatar"),Ya.prototype),Object(k.a)(Ya.prototype,"updateAvatarPickerVisibility",[w.a],Object.getOwnPropertyDescriptor(Ya.prototype,"updateAvatarPickerVisibility"),Ya.prototype),Ya),ji=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"settings"},u.createElement(wi,{user:this.props.user,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions}),u.createElement(bi,{user:this.props.user,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions}))}}]),t}(u.Component),Ei=r(1038),_i=(r(1979),function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o))))._root=void 0,r._tabLine=void 0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._root=document.getElementById("root"),this._root&&(this._tabLine=document.createElement("div"),this._tabLine.className="tab-line",this._root.appendChild(this._tabLine))}},{key:"componentWillUnmount",value:function(){this._root&&this._root.removeChild(this._tabLine)}},{key:"render",value:function(){var e=this;return u.createElement("nav",{className:"route-tabs"},this.props.tabs.keySeq().map((function(t,r){return u.createElement(Ei.a,{onMouseOver:e._onMouseOver.bind(e,t),className:"tab"+(e.props.location.pathname.startsWith(t)?" selected":""),to:t,key:"tab-nab-"+r},e.props.tabs.get(t))})))}},{key:"_onMouseOver",value:function(e){this.props.onMouseOver&&this.props.onMouseOver(e)}}]),t}(u.Component)),Si=(r(1980),r(1981),r(1219)),Di=(r(1982),Ga=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o))))._vmNameRef=void 0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._ellipsizeText()}},{key:"componentDidUpdate",value:function(e){this.props.template.name!==e.template.name&&this._ellipsizeText()}},{key:"select",value:function(){this.props.disabled||this.props.onSelect(this.props.template)}},{key:"softwareDetails",value:function(e){this.props.disabled||(this.props.onSoftwareDetails(this.props.template),e.stopPropagation())}},{key:"render",value:function(){var e=this,t=this.props.template,r="vm-template"+(this.props.disabled?" disabled":"");return u.createElement(En.a,{className:r,onClick:this.select},u.createElement("div",{className:"image"},u.createElement("img",{src:t.screenshotUrl,width:"160",height:"128",alt:""})),u.createElement("p",{ref:function(t){return e._vmNameRef=t}},t.name),!this.props.hideDetailsBubble&&u.createElement("div",{className:"info"},u.createElement("div",{className:"mouse-over-filler"}),u.createElement("p",{className:"template-name"},t.name),u.createElement("p",{className:"detailed"},u.createElement("span",null,"Size: ",Object(g.f)(t.templateSize,"???")),u.createElement("br",null),u.createElement("a",{href:"javascript:void(0);",onClick:this.softwareDetails},"More Details"))))}},{key:"_ellipsizeText",value:function(){if(this._vmNameRef)for(var e=this._vmNameRef.innerHTML.split(" ");this._vmNameRef.scrollHeight>this._vmNameRef.offsetHeight;)e.pop(),this._vmNameRef.innerHTML=e.join(" ")+"..."}}]),t}(u.Component),Object(k.a)(Ga.prototype,"select",[w.a],Object.getOwnPropertyDescriptor(Ga.prototype,"select"),Ga.prototype),Object(k.a)(Ga.prototype,"softwareDetails",[w.a],Object.getOwnPropertyDescriptor(Ga.prototype,"softwareDetails"),Ga.prototype),Ga);!function(e){e.MostRecent="Sort by creation date (ascending)",e.LeastRecent="Sort by creation date (descending)",e.Name="Sort by name (a-z)"}(Ja||(Ja={}));var Pi,Ti,Ri,xi,Ni,Mi,Vi=(qa=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={detailsFor:null,sortBy:Ja.Name,filter:""},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return this.props.loadingInitialData?u.createElement(Xn,null):u.createElement("div",{className:"vm-list"},u.createElement(qn,{filterPlaceholder:"Search cloud workspaces",filter:this.state.filter,onFilterChange:this._onFilterChange,sortBy:this.state.sortBy,sortOptions:Ja,onSortTypeChange:this._onSortChange}),u.createElement(Jn.a,null,u.createElement(En.a,{className:"new-template",onClick:this.props.onNewTemplate},u.createElement("div",{className:"create-icon"}),u.createElement("p",null,"Create New",u.createElement("br",null),"Cloud Workspace")),this._sortedVisibleTemplates.map((function(t){return u.createElement(Di,{key:t.id,disabled:t.state!==P.bb.Ready,template:t,hideDetailsBubble:e.props.hideDetailsBubble,onSelect:function(){return e.props.onTemplateSelect(t)},onSoftwareDetails:function(){return e._onTemplateDetails(t)}})}))),u.createElement(Dr,{visible:!!this.state.detailsFor,template:this.state.detailsFor||new P.Z({}),onToggle:this._onSoftwareDetailsToggle}))}},{key:"_onTemplateDetails",value:function(e){this.setState({detailsFor:e})}},{key:"_onSoftwareDetailsToggle",value:function(e){e||this.setState({detailsFor:null})}},{key:"_onFilterChange",value:function(e){this.setState({filter:e})}},{key:"_onSortChange",value:function(e){this.setState({sortBy:e})}},{key:"_sortedVisibleTemplates",get:function(){var e=this.state.filter.toLowerCase();return this.props.templates.filter((function(t){return Object(g.e)(t)&&function(t){return t.name.toLowerCase().includes(e)}(t)})).sort(this._templateSort).toList()}},{key:"_templateSort",get:function(){switch(this.state.sortBy){case Ja.MostRecent:return Object(Si.a)((function(e){return e.createdAt}),"desc");case Ja.LeastRecent:return Object(Si.a)((function(e){return e.createdAt}));case Ja.Name:default:return Object(Si.a)((function(e){return e.name}))}}}]),t}(u.PureComponent),Object(k.a)(qa.prototype,"_onSoftwareDetailsToggle",[w.a],Object.getOwnPropertyDescriptor(qa.prototype,"_onSoftwareDetailsToggle"),qa.prototype),Object(k.a)(qa.prototype,"_onFilterChange",[w.a],Object.getOwnPropertyDescriptor(qa.prototype,"_onFilterChange"),qa.prototype),Object(k.a)(qa.prototype,"_onSortChange",[w.a],Object.getOwnPropertyDescriptor(qa.prototype,"_onSortChange"),qa.prototype),qa),Ai=(r(1983),r(1343)),Ii=(Pi=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"terminateAndLeave",value:function(){var e=this.props,t=e.asyncActions,r=e.dispatch,n=e.vm;return n&&this.isVmReady?r(t.terminateVM(n)).then(this.props.onResolve):(this.props.onResolve(),Promise.resolve())}},{key:"render",value:function(){return u.createElement(Ye.a,{text:this.isVmReady?"If you leave now, your cloud workspace will be terminated.":"",visible:this.props.visible,onToggle:this.props.onToggle,onResolve:this.terminateAndLeave})}},{key:"isVmReady",get:function(){return!!this.props.vm&&this.props.vm.state===P.kb.Ready}}]),t}(u.Component),Object(k.a)(Pi.prototype,"terminateAndLeave",[w.a],Object.getOwnPropertyDescriptor(Pi.prototype,"terminateAndLeave"),Pi.prototype),Pi),Ui=(r(1984),Ti=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._stopwatch=void 0,r._gtmVmLaunchTime=null,r.state={uploadInProgress:!1,screenshot:"",templateName:"",templateNameValid:!1,connected:!1,isTerminateVmModalVisible:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onUploadStart",value:function(){this.setState({uploadInProgress:!0})}},{key:"onUploadEnd",value:function(){this.setState({uploadInProgress:!1})}},{key:"onScreenshotUpdate",value:function(e){this.setState({screenshot:e})}},{key:"onTemplateNameUpdate",value:function(e,t){this.setState({templateName:e,templateNameValid:t})}},{key:"onComplete",value:function(){return this.state.screenshot?this.props.onDataCompleted(this.props.vm,new P.Z({name:this.state.templateName}),this.state.screenshot):Promise.reject("Missing screenshot")}},{key:"onToggleTerminateVmModal",value:function(e){this.setState({isTerminateVmModalVisible:e})}},{key:"onExit",value:function(){this.props.vm.id?this.onToggleTerminateVmModal(!0):this.exit()}},{key:"exit",value:function(){this.props.onExit&&this.props.onExit(),this.props.dispatch(Object(h.c)(this.props.totalPagesBackwards||-1))}},{key:"onVmInit",value:function(){this._gtmVmLaunchTime=We.a.customizeVmLaunchTime(this.props.vm.id)}},{key:"onVmConnect",value:function(){this._stopwatch&&this._stopwatch.start(),this.setState({connected:!0}),this._gtmVmLaunchTime&&(this._gtmVmLaunchTime(),this._gtmVmLaunchTime=null)}},{key:"onVmDisconnect",value:function(){this._stopwatch&&this._stopwatch.pause(),this.setState({connected:!1})}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"customize-vm"},u.createElement(Qt.a,{vm:this.props.vm,dispatch:this.props.dispatch,onReadWriteInit:this.onVmInit,onConnect:this.onVmConnect,onDisconnect:this.onVmDisconnect,controls:!0,asyncActions:this.props.asyncActions,template:this.template},u.createElement("div",{className:"customize-template-wizard"},u.createElement("div",{className:"logo-container"},u.createElement("div",{className:"logo"}),u.createElement($t,{onRef:function(t){return e._stopwatch=t}})),u.createElement("h3",null,"Customize Cloud Workspace"),u.createElement(tr,{className:"customize-vm-wizard",onComplete:this.onComplete,onExit:this.onExit},u.createElement(rr,{title:"Install Software",disableNext:!this.state.connected},u.createElement(yr,null)),u.createElement(rr,{title:"Upload Files",disableNext:!this.state.connected||this.state.uploadInProgress,disablePrev:this.state.uploadInProgress},u.createElement(ir,{dispatch:this.props.dispatch,remoteClientManager:this.props.remoteClientManager,vm:this.props.vm,disabled:!this.state.connected,onUploadStart:this.onUploadStart,onUploadEnd:this.onUploadEnd})),u.createElement(rr,{title:"Apply Licenses",disableNext:!this.state.connected},u.createElement(mr,null)),u.createElement(rr,{title:"Configure"},u.createElement(dr,null)),u.createElement(rr,{title:"Screenshot & Name",disableNext:!this.isCompleted||!this.state.connected},u.createElement(pr,{dispatch:this.props.dispatch,remoteClientManager:this.props.remoteClientManager,vm:this.props.vm,onScreenshotUpdate:this.onScreenshotUpdate,onTemplateNameUpdate:this.onTemplateNameUpdate}))))),this.props.vm.id?u.createElement(Ii,{vm:this.props.vm,visible:this.state.isTerminateVmModalVisible,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,onToggle:this.onToggleTerminateVmModal,onResolve:this.exit}):null)}},{key:"template",get:function(){return this.props.templates.get(this.props.vm.templateId)}},{key:"isCompleted",get:function(){return!!this.state.screenshot&&this.state.templateNameValid&&!this.state.uploadInProgress}}]),t}(u.Component),Object(k.a)(Ti.prototype,"onUploadStart",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"onUploadStart"),Ti.prototype),Object(k.a)(Ti.prototype,"onUploadEnd",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"onUploadEnd"),Ti.prototype),Object(k.a)(Ti.prototype,"onScreenshotUpdate",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"onScreenshotUpdate"),Ti.prototype),Object(k.a)(Ti.prototype,"onTemplateNameUpdate",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"onTemplateNameUpdate"),Ti.prototype),Object(k.a)(Ti.prototype,"onComplete",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"onComplete"),Ti.prototype),Object(k.a)(Ti.prototype,"onToggleTerminateVmModal",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"onToggleTerminateVmModal"),Ti.prototype),Object(k.a)(Ti.prototype,"onExit",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"onExit"),Ti.prototype),Object(k.a)(Ti.prototype,"exit",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"exit"),Ti.prototype),Object(k.a)(Ti.prototype,"onVmInit",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"onVmInit"),Ti.prototype),Object(k.a)(Ti.prototype,"onVmConnect",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"onVmConnect"),Ti.prototype),Object(k.a)(Ti.prototype,"onVmDisconnect",[w.a],Object.getOwnPropertyDescriptor(Ti.prototype,"onVmDisconnect"),Ti.prototype),Ti),Li=(r(1985),r(1986),Ri=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"chooseVm",value:function(){this.props.onSelect(this.props.templateType)}},{key:"softwareDetails",value:function(){this.props.onSoftwareDetailsRequest(this.props.templateType)}},{key:"mouseOver",value:function(){this.props.onMouseChange(this.props.templateType)}},{key:"mouseOut",value:function(){this.props.onMouseChange(null)}},{key:"render",value:function(){var e=this.props.templateType;return u.createElement("div",{className:"vm-selector-vm"+(this.props.hovered?" hovered":"")},u.createElement(En.a,{className:"vm",onMouseOver:this.mouseOver,onMouseOut:this.mouseOut,onClick:this.chooseVm,border:this.props.hovered},u.createElement("p",{className:"name"},e.name),u.createElement("div",{className:"icon ".concat(e.icon)}),u.createElement("div",{className:"arrow"})),u.createElement("div",{className:"software",onMouseOver:this.mouseOver,onMouseOut:this.mouseOut},u.createElement("p",{className:"title"},function(e,t){var r=e.default,n=e.os===P.L.Win?"Windows":e.os===P.L.Linux?"Ubuntu":"",o=e.os===P.L.Win?"Windows":e.os===P.L.Linux?"Linux/Ubuntu":"",a=r?u.createElement(u.Fragment,null,"Use our default ",n," cloud workspace which has"," ",u.createElement("a",{href:"javascript:void(0);",onClick:t},"some of the popular software already installed"),". Or create"):"Create",i=u.createElement(u.Fragment,null,n," cloud workspace should be used for projects involving desktop applications that run on ",o,"."," ",a," a custom cloud workspace: install your software, save your data, and configure the cloud workspace just the way you like it.");switch(e.os){case P.L.Win:case P.L.Linux:return i;case P.L.Docker:return Sr.get(P.L.Docker);default:return"Unknown information"}}(this.props.templateType,this.softwareDetails)),u.createElement("p",{className:"title"},"You will be charged ",this.price," every 15 mins for each cloud workspace you or your learners use")))}},{key:"price",get:function(){var e=this.props.templateType,t=x.a[e.currency]+Object(x.b)(e.ownPrice/4,!0);if(e.customPrice){var r=x.a[e.currency]+Object(x.b)(e.customPrice/4,!0);t="".concat(t," for a default and ").concat(r," for a custom cloud workspace")}return t}}]),t}(u.Component),Object(k.a)(Ri.prototype,"chooseVm",[w.a],Object.getOwnPropertyDescriptor(Ri.prototype,"chooseVm"),Ri.prototype),Object(k.a)(Ri.prototype,"softwareDetails",[w.a],Object.getOwnPropertyDescriptor(Ri.prototype,"softwareDetails"),Ri.prototype),Object(k.a)(Ri.prototype,"mouseOver",[w.a],Object.getOwnPropertyDescriptor(Ri.prototype,"mouseOver"),Ri.prototype),Object(k.a)(Ri.prototype,"mouseOut",[w.a],Object.getOwnPropertyDescriptor(Ri.prototype,"mouseOut"),Ri.prototype),Ri),Fi=[P.L.Win,P.L.Linux,P.L.Docker],Bi=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={hovered:null,softwareDetailsFor:null,softwareDetailsVisible:!1},r.back=function(){r.props.dispatch(Object(h.d)())},r.onMouseChange=function(e){r.setState({hovered:e})},r.onSoftwareDetailsRequest=function(e){r.setState({softwareDetailsFor:e}),r.updateSoftwareDetailsVisibility(!0)},r.updateSoftwareDetailsVisibility=function(e){r.setState({softwareDetailsVisible:e})},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return u.createElement("div",{className:"vm-selector form-styles"},u.createElement("h2",null,!this.props.hideBackButton&&u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),"Choose Cloud Workspace"),u.createElement("div",{className:"text main-title"},this.props.description||"Choose the type of cloud workspaces you want your learners to use"),u.createElement("div",{className:"list"},this.props.templateTypes.sortBy((function(e){return Fi.indexOf(e.os)})).map((function(t){return u.createElement(Li,{key:"vm-"+t.os,hovered:t===e.state.hovered,templateType:t,onSelect:e.props.onTemplateTypeSelect,onMouseChange:e.onMouseChange,onSoftwareDetailsRequest:e.onSoftwareDetailsRequest})}))),this.state.softwareDetailsFor&&u.createElement(Dr,{template:new P.Z({os:this.state.softwareDetailsFor.os,name:this.state.softwareDetailsFor.name}),visible:this.state.softwareDetailsVisible,onToggle:this.updateSoftwareDetailsVisibility}))}}]),t}(u.Component),zi=(xi=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).templateSelected=void 0,r.state={vmId:"",totalPagesBackwards:0},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createVmAndConnection",value:function(e){var t=this;this._requestVm(e).then((function(){t.props.dispatch(Object(h.g)(Y.vb))}))}},{key:"saveAndExit",value:function(e,t,r){var n=this,o=this.props.asyncActions.saveTemplate(e,t);return this.props.dispatch(o).then((function(e){var t=new Blob([He.a.toArrayBuffer(r)],{type:"image/png"});return n.props.dispatch(n.props.asyncActions.saveTemplateScreenshot(e,t))})).then(this.props.onExit)}},{key:"onExitCustomization",value:function(){this.setState({vmId:""})}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"new-template"},u.createElement(y.d,null,u.createElement(y.b,{path:Y.xb,exact:!0,render:function(){return u.createElement(Bi,{templateTypes:e.customTemplateTypes,onTemplateTypeSelect:e.createVmAndConnection,description:"Choose the type of cloud workspaces you want to customize. \n                If you want to use a Virtual Browser instead, there\u2019s no need to customize",dispatch:e.props.dispatch})}}),u.createElement(y.b,{path:Y.vb,exact:!0,render:function(){return u.createElement(Ai.a,{condition:!e.templateSelected,redirectPath:Y.yb,dispatch:e.props.dispatch},u.createElement(Ui,{vms:e.props.vms,vm:e.vm,remoteClientManager:e.props.remoteClientManager,onDataCompleted:e.saveAndExit,onExit:e.onExitCustomization,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,templates:e.props.templates,totalPagesBackwards:e.state.totalPagesBackwards,cost:e.props.cost}))}}),u.createElement(y.a,{to:Y.H})))}},{key:"_requestVm",value:function(e){var t=this;this.templateSelected=!0;var r=this.props.templates.find((function(t){return t.defaultTemplate&&t.os===e.os})),n=this.props.asyncActions.getVMAndConnection(r,!0),o=this.props.dispatch(n);return o.then((function(e){return t.setState({vmId:e.id})})),o}},{key:"vm",get:function(){return this.props.vms.get(this.state.vmId)||new P.lb({})}},{key:"customTemplateTypes",get:function(){return this.props.templateTypes.filter((function(e){return!e.default}))}}]),t}(u.Component),Object(k.a)(xi.prototype,"createVmAndConnection",[w.a],Object.getOwnPropertyDescriptor(xi.prototype,"createVmAndConnection"),xi.prototype),Object(k.a)(xi.prototype,"saveAndExit",[w.a],Object.getOwnPropertyDescriptor(xi.prototype,"saveAndExit"),xi.prototype),Object(k.a)(xi.prototype,"onExitCustomization",[w.a],Object.getOwnPropertyDescriptor(xi.prototype,"onExitCustomization"),xi.prototype),xi);!function(e){e[e.None=0]="None",e[e.New=1]="New",e[e.Update=2]="Update",e[e.Screenshot=3]="Screenshot"}(Mi||(Mi={}));var Hi,Wi,Ki,Yi,Gi,qi,Ji,Xi,Zi,Qi,$i,es,ts,rs,ns,os,as,is,ss=(Ni=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).vmRequested=void 0,r.state={selectedTemplate:null,vmId:"",templateCustomizationVisible:!1},r._redirectIfNoData(),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"showDetailsFor",value:function(e){this.setState({selectedTemplate:e.id}),this.toggleDetailsModal(!0)}},{key:"toggleDetailsModal",value:function(e){this.setState({templateCustomizationVisible:e}),e||this.setState({selectedTemplate:null})}},{key:"endOfTemplateCustomization",value:function(){this.customizeTemplate(Mi.None),this.toggleDetailsModal(!0)}},{key:"customizeTemplate",value:function(e){return this.props.user.creditCards.size?this._customizeTemplate(e):(this.props.cardModalCtrl.show(),this.props.cardModalCtrl.onSave().then(this._customizeTemplate.bind(this,e)))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"templates"},u.createElement(y.d,null,u.createElement(y.b,{path:Y.yb,exact:!0,render:function(){return u.createElement(u.Fragment,null,u.createElement(Vi,{templates:e.customTemplates,onNewTemplate:function(){return e.customizeTemplate(Mi.New)},onTemplateSelect:e.showDetailsFor,hideDetailsBubble:!0,loadingInitialData:e.props.loadingInitialData}),e.state.selectedTemplate?u.createElement(rn,{dispatch:e.props.dispatch,template:e.template||new P.Z({}),templates:e.props.templates,templateTypes:e.props.templateTypes,asyncActions:e.props.asyncActions,courses:e.props.courses,rooms:e.props.rooms,visible:e.state.templateCustomizationVisible,transparent:e.props.cardModalVisible,onToggle:e.toggleDetailsModal,onCustomize:function(){return e.customizeTemplate(Mi.Update)},onScreenshotUpdate:function(){return e.customizeTemplate(Mi.Screenshot)}}):null)}}),u.createElement(y.b,{path:Y.wb,render:function(){return u.createElement(zi,{vms:e.props.vms,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,user:e.props.user,templates:e.props.templates,templateTypes:e.props.templateTypes,cost:e.props.cost,onExit:function(){return e.customizeTemplate(Mi.None)}})}}),u.createElement(y.b,{path:Y.Ab,exact:!0,render:function(){return e.vm&&e.template?u.createElement(er,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.vm,template:e.template},u.createElement(vr,{dispatch:e.props.dispatch,vm:e.vm,template:e.template,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.b,{path:Y.zb,exact:!0,render:function(){return e.vm&&e.template?u.createElement(er,{asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,vm:e.vm,template:e.template},u.createElement(gr,{dispatch:e.props.dispatch,vm:e.vm,remoteClientManager:e.props.remoteClientManager,asyncActions:e.props.asyncActions,template:e.template,onExit:e.endOfTemplateCustomization})):null}}),u.createElement(y.a,{to:Y.H})))}},{key:"_createVmFromSelectedTemplate",value:function(){var e=this;this.vmRequested=!0;var t=this.template;return t?this.props.dispatch(this.props.asyncActions.getVMAndConnection(t,!0)).then((function(t){e.setState({vmId:t.id})})):Promise.reject("No selected template")}},{key:"_customizeTemplate",value:function(e){var t=this;switch(this.setState({vmId:""}),e){case Mi.None:return this.props.dispatch(Object(h.g)(Y.yb)),Promise.resolve();case Mi.New:return this.props.dispatch(Object(h.g)(Y.xb)),Promise.resolve();case Mi.Screenshot:return this._createVmFromSelectedTemplate().then((function(){return t.props.dispatch(Object(h.g)(Y.Ab))}));case Mi.Update:return this._createVmFromSelectedTemplate().then((function(){return t.props.dispatch(Object(h.g)(Y.zb))}))}}},{key:"_redirectIfNoData",value:function(){var e=this.props.location;!Object(Y.Hb)(e,Y.Ab)&&!Object(Y.Hb)(e,Y.zb)||this.vm&&this.template||this.props.dispatch(Object(h.h)(Y.yb))}},{key:"customTemplates",get:function(){return this.props.templates.filter((function(e){return!e.defaultTemplate})).toList()}},{key:"template",get:function(){return this.props.templates.get(this.state.selectedTemplate||"")||null}},{key:"vm",get:function(){return this.props.vms.get(this.state.vmId)||null}}]),t}(u.Component),Object(k.a)(Ni.prototype,"showDetailsFor",[w.a],Object.getOwnPropertyDescriptor(Ni.prototype,"showDetailsFor"),Ni.prototype),Object(k.a)(Ni.prototype,"toggleDetailsModal",[w.a],Object.getOwnPropertyDescriptor(Ni.prototype,"toggleDetailsModal"),Ni.prototype),Object(k.a)(Ni.prototype,"endOfTemplateCustomization",[w.a],Object.getOwnPropertyDescriptor(Ni.prototype,"endOfTemplateCustomization"),Ni.prototype),Ni),cs=(Hi=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this)))._toggle=e,r._saveResolver=void 0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"show",value:function(){this._toggle(!0)}},{key:"onSave",value:function(){var e=this;return new Promise((function(t,r){e._saveResolver=t}))}},{key:"saveCallback",value:function(){this._saveResolver&&this._saveResolver()}}]),t}((function e(){Object(i.a)(this,e)})),Object(k.a)(Hi.prototype,"saveCallback",[w.a],Object.getOwnPropertyDescriptor(Hi.prototype,"saveCallback"),Hi.prototype),Hi),ls=(r(1987),Wi=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onCardSave",value:function(e){var t=this;return this.props.dispatch(this.props.asyncActions.addCreditCard(this.props.user,e)).then((function(){t.props.onCardSave&&t.props.onCardSave();var e=new P.J({type:P.K.General,text:"Card successfully added!"});t.props.dispatch(new v.i(e)),t.props.onToggle(!1)}))}},{key:"render",value:function(){return u.createElement("div",{className:"card-modal"},u.createElement(R.a,{title:"Payment Information",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("p",null,"We need your payment information in order to proceed with the selected action."),u.createElement($a.b,{dispatch:this.props.dispatch,onCardSave:this.onCardSave})))}},{key:"card",get:function(){return this.props.user.creditCards.find((function(e){return e.primary}))}}]),t}(u.Component),Object(k.a)(Wi.prototype,"onCardSave",[w.a],Object.getOwnPropertyDescriptor(Wi.prototype,"onCardSave"),Wi.prototype),Wi),ps=Object($.OrderedMap)((Ki={},Object(Q.a)(Ki,Y.qb,"Sessions"),Object(Q.a)(Ki,Y.bb,"Recordings"),Object(Q.a)(Ki,Y.yb,"Custom Workspaces"),Object(Q.a)(Ki,Y.rb,"Settings"),Ki)),us=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).cardModalCtrl=void 0,r.toggleCardModal=function(e){r.setState({cardModalVisible:e})},r.state={cardModalVisible:!1},r.cardModalCtrl=new cs(r.toggleCardModal.bind(Object(Z.a)(r))),Object(O.c)(O.a.TryFlowSession),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return u.createElement("div",{className:"dashboard"},u.createElement(_i,{tabs:this.tabs,location:this.props.location}),u.createElement(y.d,null,u.createElement(y.b,{path:Y.qb,render:function(){return e.shouldHideSessionsTab?u.createElement(y.a,{to:e.tabs.keySeq().first()}):u.createElement(Xa,{loadingInitialData:e.props.loadingInitialData,courses:e.props.courses,rooms:e.props.rooms,templates:e.props.templates,templateTypes:e.props.templateTypes,vms:e.props.vms,user:e.props.user,cost:e.props.cost,currentChapter:e.props.currentChapter,location:e.props.location,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,cardModalCtrl:e.cardModalCtrl,cardModalVisible:e.state.cardModalVisible})}}),u.createElement(y.b,{path:Y.bb,render:function(){return u.createElement(eo,{dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,courses:e.courses,currentChapter:e.props.currentChapter,templates:e.props.templates,templateTypes:e.props.templateTypes,rooms:e.props.rooms,vms:e.props.vms,user:e.props.user,loadingInitialData:e.props.loadingInitialData,remoteClientManager:e.props.remoteClientManager,cardModalCtrl:e.cardModalCtrl,cardModalVisible:e.state.cardModalVisible,location:e.props.location})}}),u.createElement(y.b,{path:Y.yb,render:function(){return u.createElement(ss,{loadingInitialData:e.props.loadingInitialData,asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,dispatch:e.props.dispatch,templates:e.nonLegacyTemplates,templateTypes:e.props.templateTypes,courses:e.props.courses,rooms:e.props.rooms,cost:e.props.cost,user:e.props.user,vms:e.props.vms,cardModalCtrl:e.cardModalCtrl,cardModalVisible:e.state.cardModalVisible,location:e.props.location})}}),u.createElement(y.b,{path:Y.rb,exact:!0,render:function(){return u.createElement(ji,{dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,user:e.props.user})}}),u.createElement(y.a,{to:Y.H})),u.createElement(ls,{user:this.props.user,visible:this.state.cardModalVisible,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,onToggle:this.toggleCardModal,onCardSave:this.cardModalCtrl.saveCallback}))}},{key:"courses",get:function(){return this.props.courses.filter((function(e){return!e.deleted})).toMap()}},{key:"nonLegacyTemplates",get:function(){return this.props.templates.filter((function(e){return!Object(g.d)(e)})).toMap()}},{key:"shouldHideSessionsTab",get:function(){return this.props.user.permissions.contains(P.gb.PublishToCoursera)}},{key:"tabs",get:function(){return this.shouldHideSessionsTab?ps.filter((function(e,t){return t!==Y.qb})):ps}}]),t}(u.Component),ds=r(1338),hs=(r(1988),r(1989),function(e){return u.createElement("div",{className:"bottom-container"},e.children)}),ms=(Yi=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={cardType:$a.a.CreditCard},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"back",value:function(){this.props.dispatch(Object(h.d)())}},{key:"updateCardType",value:function(e){this.setState({cardType:e})}},{key:"render",value:function(){return u.createElement("div",{className:"card-form form-styles"},u.createElement("h2",null,u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),this.state.cardType===$a.a.CreditCard?"Credit":"Rhyme Gift"," Card"),u.createElement("p",{className:"text"},"Please enter a Rhyme (or credit) card. You will NOT be charged till you use a cloud workspace."),u.createElement($a.b,{dispatch:this.props.dispatch,onCardSave:this.props.onCardSave,onCardTypeChange:this.updateCardType,key:"cc-form"}),u.createElement(hs,null,"How will I be charged?",u.createElement("br",null),"You will be charged ",this.price," (for a default cloud workspace) every 15 mins for each cloud workspace you or your learners use",u.createElement("br",null),u.createElement("br",null),"Example:",u.createElement("br",null),"For a 27 mins session with 2 learners, you pay: ",this.price," x 2 x ( 2 learners + 1 host ) +"," ",this.processingFee," (credit card processing) = ",this.totalPrice))}},{key:"price",get:function(){var e=this.props.templateType;return x.a[e.currency]+Object(x.b)(e.ownPrice/4,!0)}},{key:"totalPrice",get:function(){var e=this.props.templateType,t=Math.round(.5*e.ownPrice*3+g.a);return x.a[e.currency]+Object(x.b)(t,!0)}},{key:"processingFee",get:function(){return x.a[this.props.templateType.currency]+Object(x.b)(g.a,!0)}}]),t}(u.Component),Object(k.a)(Yi.prototype,"back",[w.a],Object.getOwnPropertyDescriptor(Yi.prototype,"back"),Yi.prototype),Object(k.a)(Yi.prototype,"updateCardType",[w.a],Object.getOwnPropertyDescriptor(Yi.prototype,"updateCardType"),Yi.prototype),Yi),fs=(r(1990),Gi={},Object(Q.a)(Gi,P.L.Win,"Windows"),Object(Q.a)(Gi,P.L.Linux,"Ubuntu"),Gi),ys=(qi=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={modalVisible:!1,isLoadingExistingCustomTemplate:!1,isUpdatingCustomTemplate:!1},r._selected=void 0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"updateModalVisibility",value:function(e){this.setState({modalVisible:e})}},{key:"back",value:function(){this.props.dispatch(Object(h.c)(this.props.totalPagesBackwards||-1))}},{key:"createNew",value:function(){this.props.onTemplateSelect()}},{key:"onSelect",value:function(e){this._selected=e,e.defaultTemplate?this.props.onTemplateSelect(e,!0):this.updateModalVisibility(!0)}},{key:"useExistingCustomTemplate",value:function(){var e=this;this.setState({isLoadingExistingCustomTemplate:!0}),this.props.onTemplateSelect(this._selected,!0).catch((function(){return e.setState({isLoadingExistingCustomTemplate:!1})}))}},{key:"updateCustomTemplate",value:function(){var e=this;this.setState({isUpdatingCustomTemplate:!0}),this.props.onTemplateSelect(this._selected).catch((function(){return e.setState({isUpdatingCustomTemplate:!1})}))}},{key:"render",value:function(){return u.createElement("div",{className:"custom-vm-selector"},u.createElement("h2",null,u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),fs[this.props.os]," Cloud Workspaces"),u.createElement("p",{className:"form-text"},"Choose a cloud workspace"),u.createElement(Vi,{loadingInitialData:this.props.loadingInitialData,onNewTemplate:this.createNew,onTemplateSelect:this.onSelect,templates:this.templates}),u.createElement(R.a,{title:"Update cloud workspace?",visible:this.state.modalVisible,onToggle:this.updateModalVisibility},u.createElement("p",{className:"text"},"Do you want to update this cloud workspace?"),u.createElement("div",null,u.createElement(T.a,{className:"short-btn",onClick:this.useExistingCustomTemplate,loading:this.state.isLoadingExistingCustomTemplate,disabled:this.state.isUpdatingCustomTemplate},"No, use it as is")),u.createElement("div",null,u.createElement(T.a,{className:"short-btn empty",onClick:this.updateCustomTemplate,loading:this.state.isUpdatingCustomTemplate,disabled:this.state.isLoadingExistingCustomTemplate},"Yes"))))}},{key:"templates",get:function(){var e=this;return this.props.templates.filter((function(t){return t.os===e.props.os})).sortBy((function(e){return!e.defaultTemplate})).toList()}}]),t}(u.Component),Object(k.a)(qi.prototype,"updateModalVisibility",[w.a],Object.getOwnPropertyDescriptor(qi.prototype,"updateModalVisibility"),qi.prototype),Object(k.a)(qi.prototype,"back",[w.a],Object.getOwnPropertyDescriptor(qi.prototype,"back"),qi.prototype),Object(k.a)(qi.prototype,"createNew",[w.a],Object.getOwnPropertyDescriptor(qi.prototype,"createNew"),qi.prototype),Object(k.a)(qi.prototype,"onSelect",[w.a],Object.getOwnPropertyDescriptor(qi.prototype,"onSelect"),qi.prototype),Object(k.a)(qi.prototype,"useExistingCustomTemplate",[w.a],Object.getOwnPropertyDescriptor(qi.prototype,"useExistingCustomTemplate"),qi.prototype),Object(k.a)(qi.prototype,"updateCustomTemplate",[w.a],Object.getOwnPropertyDescriptor(qi.prototype,"updateCustomTemplate"),qi.prototype),qi),vs=(r(1991),function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={isLoading:!1},r.submit=function(e){e.preventDefault(),r.setState({isLoading:!0}),r.props.onSubmit(r.props.url).finally((function(){return r.setState({isLoading:!1})}))},r.back=function(){r.props.goBack(r.props.totalPagesBackwards||-1)},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement("div",{className:"virtual-browser-details form-styles"},u.createElement("h2",null,u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),"Virtual Browser Details"),u.createElement("form",{name:"virtualBrowserDetails",onSubmit:this.submit},u.createElement("div",{className:"row"},u.createElement(_.a,{name:"url",component:T.s,label:"Launch URL"}),u.createElement("p",{className:"field-info"},"Specify the web address of the business application you'll be using in your project")),u.createElement(T.a,{disabled:!this.props.valid,loading:this.state.isLoading},"Save")))}}]),t}(u.PureComponent)),bs=Object(D.a)("virtualBrowserDetails"),gs=Object(S.a)({form:"virtualBrowserDetails",validate:Or.t})(vs),Os=Object(j.c)((function(e){return{url:bs(e,"url"),initialValues:{url:""}}}),(function(e){return{goBack:function(t){return e(Object(h.c)(t))}}}))(gs),ks=function(){function e(t){Object(i.a)(this,e),this._instance=t}return Object(s.a)(e,[{key:"requestVm",value:function(e){var t=this._instance,r=t.course,n=t.props;return r&&r.id&&!r.virtualMachineId?n.dispatch(n.asyncActions.getCourseVMAndConnection(r,n.asyncActions)).then((function(){return n.dispatch(Object(Y.Kb)(e))})):Promise.resolve()}}]),e}(),Cs=r(50),ws=Symbol("CourseReady"),js=Object($.Map)([[P.L.Win,"Windows"],[P.L.Linux,"Ubuntu"],[P.L.Docker,"Virtual Browser"]]),Es=function(e){return js.get(e.os)},_s=(Ji=function(){function e(t){Object(i.a)(this,e),this._instance=t,this._emitter=new Cs.EventEmitter,this._course=void 0,this._room=void 0,this._template=void 0,this._templateType=void 0,Object(O.c)(O.a.SessionCreationRoom)}return Object(s.a)(e,[{key:"onSessionDetailsSubmit",value:function(e,t){this._course=e,t&&(this._room=t,Object(O.h)(O.a.SessionCreationRoom,t))}},{key:"onTemplateTypeSelect",value:function(e){this._templateType=e,this._template=this._getDefaultTempateForType(this._templateType)}},{key:"onTemplateSelect",value:function(e,t){return this._templateType?(this._template=e||this._getDefaultTempateForType(this.templateType),this._saveCourse(t)):Promise.resolve()}},{key:"onCardSave",value:function(e){var t=this._instance.props;return(0,t.dispatch)(t.asyncActions.addCreditCard(this._instance.props.user,e))}},{key:"onCustomVmCustomization",value:function(e,t,r){var n=this;if(this._course&&this._course.id)return this._instance.props.dispatch(this._instance.props.asyncActions.saveCourseTemplate(this._course,e,t)).then((function(e){if(r){var t=new Blob([He.a.toArrayBuffer(r)],{type:"image/png"}),o=n._course;if(!o)throw new Error("Cannot set template of non-existing course");return Promise.all([n._instance.props.dispatch(n._instance.props.asyncActions.updateCourse(o.set("templateId",e.id))),n._instance.props.dispatch(n._instance.props.asyncActions.saveTemplateScreenshot(e,t))])}throw new Error("No screenshot set")}))}},{key:"onVirtualBrowserDetailsSubmit",value:function(e){return this._course?(this._course=this._course.set("virtualBrowserUrl",e),this._saveCourse(!0)):Promise.reject("Course is missing")}},{key:"onCourseReadyEvent",value:function(e){this._emitter.addListener(ws,e)}},{key:"_saveCourse",value:function(){var e=Object(oe.a)(ne.a.mark((function e(t){var r,n,o,a,i;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._course&&this._template){e.next=2;break}return e.abrupt("return",Promise.reject("Template (".concat(this._template,") or course (").concat(this._course,") is missing")));case 2:return r=this._instance.props.asyncActions,n=r.updateCourse,o=r.createCourse,a=this._course.set("templateId",this._template.id),i=this._course.id?n(a):o(a),e.next=7,this._instance.props.dispatch(i);case 7:this._course=e.sent,this._emitter.emit(ws,this._course,t);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getDefaultTempateForType",value:function(e){return this._instance.props.templates.find((function(t){return t.defaultTemplate&&t.os===e.os}))}},{key:"course",get:function(){var e=this._course;if(e){var t=this._instance.props.courses.get(e.id);return t||e}return null}},{key:"room",get:function(){return this._room}},{key:"templateType",get:function(){return this._templateType||new P.cb}}]),e}(),Object(k.a)(Ji.prototype,"onSessionDetailsSubmit",[w.a],Object.getOwnPropertyDescriptor(Ji.prototype,"onSessionDetailsSubmit"),Ji.prototype),Object(k.a)(Ji.prototype,"onTemplateTypeSelect",[w.a],Object.getOwnPropertyDescriptor(Ji.prototype,"onTemplateTypeSelect"),Ji.prototype),Object(k.a)(Ji.prototype,"onTemplateSelect",[w.a],Object.getOwnPropertyDescriptor(Ji.prototype,"onTemplateSelect"),Ji.prototype),Object(k.a)(Ji.prototype,"onCardSave",[w.a],Object.getOwnPropertyDescriptor(Ji.prototype,"onCardSave"),Ji.prototype),Object(k.a)(Ji.prototype,"onCustomVmCustomization",[w.a],Object.getOwnPropertyDescriptor(Ji.prototype,"onCustomVmCustomization"),Ji.prototype),Object(k.a)(Ji.prototype,"onVirtualBrowserDetailsSubmit",[w.a],Object.getOwnPropertyDescriptor(Ji.prototype,"onVirtualBrowserDetailsSubmit"),Ji.prototype),Ji),Ss=(Xi=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._sessionBuilder=new _s(Object(Z.a)(r)),r._createCourseVmService=new ks(Object(Z.a)(r)),e.preloadedData&&r.onSessionDetailsSubmit(e.preloadedData.course,e.preloadedData.room),r._redirectIfNoData(),r._sessionBuilder.onCourseReadyEvent((function(e,t){r.setState({courseId:e.id}),t&&r.props.dispatch(Object(Y.Kb)(Object(Y.Tb)(e.id)))})),r.state={courseId:"",totalPagesBackwards:0},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onSessionDetailsSubmit",value:function(e,t){this.props.dispatch(Object(Y.Kb)(this.props.routes.vmSelectorRoute)),this._sessionBuilder.onSessionDetailsSubmit(e,t)}},{key:"onTemplateSelect",value:function(e,t){var r=this;return this._sessionBuilder.onTemplateSelect(e,t).then((function(){return t?Promise.resolve():r._createCourseVmService.requestVm(r.props.routes.customizeVmRoute)}))}},{key:"onCardSave",value:function(e){return this._sessionBuilder.onCardSave(e).then(this._redirectToSelectedTemplateTypeDetails)}},{key:"onTemplateCustomizeCompleted",value:function(e,t,r){var n=this;return this._sessionBuilder.onCustomVmCustomization(e,t,r).then((function(){var e=n.state.courseId;e?n.props.dispatch(Object(Y.Kb)(Object(Y.Tb)(e))):console.error("Missing course after template customization")}))}},{key:"onTemplateTypeSelect",value:function(e){if(this._sessionBuilder.onTemplateTypeSelect(e),!!!this.props.user.creditCards.size)return this.props.onCardForm&&this.props.onCardForm(),this.setState({totalPagesBackwards:-2}),void this.props.dispatch(Object(Y.Kb)(this.props.routes.cardFormRoute));this.setState({totalPagesBackwards:0}),this._redirectToSelectedTemplateTypeDetails()}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"new-session-wizard"},u.createElement(y.d,null,this.props.routes.sessionDetailsRoute&&u.createElement(y.b,{path:this.props.routes.sessionDetailsRoute,exact:!0,render:function(){return u.createElement(ds.a,{data:{course:e._sessionBuilder.course,room:e._sessionBuilder.room},dispatch:e.props.dispatch,onSessionDetailsSubmit:e.onSessionDetailsSubmit})}}),u.createElement(y.b,{path:this.props.routes.vmSelectorRoute,exact:!0,render:function(){return u.createElement(Bi,{dispatch:e.props.dispatch,templateTypes:e.visibleTemplateTypes,onTemplateTypeSelect:e.onTemplateTypeSelect})}}),u.createElement(y.b,{path:this.props.routes.customVmSelectorRoute,exact:!0,render:function(){return u.createElement(ys,{dispatch:e.props.dispatch,os:e._sessionBuilder.templateType.os,onTemplateSelect:e.onTemplateSelect,templates:e.props.templates,totalPagesBackwards:e.state.totalPagesBackwards,loadingInitialData:e.props.loadingInitialData})}}),u.createElement(y.b,{path:this.props.routes.cardFormRoute,exact:!0,render:function(){return u.createElement(ms,{user:e.props.user,dispatch:e.props.dispatch,templateType:e._sessionBuilder.templateType,onCardSave:e.onCardSave})}}),u.createElement(y.b,{path:this.props.routes.virtualBrowserDetailsRoute,exact:!0,render:function(){return u.createElement(Os,{totalPagesBackwards:e.state.totalPagesBackwards,onSubmit:e._sessionBuilder.onVirtualBrowserDetailsSubmit})}}),u.createElement(y.b,{path:this.props.routes.customizeVmRoute,exact:!0,render:function(){return u.createElement(Ui,{vms:e.props.vms,vm:e.vm,templates:e.props.templates,remoteClientManager:e.props.remoteClientManager,cost:e.props.cost,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,onDataCompleted:e.onTemplateCustomizeCompleted,totalPagesBackwards:e.state.totalPagesBackwards})}}),u.createElement(y.a,{to:Y.H})))}},{key:"_redirectIfNoData",value:function(){var e=this.props.location,t=this.props.routes.sessionDetailsRoute||Y.kb;this._sessionBuilder.course&&this._sessionBuilder.room||Object(Y.Hb)(e,t)||this.props.dispatch(Object(h.h)(t))}},{key:"_redirectToSelectedTemplateTypeDetails",value:function(){var e=this.props.routes,t=e.virtualBrowserDetailsRoute,r=e.customVmSelectorRoute,n=this._sessionBuilder.templateType.os===P.L.Docker?t:r;this.props.dispatch(Object(Y.Kb)(n))}},{key:"course",get:function(){var e=this.state.courseId;if(e)return this.props.courses.get(e)}},{key:"vm",get:function(){return this.course&&this.course.virtualMachineId?this.props.vms.get(this.course.virtualMachineId):new P.lb({})}},{key:"visibleTemplateTypes",get:function(){return this.props.templateTypes.filter((function(e){return e.default&&e.os!==P.L.Docker})).map((function(e){return e.set("name",Es(e))})).toList()}}]),t}(u.Component),Object(k.a)(Xi.prototype,"onSessionDetailsSubmit",[w.a],Object.getOwnPropertyDescriptor(Xi.prototype,"onSessionDetailsSubmit"),Xi.prototype),Object(k.a)(Xi.prototype,"onTemplateSelect",[w.a],Object.getOwnPropertyDescriptor(Xi.prototype,"onTemplateSelect"),Xi.prototype),Object(k.a)(Xi.prototype,"onCardSave",[w.a],Object.getOwnPropertyDescriptor(Xi.prototype,"onCardSave"),Xi.prototype),Object(k.a)(Xi.prototype,"onTemplateCustomizeCompleted",[w.a],Object.getOwnPropertyDescriptor(Xi.prototype,"onTemplateCustomizeCompleted"),Xi.prototype),Object(k.a)(Xi.prototype,"onTemplateTypeSelect",[w.a],Object.getOwnPropertyDescriptor(Xi.prototype,"onTemplateTypeSelect"),Xi.prototype),Object(k.a)(Xi.prototype,"_redirectToSelectedTemplateTypeDetails",[w.a],Object.getOwnPropertyDescriptor(Xi.prototype,"_redirectToSelectedTemplateTypeDetails"),Xi.prototype),Xi),Ds=(r(1992),Zi=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"back",value:function(){this.props.dispatch(Object(h.d)())}},{key:"onRecordingSelect",value:function(e){var t="",r=e.chapters.filter((function(e){return!e.videoUrl}));if(1===r.size){var n=r.first().name;t='This recording has a task titled "'.concat(n,'" that is not recorded. ')+"That task will be skipped in this session"}else r.size>1&&(t="This recording has tasks that are not recorded. Those tasks will be skipped in this session");t&&this.props.dispatch(new v.i(new P.J({type:P.K.Error,title:"Warning",text:t,ttl:1e4}))),this.props.onRecordingSelect(e)}},{key:"render",value:function(){return u.createElement("div",{className:"recorded-sessions-list"},u.createElement("h2",null,u.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.back}),"Recorded Sessions"),u.createElement("div",{className:"sessions"},u.createElement(Qn,{user:this.props.user,recordings:this.recordings,rooms:this.props.rooms,templates:this.props.templates,loadingInitialData:this.props.loadingInitialData,disableUnscheduleable:!0,dispatch:this.props.dispatch,onRecordingClick:this.onRecordingSelect,onRecordingPreviewClick:this.onRecordingSelect})))}},{key:"recordings",get:function(){return this.props.courses.filter((function(e){return e.type===P.y.Recorded})).toList()}}]),t}(u.Component),Object(k.a)(Zi.prototype,"back",[w.a],Object.getOwnPropertyDescriptor(Zi.prototype,"back"),Zi.prototype),Object(k.a)(Zi.prototype,"onRecordingSelect",[w.a],Object.getOwnPropertyDescriptor(Zi.prototype,"onRecordingSelect"),Zi.prototype),Zi),Ps=(Qi=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o))))._course=void 0,r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onCardSave",value:function(e){var t=this,r=this.props,n=r.asyncActions;return(0,r.dispatch)(n.addCreditCard(this.props.user,e)).then((function(){return t._selectRecord()}))}},{key:"onRecordingSelect",value:function(e){this._course=e,this.props.user.creditCards.size?this._selectRecord():this.props.dispatch(Object(h.g)(Y.K))}},{key:"render",value:function(){var e=this;return u.createElement(y.d,null,u.createElement(y.b,{path:Y.L,exact:!0,render:function(){return u.createElement(Ds,{dispatch:e.props.dispatch,user:e.props.user,courses:e.props.courses,rooms:e.props.rooms,templates:e.props.templates,loadingInitialData:e.props.loadingInitialData,onRecordingSelect:e.onRecordingSelect})}}),u.createElement(y.b,{path:Y.K,exact:!0,render:function(){return u.createElement(ms,{user:e.props.user,dispatch:e.props.dispatch,templateType:e.templateType,onCardSave:e.onCardSave})}}),u.createElement(y.a,{to:Y.H}))}},{key:"_selectRecord",value:function(){this.props.dispatch(Object(Y.Kb)(Object(Y.Tb)(this._course.id)))}},{key:"templateType",get:function(){var e=this.props.templates.get(this._course.templateId);return this.props.templateTypes.find((function(t){return t.os===e.os&&t.default===e.defaultTemplate}))}}]),t}(u.Component),Object(k.a)(Qi.prototype,"onCardSave",[w.a],Object.getOwnPropertyDescriptor(Qi.prototype,"onCardSave"),Qi.prototype),Object(k.a)(Qi.prototype,"onRecordingSelect",[w.a],Object.getOwnPropertyDescriptor(Qi.prototype,"onRecordingSelect"),Qi.prototype),Qi),Ts=r(1341),Rs=(r(1993),$i=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).chaptersListRef=void 0,r._recordingBuilder=new nn(Object(Z.a)(r)),r.state={isSaving:!1,unsavedChangesModalVisibility:!1,chapterToBeRecorded:null,chapterToBePreviewed:null,formChanges:[]},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.chapters!==this.props.chapters&&this.setState({formChanges:Cr(e.chapters,this.props.initialValues)})}},{key:"submit",value:function(e){var t=this;e.preventDefault(),this.setState({isSaving:!0}),this.saveUnsavedChanges().then((function(){return t._updateChaptersListInput(),t.props.onDone()})).catch((function(){return t.setState({isSaving:!1})}))}},{key:"onToggleUnsavedChangesModal",value:function(){this.state.unsavedChangesModalVisibility&&!this.isFormSaveable&&this.chaptersListRef.getRenderedComponent().showValidation();this.setState({unsavedChangesModalVisibility:!this.state.unsavedChangesModalVisibility})}},{key:"onDiscardUnsavedChanges",value:function(){var e=this;this._recordingBuilder.discardUnsavedChanges().then((function(){return e._recordingBuilder.proceedAction()}))}},{key:"saveUnsavedChanges",value:function(){return this._recordingBuilder.saveUnsavedChapters()}},{key:"recordChapter",value:function(){this.state.chapterToBeRecorded&&this.props.onRecordChapter(this.state.chapterToBeRecorded)}},{key:"previewChapter",value:function(){this.state.chapterToBePreviewed&&this.props.onPreviewChapter(this.state.chapterToBePreviewed)}},{key:"onSaveUnsavedChanges",value:function(){return this._recordingBuilder.onSaveUnsavedChanges().then(this._updateChaptersListInput)}},{key:"render",value:function(){var e=this;return(u.createElement("div",{className:"chapter-list-form form-styles"},u.createElement("h2",null,"Add Tasks"),u.createElement("p",{className:"text"},u.createElement("span",null,"Instruction: Show learners how to do the task"),u.createElement("span",null,"Challenge: Ask learners to do the task themselves")),u.createElement("form",{name:"chaptersList",onSubmit:this.submit},u.createElement(_.a,Object.assign({name:"chapters",component:kr.a,ref:function(t){return e.chaptersListRef=t},forwardRef:!0},{asyncActions:this.props.asyncActions,course:this.props.course,templates:this.props.templates,rooms:this.props.rooms,actionDispatch:this.props.dispatch,onRecordChapter:this._recordingBuilder.onRecordChapter,onPreviewChapter:this._recordingBuilder.onPreviewChapter,onRecordUnsupported:this.props.onRecordUnsupported})),u.createElement(T.a,{disabled:!this.props.valid,loading:this.state.isSaving},"Done")),u.createElement(Pr,{title:"Recording Details",visible:this.state.unsavedChangesModalVisibility,onToggle:this.onToggleUnsavedChangesModal,saveable:this.isFormSaveable,changes:this.state.formChanges,onDiscard:this.onDiscardUnsavedChanges,onSave:this.onSaveUnsavedChanges}),u.createElement("i",{className:"fa fa-file-video-o","aria-hidden":"true"})))}},{key:"_updateChaptersListInput",value:function(){this._recordingBuilder.chaptersListRenderedComponent&&this._recordingBuilder.chaptersListRenderedComponent.props.input.onChange(this.props.course.chapters.map((function(e,t){return e.set("key",t)})))}},{key:"hasUnsavedChanges",get:function(){return!!this.state.formChanges.length}},{key:"isFormSaveable",get:function(){return!(!this.props.valid||!this.hasUnsavedChanges)}}]),t}(u.Component),Object(k.a)($i.prototype,"submit",[w.a],Object.getOwnPropertyDescriptor($i.prototype,"submit"),$i.prototype),Object(k.a)($i.prototype,"onToggleUnsavedChangesModal",[w.a],Object.getOwnPropertyDescriptor($i.prototype,"onToggleUnsavedChangesModal"),$i.prototype),Object(k.a)($i.prototype,"onDiscardUnsavedChanges",[w.a],Object.getOwnPropertyDescriptor($i.prototype,"onDiscardUnsavedChanges"),$i.prototype),Object(k.a)($i.prototype,"onSaveUnsavedChanges",[w.a],Object.getOwnPropertyDescriptor($i.prototype,"onSaveUnsavedChanges"),$i.prototype),Object(k.a)($i.prototype,"_updateChaptersListInput",[w.a],Object.getOwnPropertyDescriptor($i.prototype,"_updateChaptersListInput"),$i.prototype),$i),xs=Object(D.a)("chaptersList"),Ns=Object(S.a)({form:"chaptersList",validate:Or.h,enableReinitialize:!1})(Rs),Ms=Object(j.c)((function(e,t){return{chapters:xs(e,"chapters"),initialValues:{chapters:t.course.chapters.map((function(e,t){return e.set("key",t)}))}}}))(Ns),Vs=(es=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._chapterVmService=new Zt(Object(Z.a)(r)),r._onCreatingChaptersCompleted=function(){if(r.course)return r.props.onCreatingChaptersCompleted(r.course)},r.state={courseVmId:null},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;Object(Y.Jb)(this.props.location.pathname,this.props.routes.recordingChapterMediaRoute)&&!e.courses.count()&&this.props.courses.count()&&this._chapterVmService.requestVm().then((function(){return t.forceUpdate()}))}},{key:"onExitChapterRecordingOrPreview",value:function(){this.props.dispatch(Object(Y.Kb)(this.props.routes.recordChaptersRoute(this.course.id)))}},{key:"onUnsupportedRecordingBack",value:function(){this.props.dispatch(Object(Y.Kb)(this.props.routes.recordChaptersRoute(this.course.id)))}},{key:"onRecordUnsupported",value:function(){var e=this.props.chapterListRoutes.recordingChaptersUnsupportedRoute;this.props.dispatch(Object(Y.Kb)(e(this.course.id)))}},{key:"onPreviewChapter",value:function(e){var t=this.props.chapterListRoutes.recordingChapterPreviewRoute;this.props.dispatch(Object(Y.Kb)(t(this.course.id,e.id)))}},{key:"onRecordChapter",value:function(e){var t=this;this._chapterVmService.requestVm().then((function(){var r=t.props.chapterListRoutes.recordingChapterMediaRoute;t.props.dispatch(Object(Y.Kb)(r(t.course.id,e.id)))}))}},{key:"render",value:function(){var e=this;return this.props.loadingInitialData||this.course?u.createElement(y.d,null,u.createElement(y.b,{path:this.props.routes.recordingChaptersRoute,exact:!0,render:function(){return e.course?u.createElement(Ms,{dispatch:e.props.dispatch,course:e.course,asyncActions:e.props.asyncActions,templates:e.props.templates,rooms:e.props.rooms,vms:e.props.vms,onDone:e._onCreatingChaptersCompleted,onRecordUnsupported:e.onRecordUnsupported,onPreviewChapter:e.onPreviewChapter,onRecordChapter:e.onRecordChapter}):null}}),u.createElement(y.b,{path:this.props.routes.recordingChapterMediaRoute,exact:!0,render:function(t){var r=t.match;if(e.course){var n=e.course.chapters.find((function(e){return e.id===r.params.chapterId}));return n&&e.courseVm?u.createElement(ot,{dispatch:e.props.dispatch,vm:e.courseVm,course:e.course,chapter:n,asyncActions:e.props.asyncActions,vms:e.props.vms,templates:e.props.templates,onExit:e.onExitChapterRecordingOrPreview,remoteClientManager:e.props.remoteClientManager}):null}return null}}),u.createElement(y.b,{path:this.props.routes.recordingChapterPreviewRoute,exact:!0,render:function(t){var r=t.match;if(e.course){var n=e.course.chapters.find((function(e){return e.id===r.params.chapterId}));return n?u.createElement(Xt,{course:e.course,chapter:n,currentChapter:e.props.currentChapter,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,onExit:e.onExitChapterRecordingOrPreview}):null}return null}}),u.createElement(y.b,{path:Y.Q,exact:!0,render:function(){return u.createElement(te,{onBack:e.onUnsupportedRecordingBack})}}),u.createElement(y.a,{to:Y.H})):"Session not found"}},{key:"course",get:function(){return this.props.courses.get(this.props.match.params.courseId)}},{key:"courseVm",get:function(){return this.course&&this.state.courseVmId?this.props.vms.get(this.state.courseVmId):null}}]),t}(u.Component),Object(k.a)(es.prototype,"onExitChapterRecordingOrPreview",[w.a],Object.getOwnPropertyDescriptor(es.prototype,"onExitChapterRecordingOrPreview"),es.prototype),Object(k.a)(es.prototype,"onUnsupportedRecordingBack",[w.a],Object.getOwnPropertyDescriptor(es.prototype,"onUnsupportedRecordingBack"),es.prototype),Object(k.a)(es.prototype,"onRecordUnsupported",[w.a],Object.getOwnPropertyDescriptor(es.prototype,"onRecordUnsupported"),es.prototype),Object(k.a)(es.prototype,"onPreviewChapter",[w.a],Object.getOwnPropertyDescriptor(es.prototype,"onPreviewChapter"),es.prototype),Object(k.a)(es.prototype,"onRecordChapter",[w.a],Object.getOwnPropertyDescriptor(es.prototype,"onRecordChapter"),es.prototype),es),As=(ts=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._sessionBuilder=new _s(Object(Z.a)(r)),r._createCourseVmService=new ks(Object(Z.a)(r)),r.state={courseId:"",totalPagesBackwards:0},e.preloadedData&&r._sessionBuilder.onSessionDetailsSubmit(e.preloadedData.course),r._sessionBuilder.onCourseReadyEvent((function(e,t){if(r.setState({courseId:e.id}),t){var n=r.props.routes.recordChaptersRoute(e.id);r.props.dispatch(Object(Y.Kb)(n))}})),e.routes.recordingDetailsRoute&&r.props.location.pathname!==e.routes.recordingDetailsRoute&&!Object(Y.Gb)(e.routes.recordingChaptersRoute,r.props.location.pathname)&&r.props.dispatch(Object(Y.Kb)(e.routes.recordingDetailsRoute)),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onSessionDetailsSubmit",value:function(e){this._sessionBuilder.onSessionDetailsSubmit(e);var t=this.props.routes.recordingVmSelectorRoute;this.props.dispatch(Object(Y.Kb)(t))}},{key:"onTemplateTypeSelect",value:function(e){if(this._sessionBuilder.onTemplateTypeSelect(e),!!!this.props.user.creditCards.size)return this.props.onCardForm&&this.props.onCardForm(),this.setState({totalPagesBackwards:-2}),void this.props.dispatch(Object(Y.Kb)(this.props.routes.recordingCardFormRoute));this.setState({totalPagesBackwards:0}),this._redirectToSelectedTemplateTypeDetails()}},{key:"onTemplateSelect",value:function(e,t){var r=this;return this._sessionBuilder.onTemplateSelect(e,t).then((function(){return t?Promise.resolve():r._createCourseVmService.requestVm(r.props.routes.recordingCustomizeVmRoute)}))}},{key:"onCardSave",value:function(e){return this._sessionBuilder.onCardSave(e).then(this._redirectToSelectedTemplateTypeDetails)}},{key:"onTemplateCustomizeCompleted",value:function(e,t,r){var n=this;return this._sessionBuilder.onCustomVmCustomization(e,t,r).then((function(){var e=n.state.courseId;e?n.props.dispatch(Object(Y.Kb)(n.props.routes.recordChaptersRoute(e))):console.error("Missing course after template customization")}))}},{key:"onCreatingChaptersCompleted",value:function(e){return this.props.schedule?e.chapters.find((function(e){return!!e.videoUrl}))?(this.props.dispatch(Object(Y.Kb)(Object(Y.Tb)(e.id))),Promise.resolve()):(this.props.dispatch(new v.i(new P.J({type:P.K.Error,title:"No recorded tasks",text:"You cannot schedule a recording that does not have a recorded task"}))),Promise.reject("No recorded tasks")):this.props.dispatch(Object(Y.Kb)(this.props.routes.recordingsRoute+"?course=".concat(e.id)))}},{key:"render",value:function(){var e=this;return u.createElement(y.d,null,this.props.routes.recordingDetailsRoute&&u.createElement(y.b,{path:this.props.routes.recordingDetailsRoute,exact:!0,render:function(){return u.createElement(Ts.a,{course:e._sessionBuilder.course,schedule:e.props.schedule,dispatch:e.props.dispatch,onSessionDetailsSubmit:e.onSessionDetailsSubmit})}}),u.createElement(y.b,{path:this.props.routes.recordingVmSelectorRoute,exact:!0,render:function(){return u.createElement(Bi,{dispatch:e.props.dispatch,templateTypes:e.visibleTemplateTypes,onTemplateTypeSelect:e.onTemplateTypeSelect})}}),u.createElement(y.b,{path:this.props.routes.recordingCardFormRoute,exact:!0,render:function(){return u.createElement(ms,{user:e.props.user,dispatch:e.props.dispatch,templateType:e._sessionBuilder.templateType,onCardSave:e.onCardSave})}}),u.createElement(y.b,{path:this.props.routes.recordingCustomVmSelectorRoute,exact:!0,render:function(){return u.createElement(ys,{dispatch:e.props.dispatch,os:e._sessionBuilder.templateType.os,onTemplateSelect:e.onTemplateSelect,templates:e.props.templates,totalPagesBackwards:e.state.totalPagesBackwards,loadingInitialData:e.props.loadingInitialData})}}),u.createElement(y.b,{path:this.props.routes.recordingCustomizeVmRoute,exact:!0,render:function(){return u.createElement(Ui,{vms:e.props.vms,vm:e.vm,templates:e.props.templates,remoteClientManager:e.props.remoteClientManager,cost:e.props.cost,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,onDataCompleted:e.onTemplateCustomizeCompleted,totalPagesBackwards:e.state.totalPagesBackwards})}}),u.createElement(y.b,{path:this.props.routes.recordingVirtualBrowserDetailsRoute,exact:!0,render:function(){return u.createElement(Os,{totalPagesBackwards:e.state.totalPagesBackwards,onSubmit:e._sessionBuilder.onVirtualBrowserDetailsSubmit})}}),u.createElement(y.b,{path:this.props.routes.recordingChaptersRoute,render:function(t){var r=t.match;return u.createElement(Vs,{routes:e.props.chaptersWrapperRoutes,chapterListRoutes:e.props.chapterListRoutes,courses:e.props.courses,templates:e.props.templates,rooms:e.props.rooms,vms:e.props.vms,currentChapter:e.props.currentChapter,loadingInitialData:e.props.loadingInitialData,remoteClientManager:e.props.remoteClientManager,asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,match:r,location:e.props.location,onCreatingChaptersCompleted:e.onCreatingChaptersCompleted})}}),u.createElement(y.a,{to:Y.H}))}},{key:"_redirectToSelectedTemplateTypeDetails",value:function(){var e=this.props.routes,t=e.recordingVirtualBrowserDetailsRoute,r=e.recordingCustomVmSelectorRoute,n=this._sessionBuilder.templateType.os===P.L.Docker?t:r;this.props.dispatch(Object(Y.Kb)(n))}},{key:"course",get:function(){var e=this.state.courseId;if(e)return this.props.courses.get(e)}},{key:"vm",get:function(){var e;return this.course&&this.course.virtualMachineId&&(e=this.props.vms.get(this.course.virtualMachineId)),e||new P.lb({})}},{key:"visibleTemplateTypes",get:function(){return this.props.templateTypes.filter((function(e){return e.default})).map((function(e){return e.set("name",Es(e))})).toList()}}]),t}(u.Component),Object(k.a)(ts.prototype,"onSessionDetailsSubmit",[w.a],Object.getOwnPropertyDescriptor(ts.prototype,"onSessionDetailsSubmit"),ts.prototype),Object(k.a)(ts.prototype,"onTemplateTypeSelect",[w.a],Object.getOwnPropertyDescriptor(ts.prototype,"onTemplateTypeSelect"),ts.prototype),Object(k.a)(ts.prototype,"onTemplateSelect",[w.a],Object.getOwnPropertyDescriptor(ts.prototype,"onTemplateSelect"),ts.prototype),Object(k.a)(ts.prototype,"onCardSave",[w.a],Object.getOwnPropertyDescriptor(ts.prototype,"onCardSave"),ts.prototype),Object(k.a)(ts.prototype,"onTemplateCustomizeCompleted",[w.a],Object.getOwnPropertyDescriptor(ts.prototype,"onTemplateCustomizeCompleted"),ts.prototype),Object(k.a)(ts.prototype,"onCreatingChaptersCompleted",[w.a],Object.getOwnPropertyDescriptor(ts.prototype,"onCreatingChaptersCompleted"),ts.prototype),Object(k.a)(ts.prototype,"_redirectToSelectedTemplateTypeDetails",[w.a],Object.getOwnPropertyDescriptor(ts.prototype,"_redirectToSelectedTemplateTypeDetails"),ts.prototype),ts),Is=r(372),Us=(rs=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._course=void 0,r._room=void 0,r._loadData(),r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onCardForm",value:function(){this.props.user.mobileNumber&&this.props.dispatch(new v.i(new P.J({type:P.K.Error,title:"Unverified cell number",text:"Please click the link sent to you by SMS to get your credit",context:Is.a})))}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"try-flow"},u.createElement(y.d,null,u.createElement(y.b,{path:Y.f,render:function(){return u.createElement(Ss,{preloadedData:{course:e._course,room:e._room},asyncActions:e.props.asyncActions,cost:e.props.cost,courses:e.props.courses,dispatch:e.props.dispatch,location:e.props.location,loadingInitialData:e.props.loadingInitialData,remoteClientManager:e.props.remoteClientManager,rooms:e.props.rooms,user:e.props.user,vms:e.props.vms,templates:e.props.templates,templateTypes:e.props.templateTypes,hideChargeScreenBackButton:!0,onCardForm:e.onCardForm,routes:{cardFormRoute:Y.c,customizeVmRoute:Y.e,customVmSelectorRoute:Y.d,vmSelectorRoute:Y.g,virtualBrowserDetailsRoute:""}})}}),u.createElement(y.b,{path:Y.p,render:function(){return u.createElement(As,{preloadedData:{course:e._course},asyncActions:e.props.asyncActions,loadingInitialData:e.props.loadingInitialData,remoteClientManager:e.props.remoteClientManager,dispatch:e.props.dispatch,cost:e.props.cost,courses:e.props.courses,currentChapter:e.props.currentChapter,location:e.props.location,rooms:e.props.rooms,schedule:!0,templates:e.props.templates,templateTypes:e.props.templateTypes,vms:e.props.vms,user:e.props.user,hideChargeScreenBackButton:!0,onCardForm:e.onCardForm,routes:{recordChaptersRoute:Y.Db,recordingChaptersRoute:Y.k,recordingCardFormRoute:Y.h,recordingCustomizeVmRoute:Y.n,recordingCustomVmSelectorRoute:Y.m,recordingVirtualBrowserDetailsRoute:"",recordingsRoute:Y.p,recordingVmSelectorRoute:Y.o},chaptersWrapperRoutes:{recordChaptersRoute:Y.Db,recordingChapterMediaRoute:Y.i,recordingChapterPreviewRoute:Y.j,recordingChaptersRoute:Y.k,recordingChaptersUnsupportedRoute:Y.l},chapterListRoutes:{recordingChapterMediaRoute:Y.Bb,recordingChapterPreviewRoute:Y.Cb,recordingChaptersUnsupportedRoute:Y.Eb}})}})))}},{key:"_loadData",value:function(){var e=Object(O.d)(O.a.TryFlowSession);e?(this._course=new P.x(e.course),this._room=new P.Q(e.room)):this.props.dispatch(Object(h.g)(Y.w))}}]),t}(u.Component),Object(k.a)(rs.prototype,"onCardForm",[w.a],Object.getOwnPropertyDescriptor(rs.prototype,"onCardForm"),rs.prototype),rs),Ls=r(170),Fs=function(){function e(t){Object(i.a)(this,e),this._timers=Object($.Map)([[]]),this._notified={},this._props=void 0,this._props=t,this.setTimers(this._props),Object(Ls.c)()}return Object(s.a)(e,[{key:"setTimers",value:function(e){var t=this,r=Date.now();this.destroyTimers(),this._cleanNotified(e),this._props=e,this._timers=e.rooms.filter((function(e){var n=e.startTime.getTime()-r,o=0<n&&n<864e5;return!e.deleted&&o&&!t._notified[e.id]})).map((function(e){return setTimeout((function(){return t._notify(e)}),e.startTime.getTime()-r-6e5)})).toMap()}},{key:"updateTimers",value:function(e){this.setTimers(e)}},{key:"destroyTimers",value:function(){this._timers.forEach(clearTimeout)}},{key:"_notify",value:function(e){this._notified[e.id]=!0;var t=this._props.courses.get(e.courseId),r=Math.round((e.startTime.getTime()-(new Date).getTime())/1e3/60);t&&r>0&&(this._props.dispatch(new v.i(new P.J({type:P.K.General,context:"upcoming_session",ttl:15e3,text:"**Session starting**: Your session "+"\u201c".concat(t.name.length>50?t.name.substr(0,50)+"...":t.name,"\u201d ")+"is starting in ".concat(r," min").concat(r>1?"s":"",". [Join now](").concat(Object(Y.Ub)(e.secret),")")}))),this._desktopNotification(t.name,r))}},{key:"_desktopNotification",value:function(e,t){Object(Ls.a)()&&"hidden"===document.visibilityState&&Object(Ls.b)("Session starting",'"'.concat(e,'" starts in ').concat(t," min").concat(t>1?"s":""),15e3)}},{key:"_cleanNotified",value:function(e){var t=this;e.rooms.forEach((function(e){var r=t._props.rooms.get(e.id);r&&e.startTime!==r.startTime&&(t._notified[e.id]=!1)}))}}]),e}(),Bs=(r(1994),to.tz.guess()),zs=(ns=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e))).startTimePickerRef=void 0,r.expirationTimePickerRef=void 0,r.state={timezone:Bs,mobileNumber:e.user.mobileNumber,mobileNumberError:null,isSaving:!1},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.visible&&e.visible!==this.props.visible&&this.setState({timezone:Bs,mobileNumber:"",mobileNumberError:null})}},{key:"onSaveRoom",value:function(){var e=this,t=this.props,r=bo(t.room,t.startTime,t.expirationTime,this.state.timezone),n=[this.props.onSaveRoom(this.props.course,r)];if(this.state.mobileNumber!==this.props.user.mobileNumber&&this._isMobileNumberValid(this.state.mobileNumber)){var o=Object(Za.b)(this.state.mobileNumber),a=Object(Za.a)(o,"E.164"),i=this.props.user.set("mobileNumber",a);n.push(this.props.onUserUpdate(i))}this.setState({isSaving:!0}),Promise.all(n).catch((function(){return e.setState({isSaving:!1})}))}},{key:"onMobileNumberChanged",value:function(e){this.setState({mobileNumber:e})}},{key:"onMobileNumberBlur",value:function(e){var t=this;e!==this.state.mobileNumber?this.setState({mobileNumber:e},(function(){return t._validateMobileNumber(t.state.mobileNumber)})):this._validateMobileNumber(this.state.mobileNumber)}},{key:"onStartTimeChange",value:function(e){this.props.onStartTimeChange(e);var t=this.props,r=vo(t.startTime,t.expirationTime,e);this.props.onExpirationChange(r)}},{key:"render",value:function(){var e=this;return u.createElement("div",{className:"create-event-modal"},u.createElement(R.a,{title:"Schedule Session",visible:this.props.visible,onToggle:this.props.onToggle},u.createElement("div",{className:"join-room form-styles"},u.createElement("div",{className:"row"},u.createElement(T.e,{ref:function(t){return e.startTimePickerRef=t},label:"Start",date:this.props.startTime,minDate:this.props.minStartDate,onDateChange:this.onStartTimeChange}),u.createElement("div",{className:"field-info"},u.createElement(T.A,{timezone:this.state.timezone,onTimezoneChange:function(t){return e.setState({timezone:t})}}))),u.createElement(T.e,{ref:function(t){return e.expirationTimePickerRef=t},label:"End",date:this.props.expirationTime,minDate:this.props.minExpDate,onDateChange:this.props.onExpirationChange}),!this.props.user.mobileNumber&&u.createElement("div",{className:"mobile-number"},u.createElement(T.c,{value:this.state.mobileNumber,error:this.state.mobileNumberError?this.state.mobileNumberError:"",onChange:this.onMobileNumberChanged,onBlur:this.onMobileNumberBlur}),u.createElement("div",{className:"field-info"},"(Optional) Get reminder SMS 15 mins before session starts"))),u.createElement(T.a,{className:"def-btn btn",onClick:this.onSaveRoom,disabled:!this.isDataValid,loading:this.state.isSaving},"Save"),u.createElement("i",{className:"fa fa-calendar","aria-hidden":"true"})))}},{key:"_isMobileNumberValid",value:function(e){var t=Object(Za.b)(e);return t&&t.country&&t.phone}},{key:"_validateMobileNumber",value:function(e){var t=Object(T.C)({cellNumber:e});this.setState({mobileNumberError:t.cellNumber?t.cellNumber:null})}},{key:"isDataValid",get:function(){return null===this.state.mobileNumberError}}]),t}(u.Component),Object(k.a)(ns.prototype,"onSaveRoom",[w.a],Object.getOwnPropertyDescriptor(ns.prototype,"onSaveRoom"),ns.prototype),Object(k.a)(ns.prototype,"onMobileNumberChanged",[w.a],Object.getOwnPropertyDescriptor(ns.prototype,"onMobileNumberChanged"),ns.prototype),Object(k.a)(ns.prototype,"onMobileNumberBlur",[w.a],Object.getOwnPropertyDescriptor(ns.prototype,"onMobileNumberBlur"),ns.prototype),Object(k.a)(ns.prototype,"onStartTimeChange",[w.a],Object.getOwnPropertyDescriptor(ns.prototype,"onStartTimeChange"),ns.prototype),ns);r(1995);!function(e){e.Min15="Min15",e.Min30="Min30",e.Min45="Min45",e.Hour1="Hour1",e.Hour2="Hour2",e.Custom="Custom"}(is||(is={}));var Hs,Ws=(os={},Object(Q.a)(os,is.Min15,15),Object(Q.a)(os,is.Min30,30),Object(Q.a)(os,is.Min45,45),Object(Q.a)(os,is.Hour1,60),Object(Q.a)(os,is.Hour2,120),os),Ks=(as=function(e){function t(e){var r;Object(i.a)(this,t),r=Object(c.a)(this,Object(l.a)(t).call(this,e));var n=e.courseDuration,o=n<36e5?is.Hour1:n<=72e5?is.Hour2:is.Custom;return r.state={duration:o},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"start",value:function(){if(this.state.duration!==is.Custom){var e=this.props.delay?this.props.delay:0,t=Ws[this.state.duration];this.props.onStartIn(e,t)}else this.props.onScheduleWithCustomDuration()}},{key:"onDurationChange",value:function(e){this.setState({duration:e})}},{key:"render",value:function(){var e=0===this.props.delay?"now":"in ".concat(this.props.delay," mins");return u.createElement("div",{className:"quick-scheduler"},u.createElement("i",{className:"fa fa-calendar","aria-hidden":"true"}),u.createElement("h2",null,"Schedule Session"),u.createElement("h4",null,"You can start a session ",e," or schedule one for later"),u.createElement("div",{className:"start-button"},u.createElement(T.a,{className:"btn",onClick:this.start},"Start ",e),u.createElement("span",null,"at ",this.props.startTime.format("h:mma")," (GMT ",to.tz(to.tz.guess()).format("Z"),") with"),u.createElement(T.y,{value:this.state.duration,onChange:this.onDurationChange},u.createElement(T.n,{value:is.Min15},"15-mins"),u.createElement(T.n,{value:is.Min30},"30-mins"),u.createElement(T.n,{value:is.Min45},"45-mins"),u.createElement(T.n,{value:is.Hour1},"1-hour"),u.createElement(T.n,{value:is.Hour2},"2-hours"),u.createElement(T.n,{value:is.Custom},"Custom")),u.createElement("span",null,"duration")),u.createElement("span",{className:"separator"},"Or"))}}]),t}(u.Component),Object(k.a)(as.prototype,"start",[w.a],Object.getOwnPropertyDescriptor(as.prototype,"start"),as.prototype),Object(k.a)(as.prototype,"onDurationChange",[w.a],Object.getOwnPropertyDescriptor(as.prototype,"onDurationChange"),as.prototype),as),Ys=(r(1996),Hs=function(e){function t(e){var r;Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._minTimeInterval=void 0;var n=!!e.startTime&&!!e.expirationTime,o=e.startTime&&e.startTime.isValid()?e.startTime:m(),a=e.expirationTime&&e.expirationTime.isValid()?e.expirationTime:m().add(1,"h");return r.state={createModalVisible:n,startTime:o,expirationTime:a,minStartDate:r.minStartDate},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._minTimeInterval=setInterval((function(){e.state.minStartDate.isSame(e.minStartDate,"minute")||e.setState({minStartDate:e.minStartDate})}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this._minTimeInterval)}},{key:"schedule",value:function(e,t){var r=t.diff(e);t=this.courseDuration>r?e.clone().add(this.courseDuration,"ms"):t,this.setState({createModalVisible:!0,startTime:m(e),expirationTime:m(t)})}},{key:"onStartTimeChange",value:function(e){this.setState({startTime:e})}},{key:"onExpirationChange",value:function(e){this.setState({expirationTime:e})}},{key:"toggleCreateModal",value:function(){this.setState({createModalVisible:!this.state.createModalVisible})}},{key:"onStartIn",value:function(e,t){var r=bo(this.props.room,m().add(e,"minutes").seconds(0),m().add(t+e,"minutes").seconds(0),m.tz.guess());this.saveRoom(this.props.course,r)}},{key:"onScheduleWithCustomDuration",value:function(){var e=m().add(this.delay,"minutes").seconds(0),t=this.courseDuration||36e5,r=m(e).add(t,"milliseconds").seconds(0);this.schedule(e,r)}},{key:"updateUser",value:function(e){return this.props.dispatch(this.props.asyncActions.updateUser(e))}},{key:"saveRoom",value:function(e,t){var r=this;return this._validateTimeAndWarn(e,t)?this.props.dispatch(this.props.asyncActions.addRoom(e,t)).then((function(e){r.props.dispatch(new v.P("upcoming_session")),r.props.dispatch(Object(h.g)(Object(Y.Ub)(e.secret)))})):Promise.reject("Time is not valid")}},{key:"render",value:function(){return u.createElement("div",{className:"session-scheduler"},u.createElement(Ks,{delay:this.delay,startTime:this.state.minStartDate,courseDuration:this.courseDuration,onStartIn:this.onStartIn,onScheduleWithCustomDuration:this.onScheduleWithCustomDuration}),u.createElement(Va,{rooms:this.props.rooms,courses:this.props.courses,templates:this.props.templates,onSelectSlot:this.schedule}),u.createElement(zs,{onToggle:this.toggleCreateModal,minStartDate:this.state.minStartDate,minExpDate:this.minExpDate,course:this.props.course,room:this.props.room,visible:this.state.createModalVisible,startTime:this.state.startTime,expirationTime:this.state.expirationTime,onSaveRoom:this.saveRoom,onStartTimeChange:this.onStartTimeChange,onExpirationChange:this.onExpirationChange,onUserUpdate:this.updateUser,user:this.props.user}))}},{key:"_validateTimeAndWarn",value:function(e,t){var r=fo(t,this._getCourseTemplate(e),void 0,this.props.courseDuration);return!r.isValid&&r.notification&&this.props.dispatch(new v.i(r.notification)),r.isValid}},{key:"_getCourseTemplate",value:function(e){return this.props.templates.get(e.templateId)}},{key:"delay",get:function(){return yo(this._getCourseTemplate(this.props.course))}},{key:"minStartDate",get:function(){return m().add(this.delay,"minutes").seconds(0)}},{key:"minExpDate",get:function(){return m(this.state.startTime).add(this.courseDuration,"ms")}},{key:"courseDuration",get:function(){var e=this.props.course.chapters.map((function(e){return e.duration})).reduce((function(e,t){return e+t}),0);return 60*Math.ceil(e/60/1e3)*1e3}}]),t}(u.Component),Object(k.a)(Hs.prototype,"schedule",[w.a],Object.getOwnPropertyDescriptor(Hs.prototype,"schedule"),Hs.prototype),Object(k.a)(Hs.prototype,"onStartTimeChange",[w.a],Object.getOwnPropertyDescriptor(Hs.prototype,"onStartTimeChange"),Hs.prototype),Object(k.a)(Hs.prototype,"onExpirationChange",[w.a],Object.getOwnPropertyDescriptor(Hs.prototype,"onExpirationChange"),Hs.prototype),Object(k.a)(Hs.prototype,"toggleCreateModal",[w.a],Object.getOwnPropertyDescriptor(Hs.prototype,"toggleCreateModal"),Hs.prototype),Object(k.a)(Hs.prototype,"onStartIn",[w.a],Object.getOwnPropertyDescriptor(Hs.prototype,"onStartIn"),Hs.prototype),Object(k.a)(Hs.prototype,"onScheduleWithCustomDuration",[w.a],Object.getOwnPropertyDescriptor(Hs.prototype,"onScheduleWithCustomDuration"),Hs.prototype),Object(k.a)(Hs.prototype,"updateUser",[w.a],Object.getOwnPropertyDescriptor(Hs.prototype,"updateUser"),Hs.prototype),Object(k.a)(Hs.prototype,"saveRoom",[w.a],Object.getOwnPropertyDescriptor(Hs.prototype,"saveRoom"),Hs.prototype),Hs),Gs=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(l.a)(t).call(this,e)))._cb=void 0,r._failedToInitUnsubscribe=void 0,r._onInitUnsubscribe=void 0,r._routeQueryParams=void 0,r._upcomingSessions=void 0,r._cb=function(){r.props.dispatch(Object(h.h)(Y.F))},r._routeQueryParams=new Y.fb(e.location),r._loadData((function(){r._logoutIfJwtExpiresSoon(),r._checkIfCostShouldBeShown()})),r._upcomingSessions=new Fs(e),Object(Y.Gb)(Y.q,e.location.pathname)||Object(O.c)(O.a.TryFlowSession),r.state={notDeletedCourses:e.courses.filter((function(e){return!e.deleted})).toMap(),notDeletedRooms:e.rooms.filter((function(e){return!e.deleted})).toMap()},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){Object(b.b)().onLogout(this._cb)}},{key:"componentWillUnmount",value:function(){Object(b.b)().unsubscribe(this._cb),this._failedToInitUnsubscribe&&this._failedToInitUnsubscribe(),this._onInitUnsubscribe&&this._onInitUnsubscribe(),this._upcomingSessions.destroyTimers()}},{key:"componentWillReceiveProps",value:function(e){this._upcomingSessions.updateTimers(e)}},{key:"componentDidUpdate",value:function(e){var t={};this.props.courses!==e.courses&&(t.notDeletedCourses=this.props.courses.filter((function(e){return!e.deleted})).toMap()),this.props.rooms!==e.rooms&&(t.notDeletedRooms=this.props.rooms.filter((function(e){return!e.deleted})).toMap()),this.props.courses===e.courses&&this.props.rooms===e.rooms||this.setState(t)}},{key:"render",value:function(){var e=this;return u.createElement("section",{className:"app-wrapper page-wrapper"},u.createElement(U.a,null),u.createElement(W,{predefined:!0}),u.createElement(L.a,null),u.createElement(y.d,null,u.createElement(y.b,{path:Y.b,exact:!0,render:function(){return u.createElement(X,{dispatch:e.props.dispatch})}}),u.createElement(y.b,{path:Y.pb,exact:!0,render:function(){return u.createElement(K.a,{courses:e.state.notDeletedCourses,dispatch:e.props.dispatch,location:e.props.location})}}),u.createElement(y.b,{path:Y.E,render:function(){return u.createElement(Ss,{remoteClientManager:e.props.remoteClientManager,location:e.props.location,dispatch:e.props.dispatch,user:e.props.user,asyncActions:e.props.asyncActions,templates:e.nonLegacyTemplates,templateTypes:e.props.templateTypes,courses:e.state.notDeletedCourses,rooms:e.state.notDeletedRooms,vms:e.props.vms,cost:e.props.cost,loadingInitialData:e.props.loadingInitialData,routes:{cardFormRoute:Y.s,customizeVmRoute:Y.v,customVmSelectorRoute:Y.u,virtualBrowserDetailsRoute:Y.tb,sessionDetailsRoute:Y.kb,vmSelectorRoute:Y.ub}})}}),u.createElement(y.b,{path:Y.J,render:function(){return u.createElement(Ps,{user:e.props.user,dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,courses:e.state.notDeletedCourses,rooms:e.props.rooms,templates:e.props.templates,templateTypes:e.props.templateTypes,loadingInitialData:e.props.loadingInitialData})}}),u.createElement(y.b,{path:Y.gb,render:function(t){var r=t.match,n=e.state.notDeletedCourses.get(r.params.id),o=(n||{chapters:[]}).chapters.map((function(e){return e.duration})).reduce((function(e,t){return e+t}),0);o=60*Math.ceil(o/60/1e3)*1e3;var a=new Y.fb(e.props.location),i=a.params.start,s=a.params.expiration,c=o>(i&&s?s-i:0)?parseInt(i,10)+o:s,l=i?m(i,Y.eb):void 0,p=c?m(c,Y.eb):void 0,d=Object(O.d)(O.a.SessionCreationRoom);return n?u.createElement(Ys,{courses:e.props.courses,course:n,room:new P.Q(d||{}),templates:e.props.templates,dispatch:e.props.dispatch,user:e.props.user,asyncActions:e.props.asyncActions,rooms:e.state.notDeletedRooms,startTime:l,expirationTime:p,courseDuration:o}):null}}),u.createElement(y.b,{path:Y.w,render:function(){return u.createElement(us,{asyncActions:e.props.asyncActions,remoteClientManager:e.props.remoteClientManager,dispatch:e.props.dispatch,templates:e.props.templates,templateTypes:e.props.templateTypes,currentChapter:e.props.currentChapter,rooms:e.state.notDeletedRooms,courses:e.props.courses,location:e.props.location,user:e.props.user,cost:e.props.cost,vms:e.props.vms,loadingInitialData:e.props.loadingInitialData})}}),u.createElement(y.b,{path:Y.W,render:function(){var t="true"===new Y.fb(e.props.location).params.schedule;return u.createElement(As,{loadingInitialData:e.props.loadingInitialData,asyncActions:e.props.asyncActions,dispatch:e.props.dispatch,user:e.props.user,templates:e.nonLegacyTemplates,templateTypes:e.props.templateTypes,rooms:e.state.notDeletedRooms,courses:e.state.notDeletedCourses,cost:e.props.cost,currentChapter:e.props.currentChapter,vms:e.props.vms,remoteClientManager:e.props.remoteClientManager,schedule:t,location:e.props.location,routes:{recordChaptersRoute:Y.Pb,recordingDetailsRoute:Y.T,recordingChaptersRoute:Y.P,recordingCardFormRoute:Y.M,recordingCustomizeVmRoute:Y.S,recordingCustomVmSelectorRoute:Y.R,recordingVirtualBrowserDetailsRoute:Y.X,recordingsRoute:Y.bb,recordingVmSelectorRoute:Y.Y},chaptersWrapperRoutes:{recordChaptersRoute:Y.Pb,recordingChapterMediaRoute:Y.N,recordingChapterPreviewRoute:Y.O,recordingChaptersRoute:Y.P,recordingChaptersUnsupportedRoute:Y.Q},chapterListRoutes:{recordingChapterMediaRoute:Y.Nb,recordingChapterPreviewRoute:Y.Ob,recordingChaptersUnsupportedRoute:Y.Qb}})}}),u.createElement(y.b,{path:Y.q,render:function(){return u.createElement(Us,{dispatch:e.props.dispatch,asyncActions:e.props.asyncActions,cost:e.props.cost,courses:e.state.notDeletedCourses,currentChapter:e.props.currentChapter,location:e.props.location,loadingInitialData:e.props.loadingInitialData,remoteClientManager:e.props.remoteClientManager,rooms:e.state.notDeletedRooms,templates:e.props.templates,templateTypes:e.props.templateTypes,user:e.props.user,vms:e.props.vms})}}),u.createElement(y.a,{to:Y.H})),u.createElement(I,{dispatch:this.props.dispatch,user:this.props.user,cost:this.props.cost,attendeeId:this.queryParams.attendee,courses:this.state.notDeletedCourses,templates:this.props.templates,asyncActions:this.props.asyncActions}))}},{key:"_loadData",value:function(e){var t=this;this._failedToInitUnsubscribe=this.props.appInitializer.onAppFailedToInitialize((function(){e(),t.props.dispatch(new v.i(new P.J({type:P.K.Info,title:"Something went wrong",text:"Please reload the page",permanent:!0})))})),this._onInitUnsubscribe=this.props.appInitializer.onAppInitialized(e),this.props.appInitializer.loadData()}},{key:"_checkIfCostShouldBeShown",value:function(){var e=this.state.notDeletedRooms.get(this.queryParams.room)||new P.Q({}),t=this.state.notDeletedCourses.get(e.courseId),r=!!e.id&&Object(Tr.h)(e),n=this.props,o=n.dispatch,a=n.asyncActions;t&&r&&o(a.loadRoomCost(e))}},{key:"_logoutIfJwtExpiresSoon",value:function(){var e=Object(b.b)(),t=e.getJwtExpiry()-Date.now();(t=t/1e3/60/60/24)<=1&&(e.logout(),this.props.dispatch(new v.i(new P.J({type:P.K.Info,title:"Authorization token expiry",text:"Your authorization token is about to expire soon. Please login again"}))))}},{key:"queryParams",get:function(){return this._routeQueryParams.params}},{key:"nonLegacyTemplates",get:function(){return this.props.templates.filter((function(e){return!Object(g.d)(e)})).toMap()}}]),t}(u.Component);r.d(t,"AppWrapper",(function(){return Gs}))}}]);
//# sourceMappingURL=4.146db3a8.chunk.js.map