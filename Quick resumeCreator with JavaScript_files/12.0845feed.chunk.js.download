(this.webpackJsonpRhyme=this.webpackJsonpRhyme||[]).push([[12,7],{1054:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return p}));var r=n(3),o=n(1058),i=n(1066),s=Object(r.a)({},i.c,(function(){return new i.a})),a=function(e){var t=Object(o.b)(e),n=s[t];if(!n)throw new Error("InputCodec with version ".concat(t," not supported"));return n()},c=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(this.result)},r.readAsArrayBuffer(e)}))},l=function(e){var t=0;return e.left&&(t|=1),e.middle&&(t|=2),e.right&&(t|=4),e.up&&(t|=8),e.down&&(t|=16),t},p=function(e){return{left:!!(1&e),middle:!!(2&e),right:!!(4&e),up:!!(8&e),down:!!(16&e)}}},1058:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c}));var r=0;function o(){return"".concat(r++)}function i(e){return new DataView(e).getUint8(0)}function s(e){return new Promise((function(t){var n=document.createElement("video");n.preload="metadata",n.onloadedmetadata=function(){t(Math.round(1e3*n.duration))},n.src=e}))}function a(e,t,n){var r=e.reduce((function(e,n){return e+t(n).byteLength}),0)-e.size+1,o=new ArrayBuffer(r),s=new Uint8Array(o);s[0]=n.version[0];var a=0,c=1;return e.forEach((function(e){var r=t(e),l=i(r);if(l!==n.version[0])throw new Error("Merging streams with different versions is not supported. Expected version: ".concat(n.version[0]," actual version: ").concat(l));if((r.byteLength-1)%n.packetSize!==0)throw new Error("Invalid buffer size. It is not dividable by ".concat(n.packetSize));var p=new Uint8Array(r,1);s.set(p,c);for(var u=new DataView(o,c,p.length),h=new DataView(r,1,p.length),d=0;d<h.byteLength;d+=n.packetSize){var m=n.getPacketTimestamp(h,d);n.setPacketTimestamp(u,d,m+a)}c+=p.length,a+=e.duration})),o}function c(e,t,n){for(var r=t(e),o=new DataView(e),i=1;i<o.byteLength&&r.getPacketTimestamp(o,i)<=n;)i+=r.packetSize;return e.slice(0,i)}},1059:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r,o=n(51),i=n(1054),s=n(1066);function a(e){if(e[0]===s.b)return{type:r.Keyboard,timestamp:e[1],down:1===e[2],keyCode:e[3]};var t=Object(i.b)(e[2]);return Object(o.a)({type:r.Mouse,timestamp:e[1],x:e[3],y:e[4]},t)}!function(e){e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse"}(r||(r={}))},1062:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return p}));var r=n(8),o=n(0),i=30,s=function(e,t){switch(e){case o.ab.Micro:return"Micro (2 vCPU, 1GB RAM, 30GB SSD)";case o.ab.Small:return"Small (2 vCPU, 2GB RAM, 30GB SSD)";case o.ab.Medium:return"Medium (2 vCPUs, 4GB RAM, 30GB SSD)";case o.ab.Large:return"Normal (2 vCPUs, 8GB RAM, 50GB SSD)";case o.ab.XLarge:return"Double (4 vCPUs, 16GB RAM, 100GB SSD)";case o.ab.XXLarge:return"Quadruple (8 vCPUs, 32GB RAM, 250 SSD)";case o.ab.GPUMicro:return"GPU Micro (1 NVIDIA Tesla M60 2048 cores, 4 vCPUs, 30.5GB RAM, 100 SSD)";case o.ab.GPUSmall:return"GPU Small (1 NVIDIA K80 2496 cores, 4 vCPUs, 61GB RAM, 100 SSD)";case o.ab.GPUMedium:return"GPU Medium (1 NVIDIA Tesla V100 5120 cores, 8 vCPUs, 61GB RAM, 100 SSD)";case o.ab.GPULarge:return"GPU Large (4 NVIDIA Tesla V100 5120 cores each, 32 vCPUs, 244GB RAM, 100 SSD)";case o.ab.MemMicro:return"Memory Micro (8 vCPUs, 64GB RAM, 100 SSD)";case o.ab.MemSmall:return"Memory Small (16 vCPUs, 128GB RAM, 100 SSD)";default:return""}},a=function(e,t){var n=e.find((function(e){return e.defaultTemplate&&e.os===o.L.Win}));if(!t)return n?n.screenshotUrl:"";if(!t.screenshotUrl)switch(t.os){case o.L.Linux:var r=e.find((function(e){return e.defaultTemplate&&e.os===o.L.Linux}));return r?r.screenshotUrl:"";case o.L.Win:return n?n.screenshotUrl:"";case o.L.Docker:var i=e.find((function(e){return e.defaultTemplate&&e.os===o.L.Docker}));return i?i.screenshotUrl:""}return t.screenshotUrl},c=function(e){return e&&!e.ownerId&&!e.defaultTemplate},l=function(e,t){return t?e.filter((function(e){if(t&&e.os!==t.os)return!1;var n=p(e);return t&&t.id===e.id&&c(e)?n:n&&(!!e.ownerId||e.defaultTemplate)})).toList():Object(r.List)([])},p=function(e){return e.state!==o.bb.Deleted}},1065:function(e,t,n){"use strict";var r,o=n(84),i=n(5),s=n(11),a=n(30),c=n(28),l=n(290),p=n(29),u=n(1050),h=n.n(u),d=n(8),m=n(210),y=n.n(m),f=n(4),v=n(165),b=n(1060),g=n(211),_=n(1069),k=n(0),O=n(1087),w=n(19),C=n.n(w),E=n(44),j=n(1466),S=function(e){return function(t){if(t.seekable&&Number.isFinite(t.duration)){var n=Object(j.a)(0,t.duration,t.currentTime+e);t.currentTime=n}}},P=function(e){return function(t){t.volume=Object(j.a)(0,1,t.volume+e)}},T=function(e){var t=document,n=t.fullscreenElement,r=t.webkitFullscreenElement;return n===e||r===e},R=function(e){return e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.requestFullscreen()},A=function(){var e=Object(E.a)(C.a.mark((function e(t){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T(t)){e.next=4;break}return e.next=3,R(t);case 3:return e.abrupt("return",!0);case 4:return e.next=6,document.webkitExitFullscreen?document.webkitExitFullscreen():document.exitFullscreen();case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(e){return e.muted=!e.muted},M=n(1074),x=n(134),N=n(1051),V=n(1105),L=n(47),U=function(e){if(e.startsWith("blob:"))return e;var t,n,r,o,i,s=e.replace("https://","").split("/"),a=Object(L.a)(s,2),c=a[0],l=a[1].split("."),p=Object(L.a)(l,1)[0],u=c.split(".");if(5===u.length){var h=Object(L.a)(u,5);t=h[0],n=h[1],r=h[2],o=h[3],i=h[4]}else{var d=Object(L.a)(u,4);t=d[0],n=d[1],o=d[2],i=d[3],r="us-east-1"}var m=t.split("-"),y=m.indexOf("skillspace");return t=m.slice(0,y).join("-")+"-mp4-"+m.slice(y,m.length).join("-"),"https://".concat(t,".").concat(n,".").concat(r,".").concat(o,".").concat(i,"/").concat(p,".mp4")},I=(n(1164),function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(n=Object(a.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={current:void 0},n._leftOn=!1,n._ref=void 0,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onMouseEvent",value:function(e){this.setState({current:e})}},{key:"render",value:function(){var e=this;if(!this.state.current)return null;var t=this.state.current,n=t.x,r=t.y,o=t.left,i=this.props.scale;return o&&this._leftOn!==o&&this._playRipple(n*i,r*i),this._leftOn=o,f.createElement("div",{ref:function(t){return e._ref=t},className:"cursor-player cursor"})}},{key:"_playRipple",value:function(e,t){if(this._ref){var n=document.createElement("div");n.className="ripple ripple-effect",this._ref.appendChild(n),n.style.left=e-n.offsetHeight/2+"px",n.style.top=t-n.offsetWidth/2+"px",n.addEventListener("animationend",(function(){var e=n.parentElement;e&&e.removeChild(n)}))}}}]),t}(f.Component)),F=n(1106);n(1165);n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return z})),function(e){e.x025="0.25",e.x050="0.5",e.x075="0.75",e.x100="1",e.x125="1.25",e.x150="1.5",e.x200="2"}(r||(r={}));var z=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e))).state={zoomPointerCenter:{x:0,y:0},videoSize:{width:0,height:0},videoDimm:{width:0,height:0},firstFrame:null,videoPlayable:!1,windowBlured:!1,failedUrls:new Set},n._video=void 0,n._videoWrapper=void 0,n._inputPlayer=void 0,n._annotationsPlayer=void 0,n._expandModePlayer=void 0,n._cursor=void 0,n._lastSync=NaN,n._resizeObserver=void 0,n._mouseDownTimestamp=0,n._playbackRate=r.x100,n._screenshotCanvas=void 0,n._canPlayTimeout=null,n._moveZoomPointerCenter=void 0,n._resetZoomPointerMovementHistory=void 0,n._keyboardActionHandlers={"video.toggleMute":n._withVideoRef(D),"video.toggleFullscreen":n._withVideoRef(A),"video.volumeUp":n._withVideoRef(P(.1)),"video.volumeDown":n._withVideoRef(P(-.1)),"video.forward":n._withVideoRef(S(15)),"video.backward":n._withVideoRef(S(-15))},n.onVideoRef=function(e){n._video=e,e&&(e.playbackRate=parseFloat(n._playbackRate),e.oncanplay=function(){n._obtainDimmensions(e),n._createFirstFrame(e),n._canPlayTimeout=setTimeout((function(){n.setState({videoPlayable:!0},(function(){return n.props.onCanPlay(!0)}))}),500),e.oncanplay=null},e.onplaying=function(){n.setState({firstFrame:null}),e.onplaying=null})},n.onLoadedData=function(){n._video&&n._video.readyState>=1&&n.props.onReadyMetadata()},n._onSourceError=function(e){var t=e.target.src;n.setState({videoPlayable:!1,failedUrls:new Set([].concat(Object(o.a)(n.state.failedUrls),[t]))})},n._onClick=function(){Date.now()-n._mouseDownTimestamp<=500&&n.props.onClick()},n._onWrapperRef=function(e){e&&(n._videoWrapper=e,n._resizeObserver&&n._resizeObserver.disconnect(),n._resizeObserver=new b.a((function(){if(n._video){var e={width:n._video.clientWidth,height:n._video.clientHeight};n.setState({videoSize:e})}})),n._resizeObserver.observe(n._videoWrapper))},n._onMediaPlay=function(){if(n._inputPlayer){n.props.captionPlayer&&n.props.captionPlayer.reset(),n._annotationsPlayer&&n._annotationsPlayer.play(n.currentTimeInMs),n._expandModePlayer&&n._expandModePlayer.play(n.currentTimeInMs);var e=n._inputPlayer.play(n.currentTimeInMs);n._playMouseEvent(e.mouse)}},n._onSeeked=function(){if(n._video&&n._inputPlayer){n._resetZoomPointerMovementHistory();var e=n._inputPlayer.getKeyframeAt(n.currentTimeInMs);n._playMouseEvent(e.mouse)}},n._onMediaPause=function(){n._inputPlayer&&(n._inputPlayer.pause(),n._annotationsPlayer&&n._annotationsPlayer.pause(),n._expandModePlayer&&n._expandModePlayer.pause())},n._frameHandler=function(e){e.type===_.a.Mouse?n._playMouseEvent(e):n._playKeyboardEvent(e)},n._onLoadedMetadata=function(e){var t=e.target;t.duration===1/0&&(t.currentTime=1e101,t.ontimeupdate=function(){t.currentTime=.1,t.ontimeupdate=null})},n._syncInput=function(){if(n._video&&n._inputPlayer){var e=Date.now();!n._video.paused&&(isNaN(n._lastSync)||e-n._lastSync>500)&&(n._lastSync=e,n._inputPlayer.sync(n.currentTimeInMs))}},n._onWindowFocus=function(){n.setState({windowBlured:!1},(function(){n.play(),n.props.onCanPlay(!0)})),window.removeEventListener("focus",n._onWindowFocus)},n._onWindowBlur=function(){n.playing&&(n.pause(),n.setState({windowBlured:!0},(function(){return n.props.onCanPlay(!1)})),window.addEventListener("focus",n._onWindowFocus))},n._tryInitInputPlayer(e),n._tryInitAnnotationsPlayer(e),n._tryInitExpandModePlayer(e),n._screenshotCanvas=document.createElement("canvas");var s=Object(M.b)(Object(l.a)(n));return n._moveZoomPointerCenter=s.moveCenter,n._resetZoomPointerMovementHistory=s.resetHistory,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("blur",this._onWindowBlur)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.input,r=t.expandModeData;n&&n!==e.input&&this._tryInitInputPlayer(this.props),!n&&this._inputPlayer&&(this._inputPlayer.pause(),this._inputPlayer=void 0),r&&r!==e.expandModeData&&this._tryInitExpandModePlayer(this.props),!r&&this._expandModePlayer&&(this._expandModePlayer.pause(),this._expandModePlayer=void 0),this._handleNewUrlProps(e),this._tryInitAnnotationsPlayer(this.props)}},{key:"componentWillUnmount",value:function(){this._inputPlayer&&this._inputPlayer.pause(),this._annotationsPlayer&&this._annotationsPlayer.destroy(),this._expandModePlayer&&this._expandModePlayer.destroy(),this._canPlayTimeout&&clearTimeout(this._canPlayTimeout),window.removeEventListener("blur",this._onWindowBlur),window.removeEventListener("focus",this._onWindowFocus)}},{key:"play",value:function(){return this._inputPlayer&&this._video&&this.canPlay?(this.props.captionPlayer&&this.props.captionPlayer.reset(),this._video.play()):Promise.reject()}},{key:"pause",value:function(){this._inputPlayer&&this._video&&this.canPlay&&(window.removeEventListener("focus",this._onWindowFocus),this._video.pause())}},{key:"changePlaybackRate",value:function(e){if(this._video&&this._inputPlayer){this._playbackRate=e;var t=parseFloat(this._playbackRate);this._video.playbackRate=t,this._inputPlayer.setPlaybackRate(t),this._annotationsPlayer&&this._annotationsPlayer.setPlaybackRate(t,this.currentTimeInMs),this._expandModePlayer&&this._expandModePlayer.setPlaybackRate(t,this.currentTimeInMs)}}},{key:"toggleViewbox",value:function(){if(this.props.onViewboxToggle)return this.props.onViewboxToggle(!this.props.showViewbox),!this.props.showViewbox}},{key:"setCurrentTime",value:function(e){this._video&&(this.props.captionPlayer&&this.props.captionPlayer.reset(),e&&!isNaN(e)||(e=0),this._video.currentTime=e)}},{key:"learnerChangedSidebarMode",value:function(){this._expandModePlayer&&this._expandModePlayer.learnerChangedSidebarMode(this.currentTimeInMs)}},{key:"takeScreenshot",value:function(){if(!this._video)return null;var e=this._video,t=e.videoWidth,n=e.videoHeight;this._screenshotCanvas.width=t,this._screenshotCanvas.height=n,this._screenshotCanvas.getContext("2d").drawImage(this._video,0,0,t,n);var r=this._screenshotCanvas.toDataURL("image/png");return new Blob([g.a.toArrayBuffer(r)],{type:"image/png"})}},{key:"render",value:function(){var e=this,t=h()("vm-player",this.props.className);return this.props.src?f.createElement("div",{className:t},f.createElement(x.Hotkeys,{handlers:this._keyboardActionHandlers}),f.createElement("div",{className:"video-wrapper",ref:this._onWrapperRef},this.state.firstFrame&&f.createElement("img",{className:"first-frame",src:this.state.firstFrame}),f.createElement("video",{key:"".concat(this.props.mp4).concat(this.props.webm).concat(this.props.src),autoPlay:this.props.autoPlay,onTimeUpdate:this._syncInput,onSeeked:this._onSeeked,ref:this.onVideoRef,onLoadedMetadata:this._onLoadedMetadata,onLoadedData:this.onLoadedData,controls:Boolean(this.props.src||this.props.mp4||this.props.webm)&&this.props.controls,onPlaying:this._onMediaPlay,onPause:this._onMediaPause,onMouseDown:function(){return e._mouseDownTimestamp=Date.now()},onMouseUp:this._onClick,crossOrigin:"anonymous",onError:this._onSourceError},this.props.mp4&&f.createElement("source",{type:"video/mp4",src:this.props.mp4}),this.props.webm&&f.createElement("source",{type:"video/webm",src:this.props.webm}),this.props.src&&f.createElement("source",{type:"video/mp4",src:U(this.props.src)}),this.props.src&&f.createElement("source",{type:"video/webm",src:this.props.src}),(this.props.subtitles||Object(d.Map)()).filter(O.d).map((function(t,n,r){return f.createElement(F.a,{key:t.url,url:t.url,srcLang:Object(O.e)(t.language),default:t.language===e.props.subtitleLang||1===r.size,onCueChange:e.props.onCueChange})})).toList()),this.props.mouse?f.createElement(I,{ref:function(t){return e._cursor=t},scale:this.scale}):null,this.renderViewbox(),this.props.errorContainer?v.createPortal(this.renderSourceSplash(),this.props.errorContainer):this.renderSourceSplash())):f.createElement("div",{className:t},f.createElement("div",{className:"video-placeholder"}))}},{key:"renderViewbox",value:function(){var e=this.props,t=e.showViewbox,n=e.viewboxSize,r=this.state,o=r.videoSize,i=r.videoDimm,s=r.zoomPointerCenter;if(!t||!n)return null;var a=o.width/i.width,c=s.x,l=s.y;return f.createElement("div",{className:"zoom-wrapper"},f.createElement(V.a,{isExpanded:this.props.isViewExpanded||!1,width:n.width*a,height:n.height*a,maxWidth:o.width,maxHeight:o.height,x:c*a,y:l*a}))}},{key:"renderSourceSplash",value:function(){var e=this.state,t=e.videoPlayable,n=e.windowBlured,r=e.failedUrls;if(t||n)return null;var o=[this.props.webm,this.props.mp4,this.props.src,this.props.src].reduce((function(e,t){return e+(t?1:0)}),0),i=r.size>0&&r.size>=o;return f.createElement("div",{className:"source-splash"},i?f.createElement(f.Fragment,null,f.createElement("p",null,"We are sorry, but we were not able to load the video. :("),f.createElement("p",null,"Please, try again later.")):f.createElement(N.a,null))}},{key:"_tryInitInputPlayer",value:function(e){this._inputPlayer&&this._inputPlayer.pause(),e.input&&(this._inputPlayer=new _.f(e.input),this._inputPlayer.onFrame(this._frameHandler),this._inputPlayer.setPlaybackRate(parseFloat(this._playbackRate)))}},{key:"_tryInitAnnotationsPlayer",value:function(e){!this._annotationsPlayer&&e.annotations&&e.annotations.size&&(this._annotationsPlayer=Object(_.k)(this),this._annotationsPlayer.setPlaybackRate(parseFloat(this._playbackRate),this.currentTimeInMs))}},{key:"_tryInitExpandModePlayer",value:function(e){this._expandModePlayer&&this._expandModePlayer.destroy(),e.expandModeData&&(this._expandModePlayer=new _.b(e.expandModeData),this._expandModePlayer.setPlaybackRate(parseFloat(this._playbackRate),this.currentTimeInMs),this.props.onExpandModeChange&&this._expandModePlayer.onExpandModeChange(this.props.onExpandModeChange))}},{key:"_playMouseEvent",value:function(e){this._cursor&&this._cursor.onMouseEvent(e),this._moveZoomPointerCenter(e),this.props.onMouseFrame&&this.props.onMouseFrame(e)}},{key:"_playKeyboardEvent",value:function(e){this.props.captionPlayer&&this.props.captionPlayer.onKey(e),this.props.onKeyboardFrame&&this.props.onKeyboardFrame(e)}},{key:"_obtainDimmensions",value:function(e){this.setState({videoDimm:{width:e.videoWidth,height:e.videoHeight}}),this.props.onVideoDimmensions&&this.props.onVideoDimmensions(e.videoWidth,e.videoHeight)}},{key:"_createFirstFrame",value:function(e){var t=e.videoWidth,n=e.videoHeight,r=document.createElement("canvas");r.width=t,r.height=n;var o=r.getContext("2d");o&&(o.filter="blur(5px) opacity(40%)",o.drawImage(e,0,0,t,n),this.setState({firstFrame:r.toDataURL()}))}},{key:"_withVideoRef",value:function(e){var t=this;return function(){return t._video?e(t._video):void 0}}},{key:"_handleNewUrlProps",value:function(e){var t=this.props,n=t.webm,r=t.mp4,i=t.src,s=[n!==e.webm&&e.webm,r!==e.mp4&&e.mp4].concat(Object(o.a)(i!==e.src&&e.src?[U(e.src),e.src]:[])).filter(Boolean);if(0!==s.length){var a=this.state.failedUrls.size>0?s.reduce((function(e,t){return e.delete(t),e}),new Set(this.state.failedUrls)):this.state.failedUrls;this.setState({videoPlayable:!1,failedUrls:a}),this.props.onCanPlay(!1)}}},{key:"playing",get:function(){return!!this._video&&!this._video.paused}},{key:"playbackRate",get:function(){return this._playbackRate}},{key:"canPlay",get:function(){return this.state.videoPlayable&&!this.state.windowBlured}},{key:"zoomPointerDimensions",get:function(){return this.props.viewboxSize||{height:0,width:0}}},{key:"currentTime",get:function(){return this._video?this._video.currentTime:0}},{key:"currentTimeInMs",get:function(){return Math.round(1e3*this.currentTime)}},{key:"duration",get:function(){return this._video?this._video.duration:0}},{key:"scale",get:function(){if(!this._video)return 1;var e=this._video.getBoundingClientRect(),t=e.width,n=e.height,r=this.state.videoDimm.width/this.state.videoDimm.height;return Math.min(t,n*r)/this.state.videoDimm.width}}]),t}(f.Component);z.defaultProps={subtitleLang:k.Y.enUS,onCanPlay:y.a,onReadyMetadata:y.a,onClick:y.a}},1066:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return h}));var r=n(5),o=n(11),i=Math.pow(2,8)-1,s=Math.pow(2,16)-1,a=Math.pow(2,32)-1,c=0,l=1,p=new Uint8Array([0]),u=new Uint8Array([l]),h=function(){function e(){Object(r.a)(this,e),this.version=new Uint8Array([c]),this.packetSize=10}return Object(o.a)(e,[{key:"encodeMouseEvent",value:function(e,t,n,r){if(e>a)throw new Error("Cannot encode time stamps bigger than 32bit");if(n>s)throw new Error("Cannot encode x coordinate bigger than 16bit");if(r>s)throw new Error("Cannot encode y coordinate bigger than 16bit");if(t>i)throw new Error("Cannot encode mouse mask bigger than 8bit");var o=new Uint32Array([e]),c=new Uint8Array([t]),l=new Uint16Array([n]),u=new Uint16Array([r]);return new Blob([p,o,c,l,u])}},{key:"encodeKeyboardEvent",value:function(e,t,n){if(e>a)throw new Error("Cannot encode time stamps bigger than 32bit");if(0!==t&&1!==t)throw new Error("Cannot encode down flag in more than 8bits");if(n>a)throw new Error("Cannot key code in more than 32bits");var r=new Uint32Array([e]),o=new Uint8Array([t]),i=new Uint32Array([n]);return new Blob([u,r,o,i])}},{key:"decodeBuffer",value:function(e){for(var t=[],n=0;n+10<=e.byteLength;n+=10)t.push(this.decodePacket(new DataView(e,n,10)));if(n!==e.byteLength)throw new Error("Invalid package size. It is not dividable by 10.");return t}},{key:"decodePacket",value:function(e){if(10===e.byteLength)return e.getInt8(0).toString()===p.toString()?this.decodeMousePacket(e):this.decodeKeyboardPacket(e);throw new Error("Cannot decode packet with size "+e.byteLength)}},{key:"decodeMousePacket",value:function(e){return[0,e.getUint32(1,!0),e.getUint8(5),e.getUint16(6,!0),e.getUint16(8,!0)]}},{key:"decodeKeyboardPacket",value:function(e){return[l,e.getUint32(1,!0),e.getUint8(5),e.getUint32(6,!0)]}},{key:"getPacketTimestamp",value:function(e,t){return e.getUint32(t+1,!0)}},{key:"setPacketTimestamp",value:function(e,t,n){e.setUint32(t+1,n,!0)}}]),e}()},1067:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),o=n(11),i=n(1059),s=n(1054),a={x:0,y:0,left:!1,middle:!1,right:!1,up:!1,down:!1,timestamp:0,type:i.a.Mouse},c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(r.a)(this,e),this._events=t,this._start=n}return Object(o.a)(e,[{key:"next",value:function(){return this._start<this._events.length?{done:!1,value:Object(i.b)(this._events[this._start++])}:{done:!0,value:null}}}]),e}(),l=function(){function e(t){Object(r.a)(this,e),this._codec=void 0,this._events=void 0,this._codec=Object(s.a)(t),this._events=this._codec.decodeBuffer(t.slice(1))}return Object(o.a)(e,[{key:"getKeyframeAt",value:function(e){for(var t=p(this._events,e),n=a,r=t-1;r>=0;r-=1){var o=Object(i.b)(this._events[r]);if(o.type===i.a.Mouse){n=o;break}}return{mouse:n,keysDown:[]}}},{key:"getIteratorAt",value:function(e){var t=p(this._events,e);return-1===t&&(t=this._events.length),new c(this._events,t)}}]),e}(),p=function(e,t){if(1===e.length)return 0;for(var n=0,r=e.length;n<r;){var o=Math.floor(n+(r-n)/2);if(e[o][1]>=t&&(!e[o-1]||e[o-1][1]<t))return o;e[o][1]<t?n=o+1:r=o}return-1}},1068:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,o=n(5),i=n(11),s=n(30),a=n(28),c=n(29),l=n(90),p=n(4),u=(n(1153),n(91)),h=n.n(u),d=(r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._docEvent=void 0,n._clickFlag=void 0,n.state={visible:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"onClick",value:function(){this._clickFlag=!0,this.setState({visible:!this.state.visible})}},{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docEvent=function(){e._clickFlag?e._clickFlag=!1:e.setState({visible:!1})})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docEvent)}},{key:"render",value:function(){return p.createElement("div",{onClick:this.onClick,className:"hint "+(this.state.visible?"visible ":"")+(this.props.className||"")},p.createElement("div",{className:"question"},"?"),p.createElement("p",{className:"text"+(this.props.position?" "+this.props.position:" top")},this.props.children))}}]),t}(p.Component),Object(l.a)(r.prototype,"onClick",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onClick"),r.prototype),r)},1069:function(e,t,n){"use strict";var r;!function(e){e[e.Collapse=0]="Collapse",e[e.Expand=1]="Expand"}(r||(r={}));var o,i=n(19),s=n.n(i),a=n(44),c=n(5),l=n(11),p=n(1058),u=n(1099),h=n(1080),d=function(){function e(){Object(c.a)(this,e),this._encoder=new h.a}return Object(l.a)(e,[{key:"trim",value:function(e,t){var n=Object(p.e)(e.expandTrackBuffer,u.createExpandModeCodec,t);return Promise.resolve(n)}},{key:"merge",value:function(e){var t=Object(p.c)(e,(function(e){return e.expandTrackBuffer}),this._encoder);return Promise.resolve(t)}}]),e}(),m=n(1081),y=n(1066),f=function(){function e(){Object(c.a)(this,e),this._encoder=new y.a}return Object(l.a)(e,[{key:"trim",value:function(e,t){var n=Object(p.e)(e.inputTrackBuffer,m.createInputCodec,t);return Promise.resolve(n)}},{key:"merge",value:function(e){var t=Object(p.c)(e,(function(e){return e.inputTrackBuffer}),this._encoder);return Promise.resolve(t)}}]),e}(),v=n(295),b=function(){function e(){Object(c.a)(this,e),this._expandEditor=new d,this._inputEditor=new f}return Object(l.a)(e,[{key:"trim",value:function(){var e=Object(a.a)(s.a.mark((function e(t,n){var r,o,i,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.d)(t,n);case 2:return r=e.sent,e.next=5,this._expandEditor.trim(t,n);case 5:return o=e.sent,e.next=8,this._inputEditor.trim(t,n);case 8:return i=e.sent,a=URL.createObjectURL(r),e.abrupt("return",{id:Object(p.d)(),videoTrack:r,inputTrackBuffer:i,expandTrackBuffer:o,dataSize:r.size+i.byteLength+o.byteLength,mediaUrl:a,duration:n});case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"merge",value:function(){var e=Object(a.a)(s.a.mark((function e(t){var n,r,o,i,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.c)(t);case 2:return n=e.sent,e.next=5,this._expandEditor.merge(t);case 5:return r=e.sent,e.next=8,this._inputEditor.merge(t);case 8:return o=e.sent,i=t.reduce((function(e,t){return e+t.duration}),0),a=URL.createObjectURL(n),e.abrupt("return",{id:Object(p.d)(),videoTrack:n,inputTrackBuffer:o,expandTrackBuffer:r,dataSize:n.size+o.byteLength+r.byteLength,mediaUrl:a,duration:i});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),g=n(47),_=n(30),k=n(28),O=n(29),w=n(1468),C=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(_.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o)))).notificationText="Recording too short",n}return Object(O.a)(t,e),t}(Object(w.a)(Error)),E=function(){function e(t,n,r){Object(c.a)(this,e),this._mediaRecorder=t,this._inputRecorder=n,this._expandModeRecorder=r,this._state="stopped",this._startTime=void 0,this._duration=0,this._recorders=void 0,this._recorders=[this._mediaRecorder,this._inputRecorder,this._expandModeRecorder]}return Object(l.a)(e,[{key:"start",value:function(){"stopped"===this._state&&(this._startTime=Date.now(),this._duration=0,this._state="recording",this._recorders.forEach((function(e){return e.start()})))}},{key:"stop",value:function(){var e=Object(a.a)(s.a.mark((function e(){var t,n=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("recording"===this._state){e.next=2;break}return e.abrupt("return",Promise.reject("Cannot stop ScreenRecorder. Current state is ".concat(this._state)));case 2:return this._state="processing",t=Date.now()-this._startTime,this._duration=t,e.abrupt("return",Promise.all(this._recorders.map((function(e){return e.stop()}))).then(function(){var e=Object(a.a)(s.a.mark((function e(r){var o,i,a,c,l,u,h,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object(g.a)(r,3),i=o[0],a=o[1],c=o[2],n._state="stopped",!(t<1e3)){e.next=4;break}throw new C;case 4:return e.next=6,Object(v.a)(i);case 6:return i=e.sent,l=URL.createObjectURL(i),e.next=10,Object(m.toArrayBuffer)(a);case 10:return u=e.sent,e.next=13,Object(m.toArrayBuffer)(c);case 13:return h=e.sent,e.next=16,Object(p.a)(l);case 16:return d=e.sent,e.abrupt("return",{id:Object(p.d)(),videoTrack:i,inputTrack:a,inputTrackBuffer:u,expandTrack:c,expandTrackBuffer:h,dataSize:i.size+a.size+c.size,mediaUrl:l,duration:d});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateStream",value:function(e){this._recorders.forEach((function(t){return t.updateStream(e)}))}},{key:"size",get:function(){return this._recorders.reduce((function(e,t){return e+t.size}),0)}},{key:"duration",get:function(){return"recording"===this._state?Date.now()-this._startTime:this._duration}},{key:"isRecording",get:function(){return"recording"===this._state}}]),e}(),j=n(84),S=n(90),P=n(91),T=n.n(P);var R,A,D=(o=function(){function e(t,n,r){Object(c.a)(this,e),this._client=t,this._audioStream=n,this._resolution=r,this._state="stopped",this._config=function(){var e,t=[{mediaType:"video/webm;codecs=vp9,opus",audioBitRate:128e3,videoBitRate:2516582,frameRate:30,timeSlice:1e3},{mediaType:"video/webm;codecs=vp8,opus",audioBitRate:128e3,videoBitRate:2516582,frameRate:24,timeSlice:1e3}];return function(){if(e)return e;if(!(e=t.find((function(e){return MediaRecorder.isTypeSupported(e.mediaType)}))))throw new Error("No supported media codec found");return e}()}(),this._videoElement=document.createElement("video"),this._recorder=void 0,this._videoStreamCanvasContext=void 0,this._blobBuffer=[],this._pollingTimeout=void 0,this._pollingDuration=void 0,this._isUsingUpdatedVideoStream=!1,this._stopResolve=void 0,this._stopReject=void 0}return Object(l.a)(e,[{key:"start",value:function(){if("stopped"===this._state){this._pollingDuration=1e3/(this._config.frameRate||30);var e=this._createVideoStreamCanvas(),t=new MediaStream([].concat(Object(j.a)(e.getTracks()),Object(j.a)(this._audioStream.getAudioTracks())));this._recorder=new MediaRecorder(t,{mimeType:this._config.mediaType,audioBitsPerSecond:this._config.audioBitRate,videoBitsPerSecond:this._config.videoBitRate}),this._recorder.ondataavailable=this._onRecorderDataAvailable,this._recorder.onstop=this._onRecorderStopped,this._recorder.onerror=this._onRecorderError,this._recorder.start(this._config.timeSlice),this._poll(),this._state="recording",console.log("Recording started. MediaType: ".concat(this._config.mediaType," FrameRate: ").concat(this._config.frameRate," Resolution: ").concat(this._resolution.width,"/").concat(this._resolution.height))}}},{key:"stop",value:function(){var e=this;return this._stopPolling(),this._recorder.stop(),this._state="processing",new Promise((function(t,n){e._stopResolve=function(){e._state="stopped",t(new Blob(e._blobBuffer,{type:"video/webm"})),e._cleanUp()},e._stopReject=n}))}},{key:"updateStream",value:function(e){this._isUsingUpdatedVideoStream=!!e,e&&(this._videoElement.autoplay=!0,this._videoElement.srcObject=e,this._videoElement.height=this._resolution.height,this._videoElement.width=this._resolution.width)}},{key:"_onRecorderDataAvailable",value:function(e){this._blobBuffer.push(e.data)}},{key:"_onRecorderStopped",value:function(e){this._stopResolve&&this._stopResolve()}},{key:"_onRecorderError",value:function(e){console.error("MediaRecorder error",e),this._state="error",this._stopReject&&this._stopReject(e),this._cleanUp()}},{key:"_poll",value:function(){this._refreshCanvas(),this._pollingTimeout=setTimeout(this._poll,this._pollingDuration)}},{key:"_cleanUp",value:function(){this._stopPolling(),this._blobBuffer=[],this._stopResolve=void 0,this._stopReject=void 0}},{key:"_stopPolling",value:function(){this._pollingTimeout&&(clearTimeout(this._pollingTimeout),this._pollingTimeout=void 0)}},{key:"_createVideoStreamCanvas",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),n=e.captureStream(this._config.frameRate),r=this._resolution,o=r.width,i=r.height;if(e.width=o,e.height=i,!t)throw new Error("Cannot initialize the context");return this._videoStreamCanvasContext=t,n}},{key:"_refreshCanvas",value:function(){this._isUsingUpdatedVideoStream?this._drawVideoStream():this._drawVM()}},{key:"_drawVM",value:function(){var e=this._client.getDisplay(),t=this._client.getDisplayCanvas();if(t&&t.width&&t.height&&e){var n=this._resolution;this._videoStreamCanvasContext.drawImage(t,0,0,e?e.getWidth():0,e?e.getHeight():0,0,0,n.width,n.height);var r=this._client.getMouse();if(r){var o=this._client.getCursorCanvas();if(o){var i=r.currentState,s=t.width/n.width;this._videoStreamCanvasContext.drawImage(o,0,0,o.width,o.height,(i.x-e.cursorHotspotX)/s/this._client.scaleX||1,(i.y-e.cursorHotspotY)/s/this._client.scaleY||1,o.width/s,o.height/s)}}}}},{key:"_drawVideoStream",value:function(){this._videoStreamCanvasContext.drawImage(this._videoElement,0,0,this._videoElement.width,this._videoElement.height)}},{key:"size",get:function(){return this._blobBuffer.reduce((function(e,t){return e+t.size}),0)}}]),e}(),Object(S.a)(o.prototype,"_onRecorderDataAvailable",[T.a],Object.getOwnPropertyDescriptor(o.prototype,"_onRecorderDataAvailable"),o.prototype),Object(S.a)(o.prototype,"_onRecorderStopped",[T.a],Object.getOwnPropertyDescriptor(o.prototype,"_onRecorderStopped"),o.prototype),Object(S.a)(o.prototype,"_onRecorderError",[T.a],Object.getOwnPropertyDescriptor(o.prototype,"_onRecorderError"),o.prototype),Object(S.a)(o.prototype,"_poll",[T.a],Object.getOwnPropertyDescriptor(o.prototype,"_poll"),o.prototype),o),M=n(293),x=n(1059),N=n(1054),V=(R=function(){function e(t,n){Object(c.a)(this,e),this._client=void 0,this._onKeyboardEventCallback=void 0,this._codec=new y.a,this._startedAt=0,this._disableClicks=void 0,this._blobs=[],this._lastMouseMoveUpdate=void 0,this._recordKeyUp=this._recordKey(!1),this._recordKeyDown=this._recordKey(!0),this._client=t,this._onKeyboardEventCallback=n}return Object(l.a)(e,[{key:"_isRecording",get:function(){return 0!==this._startedAt}},{key:"size",get:function(){return this._blobs.reduce((function(e,t){return e+t.size}),0)}}]),Object(l.a)(e,[{key:"start",value:function(){this._isRecording||(this._startedAt=Date.now(),this._blobs=[new Blob([this._codec.version])],this._recordInitialMousePosition(),this._client.on(M.h,this._recordMouseUp),this._client.on(M.f,this._recordMouseDown),this._client.on(M.g,this._recordMouseMove),this._client.on(M.d,this._recordKeyDown),this._client.on(M.e,this._recordKeyUp))}},{key:"stop",value:function(){if(!this._isRecording)return Promise.reject(new Error("Cannot stop when not recording"));this._client.off(M.h,this._recordMouseUp),this._client.off(M.f,this._recordMouseDown),this._client.off(M.g,this._recordMouseMove),this._client.off(M.d,this._recordKeyDown),this._client.off(M.e,this._recordKeyUp);var e=new Blob(this._blobs);return this._startedAt=0,Promise.resolve(e)}},{key:"updateStream",value:function(e){this._disableClicks=!!e}},{key:"_recordMouseUp",value:function(e){this._isRecording&&!this._disableClicks&&this._encodeMouseEvent(Object(N.d)(e),e.x/this._client.scaleX,e.y/this._client.scaleY)}},{key:"_recordMouseDown",value:function(e){this._isRecording&&!this._disableClicks&&this._encodeMouseEvent(Object(N.d)(e),e.x/this._client.scaleX,e.y/this._client.scaleY)}},{key:"_recordMouseMove",value:function(e){this._isRecording&&(!this._lastMouseMoveUpdate||Math.abs(this._lastMouseMoveUpdate.x-e.x)>=5||Math.abs(this._lastMouseMoveUpdate.y-e.y)>=5)&&(this._disableClicks&&(e.left=!1,e.right=!1,e.middle=!1),this._lastMouseMoveUpdate={x:e.x,y:e.y},this._encodeMouseEvent(Object(N.d)(e),e.x/this._client.scaleX,e.y/this._client.scaleY))}},{key:"_recordInitialMousePosition",value:function(){var e=this._client.getMouse();e&&this._recordMouseMove(e.currentState)}},{key:"_recordKey",value:function(e){var t=this;return function(n){if(t._isRecording){var r=t._encodeKeyboardEvent(e?1:0,n).timestamp;t._onKeyboardEventCallback({type:x.a.Keyboard,timestamp:r,keyCode:n,down:e})}}}},{key:"_encodeKeyboardEvent",value:function(e,t){var n=Date.now()-this._startedAt;return this._blobs.push(this._codec.encodeKeyboardEvent(n,e,t)),{timestamp:n,down:e,keyCode:t}}},{key:"_encodeMouseEvent",value:function(e,t,n){var r=Date.now()-this._startedAt;this._blobs.push(this._codec.encodeMouseEvent(r,e,t,n))}}]),e}(),Object(S.a)(R.prototype,"_recordMouseUp",[T.a],Object.getOwnPropertyDescriptor(R.prototype,"_recordMouseUp"),R.prototype),Object(S.a)(R.prototype,"_recordMouseDown",[T.a],Object.getOwnPropertyDescriptor(R.prototype,"_recordMouseDown"),R.prototype),Object(S.a)(R.prototype,"_recordMouseMove",[T.a],Object.getOwnPropertyDescriptor(R.prototype,"_recordMouseMove"),R.prototype),R),L=(A=function(){function e(t){Object(c.a)(this,e),this._source=t,this._codec=new h.a,this._blobs=[],this._startedAt=0}return Object(l.a)(e,[{key:"_isRecording",get:function(){return 0!==this._startedAt}}]),Object(l.a)(e,[{key:"start",value:function(){this._isRecording||(this._blobs=[new Blob([this._codec.version])],this._startedAt=Date.now(),this._recordInitialMode(this._source.currentMode),this._source.onCollapse(this._collapse),this._source.onExpand(this._expand))}},{key:"stop",value:function(){if(!this._isRecording)return Promise.reject(new Error("Cannot stop when not recording"));var e=new Blob(this._blobs);return this._source.offCollapse(this._collapse),this._source.offExpand(this._expand),this._startedAt=0,Promise.resolve(e)}},{key:"updateStream",value:function(e){}},{key:"_collapse",value:function(){this._recordExpandModeEvent(r.Collapse)}},{key:"_expand",value:function(){this._recordExpandModeEvent(r.Expand)}},{key:"_recordExpandModeEvent",value:function(e){this._isRecording&&this._blobs.push(this._codec.encodeExpandModeEvent(Date.now()-this._startedAt,e))}},{key:"_recordInitialMode",value:function(e){this._blobs.push(this._codec.encodeExpandModeEvent(0,e))}},{key:"size",get:function(){return this._blobs.reduce((function(e,t){return e+t.size}),0)}}]),e}(),Object(S.a)(A.prototype,"_collapse",[T.a],Object.getOwnPropertyDescriptor(A.prototype,"_collapse"),A.prototype),Object(S.a)(A.prototype,"_expand",[T.a],Object.getOwnPropertyDescriptor(A.prototype,"_expand"),A.prototype),Object(S.a)(A.prototype,"_recordExpandModeEvent",[T.a],Object.getOwnPropertyDescriptor(A.prototype,"_recordExpandModeEvent"),A.prototype),A),U=n(8),I=n(2),F=n(0),z=Object(U.List)([]),B=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(_.a)(this,Object(k.a)(t).call(this,e)))._timeout=void 0,n._playbackRate=1,n._isPlaying=!1,n}return Object(O.a)(t,e),Object(l.a)(t,[{key:"play",value:function(e){this._isPlaying=!0,this._instance.props.dispatch(new I.P("annotations-notification-contex"));var t=this._annotations.filter((function(t){return t.time>=e}));this._nextAnnotation(e,t)}},{key:"pause",value:function(){this._isPlaying=!1,this._timeout&&clearTimeout(this._timeout)}},{key:"destroy",value:function(){this.pause(),this._instance.props.dispatch(new I.P("annotations-notification-contex"))}},{key:"setPlaybackRate",value:function(e,t){this._playbackRate=e,this._isPlaying&&(this.pause(),this.play(t))}},{key:"_nextAnnotation",value:function(e,t){var n=this;if(this._timeout&&clearTimeout(this._timeout),t.size){var r=t.first(),o=(r.time-e)/this._playbackRate;this._timeout=setTimeout((function(){n._instance.props.dispatch(new I.i(new F.J({type:F.K.Annotation,title:"Annotation",text:r.content,context:"annotations-notification-contex",ttl:r.duration}))),n._nextAnnotation(r.time,t.delete(0))}),o)}}}]),t}(function(){function e(t){Object(c.a)(this,e),this._instance=t}return Object(l.a)(e,[{key:"_annotations",get:function(){return this._instance.props.annotations||z}}]),e}()),W=function(e){return new B(e)},H=n(50),G=(n(1067),Symbol("OnFrame")),K=Symbol("Finish"),Y=function(){function e(t){Object(c.a)(this,e),this._emitter=new H.EventEmitter,this._currentTime=0,this._startedFrom=0,this._playing=!1,this._view=void 0,this._iterator=void 0,this._lastMouseEvent=void 0,this._skipNextFrame=!1,this._startTime=0,this._currentTimeout=void 0,this._playbackRate=1,this._view=new m.InputPlayerView(t)}return Object(l.a)(e,[{key:"play",value:function(e){return clearTimeout(this._currentTimeout),this._startTime=Date.now(),this._startedFrom=e/this._playbackRate,this._currentTime=e/this._playbackRate,this._skipNextFrame=!1,this._iterator=this._view.getIteratorAt(e),this._playing=!0,this._nextFrame(),this._view.getKeyframeAt(e)}},{key:"setPlaybackRate",value:function(e){this._playbackRate=e}},{key:"getKeyframeAt",value:function(e){return this._view.getKeyframeAt(e)}},{key:"pause",value:function(){clearTimeout(this._currentTimeout),this._playing=!1}},{key:"resume",value:function(){this._playing||this._nextFrame()}},{key:"onFrame",value:function(e){var t=this;return this._emitter.on(G,e),function(){return t._emitter.off(G,e)}}},{key:"onFinish",value:function(e){var t=this;return this._emitter.on(K,e),function(){return t._emitter.off(K,e)}}},{key:"sync",value:function(e){Math.abs(e-this._currentTime)>150&&(console.log("Syncing the input player"),this.play(e))}},{key:"_nextFrame",value:function(){var e=this,t=this._iterator.next();if(!t.done&&t.value){var n=t.value,r=n.timestamp/this._playbackRate;if(this._skipNextFrame&&this._canSkip(n))return console.log("Skipping frame"),this._currentTime=r,this._nextFrame();var o=Date.now()-this._startTime,i=this._currentTime-this._startedFrom,s=r-this._currentTime,a=o-i,c=Math.max(0,s-a);0===c&&(this._skipNextFrame=!0),this._currentTimeout=setTimeout((function(){e._emitter.emit(G,n),e._currentTime=r,e._nextFrame()}),c)}else this._emitter.emit(K)}},{key:"_canSkip",value:function(e){if(e.type===m.EventType.Keyboard)return!1;var t=this._lastMouseEvent;return!!t&&(t.down===e.down&&t.left===e.left&&t.middle===e.middle&&t.right===e.right&&e.up===e.up)}}]),e}(),q=function(){},Z=function(){function e(t){Object(c.a)(this,e),this._codec=void 0,this._events=void 0,this._playbackRate=1,this._learnerSidebarModeChangeTimestamp=-1,this._isPlaying=!1,this._timeout=void 0,this._expandModeChangeCallback=q,this._codec=Object(u.createExpandModeCodec)(t);var n=this._codec.decodeBuffer(t.slice(1));this._events=this._translate(n)}return Object(l.a)(e,[{key:"onExpandModeChange",value:function(e){this._expandModeChangeCallback=e}},{key:"play",value:function(e){this._isPlaying=!0;var t=this._events.filter((function(t){return t.timestamp<e}));if(t.length){var n=t[t.length-1];n.timestamp>this._learnerSidebarModeChangeTimestamp&&this._expandModeChangeCallback(n.type)}else-1===this._learnerSidebarModeChangeTimestamp&&this._expandModeChangeCallback(r.Collapse);var o=this._events.filter((function(t){return t.timestamp>=e}));this._nextExpandModeChange(e,o)}},{key:"pause",value:function(){this._isPlaying=!1,this._clearTimeout()}},{key:"destroy",value:function(){this._isPlaying=!1,this._clearTimeout()}},{key:"setPlaybackRate",value:function(e,t){this._playbackRate=e,this._isPlaying&&(this.pause(),this.play(t))}},{key:"learnerChangedSidebarMode",value:function(e){this._learnerSidebarModeChangeTimestamp=e}},{key:"_nextExpandModeChange",value:function(e,t){var n=this;if(t.length){var r=t[0],o=(r.timestamp-e)/this._playbackRate;this._clearTimeout(),this._timeout=setTimeout((function(){n._expandModeChangeCallback(r.type),t.shift(),n._nextExpandModeChange(r.timestamp,t)}),o)}}},{key:"_clearTimeout",value:function(){this._timeout&&clearTimeout(this._timeout)}},{key:"_translate",value:function(e){return e.map((function(e){return{timestamp:e[0],type:e[1]}}))}}]),e}(),J=Symbol("Expand"),X=Symbol("Collapse"),Q=function(e){function t(){var e,n;Object(c.a)(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(n=Object(_.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(i))))._currentMode=r.Collapse,n}return Object(O.a)(t,e),Object(l.a)(t,[{key:"onExpand",value:function(e){return this.addListener(J,e)}},{key:"onCollapse",value:function(e){return this.addListener(X,e)}},{key:"offExpand",value:function(e){return this.removeListener(J,e)}},{key:"offCollapse",value:function(e){return this.removeListener(X,e)}},{key:"didExpand",value:function(){this._currentMode=r.Expand,this.emit(J)}},{key:"didCollapse",value:function(){this._currentMode=r.Collapse,this.emit(X)}},{key:"currentMode",get:function(){return this._currentMode}}]),t}(H.EventEmitter);n.d(t,"e",(function(){return r})),n.d(t,"h",(function(){return b})),n.d(t,"j",(function(){return E})),n.d(t,"i",(function(){return D})),n.d(t,"g",(function(){return V})),n.d(t,"c",(function(){return L})),n.d(t,"k",(function(){return W})),n.d(t,"f",(function(){return Y})),n.d(t,"b",(function(){return Z})),n.d(t,"d",(function(){return Q})),n.d(t,"a",(function(){return x.a}))},1070:function(e,t,n){"use strict";var r=n(5),o=n(11),i=n(30),s=n(28),a=n(29),c=n(1472),l=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this)))._handleConfig(e),n}return Object(a.a)(t,e),Object(o.a)(t,[{key:"destroy",value:function(){Object(c.a)(Object(s.a)(t.prototype),"removeAllListeners",this).call(this)}}]),t}(n(50).EventEmitter),p=Symbol("ComboPress"),u=function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a)))).emitted=void 0,n._pressed=new Set,n._keys=[],n}return Object(a.a)(t,e),Object(o.a)(t,[{key:"_handleConfig",value:function(e){this._keys=e}},{key:"keys",get:function(){return this._keys}},{key:"pressed",get:function(){return this._pressed}}]),t}(l),h=new(function(){function e(){Object(r.a)(this,e),this._instances=[],this._init()}return Object(o.a)(e,[{key:"create",value:function(e,t){var n=new u(e);return n.addListener(p,t),this._instances.push(n),n}},{key:"destroy",value:function(e){var t=this._instances.indexOf(e);t>-1&&(e.destroy(),this._instances.splice(t,1))}},{key:"_init",value:function(){var e=this;console.log("Initializing the KeyComboListener"),document.addEventListener("click",(function(){e._instances.forEach((function(e){return e.pressed.clear()}))})),document.addEventListener("keydown",(function(t){e._instances.forEach((function(e){if(e.keys.indexOf(t.keyCode)>-1){if(e.pressed.add(t.keyCode),!e.emitted&&e.pressed.size===e.keys.length){var n=0;e.keys.forEach((function(t){e.pressed.has(t)&&(n+=1)})),n===e.keys.length&&(e.emit(p),e.emitted=!0)}}else e.pressed.clear()}))})),document.addEventListener("keyup",(function(t){e._instances.forEach((function(e){e.keys.indexOf(t.keyCode)>-1&&(e.pressed.delete(t.keyCode),e.emitted=!1)}))}))}}]),e}()),d=function(e){function t(e,n){var o;return Object(r.a)(this,t),(o=Object(i.a)(this,Object(s.a)(t).call(this,e)))._eventSymbol=n,o._delay=void 0,o._timeout=void 0,o}return Object(a.a)(t,e),Object(o.a)(t,[{key:"execute",value:function(){var e=this;this._timeout&&clearTimeout(this._timeout),this._delay>0?this._timeout=setTimeout((function(){return e.emit(e._eventSymbol)}),this._delay):this.emit(this._eventSymbol)}},{key:"_handleConfig",value:function(e){this._delay=100,void 0!==e.delay&&null!==e.delay&&(this._delay=e.delay)}}]),t}(l),m=new(function(){function e(){Object(r.a)(this,e),this._instances=[],this._init()}return Object(o.a)(e,[{key:"create",value:function(e,t){var n=Symbol("WindowResize"),r=new d(e,n);return r.addListener(n,t),this._instances.push(r),r}},{key:"destroy",value:function(e){var t=this._instances.indexOf(e);t>-1&&(e.destroy(),this._instances.splice(t,1))}},{key:"_init",value:function(){var e=this;console.log("Initializing the ResizeListener"),window.addEventListener("resize",(function(){e._instances.forEach((function(e){return e.execute()}))}))}}]),e}());n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return m}))},1074:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return d}));var r=n(51),o=n(84),i=n(5),s=n(11),a=function(e,t,n,r){return{left:e,top:t,right:n,bottom:r}},c=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(e,t){var n=t.x,r=t.y;return a(Math.min(e.left,n),Math.min(e.top,r),Math.max(e.right,n),Math.max(e.bottom,r))}),a(e.x,e.y,e.x,e.y))},l=function(e,t){return a(Math.max(e.left,t.left),Math.max(e.top,t.top),Math.min(e.right,t.right),Math.min(e.bottom,t.bottom))},p=function(e,t){var n=t.x,r=t.y,o=n-e.left,i=n-e.right,s=r-e.top,a=r-e.bottom;return{x:o<0?o:i>0?i:0,y:s<0?s:a>0?a:0}},u=function(){function e(t){Object(i.a)(this,e),this.minRectWidth=100,this.minRectHeight=100,this.keepHistoryFor=5e3,this.positions=[],this.center={x:0,y:0},this.now=Date.now,Object.assign(this,t)}return Object(s.a)(e,[{key:"update",value:function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.center,a=s.x,u=s.y,h=c.apply(void 0,[{x:a-this.minRectWidth/2,y:u-this.minRectHeight/2},{x:a+this.minRectWidth/2,y:u+this.minRectHeight/2}].concat(Object(o.a)(this.positions))),d=i?l(i,h):h,m=p(d,t),y=this.now(),f=this.positions.filter((function(e){return y-e.ts<n.keepHistoryFor})),v=[].concat(Object(o.a)(f),[Object(r.a)({},t,{ts:y})]),b=m.x||m.y?{x:a+m.x,y:u+m.y}:this.center;return new e({positions:v,center:b})}}]),e}();u.empty=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new u(e)};var h=function(e){var t=u.empty();return function(n){var r=n.x,o=n.y,i=e.padding,s=void 0===i?20:i,c={x:e.zoom*r,y:e.zoom*o},l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!t)return null;var r=e.getBoundingClientRect(),o=t.getBoundingClientRect(),i=o.left-r.left,s=o.top-r.top;return a(i+n,s+n,i+o.width-n,s+o.height-n)}(e.vmContainer,e.vmKeyhole,s),p=t.update(c,l);if(p.center!==t.center){var u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.minSmoothDist,o=void 0===r?10:r,i=n.maxIntermediatePoints,s=void 0===i?8:i,a=t.x-e.x,c=t.y-e.y,l=Math.max(Math.abs(a),Math.abs(c)),p=Math.floor(l/o)+1,u=Math.min(s,p),h=Array.from({length:u},(function(e,t){return(t+1)/u})),d=h.map((function(t){return{x:e.x+t*a,y:e.y+t*c}}));return d}(t.center,p.center),h=!0,d=!1,m=void 0;try{for(var y,f=u[Symbol.iterator]();!(h=(y=f.next()).done);h=!0){var v=y.value;e.setState({keyholeCenter:v})}}catch(b){d=!0,m=b}finally{try{h||null==f.return||f.return()}finally{if(d)throw m}}}t=p}},d=function(e){var t=u.empty();return{moveCenter:function(n){var r=e.zoomPointerDimensions,o=r.width,i=r.height,s=e.padding,a=void 0===s?20:s,c=o/2,l=i/2,p=t.center,u={left:p.x-c+a,top:p.y-l+a,right:p.x+c-a,bottom:p.y+l-a},h=t.update(n,u);h.center!==t.center&&e.setState({zoomPointerCenter:h.center}),t=h},resetHistory:function(){return t=u.empty()}}}},1080:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));var r=n(5),o=n(11),i=Math.pow(2,32)-1,s=0,a=function(){function e(){Object(r.a)(this,e),this.version=new Uint8Array([s]),this.packetSize=5}return Object(o.a)(e,[{key:"encodeExpandModeEvent",value:function(e,t){if(e>i)throw new Error("Cannot encode time stamps bigger than 32bit");var n=new Uint32Array([e]),r=new Uint8Array([t]);return new Blob([n,r])}},{key:"decodeBuffer",value:function(e){for(var t=[],n=0;n+5<=e.byteLength;n+=5){var r=new DataView(e,n,5);t.push(this.decodePacket(r))}if(n!==e.byteLength)throw new Error("Invalid package size. It is not dividable by ".concat(5,"."));return t}},{key:"decodePacket",value:function(e){if(5===e.byteLength)return[e.getUint32(0,!0),e.getUint8(4)];throw new Error("Cannot decode packet with size "+e.byteLength)}},{key:"getPacketTimestamp",value:function(e,t){return e.getUint32(t,!0)}},{key:"setPacketTimestamp",value:function(e,t,n){return e.setUint32(t,n,!0)}}]),e}()},1081:function(e,t,n){"use strict";var r=n(1059);n.d(t,"EventType",(function(){return r.a}));var o=n(1103);n.o(o,"InputPlayerView")&&n.d(t,"InputPlayerView",(function(){return o.InputPlayerView}));var i=n(1054);n.d(t,"toArrayBuffer",(function(){return i.c})),n.d(t,"createInputCodec",(function(){return i.a}));var s=n(1067);n.d(t,"InputPlayerView",(function(){return s.a}))},1087:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(0),o=function(e){return"pending"===e.status},i=function(e){return"transcribed"===e.status},s=function(e,t){if(t){var n=e.subtitles.get(t);return n&&i(n)}return e.subtitles.some(i)},a=function(e){return e.split("-")[0]},c=function(e){return e?e.track.language===r.Y.arSA.slice(0,2)?"rtl":"ltr":"ltr"}},1089:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return _}));var r,o=n(47),i=n(5),s=n(11),a=n(30),c=n(28),l=n(29),p=n(90),u=n(4),h=n(165),d=n(91),m=n.n(d),y=n(14),f=n(1070),v=(n(1182),n(1347).default),b=600,g=500,_=(r=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e)))._splitter=void 0,n._leftResolver=void 0,n._rightResolver=void 0,n._leftPromise=new Promise((function(e){return n._leftResolver=e})),n._rightPromise=new Promise((function(e){return n._rightResolver=e})),n._resizeEntry=void 0,n._rightPanelSize=void 0,n.state={resizing:!1},n.props.onPanelsRefs&&Promise.all([n._leftPromise,n._rightPromise]).then((function(e){var t=Object(o.a)(e,2),r=t[0],i=t[1];return n.props.onPanelsRefs(r,i)})),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._configureSplitter(),this._resizeEntry=f.b.create({delay:0},(function(){e._onResize(e._rightPanelSize)}))}},{key:"componentDidUpdate",value:function(){this._configureSplitter()}},{key:"componentWillUnmount",value:function(){f.b.destroy(this._resizeEntry)}},{key:"onResizeStart",value:function(){this.setState({resizing:!0}),this.props.onResizeStart&&this.props.onResizeStart()}},{key:"onResizeEnd",value:function(){this.setState({resizing:!1}),this.props.onResizeEnd&&this.props.onResizeEnd()}},{key:"onResize",value:function(e){this._rightPanelSize=e,this._onResize(this._rightPanelSize)}},{key:"render",value:function(){var e=this,t=this.props.children;return u.createElement(v,{ref:function(t){return e._splitter=t},onDragStart:this.onResizeStart,onSecondaryPaneSizeChange:this.onResize,onDragEnd:this.onResizeEnd,primaryMinSize:b,secondaryInitialSize:this.props.rightPanelInitialSize,customClassName:"split-view "+(this.props.className||"")},t&&t[0]?u.createElement("section",{className:"left-panel",ref:this._leftResolver},this.state.resizing?u.createElement("div",{className:"overlay"}):null,t[0]):null,t&&t[1]?u.createElement("section",{className:"right-panel",ref:this._rightResolver},t[1]):null)}},{key:"_createDotWrapper",value:function(){var e=function(){var e=document.createElement("i");return e.className="fa fa-circle",e},t=document.createElement("div");return t.appendChild(e()),t.appendChild(e()),t.appendChild(e()),t.className="dot-wrapper",t}},{key:"_configureSplitter",value:function(){if(this._splitter){var e=Object(h.findDOMNode)(this._splitter);if(!e||e instanceof Text)return;var t=e.querySelector(".splitter-layout > .layout-splitter");if(t)t.querySelector(".dot-wrapper")||t.appendChild(this._createDotWrapper())}}},{key:"_onResize",value:function(e){if(this.props.onResize){var t=window.innerWidth-e-y.a.SplitterWidth;this.props.onResize(t,e)}}}]),t}(u.Component),Object(p.a)(r.prototype,"onResizeStart",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"onResizeStart"),r.prototype),Object(p.a)(r.prototype,"onResizeEnd",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"onResizeEnd"),r.prototype),Object(p.a)(r.prototype,"onResize",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"onResize"),r.prototype),r)},1092:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),o=n(11),i=n(30),s=n(28),a=n(29),c=n(4),l=(n(1179),function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a))))._wrapperRef=void 0,n}return Object(a.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.forceUpdate()}))}},{key:"getScale",value:function(){var e={scaleX:1,scaleY:1,width:0,height:0};if(this._wrapperRef&&this._wrapperRef.children[0]){var t=this.props.scaledWidth;(void 0===t||isNaN(t))&&(t=this._wrapperRef.parentElement.clientWidth),e.scaleX=t/this.props.originalWidth;var n=t/(this.props.originalWidth/this.props.originalHeight);e.scaleY=n/this.props.originalHeight,e.height=n,e.width=t}return!isNaN(e.width)&&!isNaN(e.height)&&isFinite(e.scaleX)&&isFinite(e.scaleY)?e:{scaleX:1,scaleY:1,width:0,height:0}}},{key:"render",value:function(){var e=this,t=this.props.children,n=this.getScale(),r=n.scaleX,o=n.scaleY,i=n.width,s=n.height;if(t.length&&t.length>=2)throw new Error("Only one scalable child allowed");var a={WebkitTransform:"scale(".concat(r,", ").concat(o,")"),msTransform:"scale(".concat(r,", ").concat(o,")"),transform:"scale(".concat(r,", ").concat(o,")"),WebkitTransformOrigin:"0 0 0",msTransformOrigin:"0 0 0",transformOrigin:"0 0 0"};return c.createElement("div",{ref:function(t){e._wrapperRef=t},style:Object.assign({width:i,height:s},this.props.style),className:"scalable-component"},c.cloneElement(t,{style:a}))}}]),t}(c.Component))},1094:function(e,t,n){"use strict";var r=n(5),o=n(30),i=n(28),s=n(11),a=n(29),c=n(4),l=n.n(c),p=(n(1168),n(1111));function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=l.a.createElement("defs",null,l.a.createElement("path",{id:"trash-a",d:"M19.1022222,10.6666667 L28.8985185,10.6666667 L28.417037,9.22296296 C28.1140741,8.31407407 27.2666667,7.7037037 26.3088889,7.7037037 L21.6911111,7.7037037 C20.7333333,7.7037037 19.8866667,8.31407407 19.582963,9.22296296 L19.1022222,10.6666667 Z M14.3340741,40.2962963 L33.6659259,40.2962963 L35.0733333,12.1481481 L12.9274074,12.1481481 L14.3340741,40.2962963 Z M26.3088889,6.22222222 C27.9059259,6.22222222 29.3177778,7.24 29.822963,8.75481481 L30.46,10.6666667 L38.8148148,10.6666667 L38.8148148,12.1481481 L36.5562963,12.1481481 L35.0748148,41.7777778 L12.9251852,41.7777778 L11.4437037,12.1481481 L9.18518519,12.1481481 L9.18518519,10.6666667 L17.5407407,10.6666667 L18.1777778,8.75481481 C18.682963,7.24 20.0948148,6.22222222 21.6911111,6.22222222 L26.3088889,6.22222222 Z M20.6661481,17.2995556 L19.1861481,17.366963 L19.9268889,33.6632593 L21.4068889,33.5958519 L20.6661481,17.2995556 Z M27.3342963,17.2995556 L26.5935556,33.5958519 L28.0735556,33.6632593 L28.8142963,17.366963 L27.3342963,17.2995556 Z"})),m=l.a.createElement("use",{fill:"#1F1F1F",fillRule:"evenodd",xlinkHref:"#trash-a"}),y=function(e){var t=e.svgRef,n=e.title,r=h(e,["svgRef","title"]);return l.a.createElement("svg",u({width:48,height:48,viewBox:"0 0 48 48",ref:t},r),n?l.a.createElement("title",null,n):null,d,m)},f=l.a.forwardRef((function(e,t){return l.a.createElement(y,u({svgRef:t},e))}));n.p;function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function b(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var g=l.a.createElement("title",null,"RHYME/SHAPES/48x48/Trim"),_=l.a.createElement("g",{id:"RHYME/SHAPES/48x48/Trim",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round"},l.a.createElement("path",{d:"M14.1212418,32.4102325 C16.5760566,32.4102325 18.5642047,34.3998622 18.5642047,36.854677 C18.5642047,39.3087511 16.5760566,41.2991214 14.1212418,41.2991214 C11.666427,41.2991214 9.67531586,39.3087511 9.67531586,36.854677 C9.67531586,34.3998622 11.666427,32.4102325 14.1212418,32.4102325 Z M33.8892,32.4102325 C36.3425333,32.4102325 38.3336444,34.4006029 38.3336444,36.854677 C38.3336444,39.3087511 36.3440148,41.2991214 33.8892,41.2991214 C31.4329037,41.2991214 29.4447556,39.3087511 29.4447556,36.854677 C29.4447556,34.3998622 31.4329037,32.4102325 33.8892,32.4102325 Z M30.1111111,39.2222222 L14.5555556,7 M17.8888889,39.2222222 L33.4444444,7",id:"Scissors-Shape",stroke:"#1F1F1F",strokeWidth:1.5})),k=function(e){var t=e.svgRef,n=e.title,r=b(e,["svgRef","title"]);return l.a.createElement("svg",v({width:"48px",height:"48px",viewBox:"0 0 48 48",ref:t},r),void 0===n?g:n?l.a.createElement("title",null,n):null,_)},O=l.a.forwardRef((function(e,t){return l.a.createElement(k,v({svgRef:t},e))})),w=(n.p,n(1112)),C=n(1050),E=n.n(C),j=n(8),S=n(1060),P=n(133),T=(n(1176),function(e){function t(){var e,n;Object(r.a)(this,t);for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return(n=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(a)))).state={tooltipVisible:!1,tooltipTimestamp:0,thumbDragging:!1,trimDragging:!1,skipOddFrames:!0},n._trackRef=c.createRef(),n._trackRect={left:0,width:0},n._resizeObserver=new S.a((function(){return n.updateTrackRect()})),n.updateTrackRect=function(){if(n._trackRef.current){var e=n._trackRef.current.getBoundingClientRect(),t=e.left,r=e.width;n._trackRect={left:t,width:r}}else n._trackRect={left:0,width:0};var o=n._trackRect.width<480;n.state.skipOddFrames!==o&&n.setState({skipOddFrames:o})},n.onProgressClick=function(e){var t=e.clientX;if(isFinite(n.props.totalDuration)){var r=n._trackRect,o=r.left,i=r.width,s=t-o;n._onSeek(n.props.totalDuration*(s/i))}},n.onShowToolTip=function(e){var t=e.clientX;n.updateTrackRect(),n.setState({tooltipVisible:!0,tooltipTimestamp:n._calculateTooltipTimestamp(t)})},n.onHideToolTip=function(){n.state.thumbDragging||n.setState({tooltipVisible:!1})},n.onThumbMouseDown=function(){n.setState({thumbDragging:!0}),document.body.style.cursor="grabbing"},n.onTrimThumbMouseDown=function(){n.props.trimDisabled||(n.setState({trimDragging:!0}),document.body.style.cursor="grabbing")},n._docMouseMove=function(e){var t=e.clientX;if(n.state.thumbDragging||n.state.trimDragging){var r=n._trackRect,o=(t-r.left)/r.width,i=n.props.totalDuration*o;0<=i&&i<=n.props.totalDuration&&(n.state.thumbDragging&&(n.props.onThumbDrag(),n._onSeek(i)),n.state.trimDragging&&n.props.onTrimDrag(i))}n.state.tooltipVisible&&n.setState({tooltipTimestamp:n._calculateTooltipTimestamp(t)})},n._docMouseUp=function(){n.state.thumbDragging&&n.props.onThumbRelease(),n.state.trimDragging&&n.props.onTrimRelease(),n.setState({thumbDragging:!1,trimDragging:!1,tooltipVisible:!1}),document.body.style.cursor="default"},n}return Object(a.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this._docMouseMove),document.addEventListener("mouseup",this._docMouseUp),this._trackRef.current&&this._resizeObserver.observe(this._trackRef.current)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this._docMouseMove),document.removeEventListener("mouseup",this._docMouseUp),this._resizeObserver.disconnect()}},{key:"render",value:function(){var e=this._durationPercent(this.props.currentTime),t=this.props.totalDuration-this.props.trimEndDuration,n=this._durationPercent(t),r=t/this.props.totalDuration<.9;return c.createElement("div",{className:"trim-progress-bar"},c.createElement("div",{className:E()("track-cont",this.props.trimActive&&"trim-active")},c.createElement("div",{className:E()("tooltip",this.state.tooltipVisible&&"visible"),style:{left:this._durationPercent(this.state.tooltipTimestamp)}},Object(P.d)(this.props.startOffsetTime+this.state.tooltipTimestamp)),c.createElement("div",{className:"start-label"},Object(P.d)(this.props.startOffsetTime)),r&&c.createElement("div",{className:"end-label",style:{left:"100%"}},Object(P.d)(this.props.startOffsetTime+this.props.totalDuration)),c.createElement("div",{className:"trim-label",style:{left:n}},Object(P.d)(this.props.startOffsetTime+t)),c.createElement("div",{className:"track",ref:this._trackRef,onClick:this.onProgressClick,onMouseEnter:this.onShowToolTip,onMouseLeave:this.onHideToolTip},this.visibleFrames.map((function(e){return c.createElement("img",{key:e.durationFraction,src:e.url,className:"keyframe",style:{left:100*e.durationFraction+"%"}})}))),c.createElement("div",{className:"trim-box"},c.createElement("div",{className:"trim-window",style:{width:n}}),c.createElement("div",{className:"trim-dim",style:{left:n}})),c.createElement("div",{className:E()("trim-thumb",this.state.trimDragging&&"hold",this.props.trimDisabled&&"disabled"),style:{left:n},onMouseDown:this.onTrimThumbMouseDown},!this.props.trimDisabled&&c.createElement("div",{className:"trim-handle"})),c.createElement("div",{style:{left:e},className:E()("thumb",this.state.thumbDragging&&"hold"),onMouseEnter:this.onShowToolTip,onMouseLeave:this.onHideToolTip,onMouseDown:this.onThumbMouseDown})))}},{key:"_durationPercent",value:function(e){return e/this.props.totalDuration*100+"%"}},{key:"_calculateTooltipTimestamp",value:function(e){if(this._trackRect.width){var t=this._trackRect.width,n=this._trackRect.left,r=Math.max(e-n,0)/t;return Math.round(this.props.totalDuration*r*1e3)/1e3}return 0}},{key:"_onSeek",value:function(e){this.props.disabled||this.props.onSeek(e)}},{key:"visibleFrames",get:function(){return this.props.frames?this.state.skipOddFrames?this.props.frames.filter((function(e,t){return t%2===0})):this.props.frames:Object(j.List)()}}]),t}(c.PureComponent));n.d(t,"a",(function(){return R}));var R=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).state={playing:!1,currentTime:0,trimEndDuration:0},n._controlsService=void 0,n._draggingWhilePlaying=void 0,n.onPlayerTimeUpdated=function(e){var t=n.trimTimestamp;e>n.trimTimestamp?(n._controlsService.onPause(),n._controlsService.onSeek(t)):n.setState({currentTime:e})},n.onPlay=function(){n.disabled||n._controlsService.onPlay()},n.onPause=function(){n.disabled||n._controlsService.onPause()},n.onSeek=function(e){n.disabled||n._controlsService.onSeek(e)},n.onThumbDrag=function(){n.state.playing&&(n._controlsService.onPause(),n._draggingWhilePlaying=!0)},n.onTrimDrag=function(e){n.state.playing&&(n._controlsService.onPause(),n._draggingWhilePlaying=!0),e=Math.max(e,1),n.setState({trimEndDuration:n.duration-e})},n.onThumbRelease=function(){n._draggingWhilePlaying&&(n._draggingWhilePlaying=!1,n._controlsService.onPlay())},n.onTrimRelease=function(){var e=Math.max(0,n.trimTimestamp-3);e<n.state.currentTime&&n._controlsService.onSeek(e),n._draggingWhilePlaying&&(n._draggingWhilePlaying=!1,n._controlsService.onPlay())},n.onTrim=function(){n.trimActive&&(n.state.playing&&n._controlsService.onPause(),n.props.onTrim(1e3*n.trimTimestamp))},n.onDelete=function(){n.state.playing&&n._controlsService.onPause(),n.props.onDelete()},n._controlsService=new p.b(n.props.dispatch,{currentChapter:null,course:null}),n._controlsService.onPlayerPlaying((function(e){return n.setState({playing:e})})),n._controlsService.onPlayerTimeUpdated(n.onPlayerTimeUpdated),n}return Object(a.a)(t,e),Object(s.a)(t,[{key:"disabled",get:function(){return!(this.props.videoPlayer&&this.props.canPlayVideo)}},{key:"duration",get:function(){return this.props.videoPlayer?this.props.videoPlayer.duration:0}},{key:"trimTimestamp",get:function(){return Math.max(0,this.duration-this.state.trimEndDuration)}},{key:"trimDisabled",get:function(){return this.props.trimDisabled}},{key:"trimActive",get:function(){return!this.props.trimDisabled&&!(this.state.trimEndDuration<.1)}}]),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.videoPlayer!==e.videoPlayer&&this._controlsService.setRefs(this.props.videoPlayer),this.props.canPlayVideo&&!e.canPlayVideo&&(this.setState({trimEndDuration:0,currentTime:0}),this.props.autoPlay&&this._controlsService.onPlay())}},{key:"render",value:function(){return c.createElement("div",{className:"edit-video-controls "+(this.disabled?" disabled":"")},c.createElement("div",{className:"progress-container"},c.createElement(w.a,{playing:this.state.playing,onClick:this.state.playing?this.onPause:this.onPlay}),c.createElement(T,{disabled:this.disabled,onSeek:this.onSeek,startOffsetTime:this.props.startOffsetTime,totalDuration:this.duration,currentTime:this.state.currentTime,trimDisabled:this.trimDisabled,trimActive:this.trimActive,onThumbDrag:this.onThumbDrag,onThumbRelease:this.onThumbRelease,trimEndDuration:this.state.trimEndDuration,onTrimDrag:this.onTrimDrag,onTrimRelease:this.onTrimRelease,frames:this.props.frames})),c.createElement("div",{className:"buttons"},c.createElement("button",{disabled:!this.trimActive,onClick:this.onTrim},c.createElement(O,null),c.createElement("span",null,"TRIM")),c.createElement("button",{disabled:!this.props.canPlayVideo,onClick:this.onDelete},c.createElement(f,null),c.createElement("span",null,"DELETE"))))}}]),t}(c.Component)},1099:function(e,t,n){"use strict";n(1100),n(1101);var r=n(1102);n.d(t,"createExpandModeCodec",(function(){return r.a}))},1100:function(e,t){},1101:function(e,t){},1102:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),o=n(1058),i=n(1080),s=Object(r.a)({},i.b,(function(){return new i.a})),a=function(e){var t=Object(o.b)(e),n=s[t];if(!n)throw new Error("ExpandModeCodec with version ".concat(t," not supported"));return n()}},1103:function(e,t){},1105:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=(n(1163),function(e){var t=e.width,n=e.height,o=e.x,i=e.y,s=o-(t=isNaN(t)?0:t)/2,a=i-(n=isNaN(n)?0:n)/2;s=Math.max(s,0),a=Math.max(a,0);var c={width:t,height:n,left:s=Math.min(s,e.maxWidth-t)||0,top:a=Math.min(a,e.maxHeight-n)||0};return r.createElement("div",{className:"sc-zoom-pointer"+(e.isExpanded?" expanded":""),style:c})})},1106:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return v}));var r,o,i,s=n(5),a=n(11),c=n(30),l=n(28),p=n(29),u=n(90),h=n(91),d=n.n(h),m=n(50),y=n(4),f=function(){var e=new m.EventEmitter;return{emitTrackEvent:function(t){return e.emit("cuechange",t)},subscribeToTrack:function(t){return e.on("cuechange",t),function(){return e.off("cuechange",t)}}}},v=(i=o=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o))))._track=null,n}return Object(p.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return y.createElement("track",{ref:this._onTrackRef,kind:this.props.kind,srcLang:this.props.srcLang,default:this.props.default,src:this.props.url})}},{key:"_onCueChange",value:function(e){this.props.onCueChange&&this.props.onCueChange(e)}},{key:"_onTrackRef",value:function(e){this._track&&this._track.removeEventListener("cuechange",this._onCueChange),this._track=e,this._track&&this._track.addEventListener("cuechange",this._onCueChange)}}]),t}(y.PureComponent),o.defaultProps={kind:"metadata",default:!0},r=i,Object(u.a)(r.prototype,"_onCueChange",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"_onCueChange"),r.prototype),Object(u.a)(r.prototype,"_onTrackRef",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"_onTrackRef"),r.prototype),r)},1111:function(e,t,n){"use strict";n(1094);var r,o,i=n(5),s=n(11),a=n(30),c=n(28),l=n(29),p=n(90),u=n(91),h=n.n(u),d=n(4),m=n.n(d),y=n(133),f=(n(1169),function(e){return d.createElement("div",{className:"cc-toggle-button ".concat(e.showCC?"":"disabled"),onClick:e.onCCToggle,title:"Toggle captions"})}),v=n(1112),b=n(3),g=(n(1171),n(134)),_=n(1065),k=(r={},Object(b.a)(r,_.a.x025,"0.2x"),Object(b.a)(r,_.a.x050,"0.5x"),Object(b.a)(r,_.a.x075,"0.7x"),Object(b.a)(r,_.a.x100,"1x"),Object(b.a)(r,_.a.x125,"1.2x"),Object(b.a)(r,_.a.x150,"1.5x"),Object(b.a)(r,_.a.x200,"2x"),r),O=Object.values(_.a),w=(o=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(n=Object(a.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={visible:!1},n._keyboardActionHandlers={"video.speedUp":n._changePlaybackRate(1),"video.speedDown":n._changePlaybackRate(-1)},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return d.createElement("div",{className:"playback-rate-button"+(this.props.hidden?" hidden":"")},d.createElement(g.Hotkeys,{handlers:this._keyboardActionHandlers}),d.createElement("ul",{className:"list"+(this.state.visible?" visible":"")},O.map((function(t){return d.createElement("li",{onClick:function(){return e.props.onPlaybackRateChange(t)},key:t},k[t])}))),d.createElement("span",{className:"open",onClick:this._open},k[this.props.playbackRate]))}},{key:"_open",value:function(){var e=this;this.state.visible||this.setState({visible:!0},(function(){return document.addEventListener("click",e._close)}))}},{key:"_close",value:function(){var e=this;this.state.visible&&this.setState({visible:!1},(function(){return document.removeEventListener("click",e._close)}))}},{key:"_changePlaybackRate",value:function(e){var t=this;return function(){var n=O.findIndex((function(e){return parseFloat(e)===parseFloat(t.props.playbackRate)})),r=Math.max(0,Math.min(n+e,O.length-1)),o=O[r];o&&t.props.onPlaybackRateChange(o)}}}]),t}(d.PureComponent),Object(p.a)(o.prototype,"_open",[h.a],Object.getOwnPropertyDescriptor(o.prototype,"_open"),o.prototype),Object(p.a)(o.prototype,"_close",[h.a],Object.getOwnPropertyDescriptor(o.prototype,"_close"),o.prototype),Object(p.a)(o.prototype,"_changePlaybackRate",[h.a],Object.getOwnPropertyDescriptor(o.prototype,"_changePlaybackRate"),o.prototype),o);n(1172);function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function E(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var j,S=m.a.createElement("defs",null,m.a.createElement("polygon",{id:"path-next-icon",points:"35.7090909 0 35.7090909 13.2781818 15.3054545 0 15.3054545 9.96 0 0 0 26.8781818 15.3054545 16.9145455 15.3054545 26.8781818 35.7090909 13.5981818 35.7090909 26.8781818 40 26.8781818 40 0"})),P=m.a.createElement("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},m.a.createElement("g",{transform:"translate(-3341.000000, -1182.000000)",id:"Icons"},m.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},m.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},m.a.createElement("g",{id:"Icons/Next",transform:"translate(0.000000, 392.000000)"},m.a.createElement("g",{id:"Colors/Grey",transform:"translate(0.000000, 6.000000)"},m.a.createElement("mask",{id:"mask-next-icon",fill:"white"},m.a.createElement("use",{xlinkHref:"#path-next-icon"})),m.a.createElement("use",{id:"Mask",fill:"#fff",xlinkHref:"#path-next-icon"}),m.a.createElement("g",{mask:"url(#mask-next-icon)",fill:"#fff",id:"Rectangle"},m.a.createElement("g",{transform:"translate(0.000000, -6.000000)"},m.a.createElement("rect",{x:0,y:0,width:40,height:40}))))))))),T=function(e){var t=e.svgRef,n=e.title,r=E(e,["svgRef","title"]);return m.a.createElement("svg",C({viewBox:"0 0 40 27",ref:t},r),n?m.a.createElement("title",null,n):null,S,P)},R=m.a.forwardRef((function(e,t){return m.a.createElement(T,C({svgRef:t},e))})),A=(n.p,j=function(e){function t(){return Object(i.a)(this,t),Object(a.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){this.props.disabled||this.props.onClick()}},{key:"render",value:function(){return d.createElement("div",{className:this.className,onClick:this.props.onClick},d.createElement(R,null))}},{key:"className",get:function(){var e="prev-next-button";switch(this.props.type){case"next":e+=" next";break;case"prev":e+=" prev"}return this.props.disabled&&(e+=" disabled"),this.props.hidden&&(e+=" hidden"),e}}]),t}(d.PureComponent),Object(p.a)(j.prototype,"onClick",[h.a],Object.getOwnPropertyDescriptor(j.prototype,"onClick"),j.prototype),j);n(1173);function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function M(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var x,N,V,L,U=m.a.createElement("defs",null),I=m.a.createElement("path",{fill:"#fff",d:"M28.37,27.09,19,27.5a27,27,0,1,1,6.61,27.16A4,4,0,0,0,20,60.31a35,35,0,1,0,.07-49.5,36.35,36.35,0,0,0-9.43,16.47,1.37,1.37,0,0,0-.07.49l-7.71.35a2.93,2.93,0,0,0-2,.84,2.7,2.7,0,0,0-.71,1.13A3.06,3.06,0,0,0,1,33.35L14.27,45.53a3,3,0,0,0,4.24-.14L30.69,32.11a3.16,3.16,0,0,0,.5-3.32A3,3,0,0,0,28.37,27.09Z"}),F=function(e){var t=e.svgRef,n=e.title,r=M(e,["svgRef","title"]);return m.a.createElement("svg",D({id:"Layer_1","data-name":"Layer 1",viewBox:"0 0 79.51 70.7",ref:t},r),n?m.a.createElement("title",null,n):null,U,I)},z=m.a.forwardRef((function(e,t){return m.a.createElement(F,D({svgRef:t},e))})),B=(n.p,x=function(e){function t(){return Object(i.a)(this,t),Object(a.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){this.props.disabled||this.props.onClick()}},{key:"render",value:function(){return d.createElement("div",{className:"repeat-button","data-time":this.props.predefinedTime,onClick:this.props.onClick},d.createElement(z,null))}}]),t}(d.PureComponent),Object(p.a)(x.prototype,"onClick",[h.a],Object.getOwnPropertyDescriptor(x.prototype,"onClick"),x.prototype),x),W=(n(1174),N=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e)))._track=void 0,n._trackRect={left:0,width:0},n._docMouseMove=void 0,n._docMouseUp=void 0,n.state={tooltipVisible:!1,tooltipTimestamp:0,tipHold:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._onMouseMove(),this._onTipRelease()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this._docMouseMove),document.removeEventListener("mouseup",this._docMouseUp)}},{key:"onProgressClick",value:function(e){var t=e.clientX;if(this._track&&isFinite(this.props.duration)){var n=this._track.getBoundingClientRect(),r=n.left,o=n.width,i=t-r;this._onSeek(this.props.duration*(i/o))}}},{key:"onMouseEnter",value:function(e){var t=e.clientX;this._trackRect=this._getTrackRect(),this.setState({tooltipVisible:!0,tooltipTimestamp:this._calculateTooltipTimestamp(t)})}},{key:"onMouseLeave",value:function(){this.state.tipHold||this.setState({tooltipVisible:!1})}},{key:"onTipHold",value:function(){this.setState({tipHold:!0}),this._trackRect=this._getTrackRect(),document.body.style.cursor="grabbing"}},{key:"render",value:function(){var e=this;return d.createElement("div",{className:"video-progress-bar"},d.createElement("div",{className:"tooltip"+(this.state.tooltipVisible?" visible":""),style:{left:this._durationPerc(this.state.tooltipTimestamp)}},Object(y.d)(this.state.tooltipTimestamp)),d.createElement("div",{className:"track-cont"},d.createElement("div",{className:"track",ref:function(t){return e._track=t},onClick:this.onProgressClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},d.createElement("div",{style:{width:this._durationPerc(this.props.currentTime)},className:"progress"},d.createElement("div",{className:"tip"+(this.state.tipHold?" hold":""),onMouseDown:this.onTipHold})))))}},{key:"_durationPerc",value:function(e){return e/this.props.duration*100+"%"}},{key:"_calculateTooltipTimestamp",value:function(e){if(this._track){var t=this._track.clientWidth,n=this._trackRect.left,r=Math.max(e-n,0)/t;return Math.round(this.props.duration*r*1e3)/1e3}return 0}},{key:"_onMouseMove",value:function(){var e=this;document.addEventListener("mousemove",this._docMouseMove=function(t){var n=t.clientX;if(e.state.tipHold){var r=e._trackRect,o=(n-r.left)/r.width,i=e.props.duration*o;0<=i&&i<=e.props.duration&&(e.props.onDrag(),e._onSeek(i))}e.state.tooltipVisible&&e.setState({tooltipTimestamp:e._calculateTooltipTimestamp(n)})})}},{key:"_onTipRelease",value:function(){var e=this;document.addEventListener("mouseup",this._docMouseUp=function(){e.setState({tipHold:!1,tooltipVisible:!1}),document.body.style.cursor="default",e.props.onRelease()})}},{key:"_getTrackRect",value:function(){if(this._track){var e=this._track.getBoundingClientRect();return{left:e.left,width:e.width}}return{left:0,width:0}}},{key:"_onSeek",value:function(e){this.props.disabled||this.props.onSeek(e)}}]),t}(d.PureComponent),Object(p.a)(N.prototype,"onProgressClick",[h.a],Object.getOwnPropertyDescriptor(N.prototype,"onProgressClick"),N.prototype),Object(p.a)(N.prototype,"onMouseEnter",[h.a],Object.getOwnPropertyDescriptor(N.prototype,"onMouseEnter"),N.prototype),Object(p.a)(N.prototype,"onMouseLeave",[h.a],Object.getOwnPropertyDescriptor(N.prototype,"onMouseLeave"),N.prototype),Object(p.a)(N.prototype,"onTipHold",[h.a],Object.getOwnPropertyDescriptor(N.prototype,"onTipHold"),N.prototype),N),H=(n(1175),V=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(n=Object(a.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o))))._draggingWhilePlaying=void 0,n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onPlay",value:function(){this.props.disableAll||this.props.onPlay()}},{key:"onPause",value:function(){this.props.disableAll||this.props.onPause()}},{key:"onPredefinedBackward",value:function(){this.props.onSeek(Math.max(this.props.currentTime-15,0))}},{key:"onBackward",value:function(){this.props.backwardDisabled||this.props.navigationHidden||this.props.disableAll||this.props.onBackward()}},{key:"onForward",value:function(){this.props.forwardDisabled||this.props.navigationHidden||this.props.disableAll||this.props.onForward()}},{key:"onProgressDrag",value:function(){this.props.playing&&(this._draggingWhilePlaying=!0,this.props.onPause())}},{key:"onProgressRelease",value:function(){this._draggingWhilePlaying&&(this._draggingWhilePlaying=!1,this.props.onPlay())}},{key:"render",value:function(){return d.createElement("div",{className:this.className},d.createElement(W,{currentTime:this.props.currentTime,duration:this.props.duration,onSeek:this.props.onSeek,onDrag:this.onProgressDrag,onRelease:this.onProgressRelease,disabled:this.props.disableAll}),d.createElement("div",{className:"buttons"},d.createElement("nav",{className:"video-nav"},d.createElement(v.a,{playing:this.props.playing,onClick:this.props.playing?this.onPause:this.onPlay}),d.createElement(A,{type:"prev",disabled:this.props.backwardDisabled,hidden:this.props.navigationHidden,onClick:this.onBackward}),d.createElement(B,{predefinedTime:15,onClick:this.onPredefinedBackward}),d.createElement(A,{type:"next",disabled:this.props.forwardDisabled,hidden:this.props.navigationHidden,onClick:this.onForward}),d.createElement("div",{className:"label"},Object(y.d)(this.props.currentTime)+" / "+Object(y.d)(this.props.duration))),d.createElement("div",{className:"video-settings"},(this.props.onCCToggle,d.createElement(f,{showCC:this.props.showCC,onCCToggle:this.props.onCCToggle})),d.createElement(w,{playbackRate:this.props.playbackRate,onPlaybackRateChange:this.props.onPlaybackRateChange}))))}},{key:"className",get:function(){var e="video-controls "+(this.props.className||"")+(this.props.disableAll?" disabled":"");switch(this.props.theme){case"dark":e+=" dark-theme"}return e}}]),t}(d.PureComponent),Object(p.a)(V.prototype,"onPlay",[h.a],Object.getOwnPropertyDescriptor(V.prototype,"onPlay"),V.prototype),Object(p.a)(V.prototype,"onPause",[h.a],Object.getOwnPropertyDescriptor(V.prototype,"onPause"),V.prototype),Object(p.a)(V.prototype,"onPredefinedBackward",[h.a],Object.getOwnPropertyDescriptor(V.prototype,"onPredefinedBackward"),V.prototype),Object(p.a)(V.prototype,"onBackward",[h.a],Object.getOwnPropertyDescriptor(V.prototype,"onBackward"),V.prototype),Object(p.a)(V.prototype,"onForward",[h.a],Object.getOwnPropertyDescriptor(V.prototype,"onForward"),V.prototype),Object(p.a)(V.prototype,"onProgressDrag",[h.a],Object.getOwnPropertyDescriptor(V.prototype,"onProgressDrag"),V.prototype),Object(p.a)(V.prototype,"onProgressRelease",[h.a],Object.getOwnPropertyDescriptor(V.prototype,"onProgressRelease"),V.prototype),V),G=n(50),K=n(2),Y=n(0),q=Symbol("PlayerPlaying"),Z=Symbol("PlayerTimeUpdated"),J=Symbol("PlayerCompleted"),X=(L=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,e),this._dispatch=t,this._props=n,this._hooks=r,this._emitter=new G.EventEmitter,this._interval=void 0,this._player=void 0}return Object(s.a)(e,[{key:"destroy",value:function(){this._dispatch(new K.mb),this.clearInterval()}},{key:"setRefs",value:function(e){e&&(this._player=e)}},{key:"updateProps",value:function(e){this._props=e}},{key:"clearInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){clearInterval(this._interval)}))},{key:"onPlayerPlaying",value:function(e){this._emitter.addListener(q,e)}},{key:"onPlayerTimeUpdated",value:function(e){this._emitter.addListener(Z,e)}},{key:"onPlayerCompleted",value:function(e){this._emitter.addListener(J,e)}},{key:"onPause",value:function(){this._player&&(clearInterval(this._interval),this._emitter.emit(q,!1),this._player.pause())}},{key:"onPlay",value:function(){var e=this;if(this._player){clearInterval(this._interval),this._interval=setInterval(this._emitPlayerTimeAndPauses,50);var t=this._player.play();t?t.then(this._onSuccessfulPlay).catch((function(){e._emitter.emit(q,!1)})):this._onSuccessfulPlay()}}},{key:"onPlaybackRateChange",value:function(e){this._player&&this._player.changePlaybackRate(e)}},{key:"onSeek",value:function(e){this._player&&(this._emitter.emit(Z,e),this._player.setCurrentTime(e))}},{key:"onForward",value:function(){this.nextChapter&&this._selectChapter(this.nextChapter)}},{key:"onBackward",value:function(){this.prevChapter&&this._selectChapter(this.prevChapter)}},{key:"_selectChapter",value:function(e){this._dispatch(new K.wb(e)),this._emitter.emit(Z,0)}},{key:"_onSuccessfulPlay",value:function(){this._emitter.emit(q,!0),this._hooks.onPlay&&this._hooks.onPlay()}},{key:"_emitPlayerTimeAndPauses",value:function(){this._player&&(this._emitter.emit(Z,this._player.currentTime),this._player.currentTime===this._player.duration&&this._player.canPlay?(this.onPause(),this._emitter.emit(J)):this._player.playing||this.onPause())}},{key:"chapters",get:function(){return this._props.course.chapters.filter((function(e){if(!e)return!1;var t=!(e instanceof Y.g)||e.paid;return!!e.videoUrl||!t})).toList()}},{key:"nextChapter",get:function(){var e=this.chapters,t=e.indexOf(this._props.currentChapter),n=t+1;return-1===t||n>=e.size?null:e.get(n)}},{key:"prevChapter",get:function(){var e=this.chapters,t=e.indexOf(this._props.currentChapter)-1;if(!(t<0))return e.get(t)}},{key:"hasNextChapter",get:function(){return!!this.nextChapter}},{key:"hasPrevChapter",get:function(){return!!this.prevChapter}}]),e}(),Object(p.a)(L.prototype,"onPause",[h.a],Object.getOwnPropertyDescriptor(L.prototype,"onPause"),L.prototype),Object(p.a)(L.prototype,"onPlay",[h.a],Object.getOwnPropertyDescriptor(L.prototype,"onPlay"),L.prototype),Object(p.a)(L.prototype,"onPlaybackRateChange",[h.a],Object.getOwnPropertyDescriptor(L.prototype,"onPlaybackRateChange"),L.prototype),Object(p.a)(L.prototype,"onSeek",[h.a],Object.getOwnPropertyDescriptor(L.prototype,"onSeek"),L.prototype),Object(p.a)(L.prototype,"onForward",[h.a],Object.getOwnPropertyDescriptor(L.prototype,"onForward"),L.prototype),Object(p.a)(L.prototype,"onBackward",[h.a],Object.getOwnPropertyDescriptor(L.prototype,"onBackward"),L.prototype),Object(p.a)(L.prototype,"_onSuccessfulPlay",[h.a],Object.getOwnPropertyDescriptor(L.prototype,"_onSuccessfulPlay"),L.prototype),Object(p.a)(L.prototype,"_emitPlayerTimeAndPauses",[h.a],Object.getOwnPropertyDescriptor(L.prototype,"_emitPlayerTimeAndPauses"),L.prototype),L);n.d(t,"a",(function(){return H})),n.d(t,"b",(function(){return X}))},1112:function(e,t,n){"use strict";var r=n(5),o=n(11),i=n(30),s=n(28),a=n(29),c=n(90),l=n(91),p=n.n(l),u=n(1050),h=n.n(u),d=n(4),m=n.n(d),y=(n(1170),n(134));function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var b=m.a.createElement("desc",null,"Created with Sketch."),g=m.a.createElement("defs",null,m.a.createElement("path",{d:"M23.7696833,0 L33.3864253,0 L33.3864253,40 L23.7696833,40 L23.7696833,0 Z M0,0 L9.61674208,0 L9.61674208,40 L0,40 L0,0 Z",id:"path-pause-icon"})),_=m.a.createElement("g",{id:"Style-Guide",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},m.a.createElement("g",{transform:"translate(-3667.000000, -1105.000000)",id:"Icons"},m.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},m.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},m.a.createElement("g",{id:"Icons/Pause",transform:"translate(323.000000, 321.000000)"},m.a.createElement("g",{id:"Colors/Grey",transform:"translate(3.000000, 0.000000)"},m.a.createElement("mask",{id:"mask-pause-icon",fill:"white"},m.a.createElement("use",{xlinkHref:"#path-pause-icon"})),m.a.createElement("use",{id:"Mask",fill:"#fff",xlinkHref:"#path-pause-icon"}),m.a.createElement("g",{mask:"url(#mask-pause-icon)",fill:"#fff",id:"Rectangle"},m.a.createElement("g",{transform:"translate(-3.000000, 0.000000)"},m.a.createElement("rect",{x:0,y:0,width:40,height:40}))))))))),k=function(e){var t=e.svgRef,n=e.title,r=v(e,["svgRef","title"]);return m.a.createElement("svg",f({viewBox:"0 0 34 40",ref:t},r),n?m.a.createElement("title",null,n):null,b,g,_)},O=m.a.forwardRef((function(e,t){return m.a.createElement(k,f({svgRef:t},e))}));n.p;function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var E,j=m.a.createElement("defs",null,m.a.createElement("polygon",{id:"path-play-icon",points:"0 0 0 40 30.7275192 20"})),S=m.a.createElement("g",{id:"Style-Guide",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},m.a.createElement("g",{transform:"translate(-3596.000000, -1103.000000)",id:"Icons"},m.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},m.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},m.a.createElement("g",{id:"Icons/Play",transform:"translate(250.000000, 319.000000)"},m.a.createElement("g",{id:"Colors/Grey",transform:"translate(5.000000, 0.000000)"},m.a.createElement("mask",{id:"mask-play-icon",fill:"white"},m.a.createElement("use",{xlinkHref:"#path-play-icon"})),m.a.createElement("use",{id:"Mask",fill:"#fff",xlinkHref:"#path-play-icon"}),m.a.createElement("g",{mask:"url(#mask-play-icon)",fill:"#fff",id:"Rectangle"},m.a.createElement("g",{transform:"translate(-5.000000, 0.000000)"},m.a.createElement("rect",{x:0,y:0,width:40,height:40}))))))))),P=function(e){var t=e.svgRef,n=e.title,r=C(e,["svgRef","title"]);return m.a.createElement("svg",w({viewBox:"0 0 31 40",ref:t},r),n?m.a.createElement("title",null,n):null,j,S)},T=m.a.forwardRef((function(e,t){return m.a.createElement(P,w({svgRef:t},e))}));n.p;n.d(t,"a",(function(){return R}));var R=(E=function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a))))._keyboardActionHandlers={"video.togglePlay":n._onClick},n}return Object(a.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return d.createElement("div",{className:h()("play-pause-button",this.props.disabled&&"disabled",this.props.playing?" pause-btn":" play-btn"),onClick:this._onClick},d.createElement(y.Hotkeys,{handlers:this._keyboardActionHandlers}),this.props.playing?d.createElement(O,null):d.createElement(T,null))}},{key:"_onClick",value:function(){this.props.disabled||this.props.onClick()}}]),t}(d.PureComponent),Object(c.a)(E.prototype,"_onClick",[p.a],Object.getOwnPropertyDescriptor(E.prototype,"_onClick"),E.prototype),E)},1113:function(e,t,n){"use strict";var r,o,i,s,a=n(51),c=n(5),l=n(11),p=n(30),u=n(28),h=n(290),d=n(29),m=n(90),y=n(91),f=n.n(y),v=n(210),b=n.n(v),g=n(2),_=n(0),k=n(107),O=n(291),w=n(1074),C=n(1051),E=(n(1180),n(47)),j=n(4),S=(n(1181),[{width:800,height:600},{width:1024,height:768},{width:1280,height:960},{width:1400,height:1050},{width:1600,height:1200}]),P=[{width:800,height:600},{width:1024,height:768},{width:1280,height:960}],T=[{width:1280,height:960}],R=function(e,t){return e.width*e.height-t.width*t.height},A=(r=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(p.a)(this,Object(u.a)(t).call(this,e)))._responseTimeout=void 0,n.state={updatingResolution:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){this.state.updatingResolution&&!this._resolutionEquals(e.vm)&&(clearTimeout(this._responseTimeout),this.setState({updatingResolution:!1}))}},{key:"componentWillUnmount",value:function(){clearTimeout(this._responseTimeout)}},{key:"increaseResolution",value:function(){this.isMaxRes||this._changeResolution(1)}},{key:"decreaseResolution",value:function(){this.isMinRes||this._changeResolution(-1)}},{key:"render",value:function(){return j.createElement("div",{className:"screen-controls"},j.createElement("div",{className:"resolution"+(this.disabled?" disabled":"")},j.createElement("span",{className:"btn"+(this.isMinRes?" disabled":""),onClick:this.decreaseResolution},"-"),this.state.updatingResolution?j.createElement(C.a,null):j.createElement("span",null,this.props.vm.width," x ",this.props.vm.height),j.createElement("span",{className:"btn"+(this.isMaxRes?" disabled":""),onClick:this.increaseResolution},"+")))}},{key:"_changeResolution",value:function(e){var t=this,n=this.props,r=n.dispatch,o=n.asyncActions,i=n.vm;this.setState({updatingResolution:!0}),this._responseTimeout=setTimeout((function(){return t.setState({updatingResolution:!1})}),3e4);var s=this._getNeighborResolution(e);r(o.changeVMResolution(i,s)).catch((function(){clearTimeout(t._responseTimeout),t.setState({updatingResolution:!1})}))}},{key:"_resolutionEquals",value:function(e){return t=this.props.vm,n=e,t.width===n.width&&t.height===n.height;var t,n}},{key:"_getNeighborResolution",value:function(e){var t=this,n=this.resolutions.map((function(e,t){return[e,t]})).find((function(e){var n=Object(E.a)(e,1)[0];return t._resolutionEquals(n)}));if(n){var r=Object(E.a)(n,2)[1];return this.resolutions[r+e]}var o=this.props.vm,i=this.resolutions.map((function(e){return{difference:R(e,o),resolution:e}})).filter((function(t){return e>0?t.difference>0:t.difference<0})).sort((function(t,n){return e>0?n.difference-t.difference:t.difference-n.difference})).pop();return i?i.resolution:{width:o.width,height:o.height}}},{key:"resolutions",get:function(){switch(this.props.template.os){case _.L.Win:return S;case _.L.Docker:return T;case _.L.Linux:default:return P}}},{key:"isMaxRes",get:function(){var e=this.resolutions[this.resolutions.length-1];return this._resolutionEquals(e)||R(e,this.props.vm)<0}},{key:"isMinRes",get:function(){var e=this.resolutions[0];return this._resolutionEquals(e)||R(e,this.props.vm)>0}},{key:"disabled",get:function(){return this.state.updatingResolution||this.props.disabled}}]),t}(j.Component),Object(m.a)(r.prototype,"increaseResolution",[f.a],Object.getOwnPropertyDescriptor(r.prototype,"increaseResolution"),r.prototype),Object(m.a)(r.prototype,"decreaseResolution",[f.a],Object.getOwnPropertyDescriptor(r.prototype,"decreaseResolution"),r.prototype),r),D=n(1105),M=n(293),x=n(299),N=n(211),V=n(14),L=n(134);n.d(t,"a",(function(){return U}));var U=(s=i=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).wrapper=void 0,n.body=void 0,n.displayScale=1,n.client=void 0,n.state={loading:!n.props.vmAccessLimitReached,zoomPointerCenter:{x:0,y:0},filter:void 0},n._controlsBound=!1,n._mouseenter=!1,n._modifierHandler=void 0,n._mouseMoveLock=void 0,n._disconnectHandler=void 0,n._connectHandler=void 0,n._reconnectionTimeout=void 0,n._screenshotCanvas=document.createElement("canvas"),n._moveZoomPointerCenter=Object(w.b)(Object(h.a)(n)).moveCenter,n._handlers={"cloudDesktop.loseFocus":n._lockFor1Second},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this._modifierHandler=function(t){return t.keyCode!==O.j&&t.keyCode!==O.i&&t.keyCode!==O.m||!e._controlsBound||(console.log("prevent default",t.keyCode),t.preventDefault(),!1)}),!this.props.readOnly&&this.props.onReadWriteInit&&this.props.onReadWriteInit(),this._initClient(this.props)}},{key:"componentWillReceiveProps",value:function(e){if(e.cursorPosition){var t=e.cursorPosition,n=this.props.vm.width/this.props.width,r=t.x/n,o=t.y/n;this._setCursorPosition({x:r,y:o})}e.vm.connection.connectionId!==this.props.vm.connection.connectionId&&e.vm.state===_.kb.Ready&&this._initClient(e)}},{key:"componentDidUpdate",value:function(e){this.props.cameraStream===e.cameraStream&&this.props.width===e.width&&this.props.height===e.height||this._handleCamera(),e.readOnly!==this.props.readOnly&&(this.props.readOnly?this._unbindControls():this._bindControls());var t=!Object(k.b)(e.vm.state)&&Object(k.b)(this.props.vm.state),n=!Object(k.c)(e.vm.state)&&Object(k.c)(this.props.vm.state);!t&&!n||this.props.vmAccessLimitReached||(this._removeScreenContent(),this._destroyCurrentClient(),this.setState({loading:!0}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._modifierHandler),this._destroyCurrentClient()}},{key:"mousemove",value:function(e){var t=this;this.props.showViewbox&&this._moveZoomPointerCenter(e),!this._mouseMoveLock&&this.props.emitCursor&&(setTimeout((function(){return t._mouseMoveLock=!1}),this.props.mouseMoveLockInterval),this.props.dispatch(new g.V(e.x,e.y)),this._mouseMoveLock=!0)}},{key:"isScreenActive",value:function(){return this._controlsBound}},{key:"getBodyRef",value:function(e){e&&(this.body=e)}},{key:"takeScreenshot",value:function(){if(!this.body)return null;var e=null;if(this.isBroadcastingCamera){var t=this.body.getElementsByTagName("video")[0];if(t)this._screenshotCanvas.width=this.props.width,this._screenshotCanvas.height=this.props.height,this._screenshotCanvas.getContext("2d").drawImage(t,0,0,this.props.width,this.props.height),e=this._screenshotCanvas.toDataURL("image/png")}else{var n=Object(x.a)().getRemoteClient(this.props.vm.id);n&&(e=n.toDataURL("image/png",1,this.props.width,this.props.height,!1))}var r=null;return e&&(r=new Blob([N.a.toArrayBuffer(e)],{type:"image/png"})),r}},{key:"onMouseEnter",value:function(){this._mouseenter=!0,this._controlsBound||this.state.loading||(this.props.onScreenFocus&&this.props.onScreenFocus(),this._bindControls()),this.setState({filter:this._keyboardShortcutFilter})}},{key:"onMouseLeave",value:function(){this._mouseenter=!1,this.props.onScreenBlur&&this.props.onScreenBlur(),this._unbindControls(),this.setState({filter:void 0})}},{key:"render",value:function(){var e=this,t="sc-screen",n=this.props.showViewbox&&!this.props.readOnly;this.isScreenActive()||(t+=" sc-screen-no-cursor"),this.state.loading&&(t+=" loading");var r=Object.assign({},this.props.style,{width:this.props.width,height:this.props.height}),o=this.props.vm.id&&this.props.vm.state===_.kb.Ready,i=this.state.loading||n||this.props.vmAccessLimitReached?"sc-screen-overlay":"";this.state.loading&&o?i+=" loading":o&&!this.props.vmAccessLimitReached||(i+=" pending");var s="screen-wrapper";this.props.readOnly&&(s+=" read-only");var a=o&&n&&this.props.viewboxSize?this._renderViewbox():null;return j.createElement(L.Hotkeys,{handlers:this._handlers,filter:this.state.filter},j.createElement(j.Fragment,null,j.createElement("div",{className:s,style:r,ref:function(t){return e.wrapper=t},onClick:this.props.onClick},j.createElement("div",{className:i},this.isVmStarting&&[j.createElement(C.a,{key:"loader"}),j.createElement("p",{key:"loader-title"},"Starting your cloud workspace"),j.createElement("p",{key:"loader-sub-title"},"Please wait!")],this.props.vmAccessLimitReached?j.createElement("p",{key:"loader-title"},"You will no longer be assigned a cloud workspace"):Object(k.c)(this.props.vm.state)?j.createElement("p",{key:"loader-title"},"Your cloud workspace has been terminated"):null),j.createElement("div",{ref:this.getBodyRef,className:t}),a),this.showControls&&j.createElement(A,{asyncActions:this.props.asyncActions,dispatch:this.props.dispatch,disabled:this.state.loading,vm:this.props.vm,template:this.props.template})))}},{key:"_renderViewbox",value:function(){return j.createElement(D.a,Object.assign({isExpanded:this.props.isViewExpanded||!1,maxWidth:this.props.width,maxHeight:this.props.height},this.zoomPointerDimensions,this.state.zoomPointerCenter))}},{key:"_bindControls",value:function(){this.client?this.props.readOnly||(this._bindMouseHandler(),this.client.unlockMouse(),this.isBroadcastingCamera||(this._bindKeyboardHandler(),this.client.unlockKeyboard()),this._controlsBound=!0,this.setState({filter:this._keyboardShortcutFilter})):console.error("Failed to set control of client input")}},{key:"_unbindControls",value:function(){this.client?(this._unbindMouseHandler(),this._unbindKeyboardHandler(),this.client.lockMouse(),this.client.lockKeyboard(),this._controlsBound=!1,this.setState({filter:void 0})):console.error("Failed to unset control of client input")}},{key:"_setCursorPosition",value:function(e){if(this.client){var t=this.client.getDisplay();if(t){t.moveCursor(e.x,e.y);var n=t.getCursorLayer().getElement(),r=this.props.cursorScale||1;t.getCursorLayer().distort(r,0,0,r,0,0),n.style.transformOrigin="0 0"}}}},{key:"_destroyCurrentClient",value:function(){this._unbindControls(),this.client&&(this.client.off(M.b,this._disconnectHandler),this.client.off(M.a,this._connectHandler),this.client.disconnect(),this.client=null)}},{key:"_initClient",value:function(e){var t=this;if(e.vm){this.client&&this._destroyCurrentClient();var n=e.vm.connection;if(n.connectionId){var r=Object(x.a)();this.client=r.createRemoteClient(e.vm.id,n),this.client.on(M.a,this._connectHandler=function(){t.props.dispatch(new g.b(e.vm.connection)),e.onConnect&&e.onConnect(t.client),t._attachScreen(t.client),t._handleCamera(),t.setState({loading:!1},(function(){!t._controlsBound&&t._mouseenter?t._bindControls():t._unbindControls()}))}),this.client.on(M.b,this._disconnectHandler=function(){console.log("DISCONNECTED event fired"),e.onDisconnect&&e.onDisconnect(),t.setState({loading:!0}),t._unbindControls(),clearTimeout(t._reconnectionTimeout),t._reconnectionTimeout=setTimeout((function(){t.client&&t.client.reconnect()}),V.a.RemoteMachineReconnectionTimeout)}),this.client.connected()?console.log("Client already connected"):(this.client&&this.client.connect(),this.setState({loading:!0}))}}else console.error("No cloud workspace data")}},{key:"_attachScreen",value:function(e){if(this.body&&this.wrapper){for(var t=this.body,n=Array.prototype.slice.call(t.children);n.length;){var r=n.pop();r.parentNode.removeChild(r)}this.wrapper.onmouseenter=this.onMouseEnter,this.wrapper.onmouseleave=this.onMouseLeave;var o=e.getDisplay();if(o){var i=this.props.width/this.props.vm.width;o.scale(i),this.displayScale=o.getScale(),o.onresize=this._updateResolution;var s=o.getWidth(),a=o.getHeight();this._updateResolution(s,a);var c=o.getElement();this._removeScreenContent(),t.appendChild(c)}}else console.error("Failed to obtain reference of body and/or wrapper")}},{key:"_handleCamera",value:function(){if(this.body)if(this.isBroadcastingCamera){var e=this.body.getElementsByTagName("video")[0],t=e?e.parentElement:null;e&&t&&t.removeChild(e);var n=this._createVideoElement(),r=n?this.body.getElementsByTagName("canvas")[0]:null,o=r?r.parentElement:null;o&&n&&(n.width=this.props.width,n.height=this.props.height,o.appendChild(n)),this.client&&this.client.lockKeyboard()}else{var i=this.body.getElementsByTagName("video")[0],s=i?i.parentElement:null;s&&i&&s.removeChild(i)}}},{key:"_createVideoElement",value:function(){if(!this.props.cameraStream)return null;var e=document.createElement("video");return e.autoplay=!0,e.srcObject=this.props.cameraStream,e}},{key:"_bindKeyboardHandler",value:function(){this.client?(this.client.on(M.d,this._onKeyDown),this.client.on(M.e,this._onKeyUp),console.log("Bind keyboard handler")):console.error("Failed to bind keyboard handler to null remote client")}},{key:"_unbindKeyboardHandler",value:function(){this.client?(this.client.off(M.d,this._onKeyDown),this.client.off(M.e,this._onKeyUp),console.log("Unbind keyboard handler")):console.warn("Failed to unbind keyboard handler from a null remote client")}},{key:"_bindMouseHandler",value:function(){this.client?(this.client.on(M.f,this._mouseHandler),this.client.on(M.h,this._mouseHandler),this.client.on(M.g,this._mouseHandler)):console.error("Failed to bind mouse handler to null remote client")}},{key:"_unbindMouseHandler",value:function(){this.client?(this.client.off(M.f,this._mouseHandler),this.client.off(M.h,this._mouseHandler),this.client.off(M.g,this._mouseHandler)):console.warn("Failed to unbind mouse handler from a null remote client")}},{key:"_updateResolution",value:function(e,t){this.props.vm.id&&this.props.dispatch(new g.Rb(this.props.vm.id,e,t))}},{key:"_keyboardShortcutFilter",value:function(e,t,n){return this._mouseenter&&"ctrl ctrl"!==n&&"ctrl"!==n}},{key:"_onKeyDown",value:function(e){this.props.onKeyDown&&this.props.onKeyDown(e),this._onKey(!0,e)}},{key:"_onKeyUp",value:function(e){this.props.onKeyUp&&this.props.onKeyUp(e),this._onKey(!1,e)}},{key:"_onKey",value:function(e,t){if((this.props.disableKeys||[]).indexOf(t)>=0)console.log("Key is disabled",t);else if(this.client){var n=this.client.getKeyboard();n?(n.modifiers.ctrl||n.modifiers.meta)&&n.modifiers.shift&&65505===t?console.log("HOTKEY detected (pressed: ".concat(e,")")):!n.modifiers.alt||65289!==t&&96!==t?this.client.sendKeyEvent(e,t):console.log("SWITCH TAB combination (pressed: ".concat(e,")")):console.log("Guac keyboard is not defined")}else console.error("Failed to send key over null client (pressed: ".concat(e,")"),t)}},{key:"_mouseHandler",value:function(e){if(this.props.onMouseEvent&&this.props.onMouseEvent(e),this.props.mouseDisabled)console.log("Mouse is disabled. Skip send mouse event");else if(this.client){var t=Object(a.a)({x:1,y:1},e);this.isBroadcastingCamera&&(t.left=!1,t.right=!1,t.middle=!1);var n=this.client.getDisplay(),r=n?n.getScale():1,o=r,i=r;this.props.scaleRatio&&(o=this.props.scaleRatio.scaleX,i=this.props.scaleRatio.scaleY),this.client.scaleX=o,this.client.scaleY=i,t.x/=o,t.y/=i,this.mousemove(t),t.x>this.props.width||t.y>this.props.height||t.x<0||t.y<0||this.client.sendMouseState(t)}else console.error("Failed to send mouse state over null client")}},{key:"_lockFor1Second",value:function(){var e=this;this._mouseenter&&(this._unbindControls(),setTimeout((function(){e._mouseenter&&e._bindControls()}),1e3))}},{key:"_removeScreenContent",value:function(){if(this.body)for(var e=0;e<this.body.children.length;e+=1)this.body.removeChild(this.body.children[e])}},{key:"isBroadcastingCamera",get:function(){return!!this.props.cameraStream}},{key:"isVmStarting",get:function(){return!this.props.vmAccessLimitReached&&(Object(k.a)(this.props.vm.state)||Object(k.b)(this.props.vm.state))}},{key:"showControls",get:function(){return!this.props.vmAccessLimitReached&&!Object(k.c)(this.props.vm.state)&&!this.isBroadcastingCamera&&this.props.controls&&this.props.asyncActions&&this.props.template&&this.props.template.os!==_.L.Docker&&(this.props.template.defaultTemplate||this.props.template.createdAt.getTime()>new Date(2018,8,1).getTime())}},{key:"zoomPointerDimensions",get:function(){if(!this.props.viewboxSize)return{width:0,height:0};var e=this.props.width/this.props.viewboxSize.width,t=this.props.height/this.props.viewboxSize.height;return{width:this.props.vm.width/e,height:this.props.vm.height/t}}}]),t}(j.Component),i.defaultProps={disableKeys:[],mouseMoveLockInterval:100,onScreenBlur:b.a,onScreenFocus:b.a,cursorScale:1,mouseDisabled:!1},o=s,Object(m.a)(o.prototype,"getBodyRef",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"getBodyRef"),o.prototype),Object(m.a)(o.prototype,"onMouseEnter",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"onMouseEnter"),o.prototype),Object(m.a)(o.prototype,"onMouseLeave",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"onMouseLeave"),o.prototype),Object(m.a)(o.prototype,"_updateResolution",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_updateResolution"),o.prototype),Object(m.a)(o.prototype,"_keyboardShortcutFilter",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_keyboardShortcutFilter"),o.prototype),Object(m.a)(o.prototype,"_onKeyDown",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_onKeyDown"),o.prototype),Object(m.a)(o.prototype,"_onKeyUp",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_onKeyUp"),o.prototype),Object(m.a)(o.prototype,"_mouseHandler",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_mouseHandler"),o.prototype),Object(m.a)(o.prototype,"_lockFor1Second",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"_lockFor1Second"),o.prototype),o)},1117:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,o=n(5),i=n(11),s=n(30),a=n(28),c=n(29),l=n(90),p=n(4),u=n(91),h=n.n(u),d=n(1085),m=n(289),y=(r=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"cancel",value:function(){this.props.onToggle(!1)}},{key:"resolveAndExit",value:function(){var e=this;this.props.onResolve().then((function(){return e.props.onToggle(!1)}))}},{key:"render",value:function(){return p.createElement(m.a,{title:"Are you sure?",visible:this.props.visible,onToggle:this.props.onToggle},p.createElement("div",{className:"leave-modal form-styles"},p.createElement("p",{className:"text"},this.props.text?"".concat(this.props.text," "):null,"Are you sure you want to leave?"),p.createElement("div",null,p.createElement(d.a,{onClick:this.cancel,className:"short-btn stay-btn"},"No")),p.createElement("div",null,p.createElement(d.a,{onClick:this.resolveAndExit,className:"short-btn empty leave-btn"},"Leave"))))}}]),t}(p.PureComponent),Object(l.a)(r.prototype,"cancel",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"cancel"),r.prototype),Object(l.a)(r.prototype,"resolveAndExit",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"resolveAndExit"),r.prototype),r)},1118:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r,o=n(5),i=n(11),s=n(30),a=n(28),c=n(29),l=n(90),p=n(91),u=n.n(p),h=n(4),d=n(1060),m=n(1089),y=function(e){return parseInt(e.replace("px","")||"0",10)},f=(r=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._splitter=void 0,n._leftCont=void 0,n._initialLayoutPerformed=!1,n._resizeObserver=void 0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentWillUnmount",value:function(){this._leftCont&&this._resizeObserver.unobserve(this._leftCont)}},{key:"onLeftContRef",value:function(e){e&&e instanceof Element&&(this._leftCont=e,this._resizeObserver=new d.a(this.adjustLayout),this._resizeObserver.observe(e))}},{key:"adjustLayout",value:function(){if(this._leftCont){var e=window.getComputedStyle(this._leftCont),t=y(e.width||"")-this._horizontalPadding,n=y(e.height||"")-this._verticalPadding,r=t/n,o=this._screenWidth/this._screenHeight,i=0,s=0;r<o?s=(i=Math.max(t,400*o))/o:i=(s=Math.max(n,400))*o;var a=i/this._screenWidth;this.setState({width:i,height:s,scaleX:a,scaleY:a}),this._initialLayoutPerformed||(this._initialLayoutPerformed=!0)}}},{key:"_horizontalPadding",get:function(){return 35}},{key:"_verticalPadding",get:function(){return 35}},{key:"rightPanelSize",get:function(){if(this._initialLayoutPerformed)return 0;var e=window.document.body,t=e.clientWidth,n=e.clientHeight;if(t-m.b<m.a)return t-m.a;var r=Math.max(n,400)*(this._screenWidth/this._screenHeight)-70+10;return Math.max(m.b,t-r)}}]),t}(h.PureComponent),Object(l.a)(r.prototype,"onLeftContRef",[u.a],Object.getOwnPropertyDescriptor(r.prototype,"onLeftContRef"),r.prototype),Object(l.a)(r.prototype,"adjustLayout",[u.a],Object.getOwnPropertyDescriptor(r.prototype,"adjustLayout"),r.prototype),r)},1119:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(19),o=n.n(r),i=n(47),s=n(44),a=n(45),c=n(98),l=n(296),p=n(215),u=function(e){return new Promise((function(t,n){return e.onstatechange=function(e){switch(e){case c.a.Connected:return t();case c.a.Disconnecting:case c.a.Disconnected:return n(new Error("Client could not connect. State ".concat(e)))}}}))},h=function(e){return new Promise((function(t){return e.onfilesystem=function(e,n){return t(new l.a(e,n))}}))},d=function(){var e=Object(s.a)(o.a.mark((function e(t){var n,r,s,c,l,d,m,y,f=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:0,r=f.length>2&&void 0!==f[2]?f[2]:0,e.next=4,Object(p.a)(t);case 4:return s=e.sent,c=new a.WebSocketTunnel(Object(p.b)(t,s,n,r)),(l=new a.Client(c)).connect(),e.next=10,Promise.all([u(l),h(l)]);case 10:return d=e.sent,m=Object(i.a)(d,2),y=m[1],e.abrupt("return",{client:l,tunnel:c,token:s,filesystem:y});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},1126:function(e,t,n){},1129:function(e,t,n){"use strict";var r,o=n(19),i=n.n(o),s=n(44),a=n(5),c=n(11),l=n(30),p=n(28),u=n(29),h=n(90),d=n(91),m=n.n(d),y=n(210),f=n.n(y),v=n(4),b=n(2),g=n(50),_=n(1119),k=n(123),O=function(){function e(t,n,r,o,i,s){Object(a.a)(this,e),this._guac=t,this._tunnelUUID=n,this._authToken=r,this._protocol=o,this._host=i,this._file=s,this._emitter=new g.EventEmitter,this._xhr=void 0}return Object(c.a)(e,[{key:"start",value:function(){var e=this,t=this._guac.createFileStream("application/zip",this._file.name);t.onack=function(){e._uploadFile(t),t.onack=null}}},{key:"onProgress",value:function(e){this._emitter.on(k.a.Progress,e)}},{key:"onCompleted",value:function(e){this._emitter.on(k.a.Completed,e)}},{key:"onError",value:function(e){this._emitter.on(k.a.Error,e)}},{key:"destroy",value:function(){this._emitter.off(k.a.Error),this._emitter.off(k.a.Completed),this._emitter.off(k.a.Progress),this._cancel()}},{key:"_uploadFile",value:function(e){var t=this,n=this._protocol+"://"+this._host+"/api/session/tunnels/"+this._tunnelUUID+"/streams/"+encodeURIComponent(e.index)+"/"+encodeURIComponent(Object(k.d)(this._file.name))+"?token="+encodeURIComponent(this._authToken),r=new XMLHttpRequest;r.withCredentials=!0,this._xhr=r,r.upload&&r.upload.addEventListener("progress",(function(e){t._emitter.emit(k.a.Progress,{current:e.loaded,total:t._file.size})})),r.onreadystatechange=function(){4===r.readyState&&(r.status>=200&&r.status<300?(t._guac.endStream(e.index),t._emitter.emit(k.a.Completed)):"application/json"===r.getResponseHeader("Content-Type")?t._emitter.emit(k.a.Error,r.responseText):r.status>=400&&r.status<500?t._emitter.emit(k.a.Error,"Stream error"):t._emitter.emit(k.a.Error,"HTTP "+r.status))},r.open("POST",n,!0),r.setRequestHeader("content-type","application/zip"),r.send(this._file)}},{key:"_cancel",value:function(){this._xhr&&this._xhr.abort()}}]),e}(),w=function(){var e=Object(s.a)(i.a.mark((function e(t,n,r){var o,s,a,c,l,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.a)(t);case 2:return o=e.sent,s=o.client,a=o.tunnel,c=o.token,(l=new O(s,a.uuid,c,t.protocol,t.host,n)).onProgress(r||f.a),l.start(),p=new Promise((function(e,t){l.onCompleted((function(){s.disconnect(),e()})),l.onError((function(e){s.disconnect(),t(new Error(e))}))})),e.abrupt("return",{promise:p,abort:function(){return l.destroy()}});case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),C=n(0),E=n(1136);n.d(t,"a",(function(){return j}));var j=(r=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={files:[],currentFile:0,currentProgress:0,inProgress:!1,done:!1,abortUpload:f.a},n._fileUploader=void 0,n._onUploadError=function(){n.props.dispatch(new b.i(new C.J({type:C.K.Error,ttl:1e4,title:"Error",text:'Something went wrong while uploading your files. Please, try again. If the issue persists, you can try [ufile.io](https://ufile.io){target="_blank"}'}))),n.props.onError&&n.props.onError()},n._trackUploadProgress=function(e){var t=new Array(e).fill(0);return function(e){return function(r){t[e]=r.current/r.total;var o=t.reduce((function(e,t){return e+t}))/t.length;n.setState({currentProgress:o}),n.props.onProgress&&n.props.onProgress(r)}}},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return v.createElement(E.a,{ref:function(t){return e._fileUploader=t},currentFile:this.state.currentFile,currentProgress:this.state.currentProgress,uploadIcon:this.props.uploadIcon,done:this.state.done,files:this.state.files,label:this.props.label,disabled:this.props.disabled,dispatch:this.props.dispatch,filters:{maxSize:104857600,minSize:1},onCancel:this._cancel,onFiles:this._onFiles})}},{key:"_onFiles",value:function(e){var t=this;this.props.onUploadStart&&this.props.onUploadStart(),this.setState({files:this.state.files.concat(e)},(function(){t.state.inProgress||t._nextFile()})),console.log("Uploading %d files",e.length)}},{key:"_nextFile",value:function(){var e=this,t=this.state.currentFile;if(t<this.state.files.length){var n=function(){return e._uploadFile(e.state.files[t]).then((function(){setTimeout((function(){return e._nextFile()}),1e3)}))};this.state.done?this.setState({done:!1},n):n()}else this.setState({done:!0}),this._fileUploader&&this._fileUploader.resetUploadArea(),this.props.onCompleted&&this.props.onCompleted(),this.props.dispatch(new b.i(new C.J({type:C.K.General,title:"Files uploaded",text:"Your files were successfully uploaded"})))}},{key:"_uploadFile",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r,o,s,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({currentProgress:0,inProgress:!0,currentFile:this.state.currentFile+1}),e.prev=1,e.next=4,"function"===typeof this.props.vms?this.props.vms():this.props.vms;case 4:return n=e.sent,r=this._trackUploadProgress(n.length),e.next=8,Promise.all(n.map((function(e,n){return w(e.connection,t,r(n))})));case 8:return o=e.sent,s=o.reduce((function(e,t){var n=t.promise;return e.then((function(){return n}))}),Promise.resolve()),a=function(){return o.forEach((function(e){return e.abort()}))},this.setState({inProgress:!1,abortUpload:a}),e.next=14,s;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),this._onUploadError();case 19:case"end":return e.stop()}}),e,this,[[1,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_cancel",value:function(){this.state.abortUpload(),this.setState({files:[],inProgress:!1,currentFile:0,currentProgress:0}),this._fileUploader&&this._fileUploader.resetUploadArea(),this.props.onCompleted&&this.props.onCompleted()}}]),t}(v.PureComponent),Object(h.a)(r.prototype,"_onFiles",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"_onFiles"),r.prototype),Object(h.a)(r.prototype,"_cancel",[m.a],Object.getOwnPropertyDescriptor(r.prototype,"_cancel"),r.prototype),r)},1130:function(e,t,n){"use strict";var r,o,i,s=n(47),a=n(5),c=n(11),l=n(30),p=n(28),u=n(29),h=n(90),d=n(3),m=n(4),y=(n(1210),n(91)),f=n.n(y),v=n(2),b=n(14),g=n(0),_=n(133),k=n(1045),O=n(1064),w={incomplete_number:"Your card number is incomplete.",incomplete_expiry:"Your card's expiration date is incomplete.",invalid_number:"The card number is not a valid credit card number.",invalid_expiry_month:"The card's expiration month is invalid.",invalid_expiry_year:"The card's expiration year is invalid.",invalid_cvc:"The card's security code is invalid.",invalid_swipe_data:"The card's swipe data is invalid.",incorrect_number:"The card number is incorrect.",expired_card:"The card has expired.",incorrect_cvc:"The card's security code is incorrect.",incorrect_zip:"The card's zip code failed validation.",card_declined:"The card was declined.",missing:"There is no card on a customer that is being charged.",processing_error:"An error occurred while processing the card."};n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return S})),function(e){e[e.CreditCard=0]="CreditCard",e[e.RhymeCard=1]="RhymeCard"}(i||(i={}));var C=function(e){return"99"===e.substr(0,2)?i.RhymeCard:i.CreditCard},E=" ".concat("/"," "),j=(r={},Object(d.a)(r,g.m.Visa,m.createElement("div",{className:"card-icon cc-visa"})),Object(d.a)(r,g.m.MasterCard,m.createElement("div",{className:"card-icon cc-mastercard"})),Object(d.a)(r,g.m.Amex,m.createElement("div",{className:"card-icon cc-amex"})),Object(d.a)(r,g.m.DinersClub,m.createElement("div",{className:"card-icon cc-diners"})),Object(d.a)(r,g.m.Discover,m.createElement("div",{className:"card-icon cc-discover"})),Object(d.a)(r,g.m.JCB,m.createElement("div",{className:"card-icon cc-jcb"})),Object(d.a)(r,g.m.Rhyme,m.createElement("div",{className:"card-icon rhyme-card"})),Object(d.a)(r,g.m.Unknown,null),r),S=(o=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(l.a)(this,Object(p.a)(t).call(this,e)))._cardType=i.CreditCard,n._cardMonth=void 0,n._cardYear=void 0,n._startCaretPosCache=0,n._initialCardNumber=void 0,n._initialCardExpiry=void 0,n._removableLeadZero=void 0,n.state={brand:g.m.Unknown,loading:!1,cardNumber:"",cardExpiry:"",cardType:i.CreditCard,validNumber:!1,validExpiry:!1,numberFocus:!1,expiryFocus:!1,numberDirty:!1,expiryDirty:!1},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){Stripe.setPublishableKey(b.a.StripeKey),this.props.onRef&&this.props.onRef(this),this.props.card&&this._setCardFromProps(this.props.card)}},{key:"componentWillReceiveProps",value:function(e){var t=e.card;!t||this._initialCardNumber||this._initialCardExpiry||this._setCardFromProps(t)}},{key:"onCardNumberChange",value:function(e){var t=this._clearIfFromProps(e.target.value),n=this._formatCardNumber(t);this.setState({cardNumber:n});var r=e.target,o=r.selectionStart,a=r.selectionEnd;e.target.value=n,this._updateCaret(4," ".length,e.target,o,a);var c,l=C(n);this.props.onCardTypeChange&&l!==this._cardType&&(this.props.onCardTypeChange(l),this._cardType=l);var p=this.state.cardExpiry.split(E),u=Object(s.a)(p,2),h=u[0],d=u[1],m=Stripe.card.validateExpiry(h,d);switch(m||(c=!0),l){case i.CreditCard:default:this.setState({numberDirty:!0,expiryDirty:c||this.state.expiryDirty,validNumber:Stripe.card.validateCardNumber(n),validExpiry:m,brand:Stripe.card.cardType(n)},this._onUpdate);break;case i.RhymeCard:var y=!Object(O.o)({card:n}).card;this.setState({numberDirty:!0,expiryDirty:c||this.state.expiryDirty,validNumber:y,validExpiry:m,brand:g.m.Rhyme},this._onUpdate)}}},{key:"onCardExpiryChange",value:function(e){var t=e.target.value,n=this._leadingZeroExpiry(t,this._removableLeadZero);if(n){t=n.value,this._removableLeadZero=n.removable;var r=this._formatCardExpiry(t),o=e.target;this.setState({cardExpiry:r});var a=o.selectionStart,c=o.selectionEnd;o.value=r,this._updateCaret(2,E.length+1,o,a,c);var l=r.split(E),p=Object(s.a)(l,2),u=p[0],h=p[1];this._cardMonth=u,this._cardYear=h;var d=this.state.cardNumber,m=C(d)===i.CreditCard?Stripe.card.validateCardNumber(d):Object(O.o)(d);this.setState({expiryDirty:!0,numberDirty:!0,validExpiry:Stripe.card.validateExpiry(this._cardMonth,this._cardYear),validNumber:m},this._onUpdate)}}},{key:"submitInfo",value:function(e){e.preventDefault(),this.submit()}},{key:"submit",value:function(e){switch(C(this.state.cardNumber)){case i.CreditCard:default:this._submitCreditCard(e);break;case i.RhymeCard:this._submitRhymeCard(e)}}},{key:"clear",value:function(){this.setState({brand:g.m.Unknown,cardNumber:"",cardExpiry:""})}},{key:"reset",value:function(){this.props.card?this._setCardFromProps(this.props.card):this.clear()}},{key:"renderCCBrand",value:function(){var e=j[this.state.brand],t=this.props.card,n=this.state.brand===g.m.Rhyme&&this.state.cardNumber.startsWith("**")&&!this.isExpired;return m.createElement(m.Fragment,null,e,t&&t.id&&n?m.createElement("div",{className:"card-amount"},"Balance: $",Object(_.b)(t.amount)):null)}},{key:"numberError",value:function(){var e="";return this.isNumberInvalid?e="Invalid number":this.isExpired&&(e=" "),e}},{key:"expiryError",value:function(){var e="";return this.isExpiryInvalid?e="Invalid expiry":this.isExpired&&(e="Card expired"),e}},{key:"focusNumber",value:function(){this.setState({numberFocus:!0})}},{key:"blurNumber",value:function(){this.setState({numberFocus:!1})}},{key:"focusExpiry",value:function(){this.setState({expiryFocus:!0})}},{key:"blurExpiry",value:function(){this.setState({expiryFocus:!1})}},{key:"render",value:function(){return m.createElement("div",{className:"universal-card-form"},m.createElement("form",{onSubmit:this.submitInfo},m.createElement("div",null,m.createElement(k.k,{type:"text",label:"Card Number",name:"card",autoComplete:"off",onChange:this.onCardNumberChange,onFocus:this.focusNumber,onBlur:this.blurNumber,value:this.state.cardNumber,placeholder:"1234 1234 1234 1234",maxLength:19,ignoreLastPass:!0,error:this.numberError()}),m.createElement(k.k,{type:"text",label:"Card Expiry",name:"expiry",autoComplete:"off",onChange:this.onCardExpiryChange,onFocus:this.focusExpiry,onBlur:this.blurExpiry,value:this.state.cardExpiry,placeholder:"MM / YY",ignoreLastPass:!0,error:this.expiryError()})),!this.props.hideSaveButton&&m.createElement(k.a,{loading:this.state.loading,disabled:!this.isFormValid},"Save")),this.renderCCBrand())}},{key:"_formatCardNumber",value:function(e){return e=e.replace(/[^0-9]/g,""),Object(_.e)(e,4," ")}},{key:"_formatCardExpiry",value:function(e){return 3===(e=e.replace(/[^0-9/]/g,"")).length&&"/"===e[2]?e.substr(0,2)+E:(e=e.replace(/[^0-9]/g,""),Object(_.e)(e,2,E))}},{key:"_submitCreditCard",value:function(e){var t=this;this.setState({loading:!0});var n=this.state.cardNumber.replace(/\s/g,"");Stripe.card.createToken({number:n,exp_month:this._cardMonth,exp_year:this._cardYear},(function(n,r){if(r.error)t.props.dispatch(new v.i(new g.J({type:g.K.Error,text:w[r.error.code]||r.error.message}))),t.props.onStripeError&&t.props.onStripeError(),t.setState({loading:!1});else{var o=t._createCard(r);t.props.onCardSave(o,!!e).catch((function(){return t.setState({loading:!1})}))}}))}},{key:"_submitRhymeCard",value:function(e){var t=this,n=this.state.cardNumber.replace(/\s/g,""),r={last4:n.substring(n.length-4,n.length),exp_month:parseInt(this._cardMonth,10),exp_year:parseInt("20"+this._cardYear,10),brand:g.m.Rhyme},o=this._createCard({id:n,card:r});this.props.onCardSave(o,!!e).catch((function(){return t.setState({loading:!1})}))}},{key:"_updateCaret",value:function(e,t,n,r,o){for(var i=0,s=e+=1;s<r+e;s+=e)r<this._startCaretPosCache&&r===s+t-1?i=-1*t:r===s&&(i=t);this._startCaretPosCache=r,n.setSelectionRange(r+i,o+i)}},{key:"_onUpdate",value:function(e,t){this.props.onUpdate&&this.props.onUpdate({card:this.state.cardNumber,expiry:this.state.cardExpiry,valid:e||this.isFormValid,pristine:t||this.pristine,brand:this.state.brand})}},{key:"_createCard",value:function(e){var t=e.id,n=e.card;return new g.l({customer:t,lastFour:n.last4,brand:n.brand,expiryMonth:n.exp_month,expiryYear:n.exp_year})}},{key:"_setCardFromProps",value:function(e){this._initialCardNumber="**** **** **** ".concat(e.lastFour),this._initialCardExpiry=function(e,t){var n=e.toString();return 1===n.length&&(n="0"+n),n+" / "+t.toString().substr(2,2)}(e.expiryMonth,e.expiryYear),this._cardMonth=e.expiryMonth.toString(),this._cardYear=e.expiryYear.toString().substr(2,2),this.setState({cardNumber:this._initialCardNumber,cardExpiry:this._initialCardExpiry,brand:e.brand,validNumber:!0,validExpiry:!0,numberDirty:!1,expiryDirty:!1})}},{key:"_clearIfFromProps",value:function(e){return-1!==e.indexOf("*")?"":e}},{key:"_leadingZeroExpiry",value:function(e,t){if(e.length>7){if("0"!==e[0]||!t)return null;var n=e.split("");n.shift(),e=n.join("")}else 3===e.length&&"0"!==e[0]&&"/"!==e[2]?(e="0"+e,t=!0):2===e.length&&"/"===e[1]?e="0"+e:e||(t=!1);return{value:e,removable:t}}},{key:"isFormValid",get:function(){return this.state.validNumber&&this.state.validExpiry}},{key:"isNumberInvalid",get:function(){var e=this.state;return e.numberDirty&&!e.numberFocus&&!e.validNumber}},{key:"isExpiryInvalid",get:function(){var e=this.state;return e.expiryDirty&&!e.expiryFocus&&!e.validExpiry}},{key:"isExpired",get:function(){var e=this.props.card;if(e&&this.pristine){var t=new Date(e.expiryYear,e.expiryMonth).getTime();return Date.now()>t}return!1}},{key:"pristine",get:function(){var e=this.state.cardNumber!==this._initialCardNumber,t=this.state.cardExpiry!==this._initialCardExpiry;return!(e||e&&t)}}]),t}(m.Component),Object(h.a)(o.prototype,"onCardNumberChange",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"onCardNumberChange"),o.prototype),Object(h.a)(o.prototype,"onCardExpiryChange",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"onCardExpiryChange"),o.prototype),Object(h.a)(o.prototype,"submitInfo",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"submitInfo"),o.prototype),Object(h.a)(o.prototype,"focusNumber",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"focusNumber"),o.prototype),Object(h.a)(o.prototype,"blurNumber",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"blurNumber"),o.prototype),Object(h.a)(o.prototype,"focusExpiry",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"focusExpiry"),o.prototype),Object(h.a)(o.prototype,"blurExpiry",[f.a],Object.getOwnPropertyDescriptor(o.prototype,"blurExpiry"),o.prototype),o)},1132:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,o=n(51),i=n(5),s=n(11),a=n(30),c=n(28),l=n(29),p=n(90),u=n(4),h=(n(1177),n(91)),d=n.n(h),m=(r=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e)))._mouseStart=0,n.state={pulled:!0,pulling:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this._onDocumentMouseMove),document.addEventListener("mouseup",this._onDocumentMouseUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this._onDocumentMouseMove),document.removeEventListener("mouseup",this._onDocumentMouseUp)}},{key:"onPullerMouseDown",value:function(e){this._mouseStart=e.clientY,this.setState({pulling:!0})}},{key:"render",value:function(){return u.createElement("div",{className:"bottom-bar"+(this.state.pulled?" pulled":"")+(this.props.width&&this.props.width<250?" hidden":""),onMouseDown:function(e){return e.stopPropagation()}},u.createElement("div",{className:"frame"}),u.createElement("div",{className:"container",style:Object(o.a)({},this.props.width?{width:this.props.width+2}:{})},u.createElement("div",{className:"puller"+(this.state.pulling?" pulling":""),onMouseDown:this.onPullerMouseDown}),u.createElement("div",{className:"content"},u.createElement("div",{className:"logo"}),u.createElement("div",{className:"children"+(this.state.pulled?" visible":"")},this.props.children))))}},{key:"_onDocumentMouseMove",value:function(e){if(this.state.pulling){var t=e.clientY-this._mouseStart;t>=30?this.setState({pulled:!1}):t<=-30&&this.setState({pulled:!0})}}},{key:"_onDocumentMouseUp",value:function(e){var t=e.clientY-this._mouseStart===0;this.setState({pulling:!1,pulled:t?!this.state.pulled:this.state.pulled})}}]),t}(u.PureComponent),Object(p.a)(r.prototype,"onPullerMouseDown",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onPullerMouseDown"),r.prototype),Object(p.a)(r.prototype,"_onDocumentMouseMove",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"_onDocumentMouseMove"),r.prototype),Object(p.a)(r.prototype,"_onDocumentMouseUp",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"_onDocumentMouseUp"),r.prototype),r)},1133:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),o=n(11),i=n(30),s=n(28),a=n(29),c=n(4),l=n(97),p=(n(1178),function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a)))).state={keys:[],down:{}},n}return Object(a.a)(t,e),Object(o.a)(t,[{key:"onKey",value:function(e){if(e){var t=l.a.fromKeySym(e.keyCode);if(t)if(e.down){var n=this.state,r=n.keys,o=n.down;r.push(t),r.length>50&&r.shift(),o[e.keyCode]=[t,Date.now()],this.setState({keys:r,down:o})}else{var i=this.state.down;i[e.keyCode]&&(delete i[e.keyCode],this.setState({down:i}))}}}},{key:"reset",value:function(){this.setState({keys:[],down:{}})}},{key:"render",value:function(){return c.createElement("div",{className:"caption-player"},c.createElement("div",{className:"caption-wrapper"},this.caption),this.keysDown.length?c.createElement("div",{className:"pinned"},this.keysDown):null,c.createElement("div",{className:"keyboard tooltip rel l","data-tooltip":this.props.tooltip||"The keys being pressed in the task video"}))}},{key:"keysDown",get:function(){var e=Date.now(),t=this.state.down;return Object.keys(t).map((function(e){return t[e]})).filter((function(t){return t[1]<e-500})).map((function(e,t){return c.createElement("span",{key:"pk-"+t},e[0].label)}))}},{key:"caption",get:function(){return this.state.keys.map((function(e,t){return c.createElement("span",{key:"ck-"+t},e.label)}))}}]),t}(c.Component))},1134:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),o=n(11),i=n(30),s=n(28),a=n(29),c=n(4),l=(n(1183),function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(a.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e={width:100*this.progress+"%",backgroundColor:this.props.color};return c.createElement("div",{className:"progress-bar-wrapper  "+this.props.type+(this.props.className||"")},c.createElement("div",{style:e,className:"progress-bar-progress"}))}},{key:"progress",get:function(){return this.props.progress<1?this.props.progress:1}}]),t}(c.Component));l.defaultProps={type:"regular"}},1135:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,o=n(5),i=n(11),s=n(30),a=n(28),c=n(29),l=n(90),p=n(4),u=(n(1188),n(91)),h=n.n(u),d=n(14),m=n(1092),y=n(1113),f=n(1118),v=n(1089),b=(r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._overlayCont=void 0,n.state={width:400,height:400,scaleX:1,scaleY:1,detailsInitialSize:370,overlayContHasChildren:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.vm,r=t.controls,o=e.vm,i=e.controls;if((n&&(n&&!o||o&&n.width!==o.width||o&&n.height!==o.height)||r&&!i)&&this.adjustLayout(),this._overlayCont){var s=this._overlayCont.childNodes.length>0;this.setState({overlayContHasChildren:s})}}},{key:"onResize",value:function(e,t){this.adjustLayout(),this.props.onResize&&this.props.onResize(e,t)}},{key:"render",value:function(){var e=this;return p.createElement(v.c,{ref:function(t){return e._splitter=t},onResize:this.onResize,onResizeStart:this.props.onResizeStart,onResizeEnd:this.props.onResizeEnd,onPanelsRefs:this.props.onPanelsRefs,rightPanelInitialSize:this.rightPanelSize,className:"split-screen"+(this.props.className?" "+this.props.className:"")},this.props.vm?p.createElement(p.Fragment,null,p.createElement("div",{className:"balance"}),p.createElement("div",{className:"left-container",ref:this.onLeftContRef},this.props.overlay&&p.createElement("div",{ref:function(t){return e._overlayCont=t},className:"overlay-cont"+(this.state.overlayContHasChildren?" has-children":""),style:{width:this.state.width,height:this.state.height}},this.props.overlay),p.createElement(m.a,{originalWidth:this.props.vm.width,originalHeight:this.props.vm.height,scaledWidth:this.state.width-8},p.createElement(y.a,{onKeyDown:this.props.onEvent,onKeyUp:this.props.onEvent,onMouseEvent:this.props.onEvent,vm:this.props.vm,template:this.props.template,isViewExpanded:this.props.isViewExpanded,showViewbox:this.props.showViewbox,viewboxSize:this.props.viewboxSize,width:this.props.vm.width,height:this.props.vm.height,cursorPosition:this.props.cursorPosition,emitCursor:this.props.emitCursor,scaleRatio:{scaleX:this.state.scaleX,scaleY:this.state.scaleY},onReadWriteInit:this.props.onReadWriteInit,onConnect:this.props.onConnect,onDisconnect:this.props.onDisconnect,readOnly:this.props.readOnly,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,controls:this.props.controls,cameraStream:this.props.cameraStream,vmAccessLimitReached:this.props.vmAccessLimitReached}))),this.props.leftPanelChildren?this.props.leftPanelChildren:p.createElement("div",{className:"balance"})):null,p.createElement(p.Fragment,null,this.props.children))}},{key:"_screenWidth",get:function(){return this.props.vm?this.props.vm.width:d.a.DefaultScreenWidth}},{key:"_screenHeight",get:function(){return this.props.vm?this.props.vm.height:d.a.DefaultScreenHeight}},{key:"_verticalPadding",get:function(){return 75}}]),t}(f.a),Object(l.a)(r.prototype,"onResize",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onResize"),r.prototype),r)},1136:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,o=n(5),i=n(11),s=n(30),a=n(28),c=n(29),l=n(90),p=n(4),u=(n(1189),n(91)),h=n.n(u),d=n(2),m=n(0),y=n(1134),f=n(1137),v={minSize:{msg:function(e){return"the minimal file size is ".concat(e/1048576,"MB")},filter:function(e,t){return e.size<t}},maxSize:{msg:function(e){return"the maximal file size is ".concat(e/1048576,"MB")},filter:function(e,t){return e.size>t}},types:{msg:function(e){return"the allowed file type".concat(1!==e.length?"s":""," ").concat(1!==e.length?"are":"is"," ")+"".concat(e.map((function(e){return e.split("/").pop()})).join(", "))},filter:function(e,t){return-1===t.indexOf(e.type)}}},b=(r=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._uploadArea=void 0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"resetUploadArea",value:function(){this._uploadArea&&this._uploadArea.reset()}},{key:"onFiles",value:function(e){if(!this.props.disabled&&e&&e.length){var t,n=[].slice.call(e),r=(t=this.props.dispatch,function(e,n){t(new d.i(new m.J({type:m.K.Error,ttl:1e4,title:e,text:n})))}),o=this.props.fileLimit;if(void 0!==o&&n.length>o)r("File number limit reached","You cannot upload more than ".concat(o," file").concat(1!==o?"s":""));else{var i=this.props.filters;if(i){var s=[];Object.keys(i).forEach((function(e){var t=i[e];if(void 0!==t){var n=v[e],r={filter:function(e){return n.filter(e,t)},msg:n.msg(t)};s.push(r)}}));var a=function(e){return function(t){return e.map((function(e){return e(t)})).reduce((function(e,t){return e||t}))}}(s.map((function(e){return e.filter}))),c=n.filter(a).map((function(e){return s.map((function(t){return t.filter(e)?t.msg:void 0})).filter((function(e){return!!e}))})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e,t,n){return n.indexOf(e)===t}));if(c.length)return void r("Cannot upload file".concat(1!==n.length?"s":""),"Because "+c.join("; "))}this.props.onFiles(n)}}}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"file-uploader"+(this.props.disabled?" disabled":"")},p.createElement(f.a,{ref:function(t){return e._uploadArea=t},allowSameFileSelection:!0,uploadIcon:this.props.uploadIcon,onFiles:this.onFiles},this.props.files.length&&!this.props.done?p.createElement("div",null,"File ",this.props.currentFile,"/",this.props.files.length,p.createElement(y.a,{className:this.props.onCancel?"":" full-width",progress:this.props.currentProgress}),this.props.onCancel&&p.createElement("i",{className:"fa fa-times cancel",onClick:this.props.onCancel})):p.createElement("div",null,this.props.done?this.props.filesUploadedLabel||"All files uploaded":this.props.label||"Upload files here")))}}]),t}(p.PureComponent),Object(l.a)(r.prototype,"onFiles",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onFiles"),r.prototype),r)},1137:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,o=n(5),i=n(11),s=n(30),a=n(28),c=n(29),l=n(90),p=n(4),u=(n(1190),n(91)),h=n.n(u),d=function(){},m=(r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._input=void 0,n.state={dragOver:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"onFilesFromDrop",value:function(e){this.onDragLeave(e),this.props.onFiles(e.dataTransfer.files)}},{key:"onDragOver",value:function(e){e.preventDefault(),this.setState({dragOver:!0})}},{key:"onDragLeave",value:function(e){e.preventDefault(),this.setState({dragOver:!1})}},{key:"onFilesFromInput",value:function(e){this.props.onFiles(e.target.files)}},{key:"reset",value:function(){this._input&&(this._input.value="")}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"drop-upload-area"+(this.state.dragOver?" active":""),onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onFilesFromDrop},p.createElement("input",{ref:function(t){return e._input=t},className:"area",type:"file",onChange:this.onFilesFromInput,onClick:this.props.allowSameFileSelection?this.reset:d}),this.props.uploadIcon?this.props.uploadIcon:p.createElement("div",{className:"upload-icon"}),p.createElement("span",{className:"ua-content"},this.props.children))}}]),t}(p.Component),Object(l.a)(r.prototype,"onFilesFromDrop",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onFilesFromDrop"),r.prototype),Object(l.a)(r.prototype,"onDragOver",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onDragOver"),r.prototype),Object(l.a)(r.prototype,"onDragLeave",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onDragLeave"),r.prototype),Object(l.a)(r.prototype,"onFilesFromInput",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"onFilesFromInput"),r.prototype),Object(l.a)(r.prototype,"reset",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"reset"),r.prototype),r)},1138:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,o=n(5),i=n(11),s=n(30),a=n(28),c=n(29),l=n(90),p=n(4),u=n(91),h=n.n(u),d=n(1348),m=(n(1195),r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._clipboard=void 0,n._button=void 0,n.state={showTooltip:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._clipboard||(this._clipboard=new d(this._button,{text:function(){return e.props.value}}),this._clipboard.on("success",(function(t){e.setState({showTooltip:!0}),t.clearSelection()})))}},{key:"componentWillUnmount",value:function(){this._clipboard&&(this._clipboard.destroy(),this._clipboard=null)}},{key:"render",value:function(){return p.createElement("div",{ref:this._onButtonRef,className:this.className,onMouseLeave:this._onMouseLeave,"aria-label":"Copied!","data-tooltip":"Copied!"},this.props.children)}},{key:"_onButtonRef",value:function(e){this._button=e}},{key:"_onMouseLeave",value:function(){this.setState({showTooltip:!1})}},{key:"className",get:function(){var e="clipboard";return this.props.className&&(e+=" ".concat(this.props.className)),this.state.showTooltip&&(e+=" tooltip rel r"),this.props.disabled&&(e+=" disabled"),e}}]),t}(p.PureComponent),Object(l.a)(r.prototype,"_onButtonRef",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"_onButtonRef"),r.prototype),Object(l.a)(r.prototype,"_onMouseLeave",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"_onMouseLeave"),r.prototype),r)},1153:function(e,t,n){},1154:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r,o=n(5),i=n(11),s=n(30),a=n(28),c=n(29),l=n(90),p=n(4),u=n(91),h=n.n(u),d=n(1079),m=(n(1155),n(1156)),y=n(1157),f=(r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).state={backgroundWrapper:void 0},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement(p.Fragment,null,p.createElement("div",{className:"unsupported-recording",ref:this._onWrapperRef},p.createElement("div",{className:"content"},p.createElement("div",{className:"header"},p.createElement("div",{className:"logo"}),this.props.onBack&&p.createElement("h2",null,p.createElement("i",{className:"fa fa-chevron-left back-btn",onClick:this.props.onBack}))),p.createElement("div",{className:"view"},p.createElement("h1",null,this.props.title),p.createElement("p",{className:"sub-title"},this.props.description),p.createElement("div",{className:"browsers"},p.createElement("a",{href:"https://www.google.com/chrome/browser/desktop/index.html",target:"_blank"},p.createElement("span",{className:"title"},"Chrome"),p.createElement("img",{src:m}),p.createElement("span",{className:"ver"},"59+")),p.createElement("a",{href:"https://www.mozilla.org/en-US/firefox/",target:"_blank"},p.createElement("span",{className:"title"},"Firefox"),p.createElement("img",{src:y}),p.createElement("span",{className:"ver"},"54+"))),this.props.onBack&&p.createElement("a",{href:"javascript:void(0);",className:"go-back",onClick:this.props.onBack},"Go Back"))),p.createElement("div",{className:"header-separator"})),this.state.backgroundWrapper?p.createElement(d.a,{overflow:"hidden",wrapper:this.state.backgroundWrapper}):null)}},{key:"_onWrapperRef",value:function(e){!this.state.backgroundWrapper&&e&&this.setState({backgroundWrapper:e})}}]),t}(p.Component),Object(l.a)(r.prototype,"_onWrapperRef",[h.a],Object.getOwnPropertyDescriptor(r.prototype,"_onWrapperRef"),r.prototype),r)},1155:function(e,t,n){},1156:function(e,t,n){e.exports=n.p+"static/media/Chrome.f3b6c54c.svg"},1157:function(e,t,n){e.exports=n.p+"static/media/Firefox.e037fac5.svg"},1163:function(e,t,n){},1164:function(e,t,n){},1165:function(e,t,n){},1166:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return f}));var r,o,i=n(5),s=n(11),a=n(30),c=n(28),l=n(29),p=n(90),u=n(4),h=(n(1167),n(91)),d=n.n(h),m=n(1045),y=n(1051);!function(e){e[e.DisabledCamera=0]="DisabledCamera",e[e.EnabledCamera=1]="EnabledCamera",e[e.BroadcastedCamera=2]="BroadcastedCamera"}(o||(o={}));var f=(r=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(a.a)(this,Object(c.a)(t).call(this,e)))._video=void 0,n.state={isLoadingCamera:!1},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.cameraStream!==e.cameraStream&&this._video&&(this._video.srcObject=this.props.cameraStream)}},{key:"onDisabledCameraAction",value:function(){this.setState({isLoadingCamera:!0}),this.props.onDisabledCameraAction()}},{key:"onVideoRef",value:function(e){this._video=e}},{key:"render",value:function(){return u.createElement("div",{className:"webcam-thumb"},u.createElement("div",{className:"thumb"},this.renderThumb()),this.thumbLabel&&u.createElement("div",{className:"label"},this.thumbLabel))}},{key:"renderThumb",value:function(){switch(this.props.view){case o.DisabledCamera:return this.renderDisabledCamera();case o.EnabledCamera:return this.renderCamera();case o.BroadcastedCamera:return this.renderBroadcastedCamera();default:return null}}},{key:"renderDisabledCamera",value:function(){return u.createElement(u.Fragment,null,u.createElement(m.b,{className:"empty enable-webcam-btn",disabled:this.props.disabled,onClick:this.onDisabledCameraAction},this.props.labels.disabledCameraButton),this.props.error?u.createElement("span",{className:"webcam-error"},this.props.error):u.createElement(u.Fragment,null,u.createElement("span",{className:"description"+(this.props.disabled?" disabled":"")},this.props.labels.disabledCameraDescription),this.props.disabled?u.createElement("span",{className:"disabled-label"},this.props.labels.disabledLabel):null))}},{key:"renderCamera",value:function(){return this.props.cameraStream?u.createElement(u.Fragment,null,u.createElement(y.a,null),u.createElement("video",{ref:this.onVideoRef,autoPlay:!0,onLoadedMetadata:this._onLoadedMetadata}),this.state.isLoadingCamera?null:u.createElement("div",{className:"camera-options"},u.createElement(m.b,{className:"empty broadcast-webcam-btn",disabled:this.props.disabled,onClick:this.props.onEnabledCameraAction},this.props.labels.enabledCameraButton),u.createElement("span",{className:"description"},this.props.labels.enabledCameraDescription))):null}},{key:"renderBroadcastedCamera",value:function(){return u.createElement(u.Fragment,null,u.createElement(m.b,{className:"empty broadcast-vm-btn",disabled:this.props.disabled,onClick:this.props.onBroadcastedCameraAction},this.props.labels.broadcastedCameraButton),u.createElement("span",{className:"description"},this.props.labels.broadcastedCameraDescription))}},{key:"_onLoadedMetadata",value:function(){this.setState({isLoadingCamera:!1})}},{key:"thumbLabel",get:function(){switch(this.props.view){case o.DisabledCamera:return this.props.labels.disabledCameraLabel;case o.EnabledCamera:return this.props.labels.enabledCameraLabel;case o.BroadcastedCamera:return this.props.labels.broadcastedCameraLabel;default:return""}}}]),t}(u.PureComponent),Object(p.a)(r.prototype,"onDisabledCameraAction",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onDisabledCameraAction"),r.prototype),Object(p.a)(r.prototype,"onVideoRef",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"onVideoRef"),r.prototype),Object(p.a)(r.prototype,"_onLoadedMetadata",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"_onLoadedMetadata"),r.prototype),r)},1167:function(e,t,n){},1168:function(e,t,n){},1169:function(e,t,n){},1170:function(e,t,n){},1171:function(e,t,n){},1172:function(e,t,n){},1173:function(e,t,n){},1174:function(e,t,n){},1175:function(e,t,n){},1176:function(e,t,n){},1177:function(e,t,n){},1178:function(e,t,n){},1179:function(e,t,n){},1180:function(e,t,n){},1181:function(e,t,n){},1182:function(e,t,n){},1183:function(e,t,n){},1184:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(5),o=n(11),i=n(30),s=n(28),a=n(29),c=n(4),l=n(1065),p=(n(1185),function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e)))._player=void 0,n.state={input:void 0,expandModeData:void 0,loading:!1},n}return Object(a.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.chapter,t=e.inputUrl,n=e.expandModeUrl;this._loadData(t,n)}},{key:"componentDidUpdate",value:function(e){this.props.chapter.inputUrl===e.chapter.inputUrl||this.props.chapter.expandModeUrl===e.chapter.expandModeUrl&&this.props.chapter.expandModeUrl||this._loadData(this.props.chapter.inputUrl,this.props.chapter.expandModeUrl)}},{key:"play",value:function(){return this._player?this._player.play():Promise.reject()}},{key:"pause",value:function(){this._player&&this._player.pause()}},{key:"changePlaybackRate",value:function(e){this._player&&this._player.changePlaybackRate(e)}},{key:"toggleViewbox",value:function(){if(this._player)return this._player.toggleViewbox()}},{key:"setCurrentTime",value:function(e){this._player&&this._player.setCurrentTime(e)}},{key:"learnerChangedSidebarMode",value:function(){this._player&&this._player.learnerChangedSidebarMode()}},{key:"takeScreenshot",value:function(){return this._player?this._player.takeScreenshot():null}},{key:"render",value:function(){var e=this;return c.createElement("div",{className:"chapter-player"},this.state.loading?this.renderLoading():null,c.createElement(l.b,{ref:function(t){return e._player=t},mp4:this.props.chapter.cdnMp4Url,webm:this.props.chapter.cdnWebmUrl,src:this.props.chapter.videoUrl,dispatch:this.props.dispatch,onKeyboardFrame:this.props.onKeyboardFrame,onMouseFrame:this.props.onMouseFrame,captionPlayer:this.props.captionPlayer,mouse:this.props.mouse,autoPlay:this.props.autoPlay||!1,input:this.state.input,expandModeData:this.state.expandModeData,controls:this.props.controls,viewboxSize:this.props.viewboxSize,showViewbox:this.props.showViewbox,isViewExpanded:this.props.isViewExpanded,onViewboxToggle:this.props.onViewboxToggle,onCanPlay:this.props.onCanPlay,onReadyMetadata:this.props.onReadyMetadata,className:this.state.loading?"hidden":void 0,annotations:this.props.chapter.annotations,subtitles:this.props.chapter.subtitles,subtitleLang:this.props.language,onVideoDimmensions:this.props.onVideoDimmensions,onExpandModeChange:this.props.onExpandModeChange,onCueChange:this.props.onCueChange,errorContainer:this.props.errorContainer}))}},{key:"renderLoading",value:function(){return"Buffering..."}},{key:"_loadData",value:function(e,t){var n=this;this.setState({loading:!0}),Promise.all([this._fetchResource(e),this._fetchResource(t)]).then((function(e){var t=e[0],r=e[1];n.setState({input:t,expandModeData:r,loading:!1})})).catch((function(){return n.setState({loading:!1})}))}},{key:"_fetchResource",value:function(e){return e?new Promise((function(t,n){var r=new XMLHttpRequest;r.responseType="arraybuffer",r.onreadystatechange=function(e){4===r.readyState&&(200===r.status?t(r.response):n())},r.open("get",e,!0),r.send()})):Promise.resolve(void 0)}},{key:"playing",get:function(){return!!this._player&&this._player.playing}},{key:"playbackRate",get:function(){return this._player?this._player.playbackRate:l.a.x100}},{key:"canPlay",get:function(){return!!this._player&&this._player.canPlay}},{key:"currentTime",get:function(){return this._player?this._player.currentTime:0}},{key:"duration",get:function(){return this._player?this._player.duration:0}}]),t}(c.PureComponent))},1185:function(e,t,n){},1186:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),o=n(11),i=n(30),s=n(28),a=n(29),c=n(4),l=(n(1187),function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a)))).props=void 0,n}return Object(a.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=["cc-container",this.props.hidden&&"hidden",this.props.className||""].filter(Boolean).join(" "),t=this.props.dir||"ltr";return c.createElement("div",{className:e},this.props.children,"string"===typeof this.props.text?this.props.text&&c.createElement("span",{dir:t,className:"cc-text"},this.props.text):this.props.text)}}]),t}(c.PureComponent))},1187:function(e,t,n){},1188:function(e,t,n){},1189:function(e,t,n){},1190:function(e,t,n){},1191:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),o=n(11),i=n(30),s=n(28),a=n(29),c=n(4),l=(n(1192),function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(i.a)(this,Object(s.a)(t).call(this,e)))._docClickCb=void 0,n._clickFlag=void 0,n._onMouseEnter=function(){n.props.showOnMouseEnter&&n.show()},n._onMouseLeave=function(){n.props.showOnMouseEnter&&n.hide()},n.state={visible:!1},n}return Object(a.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docClickCb=function(){e._clickFlag||e.hide(),e._clickFlag=!1})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docClickCb)}},{key:"show",value:function(){this._clickFlag=!0,this.setState({visible:!0})}},{key:"hide",value:function(){this.setState({visible:!1})}},{key:"render",value:function(){return c.createElement("span",{className:"rhyme-tooltip "+(this.props.className||""),onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave},this.state.visible&&c.createElement("span",{className:"rt-content"},this.props.children[0]),this.props.children[1])}}]),t}(c.Component))},1192:function(e,t,n){},1193:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return f}));var r,o,i=n(5),s=n(11),a=n(30),c=n(28),l=n(29),p=n(90),u=n(4),h=(n(1047),n(1194),n(91)),d=n.n(h),m=n(1045),y=n(289);!function(e){e.End="End",e.Delete="Delete"}(o||(o={}));var f=(r=function(e){function t(){return Object(i.a)(this,t),Object(a.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.createElement(y.a,{visible:this.props.visible,onToggle:this.props.onToggle,title:"Long Running Session",size:"small"},u.createElement("div",{className:"form-styles lrs-end-modal"},u.createElement("p",{className:"text"},this._firstSentence," ",this._secondSentence),u.createElement("div",{className:"button-sequence"},u.createElement(m.b,{className:"short-btn",onClick:this._close},"OK"))))}},{key:"_close",value:function(){this.props.onToggle(!1)}},{key:"_firstSentence",get:function(){return this.props.type===o.Delete?"You cannot delete a long running session.":"You cannot end a long running session."}},{key:"_secondSentence",get:function(){return this.props.type===o.Delete?u.createElement(u.Fragment,null,"To delete such a session,",u.createElement("br",null),"please contact the administrator."):u.createElement(u.Fragment,null,"To end such a session,",u.createElement("br",null),"please contact the administrator.")}}]),t}(u.PureComponent),Object(p.a)(r.prototype,"_close",[d.a],Object.getOwnPropertyDescriptor(r.prototype,"_close"),r.prototype),r)},1194:function(e,t,n){},1195:function(e,t,n){},1210:function(e,t,n){},1211:function(e,t,n){},1212:function(e,t,n){},1213:function(e,t,n){e.exports=n.p+"static/media/Certificate-2x.45087896.jpg"},1214:function(e,t,n){e.exports=n.p+"static/media/Certificate.2c623c64.jpg"},1391:function(e,t,n){},1392:function(e,t,n){},1393:function(e,t,n){},1394:function(e,t,n){},1395:function(e,t,n){},1396:function(e,t,n){},1397:function(e,t,n){},1398:function(e,t,n){},1399:function(e,t,n){e.exports=n.p+"static/media/alarm.a0a2469f.wav"},1400:function(e,t,n){},1401:function(e,t,n){},1402:function(e,t,n){},1403:function(e,t,n){},1404:function(e,t,n){},1405:function(e,t,n){},1406:function(e,t,n){},1407:function(e,t,n){},1408:function(e,t,n){},1409:function(e,t,n){},1410:function(e,t,n){},1411:function(e,t,n){},1412:function(e,t,n){},1413:function(e,t,n){},1414:function(e,t,n){},1415:function(e,t,n){},1416:function(e,t,n){},1417:function(e,t,n){},1418:function(e,t,n){},1419:function(e,t,n){},1420:function(e,t,n){},1421:function(e,t,n){},1422:function(e,t,n){},1423:function(e,t,n){},1424:function(e,t,n){},1425:function(e,t,n){},1426:function(e,t,n){},1427:function(e,t,n){},1428:function(e,t,n){},1429:function(e,t,n){},1430:function(e,t,n){},1431:function(e,t,n){},1432:function(e,t,n){},1433:function(e,t,n){},1434:function(e,t,n){},1435:function(e,t,n){},1436:function(e,t,n){},1437:function(e,t,n){},1438:function(e,t,n){},1439:function(e,t,n){},1440:function(e,t,n){},1441:function(e,t,n){},1442:function(e,t,n){},1443:function(e,t,n){},1444:function(e,t,n){},1445:function(e,t,n){},1446:function(e,t,n){},1447:function(e,t,n){},1448:function(e,t,n){e.exports=n.p+"static/media/approved.1a6268f7.svg"},1449:function(e,t,n){e.exports=n.p+"static/media/rejected.52687345.svg"},1450:function(e,t,n){},1451:function(e,t,n){},1452:function(e,t,n){},1453:function(e,t,n){},1454:function(e,t,n){},1455:function(e,t,n){},1456:function(e,t,n){},1457:function(e,t,n){},1458:function(e,t,n){},1459:function(e,t,n){},1460:function(e,t,n){e.exports=n.p+"static/media/free.1cac7fd6.svg"},1461:function(e,t,n){},1462:function(e,t,n){},1463:function(e,t,n){},1464:function(e,t,n){},1465:function(e,t,n){},1467:function(e,t,n){"use strict";n.r(t);var r=n(51),o=n(5),i=n(11),s=n(30),a=n(28),c=n(29),l=n(90),p=n(4),u=n.n(p),h=(n(1391),n(91)),d=n.n(h),m=n(2),y=n(14),f=n(306),v=n(12),b=n(0),g=n(21),_=n(170),k=n(1149),O=n(16),w=n(1051),C=n(122),E=(n(1392),n(42));n(1393);function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var P=u.a.createElement("style",{type:"text/css"},"\n\t.st0{fill:#3A599C;}\n"),T=u.a.createElement("g",null,u.a.createElement("path",{className:"st0",d:"M47.1,41H5.9C2.6,41,0,38.3,0,35.1V5.9C0,2.6,2.7,0,5.9,0H47c3.3,0,5.9,2.7,5.9,5.9V35 C53,38.3,50.3,41,47.1,41z"}),u.a.createElement("path",{className:"st0",d:"M57,11.6v17.8l16.5,9.3c0.7,0.4,1.5-0.1,1.5-0.9V3.2c0-0.8-0.8-1.2-1.5-0.9L57,11.6z"})),R=function(e){var t=e.svgRef,n=e.title,r=S(e,["svgRef","title"]);return u.a.createElement("svg",j({id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 75 41",style:{enableBackground:"new 0 0 75 41"},xmlSpace:"preserve",ref:t},r),n?u.a.createElement("title",null,n):null,P,T)},A=u.a.forwardRef((function(e,t){return u.a.createElement(R,j({svgRef:t},e))})),D=(n.p,function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:this.className,"data-tooltip":this.tooltip},p.createElement(A,null))}},{key:"className",get:function(){return"camera-icon icon-container tooltip rel t rh"+(this.props.selected?" selected":"")}},{key:"tooltip",get:function(){return this.props.attendee?this.props.attendee.access===b.f.Guide?"Learners":"Host":"Recording"}}]),t}(p.PureComponent));n(1126),n(1394);function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function x(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var N=u.a.createElement("path",{d:"M63.57,0H8.48A8.48,8.48,0,0,0,0,8.48V38.14a8.48,8.48,0,0,0,8.48,8.48h4.24V61.45A2.12,2.12,0,0,0,16.33,63L33.9,46.62H63.57a8.48,8.48,0,0,0,8.48-8.48V8.48A8.48,8.48,0,0,0,63.57,0"}),V=function(e){var t=e.svgRef,n=e.title,r=x(e,["svgRef","title"]);return u.a.createElement("svg",M({id:"Layer_1","data-name":"Layer 1",viewBox:"0 0 72.05 63.57",ref:t},r),n?u.a.createElement("title",null,n):null,N)},L=u.a.forwardRef((function(e,t){return u.a.createElement(V,M({svgRef:t},e))})),U=(n.p,function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:this.className,"data-tooltip":"Chat"},p.createElement(L,null))}},{key:"newMessages",get:function(){var e=this;return!!this.props.messages.find((function(t){return t.readAt.getTime()===new Date(0).getTime()&&t.sender!==e.props.attendee.id}))}},{key:"className",get:function(){return"chat-icon icon-container  tooltip rel t rh"+(this.props.selected?" selected":"")+(this.newMessages?" new":"")}}]),t}(p.Component));n(1395);function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function F(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var z=u.a.createElement("defs",null,u.a.createElement("style",null,".cls-1{fill:#a3a5ab;}")),B=u.a.createElement("path",{className:"cls-1",d:"M133,184.62H402.86a27.26,27.26,0,0,1,7,.9,22.39,22.39,0,0,1,12.32,8.22,23.41,23.41,0,0,1,4.57,14.18,29.15,29.15,0,0,1-1,7.56L387.32,358.74a38.33,38.33,0,0,1-13.41,19.72c-6.39,5-14.27,8.17-22.09,8.17H82a27,27,0,0,1-7-.9,22.4,22.4,0,0,1-12.31-8.22,23.39,23.39,0,0,1-4.57-14.18,29.21,29.21,0,0,1,1-7.56L97.52,212.51a38.3,38.3,0,0,1,13.41-19.71C117.32,187.75,125.2,184.62,133,184.62Z",transform:"translate(-58.1 -98.53)"}),W=u.a.createElement("path",{className:"cls-1",d:"M152.89,142.81H352.13A34.62,34.62,0,0,1,386.66,176H133c-10,0-19.68,3.91-27.44,10a47,47,0,0,0-16.41,24.27l-31.07,116V177.37c0-.85,0-1.74.11-2.67,0-.52.1-1.09.19-1.71-.08-.55-.15-1.09-.19-1.61-.07-.83-.11-1.68-.11-2.52v-41A29.43,29.43,0,0,1,87.47,98.53h36.05a29.43,29.43,0,0,1,29.37,29.37Z",transform:"translate(-58.1 -98.53)"}),H=function(e){var t=e.svgRef,n=e.title,r=F(e,["svgRef","title"]);return u.a.createElement("svg",I({id:"Layer_1","data-name":"Layer 1",viewBox:"0 0 368.64 288.1",ref:t},r),n?u.a.createElement("title",null,n):null,z,B,W)},G=u.a.forwardRef((function(e,t){return u.a.createElement(H,I({svgRef:t},e))})),K=(n.p,function(e){return p.createElement("div",{className:"files-settings-icon icon-container tooltip rel t rh"+(e.selected?" selected":""),"data-tooltip":"Files"},p.createElement(G,null))});n(1396);function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function q(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Z=u.a.createElement("path",{d:"M55.5,21.6c-0.2-1.2-1.4-2.4-2.6-2.6L52,18.7c-2.1-0.6-4-2-5.2-4c-1.2-2-1.5-4.3-1-6.4l0.3-0.8 c0.4-1.1-0.1-2.7-1.1-3.5c0,0-0.9-0.7-3.3-2c-2.4-1.3-3.4-1.7-3.4-1.7c-1.2-0.4-2.8,0-3.7,0.9l-0.6,0.7c-1.6,1.5-3.8,2.4-6.2,2.4 c-2.4,0-4.6-0.9-6.2-2.4L21,1c-0.8-0.9-2.5-1.3-3.7-0.9c0,0-1,0.4-3.5,1.7c-2.4,1.4-3.2,2.1-3.2,2.1c-1,0.8-1.4,2.3-1.1,3.5l0.3,0.8 c0.5,2.1,0.2,4.4-1,6.4c-1.2,2-3.1,3.4-5.3,4l-0.9,0.2c-1.2,0.3-2.4,1.5-2.6,2.6c0,0-0.2,1.1-0.2,3.8c0,2.7,0.2,3.8,0.2,3.8 c0.2,1.2,1.4,2.4,2.6,2.6l0.9,0.2c2.1,0.6,4.1,2,5.3,4c1.2,2,1.5,4.3,1,6.4l-0.3,0.8c-0.4,1.1,0.1,2.7,1.1,3.5c0,0,0.9,0.7,3.3,2 c2.4,1.3,3.4,1.7,3.4,1.7c1.2,0.4,2.8,0,3.7-0.9l0.6-0.6c1.6-1.5,3.8-2.4,6.2-2.4s4.6,0.9,6.2,2.4l0.6,0.6c0.8,0.9,2.5,1.3,3.7,0.9 c0,0,1-0.4,3.5-1.7c2.4-1.3,3.2-2,3.2-2c1-0.8,1.4-2.4,1.1-3.5l-0.3-0.8c-0.5-2.1-0.2-4.4,1-6.4c1.2-2,3.1-3.4,5.3-4l0.9-0.2 c1.2-0.3,2.4-1.5,2.6-2.6c0,0,0.2-1.1,0.2-3.8C55.7,22.6,55.5,21.6,55.5,21.6L55.5,21.6z M27.9,36.1c-6.1,0-11.1-4.8-11.1-10.8 c0-6,5-10.8,11.1-10.8C34,14.5,39,19.4,39,25.3C39,31.3,34,36.1,27.9,36.1z"}),J=function(e){var t=e.svgRef,n=e.title,r=q(e,["svgRef","title"]);return u.a.createElement("svg",Y({id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 55.7 50.6",style:{enableBackground:"new 0 0 55.7 50.6"},xmlSpace:"preserve",ref:t},r),n?u.a.createElement("title",null,n):null,Z)},X=u.a.forwardRef((function(e,t){return u.a.createElement(J,Y({svgRef:t},e))})),Q=(n.p,function(e){return p.createElement("div",{className:"settings-icon icon-container tooltip rel t rh"+(e.selected?" selected":""),"data-tooltip":"Settings"},p.createElement(X,null))}),$=n(1193),ee=function(e){return function(t,n){switch(!0){case t.id===e.id:return-1;case n.id===e.id:return 1;case t.access===b.f.Guide:return-1;case n.access===b.f.Guide:return 1;case t.online!==n.online:return t.online?-1:1;default:return n.createdAt.getTime()-t.createdAt.getTime()}}},te=(n(1397),n(1398),n(166)),ne=n(1399),re=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._alarm=void 0,n._prepareAlarm(),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"play",value:function(){var e=this._alarm.play();e&&e.catch((function(){}))}},{key:"pause",value:function(){this._alarm.pause()}},{key:"componentWillUnmount",value:function(){this._alarm.pause()}},{key:"render",value:function(){return null}},{key:"_prepareAlarm",value:function(){this._alarm=new Audio(ne),this._alarm.loop=!0,this._alarm.volume=.15}},{key:"paused",get:function(){return this._alarm.paused}}]),t}(p.Component),oe=function(e){return 1===e.toString().length?"0"+e:e},ie=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).timerRef=void 0,n.expireInterval=void 0,n.expireDuration=void 0,n._alarm=void 0,n.expireDuration=1e3*e.expireDurationSecs,n.state={timeLeft:0,expireStyle:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.start()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timerRef),clearInterval(this.expireInterval)}},{key:"startExpireTicking",value:function(){var e=this;return setInterval((function(){e.setState({expireStyle:!e.state.expireStyle})}),300)}},{key:"start",value:function(){var e=this,t=function(t){e.timerRef&&clearTimeout(e.timerRef),e.timerRef=setTimeout(t,100)},n=0;!function r(){var o=e.props.expiry.getTime()-Date.now();Math.round(n/1e3)!==Math.round(o/1e3)?(n=o,e.setState({timeLeft:o}),o<=e.expireDuration?(e.expireInterval&&clearInterval(e.expireInterval),e.expireInterval=e.startExpireTicking()):o>e.expireDuration&&e.expireInterval&&(clearInterval(e.expireInterval),e.setState({expireStyle:!1})),e._alarm.paused&&o<=1e4&&(void 0===e.props.alarm||e.props.alarm)?e._alarm.play():!e._alarm.paused&&o>1e4&&e._alarm.pause(),o<=0&&(clearTimeout(e.timerRef),clearInterval(e.expireInterval),e._alarm.pause(),o=0),e.props.onTick&&e.props.onTick(o),o>0&&t(r)):t(r)}()}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"countdown-timer tooltip rel b la"+(this.state.expireStyle?" expires":""),"data-tooltip":"Time remaining before session ends"},function(e){var t=Math.floor(e.asDays());return t>99?"99+ days":t>0?"".concat(t," day").concat(1!==t?"s":""):oe(e.hours())+":"+oe(e.minutes())+":"+oe(e.seconds())}(te.duration(this.state.timeLeft)),p.createElement(re,{ref:function(t){return e._alarm=t}}))}}]),t}(p.Component);n(1400);function se(){return(se=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ae(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var ce=u.a.createElement("path",{d:"M13.4,17.3c0-9.5,7.7-17.2,17.2-17.2s17.2,7.7,17.2,17.2v28c0,9.5-7.7,17.2-17.2,17.2s-17.2-7.7-17.2-17.2 C13.4,45.3,13.4,17.3,13.4,17.3z"}),le=u.a.createElement("path",{d:"M47.7,86.1H34.9v-10C49.6,74,61,61.3,61,46c0-2.4-2-4.4-4.4-4.4s-4.4,2-4.4,4.4c0,12-9.7,21.7-21.7,21.7 S8.8,57.9,8.8,45.9c0-2.4-2-4.4-4.4-4.4S0,43.5,0,45.9c0,15.3,11.4,28,26.1,30.1v10H13.4C11,86,9,88,9,90.4s2,4.4,4.4,4.4h34.3 c2.4,0,4.4-2,4.4-4.4C52.1,88,50.1,86.1,47.7,86.1z"}),pe=function(e){var t=e.svgRef,n=e.title,r=ae(e,["svgRef","title"]);return u.a.createElement("svg",se({id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 61 94.8",style:{enableBackground:"new 0 0 61 94.8"},xmlSpace:"preserve",ref:t},r),n?u.a.createElement("title",null,n):null,ce,le)},ue=u.a.forwardRef((function(e,t){return u.a.createElement(pe,se({svgRef:t},e))}));n.p;function he(){return(he=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function de(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var me,ye=u.a.createElement("path",{d:"M72.7,12.3L39.1,46c0-0.2,0-0.5,0-0.7v-28c0-9.5,7.7-17.2,17.2-17.2C64,0.1,70.6,5.3,72.7,12.3z"}),fe=u.a.createElement("path",{d:"M73.5,24.1v21.2c0,9.5-7.7,17.2-17.2,17.2c-5.8,0-10.9-2.9-14-7.2L73.5,24.1z"}),ve=u.a.createElement("path",{d:"M34.9,50.2l-7,7c-1.4-3.5-2.2-7.3-2.2-11.3c0-2.4,2-4.4,4.4-4.4c2.4,0,4.4,2,4.4,4.4 C34.5,47.4,34.6,48.8,34.9,50.2z"}),be=u.a.createElement("path",{d:"M77.8,90.4c0,2.4-2,4.4-4.4,4.4H39.1c-2.4,0-4.4-2-4.4-4.4c0-2.4,2-4.4,4.4-4.4h12.7V76 c-7.7-1.1-14.5-5.1-19.3-11l6.2-6.2c4,5.4,10.3,8.9,17.5,8.9c12,0,21.7-9.7,21.7-21.7c0-2.4,2-4.4,4.4-4.4c2.4,0,4.4,2,4.4,4.4 c0,15.3-11.4,28-26.1,30.1v10h12.8C75.8,86.1,77.8,88,77.8,90.4z"}),ge=u.a.createElement("path",{d:"M24.2,79.5L24.2,79.5c-1.7-1.7-1.7-4.5,0-6.2l57.9-57.9c1.7-1.7,4.5-1.7,6.2,0v0c1.7,1.7,1.7,4.5,0,6.2 L30.4,79.5C28.7,81.3,25.9,81.3,24.2,79.5z"}),_e=function(e){var t=e.svgRef,n=e.title,r=de(e,["svgRef","title"]);return u.a.createElement("svg",he({id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 112.3 94.8",style:{enableBackground:"new 0 0 112.3 94.8"},xmlSpace:"preserve",ref:t},r),n?u.a.createElement("title",null,n):null,ye,fe,ve,be,ge)},ke=u.a.forwardRef((function(e,t){return u.a.createElement(_e,he({svgRef:t},e))})),Oe=(n.p,me=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).state={isChangingState:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.attendee.micMute!==e.attendee.micMute&&this.state.isChangingState&&this.setState({isChangingState:!1})}},{key:"mute",value:function(){this.props.dispatch(this.props.asyncActions.muteAttendee(this.props.room,this.props.attendee))}},{key:"unmute",value:function(){this.props.dispatch(this.props.asyncActions.unmuteAttendee(this.props.room,this.props.attendee))}},{key:"renderMicButton",value:function(){var e=this.props.attendee.micMute,t="".concat(e?"Unmute":"Mute"," your ").concat(this.props.isGuide?"(Guide's)":""," microphone");return p.createElement("span",{className:"mic tooltip rel b rh"+(e?" muted":"")+(this.state.isChangingState?" is-changing":""),"data-tooltip":t},e?p.createElement(ke,null):p.createElement(ue,null))}},{key:"renderGuideControl",value:function(){return p.createElement("div",{className:"mic-control-button"+(this.isMicDisabled?" disabled":""),onClick:this._onClick,onContextMenu:this._onRightClick},this.renderMicButton())}},{key:"renderStudentControl",value:function(){return p.createElement("div",{className:"mic-control-button"+(this.isMicDisabled?" disabled":""),onClick:this._onClick,onContextMenu:this._onRightClick},this.renderMicButton())}},{key:"render",value:function(){return this.props.isGuide?this.renderGuideControl():this.renderStudentControl()}},{key:"_onClick",value:function(e){this.setState({isChangingState:!0}),this.props.attendee.micMute?this.unmute():this.mute()}},{key:"_onRightClick",value:function(e){e.preventDefault(),this.props.onRightClick()}},{key:"isMicDisabled",get:function(){var e=this.props.course;return e.type!==b.y.Live&&e.type!==b.y.Collaboration&&(!!this.props.room.demo||(this.props.isGuide?!this.props.attendees.find((function(e){return e.access===b.f.Student&&e.controlled})):!this.props.attendee.controlled))}}]),t}(p.Component),Object(l.a)(me.prototype,"mute",[d.a],Object.getOwnPropertyDescriptor(me.prototype,"mute"),me.prototype),Object(l.a)(me.prototype,"unmute",[d.a],Object.getOwnPropertyDescriptor(me.prototype,"unmute"),me.prototype),Object(l.a)(me.prototype,"_onClick",[d.a],Object.getOwnPropertyDescriptor(me.prototype,"_onClick"),me.prototype),Object(l.a)(me.prototype,"_onRightClick",[d.a],Object.getOwnPropertyDescriptor(me.prototype,"_onRightClick"),me.prototype),me);n(1401);function we(){return(we=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ce(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ee=u.a.createElement("style",{type:"text/css"},"\n\t.st0{fill:#3A599C;}\n"),je=u.a.createElement("g",null,u.a.createElement("path",{className:"st0",d:"M7.6,7.6c0.6,0,1.1-0.5,1.1-1.1V1.1C8.7,0.5,8.2,0,7.6,0C7,0,6.5,0.5,6.5,1.1v5.3C6.5,7.1,7,7.6,7.6,7.6z"}),u.a.createElement("path",{className:"st0",d:"M0.6,10.5C0.8,11,1,11.4,1.3,11.8c0.3,0.4,0.6,0.8,0.9,1.1c0.3,0.3,0.7,0.6,1.1,0.9c0.4,0.3,0.8,0.5,1.3,0.7 c0.5,0.2,1,0.3,1.5,0.5c0.5,0.1,1,0.2,1.5,0.2c0.5,0,1-0.1,1.5-0.2c0.5-0.1,1-0.3,1.4-0.5c0.5-0.2,0.9-0.4,1.3-0.7 c0.4-0.3,0.8-0.6,1.1-0.9c0.3-0.3,0.6-0.7,0.9-1.1c0.3-0.4,0.5-0.8,0.7-1.3c0.2-0.5,0.3-0.9,0.4-1.4c0.1-0.5,0.2-1,0.2-1.5 c0-0.5-0.1-1-0.2-1.5c-0.1-0.5-0.3-1-0.4-1.4c-0.2-0.5-0.4-0.9-0.7-1.3c-0.3-0.4-0.6-0.8-0.9-1.1c-0.4-0.4-1.1-0.4-1.6,0 c-0.4,0.4-0.4,1.1,0,1.6c0.2,0.3,0.5,0.5,0.6,0.8c0.2,0.3,0.4,0.6,0.5,0.9c0.1,0.3,0.2,0.7,0.3,1C12.9,6.9,13,7.2,13,7.6 c0,0.4,0,0.7-0.1,1.1c-0.1,0.4-0.2,0.7-0.3,1c-0.1,0.3-0.3,0.6-0.5,0.9c-0.2,0.3-0.4,0.6-0.6,0.8c-0.3,0.3-0.5,0.5-0.8,0.7 c-0.3,0.2-0.6,0.4-0.9,0.5c-0.3,0.1-0.7,0.3-1,0.3C8.4,12.9,8,13,7.6,13c-0.4,0-0.7,0-1.1-0.1c-0.4-0.1-0.7-0.2-1-0.3 c-0.3-0.1-0.6-0.3-0.9-0.5c-0.3-0.2-0.6-0.4-0.8-0.7c-0.2-0.2-0.5-0.5-0.7-0.8C2.9,10.3,2.8,10,2.6,9.7C2.5,9.4,2.4,9,2.3,8.7 C2.3,8.3,2.2,8,2.2,7.6c0-0.4,0-0.7,0.1-1.1c0.1-0.4,0.2-0.7,0.3-1c0.1-0.3,0.3-0.6,0.5-0.9C3.3,4.3,3.6,4,3.8,3.8 c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.1-0.4-1.6,0C1.9,2.6,1.6,2.9,1.3,3.3C1,3.7,0.8,4.2,0.6,4.6C0.4,5.1,0.3,5.6,0.2,6.1 C0.1,6.6,0,7.1,0,7.6c0,0.5,0.1,1,0.2,1.5C0.3,9.6,0.4,10.1,0.6,10.5z"})),Se=function(e){var t=e.svgRef,n=e.title,r=Ce(e,["svgRef","title"]);return u.a.createElement("svg",we({id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 15.2 15.2",style:{enableBackground:"new 0 0 15.2 15.2"},xmlSpace:"preserve",ref:t},r),n?u.a.createElement("title",null,n):null,Ee,je)},Pe=u.a.forwardRef((function(e,t){return u.a.createElement(Se,we({svgRef:t},e))})),Te=(n.p,function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"power-off-button tooltip rel t rh","data-tooltip":this.isGuide?"End session":"Leave session"},p.createElement(Pe,{onClick:this.props.onPowerOff}))}},{key:"isGuide",get:function(){return this.props.attendee.access===b.f.Guide}}]),t}(p.PureComponent)),Re=n(3);n(1402);function Ae(){return(Ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function De(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Me=u.a.createElement("desc",null,"Created with Sketch."),xe=u.a.createElement("defs",null,u.a.createElement("path",{d:"M9.95,29 L9.95,25 L39.999,25 L39.999,29 L9.95,29 Z M9.95,4 L9.95,0 L39.999,0 L39.999,4 L9.95,4 Z M9.95,16.5 L9.95,12.5 L39.999,12.5 L39.999,16.5 L9.95,16.5 Z M7.10542736e-15,14.5001 L4.8,7.6401 L7.259,9.3601 L3.66,14.5001 L7.259,19.6401 L4.8,21.3611 L7.10542736e-15,14.5001 Z",id:"path-1"})),Ne=u.a.createElement("g",{id:"DockClose-Icon",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},u.a.createElement("g",{transform:"translate(-3349.000000, -1336.000000)",id:"Icons"},u.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},u.a.createElement("g",{id:"Icons/Open",transform:"translate(88.000000, 909.000000)"},u.a.createElement("g",{id:"Colors/Grey",transform:"translate(0.000000, 6.000000)"},u.a.createElement("mask",{id:"mask-1",fill:"white"},u.a.createElement("use",{xlinkHref:"#path-1"})),u.a.createElement("use",{id:"Mask",fill:"#A3A5AB",xlinkHref:"#path-1"}),u.a.createElement("g",{mask:"url(#mask-1)",fill:"#A3A5AB",id:"Rectangle"},u.a.createElement("g",{transform:"translate(0.000000, -6.000000)"},u.a.createElement("rect",{x:0,y:0,width:40,height:40})))))))),Ve=function(e){var t=e.svgRef,n=e.title,r=De(e,["svgRef","title"]);return u.a.createElement("svg",Ae({viewBox:"0 0 40 29",ref:t},r),n?u.a.createElement("title",null,n):null,Me,xe,Ne)},Le=u.a.forwardRef((function(e,t){return u.a.createElement(Ve,Ae({svgRef:t},e))}));n.p;function Ue(){return(Ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ie(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Fe=u.a.createElement("desc",null,"Created with Sketch."),ze=u.a.createElement("defs",null,u.a.createElement("path",{d:"M38.4823848,40 C38.699187,40 38.9159892,40 39.0243902,39.8918919 C39.0243902,39.8918919 39.0243902,39.8918919 39.0243902,39.8918919 C39.2411924,39.7837838 39.3495935,39.6756757 39.5663957,39.5675676 C39.5663957,39.5675676 39.5663957,39.5675676 39.5663957,39.5675676 C39.5663957,39.5675676 39.5663957,39.5675676 39.5663957,39.5675676 C39.6747967,39.4594595 39.6747967,39.4594595 39.7831978,39.3513514 C39.7831978,39.2432432 39.8915989,39.1351351 39.8915989,39.1351351 C39.8915989,39.1351351 39.8915989,39.027027 39.8915989,39.027027 C40,38.8108108 40,38.7027027 40,38.4864865 L40,25.2972973 C40,24.4324324 39.2411924,23.6756757 38.3739837,23.6756757 C37.5067751,23.6756757 36.8563686,24.3243243 36.8563686,25.2972973 L36.8563686,34.4864865 L25.1490515,22.8108108 C24.498645,22.1621622 23.5230352,22.1621622 22.8726287,22.8108108 C22.5474255,23.1351351 22.4390244,23.5675676 22.4390244,24 C22.4390244,24.4324324 22.5474255,24.8648649 22.8726287,25.1891892 L34.5799458,36.7567568 L25.3658537,36.7567568 C24.498645,36.7567568 23.7398374,37.5135135 23.7398374,38.3783784 C23.7398374,39.2432432 24.498645,40 25.3658537,40 L38.4823848,40 Z M17.2357724,14.9189189 L5.52845528,3.24324324 L14.7425474,3.24324324 C15.6097561,3.24324324 16.3685637,2.48648649 16.3685637,1.62162162 C16.3685637,0.756756757 15.6097561,0 14.7425474,0 L1.62601626,0 C1.51761518,0 1.40921409,0 1.30081301,0 C1.19241192,0 1.19241192,0.108108108 1.08401084,0.108108108 C1.08401084,0.108108108 0.975609756,0.108108108 0.975609756,0.108108108 C0.758807588,0.216216216 0.650406504,0.324324324 0.54200542,0.432432432 C0.54200542,0.432432432 0.54200542,0.432432432 0.433604336,0.432432432 C0.433604336,0.432432432 0.433604336,0.432432432 0.433604336,0.432432432 C0.325203252,0.648648649 0.216802168,0.756756757 0.108401084,0.972972973 C0.108401084,0.972972973 0.108401084,0.972972973 0.108401084,0.972972973 C0,1.18918919 0,1.40540541 0,1.62162162 L0,14.7027027 C0,15.5675676 0.758807588,16.3243243 1.62601626,16.3243243 C2.49322493,16.3243243 3.25203252,15.6756757 3.25203252,14.7027027 L3.25203252,5.51351351 L14.9593496,17.1891892 C15.6097561,17.8378378 16.5853659,17.8378378 17.2357724,17.1891892 C17.8861789,16.5405405 17.8861789,15.5675676 17.2357724,14.9189189 Z",id:"path-2"})),Be=u.a.createElement("g",{id:"Expand-Icon",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},u.a.createElement("g",{transform:"translate(-3346.000000, -1105.000000)",id:"Icons"},u.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},u.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},u.a.createElement("g",{id:"Icons/Expand_Big",transform:"translate(5.000000, 321.000000)"},u.a.createElement("g",{id:"Colors/Grey"},u.a.createElement("mask",{id:"mask-2",fill:"white"},u.a.createElement("use",{xlinkHref:"#path-2"})),u.a.createElement("use",{id:"Mask",fill:"#A3A5AB",fillRule:"nonzero",xlinkHref:"#path-2"}),u.a.createElement("g",{mask:"url(#mask-2)",fill:"#A3A5AB",id:"Rectangle"},u.a.createElement("rect",{x:0,y:0,width:40,height:40})))))))),We=function(e){var t=e.svgRef,n=e.title,r=Ie(e,["svgRef","title"]);return u.a.createElement("svg",Ue({viewBox:"0 0 40 40",ref:t},r),n?u.a.createElement("title",null,n):null,Fe,ze,Be)},He=u.a.forwardRef((function(e,t){return u.a.createElement(We,Ue({svgRef:t},e))}));n.p;function Ge(){return(Ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ke(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ye,qe,Ze,Je,Xe=u.a.createElement("title",null,"Icons/Picture_in_Picture_Small"),Qe=u.a.createElement("desc",null,"Created with Sketch."),$e=u.a.createElement("defs",null,u.a.createElement("path",{d:"M8.22593573,10.2772292 L5.171569,7.22478589 L6.77610586,5.62125945 L9.82986767,8.67309824 L9.82986767,6.42332494 L12.0982987,6.42332494 L12.0982987,12.5442317 L5.97353497,12.5442317 L5.97353497,10.2772292 L8.22593573,10.2772292 Z M24.2722117,23.1234257 L-3.62376795e-13,23.1234257 L-3.62376795e-13,9.05941988e-14 L33.7240076,9.05941988e-14 L33.7240076,6.42166247 L40,6.42166247 L40,30 L24.2722117,30 L24.2722117,23.1234257 Z M24.2722117,20.8549118 L24.2722117,6.42166247 L31.4555766,6.42166247 L31.4555766,2.26700252 L2.268431,2.26700252 L2.268431,20.8549118 L24.2722117,20.8549118 Z",id:"path-3"})),et=u.a.createElement("g",{id:"Float-Icon",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},u.a.createElement("g",{transform:"translate(-3587.000000, -1186.000000)",id:"Icons"},u.a.createElement("g",{transform:"translate(3261.000000, 421.000000)"},u.a.createElement("g",{id:"Gray",transform:"translate(80.000000, 363.000000)"},u.a.createElement("g",{id:"Icons/Picture_in_Picture_Small",transform:"translate(246.000000, 397.000000)"},u.a.createElement("g",{id:"Colors/Grey",transform:"translate(0.000000, 5.000000)"},u.a.createElement("mask",{id:"mask-3",fill:"white"},u.a.createElement("use",{xlinkHref:"#path-3"})),u.a.createElement("use",{id:"Mask",fill:"#A3A5AB",xlinkHref:"#path-3"}),u.a.createElement("g",{mask:"url(#mask-3)",fill:"#A3A5AB",id:"Rectangle"},u.a.createElement("g",{transform:"translate(0.000000, -5.000000)"},u.a.createElement("rect",{x:0,y:0,width:40,height:40}))))))))),tt=function(e){var t=e.svgRef,n=e.title,r=Ke(e,["svgRef","title"]);return u.a.createElement("svg",Ge({viewBox:"0 0 40 30",ref:t},r),void 0===n?Xe:n?u.a.createElement("title",null,n):null,Qe,$e,et)},nt=u.a.forwardRef((function(e,t){return u.a.createElement(tt,Ge({svgRef:t},e))})),rt=(n.p,[b.V.Close,b.V.Dock,b.V.Expand]),ot=(Ye={},Object(Re.a)(Ye,b.V.Close,p.createElement(Le,{className:"mode close"})),Object(Re.a)(Ye,b.V.Dock,p.createElement(Le,{className:"mode dock"})),Object(Re.a)(Ye,b.V.Expand,p.createElement(He,{className:"mode expand"})),Object(Re.a)(Ye,b.V.Float,p.createElement(nt,{className:"mode float"})),Ye),it=(qe=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._docCb=void 0,n._clickFlag=void 0,n.state={visible:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("mousedown",this._docCb=function(){e.props.disabled||(e._clickFlag||(e.setState({visible:!1}),e._changeVisibility(!1)),e._clickFlag=!1)})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this._docCb)}},{key:"componentDidUpdate",value:function(e){this.props.sidebarMode.mode!==e.sidebarMode.mode&&this.state.visible&&this._changeVisibility(!1)}},{key:"toggleOptions",value:function(){this.props.disabled||(this._clickFlag=!0,this._changeVisibility(!this.state.visible))}},{key:"changeMode",value:function(e){this._clickFlag=!0,this._changeVisibility(!1),this.props.dispatch(new m.H(e))}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"sidebar-mode-selector"+(this.props.disabled?" disabled":""),onMouseDown:this.toggleOptions},p.createElement("div",{className:"selected-mode"},ot[this.props.sidebarMode.mode]),p.createElement("ul",{style:{width:170},className:"options"+(this.state.visible?" visible":"")+(this.isRightAlignedMenu?" right-aligned":"")},this.modes.map((function(t,n){return p.createElement("li",{key:"sm-"+n,onMouseDown:function(){return e.changeMode(t)}},ot[t]," ",p.createElement("span",{className:"mode-name"},t))}))))}},{key:"_changeVisibility",value:function(e){this._handleRightSplitOverflow(e),this.setState({visible:e})}},{key:"_handleRightSplitOverflow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.visible,t=this.props.rightPanel;t&&t.parentElement&&(e?(t.classList.add("override-overflow-unset"),t.parentElement.classList.add("override-overflow-unset")):(t.classList.remove("override-overflow-unset"),t.parentElement.classList.remove("override-overflow-unset")))}},{key:"modes",get:function(){var e=this;return rt.filter((function(t){return t!==e.props.sidebarMode.mode}))}},{key:"isRightAlignedMenu",get:function(){var e=this.props.rightPanel,t=e&&parseInt((e.style.width||"0").replace("px",""),10)||0;return window.innerWidth-t<170}}]),t}(p.PureComponent),Object(l.a)(qe.prototype,"toggleOptions",[d.a],Object.getOwnPropertyDescriptor(qe.prototype,"toggleOptions"),qe.prototype),qe),st=(Ze=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).state={audioConfigVisible:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"switchView",value:function(e){var t=this.props,n=t.views,r=t.sidebarMode,o=t.dispatch;n&&n.switchView(e),r.mode===b.V.Close&&o(new m.H(b.V.Dock))}},{key:"toggleAudioConfig",value:function(){this.setState({audioConfigVisible:!this.state.audioConfigVisible})}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"buttons-bar",style:{width:y.a.ButtonsBarWidth}},p.createElement(it,{dispatch:this.props.dispatch,sidebarMode:this.props.sidebarMode,rightPanel:this.props.rightPanel,disabled:this.sidebarModeSelectorDisabled}),p.createElement("div",{className:"views-icons"},this.views.map((function(t,n){return p.createElement("div",{className:"icon",key:"vi-"+n,onClick:function(){return e.switchView(t.props.id)}},p.cloneElement(t.props.icon,Object(r.a)({selected:e.props.visibleView===t.props.id},t.props.icon.props)))}))),p.createElement("div",{className:"bottom-controls"},p.createElement(Oe,{onRightClick:this.toggleAudioConfig,isGuide:this.props.currentAttendee.access===b.f.Guide,room:this.props.room,course:this.props.course,attendee:this.props.currentAttendee,attendees:this.props.attendees,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions}),p.createElement("div",{className:"session-controls"},p.createElement(ie,{expiry:this.props.expiration,expireDurationSecs:60,onTick:this.props.onCountdownTick}),p.createElement(Te,{onPowerOff:this.props.onPowerOff,attendee:this.props.currentAttendee}))))}},{key:"views",get:function(){var e=this.props.views;return e&&e.props.children.filter((function(e){return e}))||[]}},{key:"sidebarModeSelectorDisabled",get:function(){return this.props.currentAttendee.access===b.f.Guide&&this.props.course.type===b.y.Recorded}}]),t}(p.PureComponent),Object(l.a)(Ze.prototype,"toggleAudioConfig",[d.a],Object.getOwnPropertyDescriptor(Ze.prototype,"toggleAudioConfig"),Ze.prototype),Ze),at=(n(1403),n(1045));!function(e){e.Off="off",e.Zoom="zoom",e.Control="control",e.Broadcast="broadcast"}(Je||(Je={}));var ct,lt,pt,ut,ht=function(){function e(t){Object(o.a)(this,e),this._instance=t}return Object(i.a)(e,[{key:"getCtrlState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._instance.props.attendee,t=this._instance.props,n=t.broadcastVm,r=t.course,o=t.focusAttendee;return r.type===b.y.Collaboration?e.controlled?Je.Control:Je.Off:n.id===e.virtualMachineId&&""!==e.virtualMachineId?Je.Broadcast:e.controlled?Je.Control:o.id===e.id?Je.Zoom:Je.Off}},{key:"off",value:function(){this._turnOffControlAndBroadcasting();var e=this._instance.props;e.dispatch(new m.yb(e.guide))}},{key:"zoom",value:function(){var e=this._instance.props,t=e.attendee,n=e.asyncActions,r=e.dispatch,o=e.vms;this._turnOffControlAndBroadcasting();var i=Promise.resolve();return o.get(t.virtualMachineId).connection.id||(i=r(n.createAttendeeVMConnection(t))),i.then((function(){return r(new m.yb(t))}))}},{key:"control",value:function(){var e=this;this._turnOffCtrlBroadcastingIfNeeded().then((function(){return e._zoomIfNeeded()})).then((function(){var t=e._instance.props,n=t.dispatch,r=t.asyncActions,o=t.attendee,i=t.guide,s=t.vms,a=e.getCtrlState()===Je.Broadcast;n(r.changeAttendeeControlState(o,!0)).then((function(){if(a){var e=s.get(i.virtualMachineId);n(r.setBroadcastVm(e))}}))}))}},{key:"broadcast",value:function(){var e=this;this._turnOffCtrlBroadcastingIfNeeded().then((function(){return e._zoomIfNeeded()})).then((function(){var t=e._instance.props,n=t.dispatch,r=t.asyncActions,o=t.attendee,i=t.vms.get(o.virtualMachineId),s=Promise.resolve();e.getCtrlState()!==Je.Control&&(s=n(r.changeAttendeeControlState(o,!0))),s.then((function(){return n(r.setBroadcastVm(i))}))}))}},{key:"_turnOffControlAndBroadcasting",value:function(){var e=this._instance.props,t=e.asyncActions,n=e.dispatch,r=e.guide,o=e.vms,i=e.focusAttendee,s=this.getCtrlState(i);return new Promise((function(e){s===Je.Control||s===Je.Broadcast?n(t.changeAttendeeControlState(i,!1)).then((function(){if(s===Je.Broadcast){var i=o.get(r.virtualMachineId);i&&n(t.setBroadcastVm(i))}e()})):e()}))}},{key:"_turnOffCtrlBroadcastingIfNeeded",value:function(){var e=Promise.resolve(),t=this._instance.props,n=t.focusAttendee,r=t.attendee,o=t.guide;return n.id!==r.id&&n.id!==o.id&&(e=this._turnOffControlAndBroadcasting()),e}},{key:"_zoomIfNeeded",value:function(){var e=Promise.resolve();return this.getCtrlState()===Je.Off&&(e=this.zoom()),e}}]),e}(),dt=n(290),mt=(n(1404),ct={},Object(Re.a)(ct,Je.Off,"Zoom Out"),Object(Re.a)(ct,Je.Zoom,"Zoom In"),Object(Re.a)(ct,Je.Control,"Control"),Object(Re.a)(ct,Je.Broadcast,"Broadcast"),ct),yt=(lt={},Object(Re.a)(lt,Je.Off,"Zoom Out"),Object(Re.a)(lt,Je.Zoom,"Zoom In"),Object(Re.a)(lt,Je.Control,"Control"),lt),ft=(pt={},Object(Re.a)(pt,Je.Off,"Zoom Out"),Object(Re.a)(pt,Je.Control,"Control"),pt),vt=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._vmControlService=new ht(Object(dt.a)(n)),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.getCtrlState(),t=this.props,n=t.attendee,r=t.asyncActions,o=t.dispatch,i=this.props.vms.get(n.virtualMachineId);e!==Je.Control&&e!==Je.Broadcast||!i||i.state!==b.kb.Ready||o(r.createAttendeeVMConnection(n))}},{key:"getCtrlState",value:function(){return this._vmControlService.getCtrlState()}},{key:"onControlStateChange",value:function(e){if(this.getCtrlState()!==e)switch(e){case Je.Off:this.props.onUnfocusAttendee(),this._vmControlService.off();break;case Je.Zoom:this.props.onFocusAttendee(),this._vmControlService.zoom();break;case Je.Control:this.props.onFocusAttendee(),this._vmControlService.control();break;case Je.Broadcast:this.props.onFocusAttendee(),this._vmControlService.broadcast()}}},{key:"render",value:function(){var e=this,t=this.props.course.type===b.y.Live?mt:yt;return p.createElement("div",{className:"vm-controls"+(this.props.disabled?" disabled":"")},Object.keys(t).map((function(n,r){return p.createElement("div",{className:"control"+(n===e.getCtrlState()?" current":""),onClick:function(){return e.onControlStateChange(n)},key:"vmcs-"+r},t[n])})))}}]),t}(p.Component),bt=(n(1405),function(e){var t=e.attendee,n=t.name;return t.access===b.f.Guide&&(n=p.createElement(p.Fragment,null,"Host: ",t.name,t.online?p.createElement("span",{className:"online-lbl"}," (Online)"):p.createElement("span",{className:"offline-lbl"}," (Offline)"))),p.createElement("span",{className:"chat-name"},n)}),gt=n(8);!function(e){e.Help="help",e.Mute="mute",e.Unmute="unmute",e.RaiseHand="raise",e.Message="message",e.Unknown="unknown"}(ut||(ut={}));var _t,kt,Ot,wt,Ct=["/mute","/m"],Et=["/unmute","/um"],jt=["/help","/?"],St=function(e,t){var n=t.filter((function(t){return e.startsWith(t)})).pop();return!!(n&&" "===e[n.length]||n&&e.length===n.length)},Pt=function(e,t,n){var r=e.match(/@\[.*?\]\(([0-9a-z-]+)\)/),o=t;return r&&(o=n.filter((function(e){return e.id===r[1]})).first()),o||t},Tt=/^\/(\w+)/,Rt=function(e,t,n,r,o,i,s,a){var c,l=function(e,t,n){if(St(e,Ct))return{type:ut.Mute,payload:Pt(e,t,n)};if(St(e,Et))return{type:ut.Unmute,payload:Pt(e,t,n)};if(St(e,jt))return{type:ut.Help};var r=Tt.exec(e);return r?{type:ut.Unknown,value:r[0]}:{type:ut.Message}}(r,t,o);switch(l.type){case ut.Mute:return i.muteAttendee(e,l.payload);case ut.Unmute:return i.unmuteAttendee(e,l.payload);case ut.Help:return new m.f(new b.G({id:1e4*Math.random()+"-"+Date.now(),text:t.id===n.id?"<strong>/?</strong> - Displays a list of command descriptions and usages.<br>\n<strong>/mute @user</strong> - Mute the microphone of specific user.<br>\n<strong>/unmute @user</strong> - Unmute the microphone of specific user.<br>\n<strong>/mute</strong> - Mutes your microphone.<br>\n<strong>/unmute</strong> - Umute own microphone.<br>\n":"/? - Displays a list of command descriptions and usages.\n/mute @user - Mute the microphone of specific user.\n/unmute @user - Unmute the microphone of specific user.\n/mute - Mutes your microphone.\n/unmute - Umute own microphone.\n",sentAt:new Date,recipients:Object(gt.List)([t.id]),sender:"@system@"}));case ut.Message:return i.sendMessage(e,new b.G({text:r,sentAt:new Date,recipients:o.map((function(e){return e.id})).toList(),public:s===Yt.Public,sender:t.id}),a);case ut.Unknown:return new m.f(new b.G({text:(c=l.value,c+' is not a valid command. In Rhyme, all messages that start with the "/" character are interpreted as commands. If you are trying to send a message and not run a command, try preceding the "/" with an empty space.'),sentAt:new Date,recipients:Object(gt.List)([t.id]),sender:"@system@"}));default:throw new Error("Unrecognized command")}},At=(n(1406),n(291)),Dt=n(167),Mt=(n(1407),n(19)),xt=n.n(Mt),Nt=n(44),Vt=(n(1408),n(133)),Lt=(_t=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).state={sending:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"takePhoto",value:function(){var e=Object(Nt.a)(xt.a.mark((function e(){var t,n,r,o,i=this;return xt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.sending){e.next=2;break}return e.abrupt("return");case 2:if(t=this.props.currentAttendee.virtualMachineId,!(n=this.props.remoteClientManager.getRemoteClient(t))){e.next=12;break}return e.next=7,n.toBlob("image/jpeg",1,1024,768,!0);case 7:if(!(r=e.sent)){e.next=12;break}return this.setState({sending:!0}),o=this._generateMessage(),e.abrupt("return",this.props.messageHandler(o,r).finally((function(){return i.setState({sending:!1})})));case 12:this.props.dispatch(new m.i(new b.J({type:b.K.Error,text:"Couldn't take a screenshot of your cloud workspace"})));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return p.createElement("div",{className:"take-screenshot tooltip rel l","data-tooltip":"Send screenshot of your cloud workspace"},this.state.sending?p.createElement(w.a,{theme:"dark"}):p.createElement("div",{className:"camera-btn",onClick:this.takePhoto}))}},{key:"_generateMessage",value:function(){var e=this.props,t=e.course,n=e.currentAttendee.chapterProgress,r=n.chapterId,o=n.time;if(t.type===b.y.Recorded){var i=t.chapters.find((function(e){return e.chapterId===r}));return'Sent screenshot for task "'.concat(i.order,". ").concat(i.name,'" at ').concat(Object(Vt.c)(Math.round(o)))}return'Sent screenshot for session "'.concat(t.name,'"')}}]),t}(p.PureComponent),Object(l.a)(_t.prototype,"takePhoto",[d.a],Object.getOwnPropertyDescriptor(_t.prototype,"takePhoto"),_t.prototype),_t),Ut=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"rich-content-button"},p.createElement(Lt,{dispatch:this.props.dispatch,course:this.props.course,messageHandler:this.props.messageHandler,currentAttendee:this.props.currentAttendee,remoteClientManager:this.props.remoteClientManager}))}}]),t}(p.PureComponent),It=(kt=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._inputRef=void 0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"sendHandler",value:function(e){var t=Object(Dt.b)(e.target.value.trim());e.keyCode===At.g&&t.length&&(this.props.messageHandler(t),e.target.value="")}},{key:"focus",value:function(){this._inputRef&&this._inputRef.focus()}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"chat-input-wrapper"},p.createElement("input",{ref:function(t){return e._inputRef=t},type:"text",onKeyUp:this.sendHandler,placeholder:this.props.placeholder||"Type your message here",maxLength:600}),p.createElement(Ut,{dispatch:this.props.dispatch,course:this.props.course,currentAttendee:this.props.currentAttendee,messageHandler:this.props.messageHandler,remoteClientManager:this.props.remoteClientManager}))}}]),t}(p.Component),Object(l.a)(kt.prototype,"sendHandler",[d.a],Object.getOwnPropertyDescriptor(kt.prototype,"sendHandler"),kt.prototype),kt);!function(e){e[e.Image=0]="Image",e[e.Video=1]="Video"}(Ot||(Ot={})),function(e){e.jpeg="jpeg",e.jpg="jpg",e.png="png",e.mp4="mp4",e.webm="webm"}(wt||(wt={}));var Ft,zt,Bt,Wt,Ht,Gt,Kt,Yt,qt=function(e){var t=e.split(".");if(e.startsWith("blob:"))return Ot.Video;if(t.length>2)switch(t[t.length-1]){case wt.jpeg:case wt.jpg:case wt.png:return Ot.Image;case wt.mp4:case wt.webm:return Ot.Video;default:throw new Error("Url ".concat(e," does not have a valid extention"))}throw new Error("Url ".concat(e," does not have a valid extention"))},Zt=n(1061),Jt=(n(1409),120),Xt=90,Qt=(Ft=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"formatTime",value:function(e){var t=new Date,n=te(e);return t.toDateString()===e.toDateString()?n.format("h:mm a"):n.format("ddd D MMM, h:mm a")}},{key:"renderSystemMessage",value:function(e){return p.createElement("div",{className:"chat-message system"},p.createElement("div",{className:"message-wrapper"},p.createElement("div",{className:"message-content",dangerouslySetInnerHTML:{__html:e.text}})))}},{key:"renderAttachments",value:function(e){var t=this,n=e.attachments.size;if(n){var r=e.attachments.first();return p.createElement("div",{className:"attachments"},1===n&&r.type===b.d.Image?p.createElement("div",{className:"img",onClick:function(){return t.props.onAttachmentClick(r)}},p.createElement("img",{src:r.url,width:Jt,height:Xt,alt:r.name})):p.createElement(p.Fragment,null,p.createElement("strong",null,"Attachments:"),e.attachments.map((function(e,t){return p.createElement("p",{key:"mat-"+t},p.createElement("a",{href:e.url,target:"_blank"},e.url.split("/").pop()))}))))}return null}},{key:"renderChallengeSubmission",value:function(e){var t=e.challengeSubmission;if(t){var n=qt(t.resourceUrl);return p.createElement("div",{className:"challenge-submission"},p.createElement("div",{className:"img",onClick:this._onChallengeSubmissionPreview},p.createElement("img",{src:t.screenshotUrl,width:Jt,height:Xt,alt:"Challenge submission"}),n===Ot.Video?p.createElement("i",{className:"fa fa-play-circle"}):null))}return null}},{key:"render",value:function(){var e=this.props.message;if("@system@"===e.sender)return this.renderSystemMessage(e);var t=e.sender===this.props.currentAttendee.id,n=this.formatTime(e.sentAt),r="chat-message"+(t?" own":"")+(e.readAt.getTime()===new Date(0).getTime()?" new":""),o=this.props.attendees.get(e.sender);return p.createElement("div",{className:r,title:n},p.createElement("div",{className:"message-wrapper"},p.createElement("div",{className:"message-bubble"},p.createElement("p",{className:"message-content",dangerouslySetInnerHTML:{__html:Object(Dt.a)(e.text)}}),this.renderAttachments(e),this.renderChallengeSubmission(e)),this.props.showMessageDetails?p.createElement("div",{className:"message-data"},!t&&p.createElement("span",{className:"author"},o?p.createElement(p.Fragment,null,p.createElement(Zt.a,{source:o,width:30,height:30,fontSize:12}),p.createElement("div",{className:"name"},o.name)):p.createElement("div",{className:"name"},"Unknown")),p.createElement("span",{className:"time"},n)):null))}},{key:"_onChallengeSubmissionPreview",value:function(){var e=this.props.message.challengeSubmission;e&&this.props.onChallengeSubmissionPreview(e)}}]),t}(p.Component),Object(l.a)(Ft.prototype,"_onChallengeSubmissionPreview",[d.a],Object.getOwnPropertyDescriptor(Ft.prototype,"_onChallengeSubmissionPreview"),Ft.prototype),Ft),$t=(n(1410),function(e){return!0}),en=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).messageContainerRef=void 0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._markMessagesAsReadWithDelay()}},{key:"componentDidUpdate",value:function(e){var t=this;this.props.messages.size>e.messages.size&&(setTimeout((function(){t._smartScrolling(t.props.messages.last())})),this._markMessagesAsRead(this.props)),(this.props.visible&&!e.visible||this._differentRecipients(e,this.props))&&this._markMessagesAsReadWithDelay()}},{key:"scrollBottom",value:function(){var e=this.messageContainerRef;e.scrollTop=e.scrollHeight}},{key:"render",value:function(){var e=this,t=this.props.messages.filter((function(t){return(e.props.messageFilter||$t)(t)&&!!t.text})).toArray();return p.createElement("div",{ref:function(t){return e.messageContainerRef=t},className:"messages-list"},p.createElement("div",null,t.map((function(n,r){var o=!0;if(r!==t.length-1){var i=t[r+1];o=n.sender!==i.sender}return p.createElement(Qt,{key:"msg-"+n.id,currentAttendee:e.props.currentAttendee,message:n,onAttachmentClick:e.props.onOpenAttachment,onChallengeSubmissionPreview:e.props.onChallengeSubmissionPreview,attendees:e.props.attendees,showMessageDetails:o})}))))}},{key:"_smartScrolling",value:function(e){var t=this.messageContainerRef;(e.sender===this.props.currentAttendee.id||t.scrollHeight-(t.scrollTop+t.offsetHeight)<250)&&this.scrollBottom()}},{key:"_markMessagesAsRead",value:function(e){if(e.visible)for(var t=new Date(0).getTime(),n=e.messages.size-1;n>=0;n-=1){var r=e.messages.get(n),o=e.dispatch,i=e.asyncActions,s=e.room,a=e.currentAttendee;r.readAt.getTime()===t&&r.sender!==a.id&&(e.messageFilter||$t)(r)&&o(i.markMessageAsRead(s,r,a))}}},{key:"_markMessagesAsReadWithDelay",value:function(){var e=this;setTimeout((function(){e._markMessagesAsRead(e.props)}),500)}},{key:"_differentRecipients",value:function(e,t){return e.recipients.size!==t.recipients.size||e.audience!==t.audience||e.recipients.map((function(e){return!t.recipients.has(e.id)})).find((function(e){return e}))}}]),t}(p.Component),tn=(n(1411),zt={},Object(Re.a)(zt,Je.Off,Je.Zoom),Object(Re.a)(zt,Je.Zoom,Je.Control),Object(Re.a)(zt,Je.Control,Je.Broadcast),Object(Re.a)(zt,Je.Broadcast,Je.Off),zt),nn=(Bt={},Object(Re.a)(Bt,Je.Off,Je.Zoom),Object(Re.a)(Bt,Je.Zoom,Je.Control),Object(Re.a)(Bt,Je.Control,Je.Off),Bt),rn=(Wt={},Object(Re.a)(Wt,Je.Control,Je.Off),Object(Re.a)(Wt,Je.Off,Je.Control),Wt),on=(Ht=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){if(e.vms!==this.props.vms){var t=this._getVm(e);this.vm!==t&&this.forceUpdate()}}},{key:"goNext",value:function(){this.onControlStateChange(this.next)}},{key:"render",value:function(){var e=this.props.course.type===b.y.Recorded?yt:this.props.course.type===b.y.Collaboration?ft:mt;return p.createElement(at.b,{className:"vm-control-button empty",disabled:this.props.disabled||!this.isVMReady,onClick:this.goNext},e[this.next])}},{key:"_getVm",value:function(e){return e.attendee?e.vms.get(e.attendee.virtualMachineId):null}},{key:"next",get:function(){return this.props.course.type===b.y.Recorded?nn[this.getCtrlState()]:this.props.course.type===b.y.Collaboration?rn[this.getCtrlState()]:tn[this.getCtrlState()]}},{key:"vm",get:function(){return this._getVm(this.props)}},{key:"isVMReady",get:function(){return!(!this.vm||this.vm.state!==b.kb.Ready)}}]),t}(vt),Object(l.a)(Ht.prototype,"goNext",[d.a],Object.getOwnPropertyDescriptor(Ht.prototype,"goNext"),Ht.prototype),Ht),sn=(Gt=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).messagesListRef=void 0,n.messageInputRef=void 0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"scrollBottom",value:function(){this.messagesListRef.scrollBottom()}},{key:"messageHandler",value:function(e,t){return function(e,t,n,r,o,i,s,a,c){try{return e(Rt(t,n,r,o,i,s,a,c))}catch(l){return console.log(l),Promise.reject(l)}}(this.props.dispatch,this.props.room,this.props.currentAttendee,this.props.guide,e,this.props.recipients,this.props.asyncActions,this.props.audience,t)}},{key:"focusMessageInput",value:function(){this.messageInputRef&&this.messageInputRef.focus()}},{key:"render",value:function(){var e=this,t=this.renderControlButtons(),n=!this.props.fullSize&&!this.noAudience;return p.createElement("div",{className:"chat-box"},p.createElement("div",{className:"header"},n?p.createElement("div",{className:"back-button",onClick:this.props.clearSelection},p.createElement("i",{className:"fa fa-angle-left"}),p.createElement("span",null,"Back")):null,p.createElement("div",{className:"name"+(t?" with-control-buttons":"")+(n?" with-back-button":"")},p.createElement("div",null,this.props.audience===Yt.Private?this.props.recipient?p.createElement(bt,{attendee:this.props.recipient}):null:this.props.audience===Yt.Public?"Everyone":null)),t),p.createElement("div",{className:"chat-content-wrapper"},this.props.chatBg&&p.createElement("div",{className:"chat-bg"},this.props.chatBg),p.createElement(en,{ref:function(t){return e.messagesListRef=t},visible:this.props.visible,room:this.props.room,audience:this.props.audience,recipients:this.props.recipients,currentAttendee:this.props.currentAttendee,messages:this.props.messages,messageFilter:this.props.messageFilter,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,attendees:this.props.attendees,onOpenAttachment:this.props.onOpenAttachment,onChallengeSubmissionPreview:this.props.onChallengeSubmissionPreview})),p.createElement(It,{ref:function(t){return e.messageInputRef=t},isGuide:this.props.guide.id===this.props.currentAttendee.id,room:this.props.room,course:this.props.course,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,placeholder:this.props.placeholder,messageHandler:this.messageHandler,currentAttendee:this.props.currentAttendee,remoteClientManager:this.props.remoteClientManager}))}},{key:"renderControlButtons",value:function(){var e=this.attendee;if(this.noAudience||!e||this.props.currentAttendee.access!==b.f.Guide)return null;var t=this.props.vms.get(e.virtualMachineId),n=!t||!t.screenshot||t.state!==b.kb.Ready||!e.connected;return this.props.course.type===b.y.Collaboration&&(n=!t),p.createElement(on,{dispatch:this.props.dispatch,guide:this.props.guide,asyncActions:this.props.asyncActions,broadcastVm:this.props.broadcastVm,attendee:e,focusAttendee:this.props.focusAttendee,course:this.props.course,vms:this.props.vms,disabled:this.props.disableVmControls||n,onFocusAttendee:this.props.onFocusAttendee,onUnfocusAttendee:this.props.onUnfocusAttendee})}},{key:"attendee",get:function(){var e=this;return this.props.audience===Yt.Private&&this.props.recipient?this.props.attendees.find((function(t){return t.id===(e.props.recipient||{}).id})):null}},{key:"noAudience",get:function(){return this.props.audience===Yt.NotAssigned}}]),t}(p.Component),Object(l.a)(Gt.prototype,"messageHandler",[d.a],Object.getOwnPropertyDescriptor(Gt.prototype,"messageHandler"),Gt.prototype),Gt),an=(n(1412),n(1413),new Date(0).getTime()),cn=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"chat-attendee"+(this.props.selected?" selected":""),onClick:this.props.onClick},p.createElement("div",{className:"user-info"},p.createElement("div",{className:"avatar-container"+(this.isOnline?" online":"")},this.props.avatar),p.createElement("div",{className:"content-wrapper"+(this.props.message&&this.props.message.readAt.getTime()===an&&this.props.message.sender!==this.props.currentAttendee.id?" new-message":"")},p.createElement("div",{className:"details",style:{marginTop:this.props.message?"0":"9px"}},p.createElement("div",{className:"user-name","data-name":this.props.attendee?this.props.attendee.name:"Everyone"},this.renderName())),p.createElement("div",{className:"message-preview"},this.props.message?Object(Dt.a)(this.props.message.text,!1):null))))}},{key:"renderName",value:function(){var e=this.props.attendee;return e?p.createElement(bt,{attendee:e}):"Everyone"}},{key:"isOnline",get:function(){return this.props.attendee&&this.props.attendee.online}}]),t}(p.Component),ln=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"lastAttendeeMessage",value:function(e){for(var t=this.props.messages.size-1;t>=0;t-=1){var n=this.props.messages.get(t),r=!e&&n.public,o=e&&!n.public;if(r||o&&(n.sender===e||n.recipients.find((function(t){return t===e}))))return n}return null}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:this.className,style:{display:this.props.hide?"none":"block"}},this.props.currentAttendee.e2e?null:p.createElement(cn,{onClick:function(){return e.props.onSelect(Yt.Public,null)},selected:this.props.audience===Yt.Public,key:"chat-attendee-broadcast",message:this.lastAttendeeMessage(),avatar:p.createElement("div",{className:"public-chat-icon"}),currentAttendee:this.props.currentAttendee}),this.props.attendees.toList().map((function(t){return p.createElement(cn,{onClick:function(){return e.props.onSelect(Yt.Private,t)},selected:!!e.props.selected&&e.props.audience===Yt.Private&&e.props.selected.id===t.id,key:"chat-attendee-"+t.id,message:e.lastAttendeeMessage(t.id),avatar:p.createElement(Zt.a,{source:t,width:40,height:40,fontSize:12}),attendee:t,currentAttendee:e.props.currentAttendee})})))}},{key:"className",get:function(){var e="chat-attendees-list";return this.props.className&&(e+=" ".concat(this.props.className)),e}}]),t}(p.PureComponent),pn=n(1060);!function(e){e[e.NotAssigned=0]="NotAssigned",e[e.Public=1]="Public",e[e.Private=2]="Private"}(Yt||(Yt={}));var un,hn,dn,mn,yn,fn,vn,bn,gn,_n,kn,On,wn,Cn,En,jn=(Kt=function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._chatBoxRef=void 0,n._container=void 0,n._resizeObserver=void 0;var r=n._filterE2EAttendees(),i=n._filterVisibleAttendeesInList(r);return n.state={fullSize:!1,recipientId:null,audience:Yt.NotAssigned,visibleAttendees:r,visibleAttendeesInList:i},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._selectStudentIfCollaborationMode()}},{key:"componentDidUpdate",value:function(e,t){var n=this;if(this.props.attendees!==e.attendees||this.props.messages!==e.messages){var r=this._filterE2EAttendees(),o=this._filterVisibleAttendeesInList(r);this.setState({visibleAttendees:r,visibleAttendeesInList:o},(function(){1===n.state.visibleAttendeesInList.count()&&0===t.visibleAttendeesInList.count()&&n._selectStudentIfCollaborationMode()}))}}},{key:"containerMounted",value:function(e){e?(this._container=e,this._resizeObserver=new pn.a(this.onResize),this._resizeObserver.observe(e)):this._resizeObserver&&this._container&&(this._resizeObserver.unobserve(this._container),this._container=null)}},{key:"onResize",value:function(){if(this._container){var e=this._container.getBoundingClientRect().width;this.setState({fullSize:e>650})}}},{key:"onSelectRecipient",value:function(e,t){var n=t?t.id:null;this.setState({audience:e,recipientId:n}),this.focusChat()}},{key:"focusChat",value:function(){var e=this;setTimeout((function(){e._chatBoxRef&&(e._chatBoxRef.focusMessageInput(),e._chatBoxRef.scrollBottom())}),10)}},{key:"clearSelection",value:function(){this.setState({recipientId:null,audience:Yt.NotAssigned})}},{key:"messageFilter",value:function(e){if(this.noAudience)return!1;var t=this.state.recipientId;return this.state.audience===Yt.Public?e.public:!e.public&&!!t&&!(e.sender!==t&&!e.recipients.find((function(e){return e===t})))}},{key:"onFocusAttendee",value:function(){this.props.onFocusAttendee&&this.props.onFocusAttendee()}},{key:"onUnfocusAttendee",value:function(){this.props.onUnfocusAttendee&&this.props.onUnfocusAttendee()}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"chat-widget",ref:this.containerMounted},p.createElement(ln,{className:this.noAudience?"":"has-audience",onSelect:this.onSelectRecipient,selected:this.recipient,audience:this.state.audience,attendees:this.state.visibleAttendeesInList,messages:this.props.messages,currentAttendee:this.props.currentAttendee,hide:!this.state.fullSize&&!this.noAudience}),!this.noAudience&&p.createElement(sn,{ref:function(t){return e._chatBoxRef=t},visible:this.props.visible,room:this.props.room,course:this.props.course,recipient:this.recipient,recipients:this.recipients,attendees:this.state.visibleAttendees,guide:this.props.guide,messageFilter:this.messageFilter,clearSelection:this.clearSelection,currentAttendee:this.props.currentAttendee,remoteClientManager:this.props.remoteClientManager,audience:this.state.audience,dispatch:this.props.dispatch,messages:this.props.messages,asyncActions:this.props.asyncActions,chatBg:"",placeholder:this.placeholder,fullSize:this.state.fullSize,vms:this.props.vms,broadcastVm:this.props.broadcastVm,disableVmControls:this.props.disableVmControls,focusAttendee:this.props.focusAttendee,onFocusAttendee:this.onFocusAttendee,onUnfocusAttendee:this.onUnfocusAttendee,onOpenAttachment:this.props.onOpenAttachment,onChallengeSubmissionPreview:this.props.onChallengeSubmissionPreview}))}},{key:"_selectStudentIfCollaborationMode",value:function(){if(this.isCollaboration&&this.props.currentAttendee.access===b.f.Guide){var e=this.state.visibleAttendees.find((function(e){return e.access===b.f.Student}));e&&this.onSelectRecipient(Yt.Private,e)}}},{key:"_filterVisibleAttendeesInList",value:function(e){var t=this.props,n=t.currentAttendee,r=t.focusAttendee,o=t.messages.filter((function(e){return!e.public}));return e.filter((function(e){return e.id!==n.id&&(e.online||o.some((function(t){return t.sender===e.id||t.recipients.contains(e.id)})))})).sort(ee(r))}},{key:"_filterE2EAttendees",value:function(){var e=this;return this.props.attendees.filter((function(t){return t.e2e===e.props.currentAttendee.e2e}))}},{key:"recipient",get:function(){return this.state.recipientId?this.state.visibleAttendees.get(this.state.recipientId):null}},{key:"recipients",get:function(){return this.state.audience===Yt.Private&&this.state.recipientId?Object(gt.Map)([[this.state.recipientId,this.recipient]]):Object(gt.Map)([])}},{key:"noAudience",get:function(){return this.state.audience===Yt.NotAssigned}},{key:"placeholder",get:function(){return this.state.audience===Yt.Public?"Send message to everyone":this.recipient?this.recipient.access===b.f.Guide?"Send a message to the host":"Send a message to ".concat(this.recipient.name):""}},{key:"isCollaboration",get:function(){return this.props.course.type===b.y.Collaboration}}]),t}(p.PureComponent),Object(l.a)(Kt.prototype,"containerMounted",[d.a],Object.getOwnPropertyDescriptor(Kt.prototype,"containerMounted"),Kt.prototype),Object(l.a)(Kt.prototype,"onResize",[d.a],Object.getOwnPropertyDescriptor(Kt.prototype,"onResize"),Kt.prototype),Object(l.a)(Kt.prototype,"onSelectRecipient",[d.a],Object.getOwnPropertyDescriptor(Kt.prototype,"onSelectRecipient"),Kt.prototype),Object(l.a)(Kt.prototype,"focusChat",[d.a],Object.getOwnPropertyDescriptor(Kt.prototype,"focusChat"),Kt.prototype),Object(l.a)(Kt.prototype,"clearSelection",[d.a],Object.getOwnPropertyDescriptor(Kt.prototype,"clearSelection"),Kt.prototype),Object(l.a)(Kt.prototype,"messageFilter",[d.a],Object.getOwnPropertyDescriptor(Kt.prototype,"messageFilter"),Kt.prototype),Object(l.a)(Kt.prototype,"onFocusAttendee",[d.a],Object.getOwnPropertyDescriptor(Kt.prototype,"onFocusAttendee"),Kt.prototype),Object(l.a)(Kt.prototype,"onUnfocusAttendee",[d.a],Object.getOwnPropertyDescriptor(Kt.prototype,"onUnfocusAttendee"),Kt.prototype),Kt),Sn=(n(1414),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"chat-notification"},p.createElement("div",{className:"fill"}),p.createElement("div",{className:"content",onClick:this.props.onClick},this.senderAttendee&&p.createElement(Zt.a,{source:this.senderAttendee,width:25,height:25,fontSize:10}),p.createElement("div",{className:"sender-name"},this.senderName,this.props.message.public&&' in "Everyone"')))}},{key:"senderAttendee",get:function(){return this.props.attendees.get(this.props.message.sender)}},{key:"senderName",get:function(){return"@system@"!==this.props.message.sender?this.senderAttendee.name:"System"}}]),t}(p.PureComponent)),Pn=(n(1047),n(289)),Tn=(un=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).state={isEnding:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"close",value:function(){this.props.onToggle(!1)}},{key:"end",value:function(){var e=this;this.setState({isEnding:!0}),this.props.onEnd().catch((function(){return e.setState({isEnding:!1})}))}},{key:"render",value:function(){return p.createElement(Pn.a,{visible:this.props.visible,onToggle:this.props.onToggle,title:"".concat(this.label," Session?"),size:"small"},p.createElement("div",{className:"form-styles"},p.createElement("p",{className:"text"},"Are you sure you want to ",this.label.toLowerCase()," the session?"),p.createElement("div",{className:"button-sequence"},p.createElement(at.b,{className:"short-btn",onClick:this.close,disabled:this.state.isEnding},"No"),p.createElement(at.b,{className:"short-btn empty",onClick:this.end,loading:this.state.isEnding},"Yes"))))}},{key:"label",get:function(){switch(this.props.label){case"leave":return"Leave";default:return"End"}}}]),t}(p.Component),Object(l.a)(un.prototype,"close",[d.a],Object.getOwnPropertyDescriptor(un.prototype,"close"),un.prototype),Object(l.a)(un.prototype,"end",[d.a],Object.getOwnPropertyDescriptor(un.prototype,"end"),un.prototype),un),Rn=(n(1415),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.visible?p.createElement("div",{className:"error-alert"},this.props.message):null}}]),t}(p.Component)),An=(n(1416),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.on?p.createElement("div",{className:this.className},this.props.children):null}},{key:"className",get:function(){var e="rhyme-overlay";return"light"===this.props.type?e+=" light":e+=" dark",this.props.className&&(e+=" "+this.props.className),e}}]),t}(p.Component)),Dn=(n(1417),n(1070)),Mn=n(1135),xn=(hn=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._resizing=void 0,n._rightPanel=void 0,n._splitScreen=void 0,n._resizeEntry=void 0,n._resizeObserver=void 0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._resizeEntry=Dn.b.create({},(function(){e.props.sidebarMode&&e._updateExpandModeSidebarWidth(e.props.sidebarMode)}))}},{key:"componentWillUnmount",value:function(){Dn.b.destroy(this._resizeEntry),this._rightPanel&&this._resizeObserver.unobserve(this._rightPanel)}},{key:"componentDidUpdate",value:function(e){var t=this.props.sidebarMode,n=e.sidebarMode;t&&n&&t.mode!==n.mode&&this._handleSidebarMode(t)}},{key:"onRightPanelResize",value:function(){if(this._rightPanel&&this.props.onSidebarResize){var e=this._rightPanel.style.width;if(e&&"auto"!==e){var t=parseInt(e.replace("px",""),10);Number.isNaN(t)||this.props.onSidebarResize(t)}}}},{key:"onPanelsRefs",value:function(e,t){this.props.onPanelsRefs&&this.props.onPanelsRefs(e,t),this._rightPanel=t,this._resizeObserver=new pn.a(this.onRightPanelResize),this._resizeObserver.observe(this._rightPanel)}},{key:"onResizeStart",value:function(){this._resizing=!0;var e=this.props.sidebarMode;e&&e.mode===b.V.Close&&this.props.dispatch(new m.H(b.V.Dock))}},{key:"onResizeEnd",value:function(){this._resizing=!1}},{key:"render",value:function(){var e=this;return p.createElement(Mn.a,{ref:function(t){return e._splitScreen=t},vm:this.props.vm,template:this.props.template,onEvent:this.props.onEvent,cameraStream:this.props.cameraStream,emitCursor:this.props.emitCursor,rightPanelWidth:this.props.rightPanelWidth,isViewExpanded:this.props.isViewExpanded,showViewbox:this.props.showViewbox,viewboxSize:this.props.viewboxSize,readOnly:this.props.readOnly,cursorPosition:this.props.cursorPosition,dispatch:this.props.dispatch,overlay:this.props.overlay,className:this.className,controls:this.props.controls,asyncActions:this.props.asyncActions,leftPanelChildren:this.leftPanelChildren,onReadWriteInit:this.props.onReadWriteInit,onConnect:this.props.onConnect,onDisconnect:this.props.onDisconnect,onPanelsRefs:this.onPanelsRefs,onResize:this.props.onResize,onResizeStart:this.onResizeStart,onResizeEnd:this.onResizeEnd,vmAccessLimitReached:this.props.vmAccessLimitReached},p.createElement("div",{className:"sidebar"},this.props.children))}},{key:"_handleSidebarMode",value:function(e){if(this._rightPanel){var t=this._rightPanel.parentElement;if(t){switch(this._resetRightPanelLayoutToDefault(this._rightPanel),e.mode){case b.V.Close:t.style.width=y.a.ButtonsBarWidth+"px",this._handleOnResize(y.a.ButtonsBarWidth);break;case b.V.Dock:this._resizing||(t.style.width="500px",this._handleOnResize(500));break;case b.V.Expand:t.style.width="0px",this._rightPanel.classList.add("expanded"),this._updateExpandModeSidebarWidth(e)}this._adjustLayout()}}}},{key:"_updateExpandModeSidebarWidth",value:function(e){if(e.mode===b.V.Expand&&this._rightPanel){var t=this.props.calculateSidebarWidth,n=t?t():850;this._rightPanel.style.width=n+"px"}}},{key:"_resetRightPanelLayoutToDefault",value:function(e){e.classList.remove("expanded"),e.style.width="auto"}},{key:"_adjustLayout",value:function(){this._splitScreen&&this._splitScreen.adjustLayout()}},{key:"_handleOnResize",value:function(e){this.props.onResize&&this.props.onResize(window.innerWidth-e-y.a.SplitterWidth,e)}},{key:"className",get:function(){return"session-splitter"+(this.props.className?" "+this.props.className:"")}},{key:"isCollaboration",get:function(){return this.props.course.type===b.y.Collaboration}},{key:"leftPanelChildren",get:function(){var e=this,t=this.props,n=t.broadcastVm,r=t.currentAttendee;return p.createElement(p.Fragment,null,p.createElement("div",{className:"upper-left-pane-message"},function(){if(r.access===b.f.Guide){var t=e.props.attendees.find((function(e){return e.controlled}));return!!t&&n.id===t.virtualMachineId?e.isCollaboration?"You are controlling this cloud workspace":"You are broadcasting ".concat(t.name,"'s cloud workspace to everyone"):t?"You are controlling ".concat(t.name,"'s cloud workspace"):e.props.isViewExpanded?"Expand Mode: Learners see your full screen and can\u2019t follow along":"Collapse Mode: Learners can follow along by watching only the highlighted section of your cloud workspace"}return e.isCollaboration?r.controlled?"Host is now controlling":"You are controlling this cloud workspace":n.id===r.virtualMachineId?"Host is now broadcasting":r.controlled?"Host is now controlling":""}()),this.props.leftPanelChildren)}}]),t}(p.Component),Object(l.a)(hn.prototype,"onRightPanelResize",[d.a],Object.getOwnPropertyDescriptor(hn.prototype,"onRightPanelResize"),hn.prototype),Object(l.a)(hn.prototype,"onPanelsRefs",[d.a],Object.getOwnPropertyDescriptor(hn.prototype,"onPanelsRefs"),hn.prototype),Object(l.a)(hn.prototype,"onResizeStart",[d.a],Object.getOwnPropertyDescriptor(hn.prototype,"onResizeStart"),hn.prototype),Object(l.a)(hn.prototype,"onResizeEnd",[d.a],Object.getOwnPropertyDescriptor(hn.prototype,"onResizeEnd"),hn.prototype),hn),Nn=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.children}}]),t}(p.Component),Vn=(n(1418),function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._rendered={};var r=(e.children||[]).filter((function(e){return!!e}));return n._validate(r),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"switchView",value:function(e){var t=this;this.setState({visible:e},(function(){t.props.onViewChange&&t.props.onViewChange(e)}))}},{key:"render",value:function(){var e=this,t=this.props.children.filter((function(e){return!!e}));return t?p.createElement("div",{className:"rhyme-views "+(this.props.className||""),style:this.props.style},t.map((function(t,n){var r=t.props.id;return r===e.props.visible?(e._rendered[r]=!0,p.createElement("div",{style:{display:"block"},key:"tn-"+n},e._renderChildren(t.props.children,!0))):e._rendered[r]&&!t.props.destroyOnLeave||t.props.renderOnInit?(e._rendered[r]=!0,p.createElement("div",{style:{display:"none"},key:"tn-"+n},e._renderChildren(t.props.children,!1))):null}))):null}},{key:"_validate",value:function(e){var t={};e.filter((function(e){return!!e})).forEach((function(e){if(t[e.props.id])throw new Error('Views component: The views should have unique tab IDs. "'.concat(e.props.id,'" is duplicated.'));t[e.props.id]=!0}))}},{key:"_renderChildren",value:function(e,t){return p.Children.map(e,(function(e){var n=Object(r.a)({},e.props);return n.tabVisible=t,p.cloneElement(e,n)}))}}]),t}(p.Component)),Ln=(n(1419),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement(An,{on:this.props.on},p.createElement("div",{className:"vm-onboarding"},p.createElement("p",null,"This is your cloud workspace"),p.createElement(at.b,null,"Click to access")))}}]),t}(p.Component)),Un=function(){function e(t){Object(o.a)(this,e),this._roomId=t,this._closedChallengeSubmissionNotifications=[];var n=Object(O.d)(O.a.ClosedChallengeSubmissionNotifications);n&&n[t]&&(this._closedChallengeSubmissionNotifications=n[t])}return Object(i.a)(e,[{key:"isClosed",value:function(e){return this._closedChallengeSubmissionNotifications.indexOf(e.id)>=0}},{key:"close",value:function(e){var t=Object(O.d)(O.a.ClosedChallengeSubmissionNotifications)||{};this._closedChallengeSubmissionNotifications.push(e.id),t[this._roomId]=this._closedChallengeSubmissionNotifications,Object(O.h)(O.a.ClosedChallengeSubmissionNotifications,t)}},{key:"clear",value:function(){this._closedChallengeSubmissionNotifications=[],Object(O.c)(O.a.ClosedChallengeSubmissionNotifications)}}]),e}(),In=n(1050),Fn=n.n(In),zn=n(47),Bn=n(45),Wn=n(123),Hn=n(1119),Gn=function(){var e=Object(Nt.a)(xt.a.mark((function e(t,n){var r,o,i,s,a,c,l,p,u,h,d,m,y,f;return xt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.name.match(/(.*[\\/])?(.*)/)||[],o=Object(zn.a)(r,3),i=o[2]){e.next=3;break}throw new Error("Could not match filename ".concat(n.name));case 3:return e.next=5,Object(Hn.a)(t);case 5:return s=e.sent,a=s.tunnel,c=s.filesystem,l=s.token,p=s.client,u=function(){return p.disconnect()},e.next=13,new Promise((function(e){return c.object.requestInputStream(n.streamName,e)}));case 13:return(h=e.sent).onblob=function(){return h.sendAck("OK",Bn.Status.Code.SUCCESS)},h.onend=function(){return setTimeout(u,5e3)},d=t.protocol+"://"+t.host+"/api/session/tunnels/"+a.uuid+"/streams/"+encodeURIComponent(h.index)+"/"+encodeURIComponent(Object(Wn.d)(i))+"?token="+encodeURIComponent(l),e.prev=17,e.next=20,fetch(d,{method:"GET",credentials:"include",mode:"cors"});case 20:return m=e.sent,e.next=23,m.blob();case 23:y=e.sent,(f=Object.assign(document.createElement("a"),{href:URL.createObjectURL(y),download:n.name,target:"_blank"})).click(),URL.revokeObjectURL(f.href),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(17),console.error(e.t0);case 32:return e.prev=32,u(),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[17,29,32,35]])})));return function(t,n){return e.apply(this,arguments)}}(),Kn=n(296),Yn=n(293),qn=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"download-file-confirmation-modal form-styles"},p.createElement(Pn.a,{title:"Download File",visible:this.props.isVisible,onToggle:this.props.onClose,size:"small"},p.createElement("p",{className:"text"},'Are you sure you want to download file "',this.props.file.name,'"?'),p.createElement("div",{className:"button-sequence"},p.createElement(at.b,{className:"short-btn",onClick:this.props.onDownload},"Yes"),p.createElement(at.b,{className:"short-btn empty",onClick:this.props.onClose},"No"))))}}]),t}(p.PureComponent),Zn=(n(1420),function(e,t){return e.type===Wn.c.NORMAL&&t.type===Wn.c.DIRECTORY?1:e.type===Wn.c.DIRECTORY&&t.type===Wn.c.NORMAL?-1:e.name>t.name?1:e.name<t.name?-1:0}),Jn={startsWith:["."],endsWith:[".lnk",".desktop"]},Xn=function(e){var t=e.name.toLowerCase();return!Jn.startsWith.map((function(e){return t.startsWith(e)})).reduce((function(e,t){return e||t}),!1)&&!Jn.endsWith.map((function(e){return t.endsWith(e)})).reduce((function(e,t){return e||t}),!1)},Qn=function(e){return!0},$n=(dn=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._fileSystem=null,n._folderContentRef=void 0,n.state={currentDirectory:null,fileToDownload:null,downloading:!1,isDownloadModalVisible:!1,isLoadingDirectory:!1,showAllFiles:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.client&&this._onRemoteClientInit()}},{key:"componentDidUpdate",value:function(e){this.props.remoteClient&&!e.remoteClient&&this._onRemoteClientInit()}},{key:"componentWillUnmount",value:function(){this.client&&this.client.off(Yn.c,this._fileSystemReadyHandler),this._fileSystem&&(this._fileSystem.off(Kn.b.Initialized,this._initializeHandler),this._fileSystem.off(Kn.b.CurrentDirectoryUpdate,this._currentDirectoryUpdateHandler),this._fileSystem.off(Kn.b.LoadDirectory,this._loadDirectoryHandler))}},{key:"toggleDownloadModal",value:function(e){this.setState({isDownloadModalVisible:e})}},{key:"onDownloadModalClose",value:function(){this.toggleDownloadModal(!1)}},{key:"onDownload",value:function(){var e=this;if(this.toggleDownloadModal(!1),this.props.vm&&this.state.fileToDownload){this.setState({downloading:!0});var t=function(){e.state.downloading&&e.setState({downloading:!1,fileToDownload:null})};Gn(this.props.vm.connection,this.state.fileToDownload).then(t).catch(t)}}},{key:"render",value:function(){var e=this.state,t=e.downloading,n=e.currentDirectory,r=e.fileToDownload,o=e.isDownloadModalVisible;return p.createElement("div",{className:Fn()("vm-file-browser",this.props.disabled&&"disabled")},t?p.createElement(p.Fragment,null,p.createElement("h2",null,"Your file is downloading"),p.createElement("p",{className:"description"},"If the file is large, it might take a while"),p.createElement(w.a,{theme:"dark"})):p.createElement(p.Fragment,null,p.createElement("h2",null,"Download File: "),p.createElement("div",{className:"description"},"Click on a file to download it"),n?this._renderDirectory(n):p.createElement(w.a,{theme:"dark"}),r?p.createElement(qn,{isVisible:o,file:r,onClose:this.onDownloadModalClose,onDownload:this.onDownload}):null))}},{key:"_renderDirectory",value:function(e){var t=this;return p.createElement("div",{className:"wrapper"},p.createElement("div",{className:"show-hide"},p.createElement("span",{className:this.state.showAllFiles?"hide":"show-all",onClick:this._toggleFilesFilter},this.state.showAllFiles?"Hide":"Show All")),p.createElement("div",{className:"back"+(e.parent?"":" disabled"),onClick:this._onBack,title:e.parent?e.parent.name:""},p.createElement("i",{className:"fa fa-chevron-left"}),e.parent?p.createElement("span",{className:"parent-folder"},e.parent.name):null,this.state.isLoadingDirectory?p.createElement(w.a,{theme:"dark"}):null),p.createElement("div",{className:"current-folder",onClick:this._onBack},p.createElement("div",{title:e.name},p.createElement("i",{className:"fa fa-folder-open"}),p.createElement("span",null,e.name)),p.createElement("i",{className:"fa fa-refresh refresh-icon",onClick:this._onRefresh})),p.createElement("div",{className:"folder-content",ref:this._onFolderContentRef},e.files.toList().filter(this.state.showAllFiles?Qn:Xn).sort(Zn).map((function(e,n){return p.createElement("div",{className:"content-item",key:"".concat(n,"-").concat(e.name),onClick:function(){return t._onClick(e)},title:e.name},e.type===Wn.c.DIRECTORY?p.createElement("i",{className:"fa fa-folder file-type"}):p.createElement("i",{className:"fa fa-file file-type"}),p.createElement("span",null,e.name))}))))}},{key:"_onRemoteClientInit",value:function(){this.client&&(this.client.getFileSystem()?this._fileSystemReadyHandler():this.client.on(Yn.c,this._fileSystemReadyHandler))}},{key:"_fileSystemReadyHandler",value:function(){this.client&&(this._fileSystem=this.client.getFileSystem(),this._fileSystem&&(this.setState({currentDirectory:this._fileSystem.currentDirectory}),this._fileSystem.on(Kn.b.Initialized,this._initializeHandler),this._fileSystem.on(Kn.b.CurrentDirectoryUpdate,this._currentDirectoryUpdateHandler),this._fileSystem.on(Kn.b.LoadDirectory,this._loadDirectoryHandler),this._fileSystem.isInitialized&&this._initializeHandler()))}},{key:"_initializeHandler",value:function(){if(this.props.vm){var e=this.props.vm.connection.options.fileSystemDefaultPath;if(e){var t=e.split(/[\\, \/]+/).filter((function(e){return e}));this._moveToDirectory(t)}}}},{key:"_currentDirectoryUpdateHandler",value:function(e){this.setState({currentDirectory:e,isLoadingDirectory:!1}),this._folderContentRef&&(this._folderContentRef.scrollTop=0)}},{key:"_loadDirectoryHandler",value:function(e){this.setState({isLoadingDirectory:!0})}},{key:"_onClick",value:function(e){var t=this;e.type===Wn.c.DIRECTORY?this._changeDirectory(e):this.setState({fileToDownload:e},(function(){return t.toggleDownloadModal(!0)}))}},{key:"_onBack",value:function(){var e=this.state.currentDirectory;e&&e.parent&&this._changeDirectory(e.parent)}},{key:"_onRefresh",value:function(e){e.stopPropagation(),this.state.currentDirectory&&this._changeDirectory(this.state.currentDirectory)}},{key:"_changeDirectory",value:function(e){this.client&&this.client.changeDirectory(e)}},{key:"_onFolderContentRef",value:function(e){this._folderContentRef=e}},{key:"_moveToDirectory",value:function(e){this.client&&this.client.moveToDirectory(e)}},{key:"_toggleFilesFilter",value:function(){this.setState({showAllFiles:!this.state.showAllFiles})}},{key:"client",get:function(){return this.props.remoteClient}}]),t}(p.PureComponent),Object(l.a)(dn.prototype,"toggleDownloadModal",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"toggleDownloadModal"),dn.prototype),Object(l.a)(dn.prototype,"onDownloadModalClose",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"onDownloadModalClose"),dn.prototype),Object(l.a)(dn.prototype,"onDownload",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"onDownload"),dn.prototype),Object(l.a)(dn.prototype,"_fileSystemReadyHandler",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"_fileSystemReadyHandler"),dn.prototype),Object(l.a)(dn.prototype,"_initializeHandler",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"_initializeHandler"),dn.prototype),Object(l.a)(dn.prototype,"_currentDirectoryUpdateHandler",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"_currentDirectoryUpdateHandler"),dn.prototype),Object(l.a)(dn.prototype,"_loadDirectoryHandler",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"_loadDirectoryHandler"),dn.prototype),Object(l.a)(dn.prototype,"_onClick",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"_onClick"),dn.prototype),Object(l.a)(dn.prototype,"_onBack",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"_onBack"),dn.prototype),Object(l.a)(dn.prototype,"_onRefresh",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"_onRefresh"),dn.prototype),Object(l.a)(dn.prototype,"_onFolderContentRef",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"_onFolderContentRef"),dn.prototype),Object(l.a)(dn.prototype,"_toggleFilesFilter",[d.a],Object.getOwnPropertyDescriptor(dn.prototype,"_toggleFilesFilter"),dn.prototype),dn),er=n(1129),tr=(n(1211),mn=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).state={isUploading:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"getVms",value:function(){var e=this;return new Promise((function(t){var n=e.props.attendees.set(e.props.guide.id,e.props.guide),r=n.map((function(t){var n=e.props.vms.get(t.virtualMachineId);return n&&n.state===b.kb.Ready&&!n.connection.id?e.props.dispatch(e.props.asyncActions.createAttendeeVMConnection(t)):Promise.resolve()})).toArray();return Promise.all(r).then((function(){var r=n.map((function(t){return e.props.vms.get(t.virtualMachineId)})).filter((function(e){return e&&e.state===b.kb.Ready})).toArray();t(r)}))}))}},{key:"onFileUploadStart",value:function(){this.state.isUploading||this.setState({isUploading:!0})}},{key:"onUploadStart",value:function(){this.props.onUploadStart()}},{key:"onFileUploadCompleted",value:function(){this.setState({isUploading:!1}),this.props.onFileUploadCompleted()}},{key:"render",value:function(){return p.createElement("div",{className:"guide-files-settings files-settings"},p.createElement("h2",null,"Upload File:"),p.createElement(er.a,{vms:this.getVms,dispatch:this.props.dispatch,disabled:this.isFileSystemAccessDisabled,remoteClientManager:this.props.remoteClientManager,label:this.isCollaboration?"Upload files to the cloud workspace":"Upload files to all cloud workspaces",onUploadStart:this.onUploadStart,onFileUploadStart:this.onFileUploadStart,onCompleted:this.onFileUploadCompleted}),this.state.isUploading?p.createElement("div",{className:"uploading-label"},"During file upload, you cannot zoom, control, or broadcast a learner\u2019s cloud workspace"):null,p.createElement("p",{className:"upload-fallback"},"You can also use any upload service like"," ",p.createElement("a",{href:"https://ufile.io",target:"_blank"},"ufile.io")),p.createElement("div",{className:"separator"}),p.createElement($n,{disabled:this.isFileSystemAccessDisabled,remoteClient:this.ownRemoteClient,vm:this.guideOwnVm}))}},{key:"isFileSystemAccessDisabled",get:function(){return!(!this.props.focusVm||this.props.isFocusVmConnected&&this.props.focusVm.id===this.props.guide.virtualMachineId)}},{key:"isCollaboration",get:function(){return this.props.course.type===b.y.Collaboration}},{key:"ownRemoteClient",get:function(){return this.props.focusVm?this.props.remoteClientManager.getRemoteClient(this.props.focusVm.id):void 0}},{key:"guideOwnVm",get:function(){return this.props.vms.get(this.props.guide.virtualMachineId)}}]),t}(p.PureComponent),Object(l.a)(mn.prototype,"getVms",[d.a],Object.getOwnPropertyDescriptor(mn.prototype,"getVms"),mn.prototype),Object(l.a)(mn.prototype,"onFileUploadStart",[d.a],Object.getOwnPropertyDescriptor(mn.prototype,"onFileUploadStart"),mn.prototype),Object(l.a)(mn.prototype,"onUploadStart",[d.a],Object.getOwnPropertyDescriptor(mn.prototype,"onUploadStart"),mn.prototype),Object(l.a)(mn.prototype,"onFileUploadCompleted",[d.a],Object.getOwnPropertyDescriptor(mn.prototype,"onFileUploadCompleted"),mn.prototype),mn),nr=(n(1212),n(1421),n(1068)),rr=(yn=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"releaseKeys",value:function(){var e,t=this.props.vm,n=this.props.remoteClientManager.getRemoteClient(t.id);n?(n.releaseAllKeys(),e=new b.J({text:"Keys released",type:b.K.General})):e=new b.J({text:"Couldn't release keys",type:b.K.Error}),this.props.dispatch(new m.i(e))}},{key:"render",value:function(){return p.createElement("div",{className:"release-keys-button"},p.createElement(at.b,{className:"empty",onClick:this.releaseKeys,disabled:!this.props.vm},"Release Keys"),p.createElement(nr.a,{position:"bottom-left"},"If any of your keys are stuck in the cloud workspace,",p.createElement("br",null),"click this button to release them all"))}}]),t}(p.Component),Object(l.a)(yn.prototype,"releaseKeys",[d.a],Object.getOwnPropertyDescriptor(yn.prototype,"releaseKeys"),yn.prototype),yn),or=(n(1422),n(245)),ir=(n(1423),["red","orange","yellow","apple-green","green"]),sr=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return p.createElement("div",{className:"call-quality-indicator tooltip rel b ra "+ir[this.quality],"data-tooltip":"Call quality"},new Array(this.quality).fill(null).map((function(t,n){return p.createElement("div",{key:"qi-"+n,style:{width:3+3*(e.quality-n)}})})),p.createElement("div",null))}},{key:"quality",get:function(){var e=this.props.quality;return e>4?4:e<0?0:e||0}}]),t}(p.Component),ar=(fn={},Object(Re.a)(fn,or.a.HighJitter,1),Object(Re.a)(fn,or.a.HighPacketLoss,1),Object(Re.a)(fn,or.a.HighRTT,1),Object(Re.a)(fn,or.a.LowMOS,1),fn),cr=Object.keys(ar).map((function(e){return ar[e]})).reduce((function(e,t){return e+t})),lr=(vn=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._connQualityUnsubscriber=void 0,n._devicesSetUnsubscriber=void 0,n.state={warnings:Object(gt.Set)([]),inputDevice:"default",outputDevice:"default"},n._listenForWarnings(),n._listenForDevicesSet(),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._updateDevices()}},{key:"componentWillUnmount",value:function(){this._connQualityUnsubscriber(),this._devicesSetUnsubscriber()}},{key:"changeInputDevice",value:function(e){var t=this;this.props.twilioAudio.setInputDevice(e).then((function(){t.setState({inputDevice:e})}))}},{key:"changeOutputDevice",value:function(e){var t=this;this.props.twilioAudio.setOutputDevice(e).then((function(){t.setState({outputDevice:e})}))}},{key:"render",value:function(){return p.createElement("div",{className:"twilio-settings"},p.createElement("div",null,p.createElement("div",{className:"row"},p.createElement("div",{className:"microphone icon",title:"Select microphone"}),p.createElement(at.y,{value:this.state.inputDevice,onChange:this.changeInputDevice,disabled:!this.inputSelectionSupported},this.inputDevices.map((function(e){var t=Object(zn.a)(e,2),n=t[0],r=t[1];return p.createElement(at.n,{value:n,key:"ipdvs-"+n},r.label)})))),!this.props.twilioAudio.inputSelectionSupported&&p.createElement("div",{className:"not-supported"},"This browser doesn't support microphone selection"),p.createElement("div",{className:"row"},p.createElement("div",{className:"volume-up icon",title:"Select speakers"}),p.createElement(at.y,{value:this.state.outputDevice,onChange:this.changeOutputDevice,disabled:!this.outputSelectionSupported},this.outputDevices.map((function(e){var t=Object(zn.a)(e,2),n=t[0],r=t[1];return p.createElement(at.n,{value:n,key:"opdvs-"+n},r.label)})))),!this.props.twilioAudio.outputSelectionSupported&&p.createElement("div",{className:"not-supported"},"This browser doesn't support speakers selection")),p.createElement(sr,{quality:this.quality}))}},{key:"_listenForWarnings",value:function(){var e=this;this._connQualityUnsubscriber=this.props.twilioAudio.onConnectionQualityChange((function(t){var n=e.state.warnings;n=t.active?n.add(t.warning):n.remove(t.warning),e.setState({warnings:n})}))}},{key:"_listenForDevicesSet",value:function(){var e=this;this._devicesSetUnsubscriber=this.props.twilioAudio.onDevicesSet((function(){return e._updateDevices()}))}},{key:"_updateDevices",value:function(){var e=this.props.twilioAudio,t=e.inputDevice,n=e.outputDevice;this.setState({inputDevice:t?t.deviceId:"default",outputDevice:n?n.deviceId:"default"})}},{key:"quality",get:function(){var e=cr/4,t=this.state.warnings.toList().map((function(e){return ar[e]})).reduce((function(e,t){return e+t}),0);return Math.round(4-e*t)}},{key:"outputDevices",get:function(){return Array.from(this.props.twilioAudio.outputDevices)}},{key:"inputDevices",get:function(){return Array.from(this.props.twilioAudio.inputDevices)}},{key:"outputSelectionSupported",get:function(){return this.props.twilioAudio.outputSelectionSupported&&this.outputDevices.length>1}},{key:"inputSelectionSupported",get:function(){return this.props.twilioAudio.inputSelectionSupported&&this.inputDevices.length>1}}]),t}(p.Component),Object(l.a)(vn.prototype,"changeInputDevice",[d.a],Object.getOwnPropertyDescriptor(vn.prototype,"changeInputDevice"),vn.prototype),Object(l.a)(vn.prototype,"changeOutputDevice",[d.a],Object.getOwnPropertyDescriptor(vn.prototype,"changeOutputDevice"),vn.prototype),vn),pr=(bn=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._keyCombo=void 0,n.state={expandViewMode:!1,powerOffModalVisibility:!1,isUploading:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.isLiveSession&&(this._keyCombo=Dn.a.create([At.a,At.l,At.n],(function(){return e.expandView()})))}},{key:"componentWillUnmount",value:function(){this._keyCombo&&Dn.a.destroy(this._keyCombo)}},{key:"muteAll",value:function(){var e=this,t=this.props.attendees.filter((function(t){return t.id!==e.props.guide.id})).map((function(t){return e.props.dispatch(e.props.asyncActions.muteAttendee(e.props.room,t))})).toArray();Promise.all(t).then((function(){var t=new b.J({type:b.K.General,text:"All learners have been muted"});e.props.dispatch(new m.i(t))}))}},{key:"extendTime",value:function(){var e=this,t=this.props.room,n=te(t.expirationTime).add(15,"m");t=t.set("expirationTime",n.toDate()),this.props.dispatch(this.props.asyncActions.updateRoom(this.props.course,t)).then((function(){var t=new b.J({type:b.K.General,text:"The session end time has been extended by ".concat(15," minutes")});e.props.dispatch(new m.i(t))}))}},{key:"expandView",value:function(){var e=this,t=!this.state.expandViewMode;this.props.dispatch(new m.ib(t)),this.setState({expandViewMode:t},(function(){if(e.props.onExpandViewChange(t),t){Object(O.f)(t,e.props.room.id,(function(){return e.props.dispatch(new m.i(new b.J({type:b.K.Expand,title:"Expand Mode",text:"Learners are seeing expanded view of your cloud workspace. So, they can\u2019t use their own cloud workspaces. Press Alt-Shift-X to go back to normal (reduced) view"})))}))}}))}},{key:"render",value:function(){return p.createElement("div",{className:"guide-settings session-settings"},p.createElement("div",{className:"controls"},this.isLiveSession&&p.createElement(at.b,{className:"empty",onClick:this.muteAll},"Mute Learners"),p.createElement(at.b,{className:"empty",onClick:this.extendTime},"Add ",15," Minutes"),this.isLiveSession?p.createElement(at.b,{className:"empty",onClick:this.expandView},this.state.expandViewMode?"Collapse":"Expand"," View"):null,this.isLiveSession||this.isCollaboration?p.createElement(rr,{dispatch:this.props.dispatch,remoteClientManager:this.props.remoteClientManager,vm:this.props.focusVm}):null),this.props.twilioAudio&&p.createElement(lr,{twilioAudio:this.props.twilioAudio}),p.createElement("div",{className:"keyboard-shortcuts",style:{display:"none"}},p.createElement("p",null,"Keyboard shortcuts"),p.createElement("table",null,p.createElement("tbody",null,p.createElement("tr",null,p.createElement("td",null,"Alt + Shift + X"),p.createElement("td",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.")),p.createElement("tr",null,p.createElement("td",null,"Alt + Shift + X"),p.createElement("td",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.")),p.createElement("tr",null,p.createElement("td",null,"Alt + Shift + X"),p.createElement("td",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."))))))}},{key:"isLiveSession",get:function(){return this.props.course.type===b.y.Live}},{key:"isCollaboration",get:function(){return this.props.course.type===b.y.Collaboration}}]),t}(p.Component),Object(l.a)(bn.prototype,"muteAll",[d.a],Object.getOwnPropertyDescriptor(bn.prototype,"muteAll"),bn.prototype),Object(l.a)(bn.prototype,"extendTime",[d.a],Object.getOwnPropertyDescriptor(bn.prototype,"extendTime"),bn.prototype),Object(l.a)(bn.prototype,"expandView",[d.a],Object.getOwnPropertyDescriptor(bn.prototype,"expandView"),bn.prototype),bn),ur=n(84),hr=(n(1424),n(1999)),dr=n(2005),mr=n(1964),yr=(n(1554),n(168)),fr=n(1166),vr=(gn=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._videoTrack=void 0,n._videoElement=void 0,n._localTrackAddedUnsubscribe=void 0,n._localTrackRemovedUnsubscribe=void 0,n.state={view:fr.b.DisabledCamera,cameraStream:null,error:null},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){if(this.props.twilioVideo){this._handleTwilioVideoEvents();var e=this.props.twilioVideo.getLocalVideoTrack();e&&this._localTrackAdded(e)}}},{key:"componentDidUpdate",value:function(e){this.props.twilioVideo&&!e.twilioVideo&&this._handleTwilioVideoEvents()}},{key:"componentWillUnmount",value:function(){this._localTrackAddedUnsubscribe&&this._localTrackAddedUnsubscribe(),this._localTrackRemovedUnsubscribe&&this._localTrackRemovedUnsubscribe(),this.props.preserveCameraOnDestory||this._stopCamera()}},{key:"onDisabledCameraAction",value:function(){var e=this;this.props.twilioVideo&&(this.setState({view:fr.b.EnabledCamera}),this.props.twilioVideo.createVideoTrack().then((function(){e.state.error&&e.setState({error:null})})).catch((function(t){var n="An error occurred while enabling the webcam";t&&t.name&&"NotAllowedError"===t.name?n="The webcam is blocked. Please, allow this page to access your webcam":Object(yr.c)(window.navigator.userAgent)||(n="Webcam functionality is not supported in this browser. You won't be able to use your webcam or see learners' webcam"),console.log(n),e.setState({view:fr.b.DisabledCamera,error:n})})))}},{key:"onEnabledCameraAction",value:function(){this.props.onBroadcastCamera&&this.state.cameraStream?(this.props.onBroadcastCamera(this.state.cameraStream),this.setState({view:fr.b.BroadcastedCamera}),this.props.dispatch(this.props.asyncActions.setBroadcastCamera(!0))):this._stopCamera()}},{key:"onBroadcastedCameraAction",value:function(){this.props.onStopBroadcastCamera&&(this.props.onStopBroadcastCamera(),this._stopCamera(),this.props.dispatch(this.props.asyncActions.setBroadcastCamera(!1)))}},{key:"render",value:function(){return p.createElement(fr.a,{view:this.state.view,labels:this.props.labels,disabled:this.props.disabled,error:this.state.error,cameraStream:this.state.cameraStream,onDisabledCameraAction:this.onDisabledCameraAction,onEnabledCameraAction:this.onEnabledCameraAction,onBroadcastedCameraAction:this.onBroadcastedCameraAction})}},{key:"_handleTwilioVideoEvents",value:function(){this.props.twilioVideo&&(this._localTrackAddedUnsubscribe=this.props.twilioVideo.onLocalTrackAdded(this._localTrackAdded),this._localTrackRemovedUnsubscribe=this.props.twilioVideo.onLocalTrackRemoved(this._localTrackRemoved))}},{key:"_localTrackAdded",value:function(e){if("video"===e.kind&&!this.state.cameraStream){this._videoTrack=e,this._videoElement=this._videoTrack.attach();var t=this._videoElement.srcObject;this.setState({cameraStream:t,view:fr.b.EnabledCamera})}}},{key:"_localTrackRemoved",value:function(e){e&&"video"===e.kind&&this.props.onStopBroadcastCamera&&this.props.dispatch(this.props.asyncActions.setBroadcastCamera(!1)),this._cleanUp(e)}},{key:"_stopCamera",value:function(){this.props.twilioVideo&&this._videoTrack&&this._cleanUp(this._videoTrack)}},{key:"_cleanUp",value:function(e){this.props.twilioVideo&&(e&&(this.props.twilioVideo.detachLocalVideoTrack(e),this.props.twilioVideo.destroyVideoTrack(e)),this._videoTrack=null,this._videoElement=null,this.setState({cameraStream:null,view:fr.b.DisabledCamera}))}}]),t}(p.Component),Object(l.a)(gn.prototype,"onDisabledCameraAction",[d.a],Object.getOwnPropertyDescriptor(gn.prototype,"onDisabledCameraAction"),gn.prototype),Object(l.a)(gn.prototype,"onEnabledCameraAction",[d.a],Object.getOwnPropertyDescriptor(gn.prototype,"onEnabledCameraAction"),gn.prototype),Object(l.a)(gn.prototype,"onBroadcastedCameraAction",[d.a],Object.getOwnPropertyDescriptor(gn.prototype,"onBroadcastedCameraAction"),gn.prototype),Object(l.a)(gn.prototype,"_localTrackAdded",[d.a],Object.getOwnPropertyDescriptor(gn.prototype,"_localTrackAdded"),gn.prototype),Object(l.a)(gn.prototype,"_localTrackRemoved",[d.a],Object.getOwnPropertyDescriptor(gn.prototype,"_localTrackRemoved"),gn.prototype),gn),br={disabledCameraLabel:"Your webcam - Not enabled",disabledCameraButton:"Enable Webcam",disabledCameraDescription:"Build a personal connection with your learners. They will see you when you broadcast your webcam or control their cloud workspace.",enabledCameraLabel:"Your webcam - Not broadcasting",enabledCameraButton:"Broadcast Your Webcam",enabledCameraDescription:"Build a personal connection with your learners",broadcastedCameraLabel:"Your webcam - Broadcasting",broadcastedCameraButton:"Broadcast Your Cloud Workspace",broadcastedCameraDescription:"Currently, learners cannot see your cloud workspace",disabledLabel:"Webcam can be enabled once your cloud workspace is ready"},gr=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement(vr,{disabled:this.props.disabled,labels:br,twilioVideo:this.props.twilioVideo,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,onBroadcastCamera:this.props.onBroadcastCamera,onStopBroadcastCamera:this.props.onStopBroadcastCamera})}}]),t}(p.PureComponent),_r=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).state={labels:n._getLabels()},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.focusAttendee!==e.focusAttendee&&this.setState({labels:this._getLabels()})}},{key:"render",value:function(){return p.createElement(vr,{disabled:!this.props.twilioVideo,labels:this.state.labels,twilioVideo:this.props.twilioVideo,preserveCameraOnDestory:this.props.preserveCameraOnDestory,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions})}},{key:"_getLabels",value:function(){return{disabledCameraLabel:"Your webcam - Not enabled",disabledCameraButton:"Enable Webcam",disabledCameraDescription:this.isGuide?"To enable video calls with learners":"To enable video calls with host".concat(this.props.isLiveSession&&!this.isInVideoCall?". The host will see you when they control your cloud workspace.":""),enabledCameraLabel:"Your webcam - ".concat(this.isInVideoCall?"In video call with ".concat(this.isGuide?"learner":"host"):"No one watching"),enabledCameraButton:"Disable webcam",enabledCameraDescription:"To disable video calls with ".concat(this.isGuide?"learner":"host"),disabledLabel:this.isGuide?"Webcam can be enabled only when you control a learner's cloud workspace":"Webcam can be enabled only when the host controls your cloud workspace"}}},{key:"isGuide",get:function(){return this.props.currentAttendee.access===b.f.Guide}},{key:"isInVideoCall",get:function(){return this.isGuide?this.props.focusAttendee.id!==this.props.currentAttendee.id&&this.props.focusAttendee.controlled:this.props.currentAttendee.controlled}}]),t}(p.PureComponent),kr=(n(1425),n(1426),n(1138)),Or=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"invite-link-wrapper"},p.createElement("div",{className:"invite-link rhyme-ellipse-bg gray"},!this.props.hideLabel&&p.createElement("span",{className:"il-label"},"Invite link:"),p.createElement("span",{className:"il-link",title:"".concat(y.a.ShortURL,"/").concat(this.props.roomSecret.toLowerCase())},y.a.ShortURL,"/",p.createElement("span",null,this.props.roomSecret.toLowerCase())),this.props.buttonOutside?null:this._renderCopyButton(),p.createElement(nr.a,{className:"il-hint",position:this.props.hintPosition||"right"},"Your learners can join this",p.createElement("br",null),"session using this invite link.")),this.props.buttonOutside?this._renderCopyButton():null)}},{key:"_renderCopyButton",value:function(){return p.createElement(kr.a,{className:"il-copy-btn",value:this.inviteUrl},p.createElement(at.b,null,"Copy"))}},{key:"inviteUrl",get:function(){return Object(v.Fb)(this.props.roomSecret)}}]),t}(p.PureComponent),wr=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"invite-thumb",style:this.props.style},p.createElement("div",{className:"content"},p.createElement("p",null,"Send this invite link to learners:"),p.createElement(Or,{hideLabel:!0,roomSecret:this.props.roomSecret,buttonOutside:!0,hintPosition:"left"})))}}]),t}(p.PureComponent),Cr=(n(1427),n(1191)),Er=(n(1428),_n=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._video=void 0,n.state={isLoadingCamera:!0},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._video&&(this._video.srcObject=this.props.cameraStream)}},{key:"onVideoRef",value:function(e){this._video=e}},{key:"render",value:function(){return p.createElement("div",{className:"webcam-view"},this.state.isLoadingCamera?p.createElement(w.a,null):null,p.createElement("video",{ref:this.onVideoRef,autoPlay:!0,onLoadedMetadata:this._onLoadedMetadata}))}},{key:"_onLoadedMetadata",value:function(){this.setState({isLoadingCamera:!1})}}]),t}(p.Component),Object(l.a)(_n.prototype,"onVideoRef",[d.a],Object.getOwnPropertyDescriptor(_n.prototype,"onVideoRef"),_n.prototype),Object(l.a)(_n.prototype,"_onLoadedMetadata",[d.a],Object.getOwnPropertyDescriptor(_n.prototype,"_onLoadedMetadata"),_n.prototype),_n),jr=function(e,t,n){var r=1e3*n,o=e.chapters.filter((function(e){return e.order>t.order})).reduce((function(e,t){return e+t.duration}),0)+t.duration-r;return Math.max(o,0)},Sr=(n(1429),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"vm-screenshot"+(this.props.noSignal?" no-signal":"")},this.props.image&&p.createElement("img",{src:this.props.image,width:y.a.VmThumbScreenshotWidth,height:y.a.VmThumbScreenshotHeight}))}}]),t}(p.Component)),Pr=(n(1430),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"activity-tracker"},p.createElement("span",null,"Activity"),p.createElement("div",{className:"slots"},this.slots.map((function(e,t){var n=e.seconds/e.slotSize*100;return p.createElement("div",{className:"slot",key:"as-"+t,style:{height:n+"%",minHeight:n?1:"auto"}})}))))}},{key:"slots",get:function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Object(gt.List)([]),o=0;e.forEach((function(n,i){o+=n.seconds,(i+1)%t!==0&&i!==e.size-1||(r=r.push(new b.a({seconds:o,slotSize:n.slotSize*t})),o=0)}));var i=r.size-n,s=0<i&&i<r.size?i:0;return r.slice(s,r.size)}(function(e){var t=Object(gt.List)([]),n=null;return e.forEach((function(e){if(n){var r=Math.round((e.start.getTime()-n.start.getTime())/1e3),o=Math.round(r/e.slotSize);if(o>1)for(var i=0;i<o-1;i+=1)t=t.push(new b.a({seconds:0,start:new Date(n.start.getTime()+e.slotSize*i*1e3)}))}n=e,t=t.push(e)})),t}(this.props.attendee.activity),4,40)}}]),t}(p.Component)),Tr=(n(1431),kn=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"toggleMic",value:function(){var e=this.props,t=e.attendee,n=e.asyncActions,r=e.dispatch,o=e.room;t.micMute?r(n.unmuteAttendee(o,t)):r(n.muteAttendee(o,t))}},{key:"chatWith",value:function(){this.props.onChatWith(this.props.attendee)}},{key:"expel",value:function(){this.props.dispatch(new m.W(this.props.attendee)),this.props.dispatch(new m.i(new b.J({type:b.K.Error,text:"You expelled **".concat(this.props.attendee.name,"** from the session")})))}},{key:"render",value:function(){return p.createElement("div",{className:"attendee-actions"},p.createElement(at.b,{className:"empty",onClick:this.chatWith},"Chat"),p.createElement(at.b,{className:"empty",disabled:this.isMicDisabled,onClick:this.toggleMic},this.props.attendee.micMute?"Unmute":"Mute"),p.createElement(at.b,{onClick:this.expel,className:"expel"},"Expel"))}},{key:"isMicDisabled",get:function(){return this.props.course.type===b.y.Recorded&&!this.props.attendee.controlled}}]),t}(p.Component),Object(l.a)(kn.prototype,"toggleMic",[d.a],Object.getOwnPropertyDescriptor(kn.prototype,"toggleMic"),kn.prototype),Object(l.a)(kn.prototype,"chatWith",[d.a],Object.getOwnPropertyDescriptor(kn.prototype,"chatWith"),kn.prototype),Object(l.a)(kn.prototype,"expel",[d.a],Object.getOwnPropertyDescriptor(kn.prototype,"expel"),kn.prototype),kn),Rr=n(1077),Ar=(n(1432),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"pending-challenge-submission"},p.createElement("div",{className:"title"},"Solution submitted"),p.createElement("div",{className:"description",onClick:this.props.onOpen},'"',this.props.chapter.order,": ",this.chapterName,'" done in'," ",Object(Rr.a)(this.props.challengeSubmission.duration)),p.createElement("div",{className:"close",onClick:this.props.onClose}))}},{key:"chapterName",get:function(){var e=this.props.chapter.name;return e.length>100&&(e=e.slice(0,100)+"..."),e}}]),t}(p.PureComponent)),Dr=[{duration:6e4,className:"recent-inactivity"},{duration:12e4,className:"mild-inactivity"},{duration:3e5,className:"long-inactivity"}].reverse(),Mr=(On=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._screenshotRequestTimeout=void 0,n._heartbeatTimeout=void 0,n._chapterProgressRequestTimeout=void 0,n._screenshotThrottleTimeout=void 0,n._heartbeatThrottleTimeout=void 0,n._chapterProgressThrottleTimeout=void 0,n._updating=void 0,n._remoteTrackAddedUnsubscribe=void 0,n._remoteTrackRemovedUnsubscribe=void 0,n.state={cameraStream:null},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.props.visible&&!e.visible?this._initUpdaters():!this.props.visible&&e.visible&&this._clearUpdaters(),this.props.twilioVideo&&!e.twilioVideo&&this.props.attendee.controlled&&this._handleTwilioVideoEvents(),this.props.attendee.controlled!==e.attendee.controlled)if(this.props.attendee.controlled){if(this.props.twilioVideo){this._handleTwilioVideoEvents();var t=this.props.twilioVideo.getAttendeeVideoInfo(this.props.attendee.id);t&&this._remoteTrackAdded(t.participant,t.track)}}else this.setState({cameraStream:null}),this._clearTwilioVideoEvents()}},{key:"componentDidMount",value:function(){this._initUpdaters()}},{key:"componentWillUnmount",value:function(){this._clearUpdaters(),this._clearTwilioVideoEvents()}},{key:"onPendingChallengeSubmissionClose",value:function(){this.pendingChallengeSubmission&&this.props.challengeSubmissionNotificationsManager.close(this.pendingChallengeSubmission)}},{key:"onPendingChallengeSubmissionOpen",value:function(){this.pendingChallengeSubmission&&this.props.onChallengeSubmissionPreview(this.pendingChallengeSubmission)}},{key:"render",value:function(){var e=Date.now()-this.props.attendee.lastActive.getTime(),t=Dr.reduce((function(t,n){return t||e>=n.duration&&n}),!1),n=Math.floor(t?t.duration/6e4:0);return p.createElement("div",{style:this.props.style,className:"student-vm-thumb"+(this.isActive?" active":"")+(this.isDisconnected?" disconnected":"")+(this.props.attendee.vmAccessLimitReached?" vm-limit":"")+(this.state.cameraStream?" camera":"")+(this.pendingChallengeSubmission&&!this.isPendingChallengeSubmissionNotificationClosed?" has-pending-challenge-submission-view":"")+(t&&!this.isDisconnected?" ".concat(t.className):""),"data-user-name":this.props.attendee.name},p.createElement("div",{className:"thumb"},this.isConnectedToVM&&p.createElement(Sr,{image:this.vm.screenshot,noSignal:this.isDisconnected}),this.state.cameraStream?p.createElement(Er,{cameraStream:this.state.cameraStream}):null,p.createElement("div",{className:"controls"},this.props.attendee.vmAccessLimitReached?p.createElement("div",{className:"vm-limit-label"},this.props.attendee.name," has used the cloud workspace for too long and will not be assigned new cloud workspaces anymore"):p.createElement(p.Fragment,null,p.createElement(Pr,{attendee:this.props.attendee}),p.createElement(vt,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,focusAttendee:this.props.focusAttendee,broadcastVm:this.props.broadcastVm,attendee:this.props.attendee,guide:this.props.guide,course:this.props.course,vms:this.props.vms,disabled:this.props.disableVmControls||!this.isConnectedToVM,onFocusAttendee:this.props.onFocusAttendee,onUnfocusAttendee:this.props.onUnfocusAttendee})),p.createElement(Tr,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,attendee:this.props.attendee,room:this.props.room,course:this.props.course,onChatWith:this.props.onChatWith})),this.pendingChallengeSubmission&&this.pendingChallengeSubmissionChapter&&!this.isPendingChallengeSubmissionNotificationClosed?p.createElement(Ar,{challengeSubmission:this.pendingChallengeSubmission,chapter:this.pendingChallengeSubmissionChapter,onClose:this.onPendingChallengeSubmissionClose,onOpen:this.onPendingChallengeSubmissionOpen}):null,p.createElement("div",{className:"tooltips"},this.pendingChallengeSubmission&&this.isPendingChallengeSubmissionNotificationClosed?p.createElement(Cr.a,{className:"pending-challenge-submission-tooltip",showOnMouseEnter:!0},p.createElement("span",null,"Challenge solution submitted"),p.createElement("i",{onClick:this.onPendingChallengeSubmissionOpen,className:"fa fa-trophy pending-challenge-submission-warning"})):null,this.isDisconnected?null:p.createElement(p.Fragment,null,this.hasEnoughtTime?null:p.createElement(Cr.a,{className:"not-enough-time-tooltip",showOnMouseEnter:!0},p.createElement("span",null,"The session will end before ",this.props.attendee.name," can complete all tasks."),p.createElement("i",{className:"fa fa-clock-o not-enought-time-warning"})),n>=1?p.createElement(Cr.a,{className:"student-inactivity-tooltip",showOnMouseEnter:!0},p.createElement("span",null,"Last active over ",n," ",1===n?"minute":"minutes"," ago"),p.createElement("i",{className:"fa fa-exclamation inactivity-warning"})):null))),p.createElement("div",{className:"attendee-description"},p.createElement(Zt.a,{source:this.props.attendee,width:30,height:30,fontSize:12}),p.createElement("p",{className:"name"},this.props.attendee.name,this.props.attendee.chapterProgress.chapterId&&p.createElement("span",null," ","- (",Object(Vt.d)(this.chapterProgress.time),") ",this.chapterNumber,". ",this.attendeeChapter.name))))}},{key:"_initUpdaters",value:function(){var e=this;if(!this._updating){this._updating=!0;this._screenshotThrottleTimeout=setTimeout((function t(){clearTimeout(e._screenshotRequestTimeout),e.props.attendee.connected&&e.isConnectedToVM&&e._isBrowserTabVisible&&e.props.dispatch(new m.kb(e.props.attendee)),e._screenshotRequestTimeout=setTimeout(t,e.props.refreshRate)}),3e3),this._heartbeatThrottleTimeout=setTimeout((function t(){clearTimeout(e._heartbeatTimeout),Date.now()-e.props.attendee.lastHeartbeat>=1e3&&e.props.dispatch(new m.jb(e.props.attendee)),e._heartbeatTimeout=setTimeout(t,e.props.refreshRate)}),3e3),this._isRecordedSession&&(this._chapterProgressThrottleTimeout=setTimeout((function t(){clearTimeout(e._chapterProgressRequestTimeout),e._isBrowserTabVisible&&e.props.dispatch(new m.hb(e.props.attendee)),e._chapterProgressRequestTimeout=setTimeout(t,e.props.refreshRate)}),3e3))}}},{key:"_clearUpdaters",value:function(){this._updating=!1,clearTimeout(this._screenshotRequestTimeout),clearTimeout(this._screenshotThrottleTimeout),clearTimeout(this._heartbeatTimeout),clearTimeout(this._heartbeatThrottleTimeout),this._isRecordedSession&&(clearTimeout(this._chapterProgressRequestTimeout),clearTimeout(this._chapterProgressThrottleTimeout))}},{key:"_handleTwilioVideoEvents",value:function(){this.props.twilioVideo&&(this._remoteTrackAddedUnsubscribe=this.props.twilioVideo.onRemoteTrackAdded(this._remoteTrackAdded),this._remoteTrackRemovedUnsubscribe=this.props.twilioVideo.onRemoteTrackRemoved(this._remoteTrackRemoved))}},{key:"_remoteTrackAdded",value:function(e,t){if(e.identity===this.props.attendee.id){var n=t.attach().srcObject;this.setState({cameraStream:n})}}},{key:"_remoteTrackRemoved",value:function(e,t){e.identity===this.props.attendee.id&&(t.detach(),this.setState({cameraStream:null}))}},{key:"_clearTwilioVideoEvents",value:function(){this._remoteTrackAddedUnsubscribe&&this._remoteTrackAddedUnsubscribe(),this._remoteTrackRemovedUnsubscribe&&this._remoteTrackRemovedUnsubscribe()}},{key:"vm",get:function(){return this.props.vms.get(this.props.attendee.virtualMachineId)}},{key:"isActive",get:function(){var e=this.props.focusAttendee.id===this.props.attendee.id,t=this.props.attendee.controlled,n=this.props.attendee.virtualMachineId===this.props.broadcastVm.id&&""!==this.props.broadcastVm.id;return e||t||n}},{key:"isDisconnected",get:function(){return!this.props.attendee.connected}},{key:"isConnectedToVM",get:function(){return!(!this.vm||this.vm.state!==b.kb.Ready)}},{key:"chapterProgress",get:function(){return this.props.attendee.chapterProgress}},{key:"chapters",get:function(){return this.props.course.chapters}},{key:"attendeeChapter",get:function(){var e=this;return this.chapters.find((function(t){return t.id===e.chapterProgress.chapterId}))}},{key:"chapterNumber",get:function(){return this.attendeeChapter.order}},{key:"hasEnoughtTime",get:function(){if(this.attendeeChapter){var e=jr(this.props.course,this.attendeeChapter,this.chapterProgress.time);return new Date(Date.now()+e)<this.props.room.expirationTime}return!0}},{key:"pendingChallengeSubmission",get:function(){var e=this;return this.props.challengeSubmissions.find((function(t){return t.attendeeId===e.props.attendee.id&&t.state===b.p.Pending}))||null}},{key:"pendingChallengeSubmissionChapter",get:function(){var e=this.pendingChallengeSubmission;return e&&this.chapters.find((function(t){return t.id===e.chapterId}))||null}},{key:"isPendingChallengeSubmissionNotificationClosed",get:function(){return!!this.pendingChallengeSubmission&&this.props.challengeSubmissionNotificationsManager.isClosed(this.pendingChallengeSubmission)}},{key:"_isRecordedSession",get:function(){return this.props.course.type===b.y.Recorded}},{key:"_isBrowserTabVisible",get:function(){return"visible"===document.visibilityState}}]),t}(p.PureComponent),Object(l.a)(On.prototype,"onPendingChallengeSubmissionClose",[d.a],Object.getOwnPropertyDescriptor(On.prototype,"onPendingChallengeSubmissionClose"),On.prototype),Object(l.a)(On.prototype,"onPendingChallengeSubmissionOpen",[d.a],Object.getOwnPropertyDescriptor(On.prototype,"onPendingChallengeSubmissionOpen"),On.prototype),Object(l.a)(On.prototype,"_remoteTrackAdded",[d.a],Object.getOwnPropertyDescriptor(On.prototype,"_remoteTrackAdded"),On.prototype),Object(l.a)(On.prototype,"_remoteTrackRemoved",[d.a],Object.getOwnPropertyDescriptor(On.prototype,"_remoteTrackRemoved"),On.prototype),On),xr=[[5,1e3],[10,1500],[20,2e3],[40,3e3],[1/0,4e3]],Nr=(wn=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._gridRef=void 0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.cellData,n=(xr.filter((function(e){return e[0]>t.size})).shift()||[1/0,4e3]).slice().pop();return p.createElement("div",{className:"student-vm-list"},p.createElement(hr.a,null,(function(r){var o=r.width,i=r.height,s=t.size,a=s?Math.min(s,Math.floor(Math.max(o-30,400)/400)):0,c=s?Math.ceil(s/a):0;return p.createElement(dr.a,{ref:function(t){return e._gridRef=t},cellRenderer:e._cellRenderer.bind(e,n,t,a),cellRangeRenderer:e._cellRangeRenderer.bind(e),columnWidth:400,columnCount:a,overscanColumnCount:1,overscanRowCount:1,rowHeight:360,rowCount:c,height:i,width:o})})))}},{key:"_cellRangeRenderer",value:function(e){var t=Object(mr.a)(e);if(y.a.ShowWebcam){var n=this.props.course.type===b.y.Live?p.createElement(gr,{key:"broadcastable-webcam",disabled:!this.props.isVMConnected,twilioVideo:this.props.twilioVideo,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,onBroadcastCamera:this.props.onBroadcastCamera,onStopBroadcastCamera:this.props.onStopBroadcastCamera}):p.createElement(_r,{key:"unbroadcastable-webcam",isLiveSession:!1,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,currentAttendee:this.props.guide,focusAttendee:this.props.focusAttendee,twilioVideo:this.props.twilioVideo});t.push(n)}return t}},{key:"_cellRenderer",value:function(e,t,n,r){var o=r.columnIndex,i=r.rowIndex,s=r.style,a=i*n+o,c=t.get(a);if(c&&"null_cell"!==c){var l=c;return l.access===b.f.Guide?p.createElement("div",{key:"webcam-placeholder"}):p.createElement(Mr,{refreshRate:e,attendee:l,course:this.props.course,asyncActions:this.props.asyncActions,dispatch:this.props.dispatch,guide:this.props.guide,broadcastVm:this.props.broadcastVm,focusAttendee:this.props.focusAttendee,room:this.props.room,vms:this.props.vms,challengeSubmissions:this.props.challengeSubmissions,key:"sla-".concat(a,"-").concat(l.id),style:s,visible:this.props.tabVisible||!1,onChatWith:this.props.onChatWith,onFocusAttendee:this._onFocusAttendee,onUnfocusAttendee:this.props.onUnfocusAttendee,twilioVideo:this.props.twilioVideo,challengeSubmissionNotificationsManager:this.props.challengeSubmissionNotificationsManager,disableVmControls:this.props.disableVmControls,onChallengeSubmissionPreview:this.props.onChallengeSubmissionPreview})}return"null_cell"===c?p.createElement(wr,{roomSecret:this.props.room.secret,key:"sla-".concat(a,"-null-cell"),style:s}):null}},{key:"_onFocusAttendee",value:function(){return this._gridRef&&this._gridRef.scrollToCell({columnIndex:0,rowIndex:0}),this.props.onFocusAttendee(),!0}},{key:"cellData",get:function(){var e,t=y.a.ShowWebcam?Object(gt.List)([this.props.guide]):Object(gt.List)([]);return t=(e=t).push.apply(e,Object(ur.a)(this.props.attendees.toArray()).concat(["null_cell"]))}}]),t}(p.PureComponent),Object(l.a)(wn.prototype,"_onFocusAttendee",[d.a],Object.getOwnPropertyDescriptor(wn.prototype,"_onFocusAttendee"),wn.prototype),wn);!function(e){e.Customers="GuideCustomers",e.Chat="GuideChat",e.Settings="GuideSettings",e.FilesSettings="FilesSettings"}(En||(En={}));var Vr,Lr,Ur,Ir,Fr,zr,Br,Wr=(Cn=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._challengeSubmissionNotificationsManager=void 0,n._chat=void 0,n._rightPanel=void 0,n._gtmVmLaunchTime=null,n._challengeSubmissionNotificationsManager=new Un(e.room.id),n.state={endSessionModal:!1,isFocusVmConnected:!1,attendeesSidebarExpanded:!1,cameraStream:null,isUploadingFiles:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.onMount&&this.props.onMount(),window.onbeforeunload=this._challengeSubmissionNotificationsManager.clear}},{key:"componentWillUnmount",value:function(){this._challengeSubmissionNotificationsManager.clear()}},{key:"componentDidUpdate",value:function(e){if(this.props.focusVm&&e.focusVm&&this.props.focusVm.state!==e.focusVm.state&&e.focusVm.state===b.kb.Ready&&this.props.focusAttendee!==this.props.currentAttendee){this.props;var t=Object(C.a)(this,["props"]);new ht(Object(r.a)({},t,{props:Object(r.a)({},this.props,{guide:this.props.currentAttendee,attendee:this.props.focusAttendee})})).off(),this.props.dispatch(new m.i(new b.J({type:b.K.Info,text:"".concat(e.focusAttendee.name," left the session. The cloud workspace will be stopped")})))}this.isCollaboration&&2===this.props.attendees.count()&&1===e.attendees.count()&&this.props.visibleView!==En.Chat&&this.focusView(En.Chat)}},{key:"toggleEndSessionModal",value:function(e){this.setState({endSessionModal:e})}},{key:"focusView",value:function(e){var t=this;this.props.onViewChange&&this.props.onViewChange(e),e===En.Chat&&setTimeout((function(){t._chat&&t._chat.focusChat()}))}},{key:"calculateSidebarWidth",value:function(){var e=document.body.clientWidth;return 400*Math.floor((e-80-30-2)/400)+80+30+2}},{key:"onEndSessionClick",value:function(){this.toggleEndSessionModal(!0)}},{key:"onTurnSessionOff",value:function(){var e=this;return this.props.dispatch(this.props.asyncActions.powerOffRoom(this.props.course,this.props.room)).then((function(){return e.props.onSessionEnd({notify:!1})})).catch((function(e){console.error("Error while terminating session",e)}))}},{key:"onTick",value:function(e){e<=0&&this.props.onSessionEnd({notify:!0})}},{key:"onChatWith",value:function(e){var t=this;this.props.views&&(this.props.views.switchView(En.Chat),setTimeout((function(){t._chat&&(t._chat.onSelectRecipient(Yt.Private,e),t._chat.focusChat())})))}},{key:"onVmInit",value:function(){var e=this.props,t=e.course,n=e.room,r=e.focusVm;r&&(this._gtmVmLaunchTime=E.a.sessionVmLaunchTime(t.id,n.id,r.id))}},{key:"onFocusVmConnect",value:function(){this.setState({isFocusVmConnected:!0}),this._gtmVmLaunchTime&&(this._gtmVmLaunchTime(),this._gtmVmLaunchTime=null)}},{key:"onFocusVmDisconnect",value:function(){this.setState({isFocusVmConnected:!1})}},{key:"onFocusOrUnfocusAttendee",value:function(){return this.props.dispatch(new m.H(b.V.Dock)),!0}},{key:"onExpandViewChange",value:function(e){this.setState({attendeesSidebarExpanded:e})}},{key:"onBroadcastCamera",value:function(e){this.setState({cameraStream:e})}},{key:"onStopBroadcastCamera",value:function(){this.setState({cameraStream:null})}},{key:"onChallengeSubmissionPreviewFromStudentVmList",value:function(e){var t=this.props.attendees.get(e.attendeeId);this.onChatWith(t),this.props.onChallengeSubmissionPreview(e)}},{key:"render",value:function(){var e=this;return p.createElement(p.Fragment,null,p.createElement(Rn,{visible:this.props.currentAttendee.micMute,message:p.createElement("span",null,p.createElement("i",{className:"fa fa-microphone-slash"})," Guide microphone is currently muted")}),p.createElement(xn,{vm:this.props.focusVm,readOnly:this.readOnly,emitCursor:!0,dispatch:this.props.dispatch,overlay:p.createElement(Ln,{on:this.props.onboarding}),showViewbox:this.showViewbox,className:this.className,controls:!this.isZooming,asyncActions:this.props.asyncActions,sidebarMode:this.props.sidebarMode,template:this.props.focusVmTemplate,attendees:this.props.attendees,course:this.props.course,cameraStream:this.showCamera?this.state.cameraStream:null,calculateSidebarWidth:this.calculateSidebarWidth,currentAttendee:this.props.currentAttendee,broadcastVm:this.props.broadcastVm,isViewExpanded:this.state.attendeesSidebarExpanded,onReadWriteInit:this.onVmInit,onConnect:this.onFocusVmConnect,onDisconnect:this.onFocusVmDisconnect,onPanelsRefs:function(t,n){return e._rightPanel=n},viewboxSize:this.props.focusVm?{width:y.a.Zoom.VisibleSize.Width*(this.props.focusVm.width/y.a.Zoom.Sizes[60].Width),height:y.a.Zoom.VisibleSize.Height*(this.props.focusVm.height/y.a.Zoom.Sizes[60].Height)}:{width:0,height:0}},p.createElement(st,{dispatch:this.props.dispatch,sidebarMode:this.props.sidebarMode,views:this.props.views,room:this.props.room,course:this.props.course,asyncActions:this.props.asyncActions,currentAttendee:this.props.currentAttendee,expiration:this.props.room.expirationTime,attendees:this.learners,rightPanel:this._rightPanel,visibleView:this.props.visibleView,onCountdownTick:this.onTick,onPowerOff:this.onEndSessionClick}),p.createElement(Vn,{ref:this.props.onViewsRef,visible:this.props.visibleView,style:{left:y.a.ButtonsBarWidth+y.a.ButtonsBarBorderWidth},onViewChange:this.props.onViewChange},this.isCollaboration?null:p.createElement(Nn,{id:En.Customers,icon:p.createElement(D,{attendee:this.props.currentAttendee})},p.createElement(An,{on:this.props.onboarding,className:"sidebar-onboarding"},"These are your learners' cloud workspaces"),p.createElement(Nr,{course:this.props.course,dispatch:this.props.dispatch,user:this.props.user,attendees:this.learners,vms:this.props.vms,challengeSubmissions:this.props.challengeSubmissions,focusAttendee:this.props.focusAttendee,asyncActions:this.props.asyncActions,broadcastVm:this.props.broadcastVm,guide:this.props.currentAttendee,room:this.props.room,isVMConnected:this.state.isFocusVmConnected,twilioVideo:this.props.twilioVideo,challengeSubmissionNotificationsManager:this._challengeSubmissionNotificationsManager,disableVmControls:this.state.isUploadingFiles,onChatWith:this.onChatWith,onFocusAttendee:this.onFocusOrUnfocusAttendee,onUnfocusAttendee:this.onFocusOrUnfocusAttendee,onBroadcastCamera:this.onBroadcastCamera,onStopBroadcastCamera:this.onStopBroadcastCamera,onChallengeSubmissionPreview:this.onChallengeSubmissionPreviewFromStudentVmList})),p.createElement(Nn,{id:En.Chat,icon:p.createElement(U,{messages:this.props.messages,attendee:this.props.currentAttendee})},p.createElement(jn,{visible:!!this.props.views&&this.props.visibleView===En.Chat,ref:function(t){e._chat=t,e.props.onChatRef(t)},room:this.props.room,attendees:this.learners,guide:this.props.currentAttendee,currentAttendee:this.props.currentAttendee,dispatch:this.props.dispatch,messages:this.props.messages,asyncActions:this.props.asyncActions,vms:this.props.vms,focusAttendee:this.props.focusAttendee,course:this.props.course,remoteClientManager:this.props.remoteClientManager,broadcastVm:this.props.broadcastVm,disableVmControls:this.state.isUploadingFiles,onFocusAttendee:this.onFocusOrUnfocusAttendee,onUnfocusAttendee:this.onFocusOrUnfocusAttendee,onOpenAttachment:this.props.onOpenAttachment,onChallengeSubmissionPreview:this.props.onChallengeSubmissionPreview})),p.createElement(Nn,{id:En.Settings,icon:p.createElement(Q,null)},p.createElement(pr,{dispatch:this.props.dispatch,course:this.props.course,room:this.props.room,guide:this.props.currentAttendee,asyncActions:this.props.asyncActions,attendees:this.learners,remoteClientManager:this.props.remoteClientManager,onExpandViewChange:this.onExpandViewChange,focusVm:this.props.focusVm,twilioAudio:this.props.twilioAudio})),this.areFilesSettingsSupported?p.createElement(Nn,{id:En.FilesSettings,icon:p.createElement(K,null),renderOnInit:!0},p.createElement(tr,{dispatch:this.props.dispatch,course:this.props.course,guide:this.props.currentAttendee,asyncActions:this.props.asyncActions,attendees:this.learners,vms:this.props.vms,remoteClientManager:this.props.remoteClientManager,isFocusVmConnected:this.state.isFocusVmConnected,focusVm:this.props.focusVm,onUploadStart:this._onFileUploadStart,onFileUploadCompleted:this._onFileUploadCompleted})):null)),this.props.room.longRunning?p.createElement($.a,{type:$.b.End,visible:this.state.endSessionModal,onToggle:this.toggleEndSessionModal}):p.createElement(Tn,{visible:this.state.endSessionModal,onToggle:this.toggleEndSessionModal,onEnd:this.onTurnSessionOff}))}},{key:"_onFileUploadStart",value:function(){this.setState({isUploadingFiles:!0})}},{key:"_onFileUploadCompleted",value:function(){this.setState({isUploadingFiles:!1})}},{key:"isLiveSession",get:function(){return this.props.course.type===b.y.Live}},{key:"isCollaboration",get:function(){return this.props.course.type===b.y.Collaboration}},{key:"readOnly",get:function(){var e=this;if(this.isCollaboration){var t=this.props.attendees.find((function(t){return t.id!==e.props.currentAttendee.id}));return t&&!t.controlled}return this.props.currentAttendee.id!==this.props.focusAttendee.id&&!this.props.focusAttendee.controlled}},{key:"isZooming",get:function(){return this.props.focusAttendee.id!==this.props.currentAttendee.id&&!this.props.focusAttendee.controlled}},{key:"className",get:function(){var e="";return this.state.attendeesSidebarExpanded&&(e+="expand-view-mode "),e+=this.props.className||""}},{key:"showCamera",get:function(){return this.state.cameraStream&&this.props.currentAttendee.id===this.props.focusAttendee.id}},{key:"showViewbox",get:function(){return!this.isCollaboration&&this.props.broadcastVm&&this.props.focusVm&&this.props.broadcastVm.id===this.props.focusVm.id&&!this.props.onboarding}},{key:"areFilesSettingsSupported",get:function(){if(!this.isLiveSession&&!this.isCollaboration)return!1;var e=this.props.vms.get(this.props.currentAttendee.virtualMachineId).templateId;return this.props.templates.get(e).os!==b.L.Docker}},{key:"learners",get:function(){var e=this;return this.props.attendees.filter((function(t){return t.userId!==e.props.user.id})).sort(ee(this.props.focusAttendee))}}]),t}(p.Component),Object(l.a)(Cn.prototype,"toggleEndSessionModal",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"toggleEndSessionModal"),Cn.prototype),Object(l.a)(Cn.prototype,"focusView",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"focusView"),Cn.prototype),Object(l.a)(Cn.prototype,"calculateSidebarWidth",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"calculateSidebarWidth"),Cn.prototype),Object(l.a)(Cn.prototype,"onEndSessionClick",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onEndSessionClick"),Cn.prototype),Object(l.a)(Cn.prototype,"onTurnSessionOff",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onTurnSessionOff"),Cn.prototype),Object(l.a)(Cn.prototype,"onTick",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onTick"),Cn.prototype),Object(l.a)(Cn.prototype,"onChatWith",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onChatWith"),Cn.prototype),Object(l.a)(Cn.prototype,"onVmInit",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onVmInit"),Cn.prototype),Object(l.a)(Cn.prototype,"onFocusVmConnect",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onFocusVmConnect"),Cn.prototype),Object(l.a)(Cn.prototype,"onFocusVmDisconnect",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onFocusVmDisconnect"),Cn.prototype),Object(l.a)(Cn.prototype,"onFocusOrUnfocusAttendee",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onFocusOrUnfocusAttendee"),Cn.prototype),Object(l.a)(Cn.prototype,"onExpandViewChange",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onExpandViewChange"),Cn.prototype),Object(l.a)(Cn.prototype,"onBroadcastCamera",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onBroadcastCamera"),Cn.prototype),Object(l.a)(Cn.prototype,"onStopBroadcastCamera",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onStopBroadcastCamera"),Cn.prototype),Object(l.a)(Cn.prototype,"onChallengeSubmissionPreviewFromStudentVmList",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"onChallengeSubmissionPreviewFromStudentVmList"),Cn.prototype),Object(l.a)(Cn.prototype,"_onFileUploadStart",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"_onFileUploadStart"),Cn.prototype),Object(l.a)(Cn.prototype,"_onFileUploadCompleted",[d.a],Object.getOwnPropertyDescriptor(Cn.prototype,"_onFileUploadCompleted"),Cn.prototype),Cn),Hr=(n(1433),n(54)),Gr=(n(1434),n(292)),Kr=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._timerRef=void 0,n._isTimerRunning=void 0,n._alarm=void 0,n._timeOver=void 0,n.state={timerLabel:"--:--"},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.startTimer()}},{key:"componentWillUnmount",value:function(){clearTimeout(this._timerRef)}},{key:"componentWillReceiveProps",value:function(e){!e.room||this.props.room&&this.props.room.id===e.room.id||(this._isTimerRunning=!1,clearTimeout(this._timerRef),this.setState({timerLabel:""})),setTimeout(this.startTimer.bind(this))}},{key:"startTimer",value:function(){var e=this;if(this.props.room.id&&!this._isTimerRunning){var t=function(t){e._timerRef&&clearTimeout(e._timerRef),e._timerRef=setTimeout(t,100)},n=0;this._isTimerRunning=!0,function r(){var o=e.props.room.startTime.getTime()-Date.now();if(Math.round(o/1e3)!==Math.round(n/1e3)){if(n=o,o>0){var i=Gr.duration(o,"milliseconds"),s=function(e){return 1===e.toString().length?"0"+e:e},a=s(i.minutes())+":"+s(i.seconds());i.hours()&&(a=s(i.hours())+":"+a),e.setState({timerLabel:a}),t(r)}else e._timeOver=!0,e.props.onTimeOver();e._alarm&&(!e._timeOver&&e._alarm.paused&&o<1e4?e._alarm.play():!e._alarm.paused&&o<=0&&e._alarm.pause())}else t(r)}()}}},{key:"render",value:function(){var e=this;return p.createElement(p.Fragment,null,p.createElement("span",{className:"lobby-timer"},this.state.timerLabel),p.createElement(re,{ref:function(t){return e._alarm=t}}))}}]),t}(p.Component),Yr=(Vr=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"goToDashboard",value:function(){this.props.dispatch(Object(Hr.g)(v.qb))}},{key:"render",value:function(){return p.createElement("div",{className:"guide-lobby"},p.createElement("div",{className:"top-label"},p.createElement("div",{className:"info"},p.createElement("h1",null,"Lobby - ",this.props.roomCourse.name),p.createElement(Or,{roomSecret:this.props.room.secret}))),p.createElement("div",{className:"info"},this.props.isAboutToStart?p.createElement(p.Fragment,null,p.createElement("p",{className:"attendees-num"},this.attendees.size," Learner",1!==this.attendees.size&&"s"),p.createElement("div",{className:"attendees"+(this.attendees.size>20?" scrollable":"")},p.createElement("div",{className:"attendees-fill"},new Array(20).fill(null).map((function(e,t){return p.createElement("div",{key:"f-av-"+t})}))),this.attendees.toList().map((function(e,t){return p.createElement(Zt.a,{source:e,tooltip:!0,width:90,height:90,fontSize:30,key:"a-av-"+t})})))):p.createElement(p.Fragment,null,p.createElement("p",{className:"start-time"},"This session will start on ",this.props.startTime),p.createElement("div",{className:"list"},p.createElement("ul",{className:"list-points"},p.createElement("li",null,"Send this invite link to your learners",p.createElement("span",{className:"list-points-separator"},"---")),p.createElement("li",null,"Remember to join the session few minutes before it starts",p.createElement("span",{className:"list-points-separator"},"---")),p.createElement("li",null,"In the meantime, you can go to your dashboard to manage sessions, recordings, cloud workspaces, etc"))))),this.props.isAboutToStart?p.createElement("div",{className:"guide-timer"},p.createElement("i",{className:"fa fa-clock-o"}),p.createElement(Kr,{room:this.props.room,onTimeOver:this.props.onTimeOver})):p.createElement("div",{className:"controls"},p.createElement(at.b,{onClick:this.goToDashboard},"My Dashboard")))}},{key:"attendees",get:function(){var e=this;return this.props.attendees.filter((function(t){return t.id!==e.props.currentAttendee.id}))}}]),t}(p.Component),Object(l.a)(Vr.prototype,"goToDashboard",[d.a],Object.getOwnPropertyDescriptor(Vr.prototype,"goToDashboard"),Vr.prototype),Vr),qr=(Lr=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"onTimeOver",value:function(){this.props.onReady()}},{key:"render",value:function(){return void 0===this.props.startTime||void 0===this.props.isAboutToStart?null:p.createElement("div",{className:"guide-lobby-wrapper"},p.createElement(Yr,{dispatch:this.props.dispatch,room:this.props.room,roomCourse:this.props.roomCourse,startTime:this.props.startTime,isAboutToStart:this.props.isAboutToStart,attendees:this.props.attendees,currentAttendee:this.props.currentAttendee,onTimeOver:this.onTimeOver}))}}]),t}(p.PureComponent),Object(l.a)(Lr.prototype,"onTimeOver",[d.a],Object.getOwnPropertyDescriptor(Lr.prototype,"onTimeOver"),Lr.prototype),Lr),Zr=(Ur=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"guide-wrapper"},this.props.roomLobby?this.renderLobby():this.renderGuideRoomUI())}},{key:"renderLobby",value:function(){var e=this.props.currentAttendee?p.createElement(qr,{dispatch:this.props.dispatch,room:this.props.room,roomCourse:this.props.roomCourse,attendees:this.props.attendees,currentAttendee:this.props.currentAttendee,onReady:this.props.onReady}):null;return p.cloneElement(this.props.lobbyWrapper,{},e)}},{key:"renderGuideRoomUI",value:function(){return this.props.currentAttendee&&this.props.focusAttendee?p.createElement(Wr,{course:this.props.roomCourse,room:this.props.room,currentAttendee:this.props.currentAttendee,templates:this.props.templates,focusVm:this.props.focusVm,focusVmTemplate:this.props.focusVmTemplate,focusAttendee:this.props.focusAttendee,broadcastVm:this.props.broadcastVm||new b.lb({}),user:this.props.user,attendees:this.props.attendees,dispatch:this.props.dispatch,messages:this.props.messages,onSessionEnd:this.props.onSessionEnd,twilioAudio:this.props.twilioAudio,twilioVideo:this.props.twilioVideo,asyncActions:this.props.asyncActions,sidebarMode:this.props.sidebarMode,vms:this.props.vms,challengeSubmissions:this.props.challengeSubmissions,remoteClientManager:this.props.remoteClientManager,className:this.props.className,visibleView:this.props.visibleView,views:this.props.views,onMount:this.props.onMount,onViewChange:this.props.onViewChange,onViewsRef:this.props.onViewsRef,onChatRef:this.props.onChatRef,onOpenAttachment:this.props.onOpenAttachment,onChallengeSubmissionPreview:this.onChallengeSubmissionPreview,onboarding:this.props.onboarding}):null}},{key:"onChallengeSubmissionPreview",value:function(e){var t=this.chapters.find((function(t){return t.id===e.chapterId}));t?this.props.onChallengeSubmissionPreview(e,t):console.error("Cannot find chapter for challenge submission with id ".concat(e.id))}},{key:"chapters",get:function(){return this.props.roomCourse.chapters}}]),t}(p.PureComponent),Object(l.a)(Ur.prototype,"onChallengeSubmissionPreview",[d.a],Object.getOwnPropertyDescriptor(Ur.prototype,"onChallengeSubmissionPreview"),Ur.prototype),Ur),Jr=n(62),Xr=n(96),Qr=n(22),$r=n(1095),eo=n(1079),to=(n(1435),n(1557)),no=n(1558),ro=n(1559),oo=n(1037),io=(n(1436),["Select if this was better than watching videos","This is revolutionary","This is better than watching videos","This is better in some ways and worse in others","This is worse than watching videos","This is useless"]),so=["Select how responsive your cloud workspace was","My cloud workspace was very responsive","My cloud workspace was acceptably responsive","My cloud workspace was barely responsive","My cloud workspace was not responsive at all"],ao=(Ir=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).state={isSending:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"cancel",value:function(e){e.preventDefault(),this._cancel()}},{key:"send",value:function(e){var t=this;e.preventDefault(),this.setState({isSending:!0});var n=this.props,r=n.room,o=n.rating,i=n.rhymePlatform,s=n.virtualMachine,a=n.feedbackText,c=s!==so[0]?s:"";this.props.sendSessionFeedback(this.props.room,this.props.attendee,new b.C({type:b.D.EndOfSession,rating:o,vmComment:c,platformComment:i,text:a,roomId:this.props.room.id})).then((function(){E.a.submitFeedback(r.courseId,r.id,o,i,c),t.props.showNotification(new b.J({type:b.K.General,text:"Your feedback has been sent"})),t._cancel()})).catch((function(){return t.setState({isSending:!1})}))}},{key:"render",value:function(){return p.createElement("div",{className:"feedback-modal form-styles"},p.createElement(Pn.a,{title:"Your Feedback",visible:this.props.visible,size:"small",scrollable:!1,onToggle:this.props.onToggle},p.createElement("p",{className:"text"},"Please help us improve by giving your feedback"),p.createElement("form",{name:"feedback",onSubmit:this.send},p.createElement(to.a,Object.assign({name:"rating",component:at.t},{label:"Project Rating"})),p.createElement("div",{className:"row"},p.createElement(to.a,Object.assign({name:"rhymePlatform",component:at.u},{label:"Rhyme Platform"}),io.map((function(e,t){return p.createElement(at.n,{value:e,key:"platform-"+t,disabled:0===t},e)}))),p.createElement(nr.a,{position:"left",className:"form-row-hint"},"Was this interactive session better than",p.createElement("br",null),"passively watching a similar video on YouTube?")),p.createElement("div",{className:"row"},p.createElement(to.a,Object.assign({name:"virtualMachine",component:at.u},{label:"Cloud Workspace"}),so.map((function(e,t){return p.createElement(at.n,{value:e,key:"vm-"+t,disabled:0===t},e)}))),p.createElement(nr.a,{position:"left",className:"form-row-hint"},"Did the cloud workspace always respond",p.createElement("br",null),"to your actions immediately?")),p.createElement(to.a,Object.assign({name:"feedbackText",component:at.v,rows:3},{label:"Comment (Optional)"})),p.createElement("div",{className:"row button-sequence"},p.createElement(at.b,{className:"empty",onClick:this.cancel,disabled:this.state.isSending},"Cancel"),p.createElement(at.b,{disabled:this.isSendButtonDisabled,loading:this.state.isSending},"Send")))))}},{key:"_cancel",value:function(){this.props.resetForm(),this.props.onToggle()}},{key:"isSendButtonDisabled",get:function(){return this.props.rhymePlatform===io[0]||!this.props.valid}}]),t}(p.Component),Object(l.a)(Ir.prototype,"cancel",[d.a],Object.getOwnPropertyDescriptor(Ir.prototype,"cancel"),Ir.prototype),Object(l.a)(Ir.prototype,"send",[d.a],Object.getOwnPropertyDescriptor(Ir.prototype,"send"),Ir.prototype),Ir),co=Object(no.a)({form:"feedbackModal",validate:at.G})(ao),lo=Object(ro.a)("feedbackModal"),po=Object(Jr.c)((function(e){return{room:Object(Qr.f)(e),attendee:Object(Qr.d)(e),rating:lo(e,"rating"),rhymePlatform:lo(e,"rhymePlatform"),virtualMachine:lo(e,"virtualMachine"),feedbackText:lo(e,"feedbackText"),initialValues:{rating:5,rhymePlatform:io[0],virtualMachine:so[0],feedbackText:""}}}),(function(e){return{resetForm:function(){return e(Object(oo.b)("feedbackModal"))},sendSessionFeedback:function(t,n,r){return e(Xr.a.sendSessionFeedback(t,n,r))},showNotification:function(t){return e(new m.i(t))}}}))(co),uo=(n(1437),n(1555)),ho=n.n(uo),mo=n(305),yo=n.n(mo),fo=new(n(1556).Converter)({strikethrough:!0,tables:!0,simplifiedAutoLink:!0}),vo=ho()((function(e){return yo()(fo.makeHtml(e))})),bo=n(1062),go=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"session-info"},p.createElement("div",{className:"host"},p.createElement(Zt.a,{source:this.props.lobbyGuide,width:110,height:110,fontSize:50}),p.createElement("div",{className:"label"},"Host"),p.createElement("div",{className:"name"},this.props.lobbyGuide.name)),p.createElement("div",{className:"description"},p.createElement("img",{src:this.screenshot,width:"540",height:"405",alt:""}),p.createElement("div",{className:"content"},p.createElement("h3",null,"Description"),p.createElement("p",{dangerouslySetInnerHTML:{__html:vo(this.props.roomCourse.description)}}))))}},{key:"screenshot",get:function(){return Object(bo.c)(this.props.templates,this.props.roomTemplate)}}]),t}(p.Component),_o=Object(Jr.c)((function(e){return{roomCourse:Object(Qr.j)(e),roomTemplate:Object(Qr.k)(e),templates:e.templates}}))(go),ko=(n(1438),Fr=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"createProject",value:function(){this.props.redirectTo(v.pb)}},{key:"render",value:function(){return p.createElement("div",{className:"course-experience-summary"},p.createElement("h2",null,"Learned by Doing"),p.createElement("div",{className:"summary-list"},p.createElement("div",{className:"summary"},p.createElement("div",{className:"icon hands-on"}),p.createElement("div",{className:"title"},"You Went Hands On"),p.createElement("div",{className:"description"},"Rhyme provided you a custom cloud workspace with all the required software pre-installed. You went hands-on with the software using the cloud workspace--right from your web browser.")),p.createElement("div",{className:"summary"},p.createElement("div",{className:"icon step-by-step"}),p.createElement("div",{className:"title"},"Step-By-Step Directions"),p.createElement("div",{className:"description"},"You watched and followed visual instructions in real time. Instructions can be live or pre-recorded")),p.createElement("div",{className:"summary"},p.createElement("div",{className:"icon monitoring"}),p.createElement("div",{className:"title"},"Real Time Monitoring"),p.createElement("div",{className:"description"},"Instructors can optionally monitor you in real time and give just-in-time help to get you unstuck. Even take control of your cloud workspace, if needed"))),p.createElement("div",{className:"description"},"Want to create a project of your own?"),p.createElement("div",{className:"buttons"},p.createElement(at.b,{className:"empty",onClick:this.createProject},"Create a Project"),this.props.room.completeActionURL?p.createElement("a",{href:this.props.room.completeActionURL},p.createElement(at.b,null,"Go to Project Home")):p.createElement("a",{href:"https://www.coursera.org/search?query=rhyme"},p.createElement(at.b,null,"Join another Project"))))}}]),t}(p.Component),Object(l.a)(Fr.prototype,"createProject",[d.a],Object.getOwnPropertyDescriptor(Fr.prototype,"createProject"),Fr.prototype),Fr),Oo=Object(Jr.c)((function(e){return{room:Object(Qr.f)(e)}}),(function(e){return{redirectTo:function(t){return e(Object(Hr.g)(t))}}}))(ko),wo=n(1213),Co=n.n(wo),Eo=n(1214),jo=n.n(Eo),So=(n(1439),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"lti-course-experience-summary"},p.createElement("img",{alt:"Example of certificate",className:"lti-certificate",srcSet:"".concat(jo.a,", ").concat(Co.a," 2x"),src:jo.a}),p.createElement("div",{className:"main"},p.createElement("h2",null,"You've almost earned your certificate"),p.createElement("p",null,"Take a short quiz on your project home so you can receive your",p.createElement("br",null),"certificate of completion"),p.createElement("a",{href:this._completeActionUrl},p.createElement(at.b,null,"Go to Project Home"))))}},{key:"_completeActionUrl",get:function(){return this.props.room.completeActionURL||"https://www.coursera.org/search?query=rhyme"}}]),t}(p.Component)),Po=Object(Jr.c)((function(e){return{room:Object(Qr.f)(e)}}),{})(So),To=(zr=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).state={isFeedbackModalVisible:n.shouldShowFeedbackModal},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"goToDashboard",value:function(){this.props.redirectTo(v.qb)}},{key:"onFeedbackModalToggle",value:function(){this.setState({isFeedbackModalVisible:!this.state.isFeedbackModalVisible})}},{key:"render",value:function(){return p.createElement("div",{className:"ended-lobby"},this.shouldRenderCourseExperienceSummary?this.renderCourseExperienceSummary():this.renderEndedLobby(),p.createElement(po,{visible:this.state.isFeedbackModalVisible,onToggle:this.onFeedbackModalToggle}))}},{key:"renderCourseExperienceSummary",value:function(){return this.isLtiLearner?p.createElement(Po,null):p.createElement(Oo,null)}},{key:"renderEndedLobby",value:function(){return p.createElement(p.Fragment,null,p.createElement("div",{className:"top-label ended"},p.createElement("div",{className:"info"},p.createElement("h1",null,"Lobby - ",this.props.roomCourse.name),p.createElement("div",{className:"rhyme-ellipse-bg red"},"Ended on ",this.props.endTime))),p.createElement(_o,{lobbyGuide:this.props.lobbyGuide}),p.createElement("div",{className:"tmp-my-dashboard"},p.createElement(at.b,{onClick:this.goToDashboard},"My Dashboard")))}},{key:"shouldShowFeedbackModal",get:function(){if(this.isLtiLearner)return!1;var e=this.props,t=e.currentAttendee,n=e.roomCourse,r=e.completedChaptersNum,o=n.chapters.size,i=n.type===b.y.Recorded;return!!t&&t.access===b.f.Student&&(!i||(1===r&&1===o||r>1&&o>1))}},{key:"isLtiLearner",get:function(){var e=this.props.currentAttendee;return!!e&&e.ltiLearner}},{key:"shouldRenderCourseExperienceSummary",get:function(){return this.props.showCourseExperienceSummary}}]),t}(p.Component),Object(l.a)(zr.prototype,"goToDashboard",[d.a],Object.getOwnPropertyDescriptor(zr.prototype,"goToDashboard"),zr.prototype),Object(l.a)(zr.prototype,"onFeedbackModalToggle",[d.a],Object.getOwnPropertyDescriptor(zr.prototype,"onFeedbackModalToggle"),zr.prototype),zr),Ro=Object(Jr.c)((function(e){return{currentAttendee:Object(Qr.d)(e),roomCourse:Object(Qr.j)(e)}}),(function(e){return{redirectTo:function(t){return e(Object(Hr.g)(t))}}}))(To);n(1440);!function(e){e[e.Unknown=0]="Unknown",e[e.Attendee=1]="Attendee",e[e.Guide=2]="Guide",e[e.Ended=3]="Ended"}(Br||(Br={}));var Ao,Do,Mo,xo,No,Vo,Lo,Uo,Io,Fo,zo,Bo,Wo,Ho,Go=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).state={guides:[new b.eb({})],aboutToStart:!1},n._root=void 0,n._bottomSeparator=void 0,n._guideDataLoaded=void 0,n._aboutToStartTimerStarted=void 0,n._aboutToStartTimeout=void 0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._root=document.getElementById("root"),this._root&&this.shouldRenderSeparators&&(this._bottomSeparator=document.createElement("div"),this._bottomSeparator.className="top-label-bottom-separator",this._root.appendChild(this._bottomSeparator)),this._initLobby()}},{key:"componentWillUnmount",value:function(){clearTimeout(this._aboutToStartTimeout),this._removeBottomSeparator()}},{key:"componentDidUpdate",value:function(){this._initLobby()}},{key:"render",value:function(){var e=this;if(!this.props.roomCourse)return null;var t=p.Children.map(this.props.children,(function(t){return p.cloneElement(t,{isAboutToStart:e.state.aboutToStart,startTime:e.startTime,lobbyGuide:e.lobbyGuide})}));return p.createElement("div",{className:"lobby-wrapper page-wrapper"},p.createElement(eo.a,null),p.createElement($r.a,null),function(){switch(e.lobbyType){case Br.Guide:case Br.Attendee:return t;case Br.Ended:return p.createElement(Ro,{showCourseExperienceSummary:e.props.showCourseExperienceSummary,endTime:e.endTime,lobbyGuide:e.lobbyGuide,completedChaptersNum:e.props.completedChaptersNum||0});case Br.Unknown:default:return p.createElement(w.a,null)}}())}},{key:"_initLobby",value:function(){var e=this,t=this.props.room&&this.props.room.id;this.lobbyType!==Br.Guide&&t&&!this._guideDataLoaded&&(this._guideDataLoaded=!0,this.props.loadGuidesData(this.props.room).then((function(t){return e.setState({guides:t})}))),t&&!this._aboutToStartTimerStarted&&(this._aboutToStartTimerStarted=!0,this._aboutToStartTimer(this.props)),this.shouldRenderSeparators||this._removeBottomSeparator()}},{key:"_aboutToStartTimer",value:function(e){var t=this;!function n(){var r=e.room.startTime.getTime()-Date.now()<6e5;r?t.setState({aboutToStart:r}):t._aboutToStartTimeout=setTimeout(n,2500)}()}},{key:"_removeBottomSeparator",value:function(){this._root&&this._bottomSeparator&&(this._root.removeChild(this._bottomSeparator),this._bottomSeparator=null)}},{key:"_formatTime",value:function(e){var t=Gr.tz.guess();return Gr(e).tz(t).format("MMM D, YYYY [at] h:mm a ([GMT] Z)")}},{key:"startTime",get:function(){return this._formatTime(this.props.room.startTime)}},{key:"endTime",get:function(){var e=this.props.room.endTime||this.props.room.expirationTime;if(this.props.currentAttendeeVm){var t=this.props.currentAttendeeVm.connection.maxExpiryTime;e.getTime()>t.getTime()&&(e=t)}return this._formatTime(e)}},{key:"lobbyGuide",get:function(){return this.state.guides[0]}},{key:"shouldRenderSeparators",get:function(){return!this.props.showCourseExperienceSummary}},{key:"lobbyType",get:function(){return this.props.sessionEnded?Br.Ended:this.props.currentAttendee?this.props.currentAttendee.access===b.f.Guide?Br.Guide:Br.Attendee:Br.Unknown}}]),t}(p.PureComponent),Ko=Object(Jr.c)((function(e){return{user:e.user,room:Object(Qr.f)(e),roomCourse:Object(Qr.j)(e),currentAttendee:Object(Qr.d)(e),currentAttendeeVm:Object(Qr.e)(e)}}),(function(e){return{loadGuidesData:function(t){return e(Xr.a.loadGuidesData(t))}}}))(Go),Yo=(n(1441),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.attachment;return p.createElement("div",{className:"preview-attachment-modal"},p.createElement(Pn.a,{title:e&&e.name?e.name:"Attachment preview",size:"small",visible:this.props.visible,onToggle:this.props.onToggle},e&&e.type===b.d.Image?p.createElement("img",{src:e.url,width:640,height:480,alt:""}):"Unable to preview the file"))}}]),t}(p.Component)),qo=n(1065),Zo=(n(1442),Ao=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).state={isApproving:!1,isRejecting:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"onApprove",value:function(e){var t=this;e.preventDefault(),this.setState({isApproving:!0}),this._sendFeedback(b.p.Approved).catch((function(){return t.setState({isApproving:!1})}))}},{key:"onReject",value:function(e){var t=this;e.preventDefault(),this.setState({isRejecting:!0}),this._sendFeedback(b.p.Rejected).catch((function(){return t.setState({isRejecting:!1})}))}},{key:"render",value:function(){var e=this.props.challengeSubmissionChapter;return p.createElement("div",{className:"preview-challenge-modal form-styles"},p.createElement(Pn.a,{title:this.title,size:"small",scrollable:!0,visible:this.props.visible,onToggle:this.props.onToggle},p.createElement("div",{className:"sub-title"},e.order,". ",e.name),this._renderResourceView(),this.shouldShowActionsButtons?p.createElement("form",{name:"previewChallengeSubmissionModal"},p.createElement(to.a,Object.assign({name:"feedbackText",component:at.v,rows:2},{label:"Comment (Optional)"})),p.createElement("div",{className:"actions"},p.createElement(at.b,{className:"empty",disabled:!this.props.valid||this.state.isApproving,loading:this.state.isRejecting,onClick:this.onReject},"Reject"),p.createElement(at.b,{disabled:!this.props.valid||this.state.isRejecting,loading:this.state.isApproving,onClick:this.onApprove},"Approve"))):null))}},{key:"_renderResourceView",value:function(){var e=this.props.challengeSubmission.resourceUrl;switch(this.resourceType){case Ot.Image:return p.createElement("img",{src:e,width:640,height:480,alt:""});case Ot.Video:return p.createElement(qo.b,{dispatch:this.props.dispatch,src:e,input:void 0,expandModeData:void 0,controls:!0,autoPlay:!0});default:return null}}},{key:"_sendFeedback",value:function(e){var t=this,n=new b.o({state:e,feedback:this.props.feedbackText,challengeSubmissionId:this.props.challengeSubmission.id,reviewerAttendeeId:this.props.currentAttendee.id});return this.props.dispatch(this.props.asyncActions.sendChallengeSubmissionFeedback(this.props.challengeSubmission,n)).then((function(){return t.props.onToggle(!1)}))}},{key:"title",get:function(){return"".concat(this.props.allowActions?"Review":"Preview"," Challenge Solution")}},{key:"resourceType",get:function(){return qt(this.props.challengeSubmission.resourceUrl)}},{key:"shouldShowActionsButtons",get:function(){var e=this,t=this.props.challengeSubmission,n=t.feedbacks.find((function(t){return t.reviewerAttendeeId===e.props.currentAttendee.id}));return this.props.allowActions&&t.state===b.p.Pending&&!n}}]),t}(p.PureComponent),Object(l.a)(Ao.prototype,"onApprove",[d.a],Object.getOwnPropertyDescriptor(Ao.prototype,"onApprove"),Ao.prototype),Object(l.a)(Ao.prototype,"onReject",[d.a],Object.getOwnPropertyDescriptor(Ao.prototype,"onReject"),Ao.prototype),Ao),Jo=Object(no.a)({form:"previewChallengeSubmissionModal",validate:at.G})(Zo),Xo=Object(ro.a)("previewChallengeSubmissionModal"),Qo=Object(Jr.c)((function(e,t){return{feedbackText:Xo(e,"feedbackText"),initialValues:{feedbackText:t.feedbackText}}}))(Jo),$o=(n(1443),n(210)),ei=n.n($o),ti=n(165),ni=n(297),ri=n(1117),oi=n(1133),ii=n(1087),si=n(1186),ai=(Do=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).state={activeCue:void 0},n._unsubscribeFromTrack=ei.a,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.subscribeToTrack!==this.props.subscribeToTrack&&(this._unsubscribeFromTrack(),this._subscribeToTrack())}},{key:"componentDidMount",value:function(){this._subscribeToTrack()}},{key:"componentWillUnmount",value:function(){this._unsubscribeFromTrack()}},{key:"render",value:function(){var e=(this.state.activeCue||{}).text,t=void 0===e?"":e;return p.createElement(si.a,{dir:Object(ii.b)(this.state.activeCue),hidden:this.props.hidden,text:t})}},{key:"_onCueChange",value:function(e){var t=e.srcElement.track;this.setState({activeCue:t.activeCues[0]})}},{key:"_subscribeToTrack",value:function(){this._unsubscribeFromTrack=this.props.subscribeToTrack(this._onCueChange)}}]),t}(p.PureComponent),Object(l.a)(Do.prototype,"_onCueChange",[d.a],Object.getOwnPropertyDescriptor(Do.prototype,"_onCueChange"),Do.prototype),Do),ci=n(1106),li=n(1132),pi=n(50),ui=y.a.InactivityLimitInMinutes,hi=60*ui*1e3,di=60*y.a.InactivityInModalLimitInMinutes*1e3,mi=Symbol("VmInteraction"),yi=Symbol("InactivityLimitReached"),fi=function(){function e(){var t=this;Object(o.a)(this,e),this._emitter=new pi.EventEmitter,this._lastVMInteraction=new Date,this._lastAppInteraction=new Date,this._updateActivityInterval=null,this._lastLoggedVMInteraction=this._lastVMInteraction,this.logVmInteraction=function(){t._lastVMInteraction=new Date,t._onAppInteraction()},this._onAppInteraction=function(){return t._lastAppInteraction=new Date}}return Object(i.a)(e,[{key:"onVmInteraction",value:function(e){var t=this;return this._emitter.addListener(mi,e),function(){return t._emitter.removeListener(mi,e)}}},{key:"onInactivityLimitReached",value:function(e){var t=this;return this._emitter.addListener(yi,e),function(){return t._emitter.removeListener(yi,e)}}},{key:"startTracking",value:function(){var e=this;this.hasTrackingStarted||(document.addEventListener("mousemove",this._onAppInteraction),document.addEventListener("keyup",this._onAppInteraction),this._updateActivityInterval=setInterval((function(){e._lastLoggedVMInteraction!==e._lastVMInteraction&&(e._emitter.emit(mi,e._lastVMInteraction),e._lastLoggedVMInteraction=e._lastVMInteraction),Date.now()-e._lastAppInteraction.getTime()>hi&&e._emitter.emit(yi)}),5e3))}},{key:"stopTracking",value:function(){document.removeEventListener("mousemove",this._onAppInteraction),document.removeEventListener("keyup",this._onAppInteraction),clearInterval(this._updateActivityInterval),this._updateActivityInterval=null}},{key:"lastVmInteraction",get:function(){return this._lastVMInteraction}},{key:"hasTrackingStarted",get:function(){return!!this._updateActivityInterval}}]),e}(),vi=n(1086),bi=(n(1444),function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._timeout=void 0,n.stay=function(){n._clearTimeout(),n.props.onToggle(!1)},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.visible&&!e.visible&&(this._timeout=setTimeout(this.props.onConfirmInactivity,di),Object(_.a)()&&"hidden"===document.visibilityState&&Object(_.b)("Are you still here?","Your cloud workspace will be put on hold"))}},{key:"render",value:function(){return p.createElement(Pn.a,{title:"Are you still here?",visible:this.props.visible,onToggle:this.props.onToggle,size:"small",closeWithEsc:!1,hideClose:!0},p.createElement("div",{className:"inactivity-modal form-styles"},p.createElement("p",{className:"text"},"We noticed you were inactive for the last ",ui," minutes.",p.createElement("br",null),"We are going to put your cloud workspace on hold in order to save resources.",p.createElement("br",null),"You will be able to continue the project when you are back."),p.createElement(vi.a,{onClick:this.stay},"Wait, I am still here")))}},{key:"_clearTimeout",value:function(){clearTimeout(this._timeout)}}]),t}(p.PureComponent)),gi=n(1076),_i=(n(1445),Mo=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).state={contentSize:{width:0,height:0}},n._documentClickEventListener=!1,n._resizeObserver=new pn.a((function(e){var t=e[0].contentRect,r=t.width,o=t.height;n.setState({contentSize:{width:r,height:o}})})),n._handleDocumentClick=function(e){var t=e.target.classList;t.contains("session-completed-overlay-leave-button")||t.contains("session-completed-overlay-go-to-challenge-button")||n.props.stay(),n._setDocumentClickEventListenerEnabled(!1)},n._handleContentRef=function(e){e?n._resizeObserver.observe(e):n._resizeObserver.disconnect()},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){!e.on&&this.props.on&&this._setDocumentClickEventListenerEnabled(!0)}},{key:"goToRejectedChallenge",value:function(){var e=this.rejectedChallenge;e&&this.props.goTo(e)}},{key:"render",value:function(){return p.createElement(An,{on:this.props.on,className:"session-completed-overlay"},p.createElement("div",{ref:this._handleContentRef,className:"content"},this.props.currentAttendee.ltiLearner?this._renderLTIContents():this._renderContents()))}},{key:"_renderContents",value:function(){return p.createElement(p.Fragment,null,p.createElement("div",{className:"congrats-img"}),p.createElement("p",{className:"title"},this.title),this.props.course.resourcesUrl&&p.createElement("p",{className:"resources-email"},"For your reference, we are emailing you all the files from this session"),p.createElement("div",{className:"buttons"},this._renderButtons()))}},{key:"_renderLTIContents",value:function(){var e=this.state.contentSize;return p.createElement(p.Fragment,null,p.createElement("p",{className:"lti-title"},"You've almost earned your certificate"),this.areAllChallengesApproved?p.createElement("img",{alt:"Example of certificate",hidden:e.height<=525,className:"lti-certificate",srcSet:"".concat(jo.a,", ").concat(Co.a," 2x"),src:jo.a}):null,p.createElement("p",{className:"lti-message"},this.ltiMessage),p.createElement("div",{className:"lti-buttons"},this._renderButtons()))}},{key:"_renderButtons",value:function(){return this.hasRejectedChallenge?[this._renderLeaveButton({empty:!0}),this._renderGoToChallengeButton()]:[this._renderStayButton(),this._renderLeaveButton({empty:!1})]}},{key:"_renderGoToChallengeButton",value:function(){return p.createElement(at.b,{className:"session-completed-overlay-go-to-challenge-button",onClick:this.goToRejectedChallenge},"Go to challenge")}},{key:"_renderStayButton",value:function(){return p.createElement(at.b,{className:"empty",onClick:this.props.stay},"Stay")}},{key:"_renderLeaveButton",value:function(e){var t=e.empty;return p.createElement(at.b,{onClick:this.props.leave,className:Fn()("session-completed-overlay-leave-button",t&&"empty")},this.props.currentAttendee.ltiLearner?"Go to project home":"Leave Session")}},{key:"_setDocumentClickEventListenerEnabled",value:function(e){this._documentClickEventListener&&!e?(this._documentClickEventListener=!1,document.removeEventListener("click",this._handleDocumentClick)):!this._documentClickEventListener&&e&&(this._documentClickEventListener=!0,document.addEventListener("click",this._handleDocumentClick))}},{key:"chapters",get:function(){return this.props.course.chapters}},{key:"areAllChallengesApproved",get:function(){return Object(gi.a)(this.chapters)}},{key:"hasChallengeInReview",get:function(){return Object(gi.c)(this.chapters)}},{key:"hasRejectedChallenge",get:function(){return Object(gi.e)(this.chapters)}},{key:"title",get:function(){var e="Congratulations! You completed the session";return this.areAllChallengesApproved?e:this.hasRejectedChallenge?e+". But you have a rejected challenge":this.hasChallengeInReview?e+". You will be notified when the host reviews the challenge solution":""}},{key:"ltiMessage",get:function(){return this.areAllChallengesApproved?p.createElement(p.Fragment,null,"Take a short quiz on your project home so you can receive",p.createElement("br",null),"your certificate of completion"):this.hasRejectedChallenge?p.createElement(p.Fragment,null,"But you have a rejected challenge. Please correct it to earn your certificate"):this.hasChallengeInReview?p.createElement(p.Fragment,null,"You will be notified when the host reviews the challenge solution.",p.createElement("br",null),"In the mean time, take a short quiz in project home to earn your certificate"):null}},{key:"rejectedChallenge",get:function(){return this.hasRejectedChallenge&&Object(gi.b)(this.chapters).first()||null}}]),t}(p.Component),Object(l.a)(Mo.prototype,"goToRejectedChallenge",[d.a],Object.getOwnPropertyDescriptor(Mo.prototype,"goToRejectedChallenge"),Mo.prototype),Mo),ki=(n(1446),n(1447),n(1448)),Oi=n(1449),wi=(xo=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._docClickCb=void 0,n._clickFlag=void 0,n._titleSwitchTimeout=void 0,n._chaptersSelectRef=void 0,n.state={visible:!1,courseNameVisible:!0},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this._docClickCb=function(){e._clickFlag||e.setState({visible:!1}),e._clickFlag=!1});!function t(){e.setState({courseNameVisible:!e.state.courseNameVisible}),e._titleSwitchTimeout&&clearTimeout(e._titleSwitchTimeout),e._titleSwitchTimeout=setTimeout(t,5e3)}()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._docClickCb),clearTimeout(this._titleSwitchTimeout),this._chaptersSelectRef&&this._chaptersSelectRef.removeEventListener("mouseleave",this._mouseLeaveCb)}},{key:"toggleOptions",value:function(){this._clickFlag=!0,this.setState({visible:!this.state.visible})}},{key:"onChange",value:function(e){var t=this.chapters.find((function(t){return t.id===e}));Object(gi.d)(t,this.chapters)?this.props.dispatch(new m.i(new b.J({type:b.K.Info,title:"Challenge Incomplete",text:"This task requires you to complete the preceding challenge first"}))):!t.paid&&this.props.paymentRequired?this.props.onPaidChapter(t):t.videoUrl&&this.props.dispatch(new m.wb(t))}},{key:"showTitle",value:function(e){return"title-name"+(e?" show":"")}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"chapters-select"+(this.state.visible?" visible":""),ref:this._onChaptersSelectRef},p.createElement("div",{className:"selected",onClick:this.toggleOptions},p.createElement("span",{className:this.showTitle(this.state.courseNameVisible)},this.props.course.name),p.createElement("span",{className:this.showTitle(!this.state.courseNameVisible)},p.createElement("span",{className:"order"},this.props.currentChapter.order)," ",this.props.currentChapter.name),p.createElement("i",{className:"fa fa-angle-down","aria-hidden":"true"})),p.createElement("ul",{className:"options"},this.chapters.map((function(t){var n=!t.paid&&e.props.paymentRequired,r=!t.videoUrl;return p.createElement("li",{className:(e.props.currentChapter.id===t.id?"selected":"")+(!n&&r?" disabled":"")+(n?" paid":""),onClick:function(){return e.onChange(t.id)},key:t.id},p.createElement("div",{className:"name","data-name":t.name},p.createElement("span",{className:"order"},t.order)," ",t.name),p.createElement("div",{className:"details"},p.createElement("span",null,t.type===b.s.Instruction?Object(Rr.a)(t.duration):p.createElement(p.Fragment,null,p.createElement("i",{className:"fa fa-trophy"}),t.state===b.h.Submitted?p.createElement("i",{className:"fa fa-hourglass-half"}):t.state===b.h.Approved?p.createElement("img",{src:ki}):t.state===b.h.Rejected?p.createElement("img",{src:Oi}):null))))}))))}},{key:"_onChaptersSelectRef",value:function(e){e&&!this._chaptersSelectRef&&(this._chaptersSelectRef=e,this._chaptersSelectRef.addEventListener("mouseleave",this._mouseLeaveCb))}},{key:"_mouseLeaveCb",value:function(){this.setState({visible:!1}),this._clickFlag=!1}},{key:"chapters",get:function(){return this.props.course.chapters}}]),t}(p.Component),Object(l.a)(xo.prototype,"toggleOptions",[d.a],Object.getOwnPropertyDescriptor(xo.prototype,"toggleOptions"),xo.prototype),Object(l.a)(xo.prototype,"onChange",[d.a],Object.getOwnPropertyDescriptor(xo.prototype,"onChange"),xo.prototype),Object(l.a)(xo.prototype,"_onChaptersSelectRef",[d.a],Object.getOwnPropertyDescriptor(xo.prototype,"_onChaptersSelectRef"),xo.prototype),Object(l.a)(xo.prototype,"_mouseLeaveCb",[d.a],Object.getOwnPropertyDescriptor(xo.prototype,"_mouseLeaveCb"),xo.prototype),xo),Ci=(n(1450),n(107)),Ei=n(1074),ji=n(1092),Si=n(1113),Pi=(No=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._container=void 0,n._keyhole=void 0,n._resizeObserver=void 0,n._state={zoom:1,keyholeStyles:{},scaledVmWidth:0,scaledVmHeight:0},n._emitter=new pi.EventEmitter,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"setZoomLevel",value:function(e){this._state.zoom=e,this._emitter.emit("update",this._state),this.updateVmSize()}},{key:"updateVmSize",value:function(){var e=this.screenWidth*this._state.zoom,t=this.screenHeight*this._state.zoom;this._state.scaledVmWidth=e,this._state.scaledVmHeight=t,this._emitter.emit("update",this._state),this._keyhole&&this._keyhole.refresh()}},{key:"observeForSizeChanges",value:function(e){var t=this;if(this._container){var n=window.getComputedStyle(this._container);this._resizeObserver=new pn.a((function(){t._state.keyholeStyles={height:"auto",width:"auto",maxHeight:parseInt((n.height||"").replace("px",""),10)-44,maxWidth:parseInt((n.width||"").replace("px",""),10)-35},t._emitter.emit("update",t._state)}));var r=Object(ti.findDOMNode)(this._container);if(!r)return void console.error("Element unavailable to observe");this._resizeObserver.observe(r)}this._emitter.on("update",e)}},{key:"unobserveForSizeChanges",value:function(){if(this._container){var e=Object(ti.findDOMNode)(this._container);if(!e)return void console.error("Element unavailable to unobserve");this._resizeObserver.unobserve(e)}this._emitter.off("update")}}]),t}(p.Component),Object(l.a)(No.prototype,"setZoomLevel",[d.a],Object.getOwnPropertyDescriptor(No.prototype,"setZoomLevel"),No.prototype),No),Ti=n(1217),Ri=n.n(Ti),Ai=(n(1451),/translate\((-?\d+\.?\d*)px,\s*(-?\d+\.?\d*)px\)/),Di=(Vo=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._contentWrapper=void 0,n._container=void 0,n._timeout=void 0,n._dragging=!1,n.state={position:{x:0,y:0}},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.x===this.props.x&&e.y===this.props.y||this._dragging||this.setState({position:{x:e.x,y:e.y}})}},{key:"componentDidMount",value:function(){this.refresh()}},{key:"componentWillUnmount",value:function(){clearTimeout(this._timeout)}},{key:"onStart",value:function(){this._dragging=!0}},{key:"onStop",value:function(){var e=this;this._timeout=setTimeout((function(){e._dragging=!1}),1500)}},{key:"onDrag",value:function(e,t){var n=t.x,r=t.y;this.setState({position:{x:n,y:r}})}},{key:"refresh",value:function(){this.setState({position:this._bound(this.state.position)})}},{key:"render",value:function(){var e=this;return this.props.children?p.createElement("div",{ref:function(t){return e._container=t},className:"keyhole-container",style:this.props.style},p.createElement(Ri.a,{position:this.state.position,onStart:this.onStart,onStop:this.onStop,onDrag:this.onDrag,bounds:this._bounds},p.createElement("div",{ref:this._onKeyholeRef,className:"keyhole-content-wrapper"},this.props.children))):null}},{key:"_onKeyholeRef",value:function(e){if(e&&!this._contentWrapper){var t=new Proxy(e.style,{set:function(e,t,n){if("transform"===t){var r=Ai.exec(n)||[];e.left=parseInt(r[1],10)+"px",e.top=parseInt(r[2],10)+"px",e.transform="none"}return!0}});Object.defineProperty(e,"style",{get:function(){return t}})}this._contentWrapper=e}},{key:"_bound",value:function(e){var t=e.x,n=e.y,r=this._bounds;return void 0!==(t=t||0)&&(t=Math.max(r.left,Math.min(t,r.right))),void 0!==(n=n||0)&&(n=Math.max(r.top,Math.min(n,r.bottom))),{x:t,y:n}}},{key:"_bounds",get:function(){var e=this._contentWrapper,t=this._container,n={top:0,bottom:0,right:0,left:0};if(!e||!t)return n;var r=e.getBoundingClientRect(),o=r.width,i=r.height,s=t.offsetWidth,a=t.offsetHeight;return n.top=Math.min(a-i,0),n.bottom=Math.max(a-i,0),n.left=s-o,n}}]),t}(p.PureComponent),Object(l.a)(Vo.prototype,"onStart",[d.a],Object.getOwnPropertyDescriptor(Vo.prototype,"onStart"),Vo.prototype),Object(l.a)(Vo.prototype,"onStop",[d.a],Object.getOwnPropertyDescriptor(Vo.prototype,"onStop"),Vo.prototype),Object(l.a)(Vo.prototype,"onDrag",[d.a],Object.getOwnPropertyDescriptor(Vo.prototype,"onDrag"),Vo.prototype),Object(l.a)(Vo.prototype,"_onKeyholeRef",[d.a],Object.getOwnPropertyDescriptor(Vo.prototype,"_onKeyholeRef"),Vo.prototype),Vo),Mi=(Lo=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._keyhole=void 0,n._keyholeNode=void 0,n._resizeObserver=void 0,n._lastParentSize=void 0,n._mouseDownTimestamp=0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"refresh",value:function(){this._keyhole&&this._keyhole.refresh()}},{key:"componentDidMount",value:function(){if(this._keyhole){this._resizeObserver=new pn.a(this._onParentResize);var e=this._keyholeNode;e?this._resizeObserver.observe(e):console.error("Screen keyhole element unavailable (observe)")}}},{key:"componentWillUnmount",value:function(){if(this._keyhole){var e=this._keyholeNode;e?this._resizeObserver.unobserve(e):console.error("Screen keyhole element unavailable (unobserve)")}}},{key:"componentDidUpdate",value:function(){this.refresh()}},{key:"render",value:function(){var e=this;return p.createElement(Di,{ref:this._onKeyholeRef,x:this._normalizeX(this.props.x),y:this._normalizeY(this.props.y),style:this.props.style},p.createElement("div",{onMouseDown:function(){return e._mouseDownTimestamp=Date.now()},onMouseUp:this._onMouseUp,onDoubleClick:this.props.onDoubleClick,style:{width:this.props.width,height:this.props.height}},this.props.children))}},{key:"_onMouseUp",value:function(){Date.now()-this._mouseDownTimestamp>500||this.props.onClick&&this.props.onClick()}},{key:"_onParentResize",value:function(){this._keyhole&&this._keyholeNode.offsetWidth!==this._lastParentSize&&this.refresh()}},{key:"_onKeyholeRef",value:function(e){this._keyhole=e,this._keyhole&&(this._keyholeNode=Object(ti.findDOMNode)(this._keyhole))}},{key:"_normalizeX",value:function(e){if(void 0!==e&&this._keyhole){var t=this._keyholeNode;if(t){e/=this.props.originalWidth/this.props.width;var n=t.offsetWidth;if(!(n>this.props.width))return n/2-e}}}},{key:"_normalizeY",value:function(e){if(void 0!==e&&this._keyhole){var t=this._keyholeNode;if(t){e/=this.props.originalWidth/this.props.width;var n=t.offsetHeight;if(!(n>this.props.height))return n/2-e}}}}]),t}(p.PureComponent),Object(l.a)(Lo.prototype,"_onMouseUp",[d.a],Object.getOwnPropertyDescriptor(Lo.prototype,"_onMouseUp"),Lo.prototype),Object(l.a)(Lo.prototype,"_onParentResize",[d.a],Object.getOwnPropertyDescriptor(Lo.prototype,"_onParentResize"),Lo.prototype),Object(l.a)(Lo.prototype,"_onKeyholeRef",[d.a],Object.getOwnPropertyDescriptor(Lo.prototype,"_onKeyholeRef"),Lo.prototype),Lo),xi=(n(1452),1.5),Ni=.5,Vi=(Uo=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"zoomIn",value:function(){this.zoomInDisabled||this.props.onSetZoomLevel(this.props.zoom+.1)}},{key:"zoomOut",value:function(){this.zoomOutDisabled||this.props.onSetZoomLevel(this.props.zoom-.1)}},{key:"render",value:function(){return p.createElement("div",{className:"zoom-controls"},p.createElement("div",{className:"btn"+(this.zoomOutDisabled?" disabled":""),onClick:this.zoomOut},"-"),p.createElement("span",{className:"zoom-perc"+(this.props.disabled?" disabled":"")},Math.round(100*this.props.zoom),"%"),p.createElement("div",{className:"btn"+(this.zoomInDisabled?" disabled":""),onClick:this.zoomIn},"+"))}},{key:"isZoomBelowMax",get:function(){return Math.round(100*this.props.zoom)<100*xi}},{key:"isZoomAboveMin",get:function(){return Math.round(100*this.props.zoom)>100*Ni}},{key:"zoomOutDisabled",get:function(){return!this.isZoomAboveMin||this.props.disabled}},{key:"zoomInDisabled",get:function(){return!this.isZoomBelowMax||this.props.disabled}}]),t}(p.Component),Object(l.a)(Uo.prototype,"zoomIn",[d.a],Object.getOwnPropertyDescriptor(Uo.prototype,"zoomIn"),Uo.prototype),Object(l.a)(Uo.prototype,"zoomOut",[d.a],Object.getOwnPropertyDescriptor(Uo.prototype,"zoomOut"),Uo.prototype),Uo),Li=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).vmKeyhole=void 0,n.vmContainer=void 0,n.state={keyholeCenter:{x:0,y:0},scaledVmWidth:0,scaledVmHeight:0,zoom:1,keyholeStyles:{}},n._container=void 0,n._keyhole=void 0,n._onCursorMove=Object(Ei.a)(Object(dt.a)(n)),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){ni.a.on(ni.b,this._onCursorMove),this.observeForSizeChanges(this.setState.bind(this)),this.updateVmSize()}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.broadcastVm,r=this.props.broadcastVm;n.width===r.width&&n.height===r.height||setTimeout((function(){return t.updateVmSize()}))}},{key:"componentWillUnmount",value:function(){ni.a.off(ni.b,this._onCursorMove),this.unobserveForSizeChanges()}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"broadcasted-vm",ref:function(t){return e._container=t}},p.createElement("div",{className:"vm-cont",ref:function(t){return e.vmKeyhole=t}},this.props.broadcastVm.state===b.kb.Ready?p.createElement(p.Fragment,null,p.createElement(Mi,{x:this.state.keyholeCenter.x,y:this.state.keyholeCenter.y,onDoubleClick:this.props.onExpandToggle,width:this.scaledVmWidth,height:this.scaledVmHeight,originalWidth:this.props.broadcastVm.width,originalHeight:this.props.broadcastVm.height,ref:function(t){return e._keyhole=t},style:this.state.keyholeStyles},p.createElement("div",{className:"vm",ref:function(t){return e.vmContainer=t},style:{width:this.scaledVmWidth,height:this.scaledVmHeight}},p.createElement(ji.a,{originalWidth:this.props.broadcastVm.width,originalHeight:this.props.broadcastVm.height,scaledWidth:this.scaledVmWidth},p.createElement(Si.a,{dispatch:this.props.dispatch,width:this.props.broadcastVm.width,height:this.props.broadcastVm.height,disableKeys:[65515],vm:this.props.broadcastVm,cursorPosition:this.state.keyholeCenter,readOnly:!0,cursorScale:2,mouseDisabled:!0,scaleRatio:{scaleX:this.scaledVmWidth/this.props.broadcastVm.width,scaleY:this.scaledVmHeight/this.props.broadcastVm.height},emitCursor:!1,cameraStream:this.props.cameraStream}))))):this._renderNotReadyVM()),p.createElement(Vi,{zoom:this.state.zoom,onSetZoomLevel:this.setZoomLevel,disabled:!this.state.scaledVmWidth||!this.state.scaledVmHeight}))}},{key:"_renderNotReadyVM",value:function(){return this.props.broadcastVm.state===b.kb.Ready?null:this.props.broadcastVm.state===b.kb.Stopped||Object(Ci.c)(this.props.broadcastVm.state)?p.createElement("div",{className:"stopped-vm-label"},"Broadcasted cloud workspace is stopped"):p.createElement(w.a,null)}},{key:"zoom",get:function(){return this.state.zoom}},{key:"screenWidth",get:function(){return this.props.broadcastVm.width}},{key:"screenHeight",get:function(){return this.props.broadcastVm.height}},{key:"scaledVmWidth",get:function(){return this.state.scaledVmWidth||y.a.DefaultScreenWidth}},{key:"scaledVmHeight",get:function(){return this.state.scaledVmHeight||y.a.DefaultScreenHeight}}]),t}(Pi),Ui=(n(1453),Io=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._videoRecordControlsRef=void 0,n.state={isSubmitting:!1,isRecordingStarted:!1,hasRecordedMedia:!1,isUploadingMedia:!1,recordingInProgressForChapter:null},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){}},{key:"onStartRecording",value:function(){var e=this;return new Promise((function(t){var n={isRecordingStarted:!0,hasRecordedMedia:!1};e.state.recordingInProgressForChapter||(n.recordingInProgressForChapter=e.props.chapter),e.setState(n,t)}))}},{key:"onResetRecording",value:function(){this.setState({hasRecordedMedia:!1,recordingInProgressForChapter:null})}},{key:"onRecordingAvailable",value:function(){this.setState({hasRecordedMedia:!0})}},{key:"render",value:function(){return p.createElement("div",{className:"challenge-view"+(this.props.chapter.canSubmit&&this.props.visible?"":" hidden")},p.createElement("div",{className:"wrapper"},p.createElement("div",{className:"title"},"Challenge"),p.createElement("i",{className:"fa fa-trophy"}),p.createElement("div",{className:"description"},this.props.chapter.description||"Missing challenge description"),p.createElement("div",{className:"challenge-record-controls"+(!Object(gi.g)(this.props.chapter)||this.hasRecordingInProgress?" hidden":"")}),this.hasRecordingInProgress?p.createElement("div",{className:"recording-in-progress"},'Recording a solution for challenge "',this.recordingInProgressName,'" is in progress. Please, submit it to host or reset it in order to record a solution for this challenge'):p.createElement("div",{className:"approve-button"},p.createElement(at.b,{onClick:this._requestApproval,loading:this.state.isSubmitting,disabled:this.isSubmitButtonDisabled},this.buttonText),p.createElement("div",{className:"button-description"},this.buttonDescription))),p.createElement("div",{className:"challenge-navigation"},p.createElement(at.b,{className:"empty",onClick:this.props.onShowChallengeVideo,disabled:this.state.isSubmitting},"Challenge Video")))}},{key:"_requestApproval",value:function(){var e=this;this.setState({isSubmitting:!0}),this._prepareChallengeResources().then((function(t){return e.props.onChallengeSubmission(t.resourceUrl,t.screenshotUrl)})).then((function(){e._videoRecordControlsRef&&Object(gi.g)(e.props.chapter)})).catch((function(){e.props.dispatch(new m.i(new b.J({type:b.K.Error,text:"Something went wrong. Please, try again"})))})).finally((function(){return e.setState({isSubmitting:!1})}))}},{key:"_prepareChallengeResources",value:function(){var e=Object(Nt.a)(xt.a.mark((function e(){var t;return xt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.props.chapter.type,e.next=e.t0===b.s.ChallengeSelfApproval?3:e.t0===b.s.ChallengeHostApproval?7:e.t0===b.s.ChallengePeerApproval?8:(e.t0,b.s.Instruction,8);break;case 3:return e.next=5,this._prepareImageResource();case 5:return t=e.sent,e.abrupt("return",{resourceUrl:t,screenshotUrl:t});case 7:return e.abrupt("return",Promise.all([this._prepareVideoResource(),this._prepareImageResource()]).then((function(e){return{resourceUrl:e[0],screenshotUrl:e[1]}})));case 8:throw new Error("Unsupported challenge type");case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_prepareImageResource",value:function(){var e=Object(Nt.a)(xt.a.mark((function e(){var t,n;return xt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.props.remoteClientManager.getRemoteClient(this.props.vm.id))){e.next=7;break}return e.next=4,t.toBlob("image/jpeg",1,1024,768,!0);case 4:if(!(n=e.sent)){e.next=7;break}return e.abrupt("return",this.props.dispatch(this.props.asyncActions.uploadChallengeImage(this.props.chapter,n)));case 7:return e.abrupt("return",Promise.reject("Remote client cannot be null"));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_prepareVideoResource",value:function(){}},{key:"buttonText",get:function(){switch(this.props.chapter.type){case b.s.ChallengeSelfApproval:return"Self-approve";case b.s.ChallengeHostApproval:return"Submit to host";case b.s.ChallengePeerApproval:case b.s.Instruction:default:return""}}},{key:"buttonDescription",get:function(){switch(this.props.chapter.type){case b.s.ChallengeSelfApproval:return"After you solve the challenge, self approve to proceed";case b.s.ChallengeHostApproval:return"Record how you solve the challenge and submit it to the host to proceed";case b.s.ChallengePeerApproval:case b.s.Instruction:default:return""}}},{key:"isSubmitButtonDisabled",get:function(){var e=this.props.chapter.type;return e===b.s.Instruction||!this.props.isVmConnected||e!==b.s.ChallengeSelfApproval&&!this.state.hasRecordedMedia}},{key:"hasRecordingInProgress",get:function(){return this.state.recordingInProgressForChapter&&this.state.recordingInProgressForChapter.id!==this.props.chapter.id}},{key:"recordingInProgressName",get:function(){var e=this.state.recordingInProgressForChapter;return e?"".concat(e.order,". ").concat(e.name):""}}]),t}(p.PureComponent),Object(l.a)(Io.prototype,"onStartRecording",[d.a],Object.getOwnPropertyDescriptor(Io.prototype,"onStartRecording"),Io.prototype),Object(l.a)(Io.prototype,"onResetRecording",[d.a],Object.getOwnPropertyDescriptor(Io.prototype,"onResetRecording"),Io.prototype),Object(l.a)(Io.prototype,"onRecordingAvailable",[d.a],Object.getOwnPropertyDescriptor(Io.prototype,"onRecordingAvailable"),Io.prototype),Object(l.a)(Io.prototype,"_requestApproval",[d.a],Object.getOwnPropertyDescriptor(Io.prototype,"_requestApproval"),Io.prototype),Io),Ii=(n(1454),Fo=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._remoteTrackAddedUnsubscribe=void 0,n._remoteTrackRemovedUnsubscribe=void 0,n.state={guideCameraStream:null},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){if(this.props.twilioVideo&&(this._handleTwilioVideoEvents(),this.props.guide)){var e=this.props.twilioVideo.getAttendeeVideoInfo(this.props.guide.id);e&&this._remoteTrackAdded(e.participant,e.track)}}},{key:"componentDidUpdate",value:function(e){this.props.twilioVideo&&!e.twilioVideo&&this._handleTwilioVideoEvents()}},{key:"componentWillUnmount",value:function(){this._remoteTrackAddedUnsubscribe&&this._remoteTrackAddedUnsubscribe(),this._remoteTrackRemovedUnsubscribe&&this._remoteTrackRemovedUnsubscribe()}},{key:"render",value:function(){return p.createElement("div",{className:"controlled-student-webcams"},this._renderGuideCamera(),p.createElement(_r,{isLiveSession:this.props.course.type===b.y.Live,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,currentAttendee:this.props.currentAttendee,focusAttendee:this.props.focusAttendee,preserveCameraOnDestory:this.props.course.type===b.y.Live,twilioVideo:this.props.twilioVideo}))}},{key:"_renderGuideCamera",value:function(){return p.createElement("div",{className:"guide-webcam"},p.createElement("div",{className:"guide-webcam-thumb"},this.state.guideCameraStream?p.createElement(Er,{cameraStream:this.state.guideCameraStream}):p.createElement("div",{className:"guide-webcam-avatar"},this.props.guide?p.createElement(Zt.a,{source:this.props.guide,width:200,height:200,fontSize:50}):null)),p.createElement("div",{className:"guide-webcam-label"},"Host",this.state.guideCameraStream?" webcam":"",this.props.guide?" - ".concat(this.props.guide.name):""," "))}},{key:"_handleTwilioVideoEvents",value:function(){this.props.twilioVideo&&(this._remoteTrackAddedUnsubscribe=this.props.twilioVideo.onRemoteTrackAdded(this._remoteTrackAdded),this._remoteTrackRemovedUnsubscribe=this.props.twilioVideo.onRemoteTrackRemoved(this._remoteTrackRemoved))}},{key:"_remoteTrackAdded",value:function(e,t){if(this.props.guide&&e.identity===this.props.guide.id){var n=t.attach().srcObject;this.setState({guideCameraStream:n})}}},{key:"_remoteTrackRemoved",value:function(e,t){this.props.guide&&e.identity===this.props.guide.id&&(t.detach(),this.setState({guideCameraStream:null}))}}]),t}(p.Component),Object(l.a)(Fo.prototype,"_remoteTrackAdded",[d.a],Object.getOwnPropertyDescriptor(Fo.prototype,"_remoteTrackAdded"),Fo.prototype),Object(l.a)(Fo.prototype,"_remoteTrackRemoved",[d.a],Object.getOwnPropertyDescriptor(Fo.prototype,"_remoteTrackRemoved"),Fo.prototype),Fo),Fi=n(1069),zi=n(1184),Bi=(n(1455),function(){return p.createElement("div",{className:"autoplay-progress"},p.createElement("div",{className:"frame","data-anim":"base autoplay-progress"},p.createElement("div",{className:"circle","data-anim":"base left"}),p.createElement("div",{className:"circle","data-anim":"base right"})))}),Wi=(n(1456),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"autoplay-controls"},p.createElement("div",{className:"next-label"},"Up Next"),p.createElement("div",{className:"chapter-name"},this.props.chapter.order,". ",this.props.chapter.name),p.createElement("div",{className:"buttons"},p.createElement("div",{className:"play",onClick:this.props.onPlay},p.createElement(Bi,null),p.createElement("div",{className:"play-button"}))),p.createElement("a",{href:"javascript:void(0);",className:"cancel",onClick:this.props.onCancel},"Cancel"))}}]),t}(p.Component)),Hi=n(1111),Gi=function(){function e(t){var n=this;Object(o.a)(this,e),this._getProgress=t,this._interval=void 0,this._recordCurrentProgress=function(){var e=n._getProgress();n.record(e)},this._interval=function(e,t){var n=null,r=function(){return null!==n};return{start:function(){r()||(n=setInterval(e,t))},stop:function(){null!==n&&(clearInterval(n),n=null)},running:r}}(this._recordCurrentProgress,5e3)}return Object(i.a)(e,[{key:"record",value:function(e){var t=e.chapterProgress,n=e.roomId;Object(O.i)(n,t)}},{key:"start",value:function(){this._interval.start()}},{key:"stop",value:function(){this._interval.stop()}},{key:"getProgress",value:function(e){return Object(O.e)(e)}}]),e}(),Ki=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._watched=Object(gt.List)(),n._lastStart=0,n._alarms=[],n._interval=void 0,n._initTime=0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"getTotalTime",value:function(){return this._addNewWatchPeriod(),this._mergeTimePeriods()}},{key:"onPlay",value:function(){this._lastStart=this._instance.state.currentTime}},{key:"onPause",value:function(){this._createWatchPeriodEntry()}},{key:"onSeek",value:function(e){this._addNewWatchPeriod(e)}},{key:"onEnd",value:function(){this._createWatchPeriodEntry()}},{key:"addTime",value:function(e){this._initTime+=e}},{key:"alarm",value:function(e,t){var n=this;this._alarms.push({at:e,triggered:!1,cb:t}),this._interval||(this._interval=setInterval((function(){for(var e,t=n.getTotalTime(),r=0;r<n._alarms.length;r+=1)t>=(e=n._alarms[r]).at&&!e.triggered&&(e.triggered=!0,e.cb())}),2e3))}},{key:"reset",value:function(){this._watched=Object(gt.List)(),this._lastStart=0,this._initTime=0,this._alarms=[],clearInterval(this._interval),this._interval=void 0}},{key:"_addNewWatchPeriod",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._instance.state.currentTime;this._instance.state.playing&&(this._createWatchPeriodEntry(),this._lastStart=e)}},{key:"_createWatchPeriodEntry",value:function(){this._watched=this._watched.push({start:Math.round(this._lastStart),end:Math.round(this._instance.state.currentTime)})}},{key:"_mergeTimePeriods",value:function(){for(var e=this._watched.filter((function(e){return!!(e.end-e.start)})).sort((function(e,t){return e.start-t.start})).groupBy((function(e){return e.start})).map((function(e){return e.sort((function(e,t){return t.end-e.end})).first()})).toList(),t=0,n=null,r=null,o=0;o<e.size;o+=1){if(r=e.get(o),n){if(r.end<=n.end)continue;r.start<n.end&&n.end<r.end?t+=r.end-n.end:r.start>=n.end&&r.end>n.end&&(t+=r.end-r.start)}else t+=r.end-r.start;n=r}return this._initTime+t}}]),t}((function e(t){Object(o.a)(this,e),this._instance=t})),Yi=(n(1457),zo=function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).vmContainer=void 0,n.vmKeyhole=void 0,n._container=void 0,n._keyhole=void 0,n._player=void 0,n._controlsService=void 0,n._nextChapterTimeout=void 0,n._chapterProgressTimeout=void 0,n._progressRecorder=void 0,n._resizeEntry=void 0,n._wasRequestedToPlay=void 0,n._vidCompletionEval=void 0,n._onMouseFrame=Object(Ei.a)(Object(dt.a)(n)),n._getCurrentProgress=function(){return{roomId:n.props.room.id,chapterProgress:{chapterId:n.props.currentChapter.chapterId,time:n.state.currentTime}}},n.state={keyholeCenter:{x:0,y:0},height:window.innerHeight-150,currentTime:0,playing:!1,scaledVmWidth:0,scaledVmHeight:0,playbackRate:qo.a.x100,zoom:1,playerKeyhole:!0,showAutoplay:!1,visibleVideoControls:!0,canPlayVideo:!1,videoDimm:{width:y.a.DefaultScreenWidth,height:y.a.DefaultScreenHeight}};var r={onPlay:n._updateVideoControlsVisibility};return n._controlsService=new Hi.b(e.dispatch,e,r),n._progressRecorder=new Gi(n._getCurrentProgress),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._resizeEntry=Dn.b.create({},(function(){e.setState({height:window.innerHeight-150})})),this.observeForSizeChanges(this.setState.bind(this)),this.updateVmSize(),this._controlsService.setRefs(this._player),this._controlsService.onPlayerPlaying((function(t){return e.setState({playing:t})})),this._controlsService.onPlayerTimeUpdated((function(t){e.setState({currentTime:t}),e.props.onPlayerTimeUpdated&&e.props.onPlayerTimeUpdated(t)})),this._controlsService.onPlayerCompleted(this._onPlayerCompleted),this._vidCompletionEval=new Ki(this),this._setVCEvalAlarms(this.props.currentChapter),this._updateChapterProgress(),this._progressRecorder.start()}},{key:"componentWillUnmount",value:function(){this._controlsService.destroy(),clearTimeout(this._nextChapterTimeout),clearTimeout(this._chapterProgressTimeout),Dn.b.destroy(this._resizeEntry),this.unobserveForSizeChanges(),this._progressRecorder.stop()}},{key:"componentWillReceiveProps",value:function(e){!this.props.controlled&&e.controlled&&this.pause(),e.currentChapter.id!==this.props.currentChapter.id&&(clearTimeout(this._nextChapterTimeout),this.pause(),this.setState({currentTime:0,playing:!0,showAutoplay:!1}),this._wasRequestedToPlay=!0,this._progressRecorder.record({roomId:this.props.room.id,chapterProgress:{chapterId:e.currentChapter.chapterId,time:0}}),this._vidCompletionEval.reset(),this._setVCEvalAlarms(e.currentChapter)),this._controlsService.updateProps(e)}},{key:"componentDidUpdate",value:function(e){this.props.sidebarMode!==e.sidebarMode&&!this.props.sidebarMode.guide&&this._player&&this._player.learnerChangedSidebarMode()}},{key:"play",value:function(){this._wasRequestedToPlay=!0,this.state.canPlayVideo&&(this._controlsService.onPlay(),this._vidCompletionEval.onPlay())}},{key:"pause",value:function(){this._controlsService.onPause()}},{key:"complete",value:function(){this._onPlayerCompleted()}},{key:"onPlaybackRateChange",value:function(e){this._controlsService.onPlaybackRateChange(e),this.props.onPlaybackRateChange&&this.props.onPlaybackRateChange(e),this.setState({playbackRate:e})}},{key:"onAutoplayPlay",value:function(){clearTimeout(this._nextChapterTimeout),this._controlsService.onForward(),this.setState({showAutoplay:!1})}},{key:"onAutoplayCancel",value:function(){clearTimeout(this._nextChapterTimeout),this.setState({showAutoplay:!1})}},{key:"onVideoDimmensions",value:function(e,t){var n=this;this.setState({videoDimm:{width:e,height:t}},(function(){n.updateVmSize(),n.props.onVideoDimmensions()}))}},{key:"onExpandModeChange",value:function(e){var t=e===Fi.e.Expand;this.props.dispatch(new m.ib(t,!0))}},{key:"onCanPlay",value:function(e){e&&this._wasRequestedToPlay&&this._controlsService.onPlay(),this.setState({canPlayVideo:e})}},{key:"onForward",value:function(){var e=this._controlsService.nextChapter;e&&!e.paid&&this.props.paymentRequired?this.props.onPaidChapter(e):this._controlsService.onForward()}},{key:"onSeek",value:function(e){this._controlsService.onSeek(e),this._vidCompletionEval.onSeek(e)}},{key:"onPause",value:function(){this._controlsService.onPause(),this._vidCompletionEval.onPause()}},{key:"onZoomChange",value:function(e){this.setZoomLevel(e),this.props.onZoomChange&&this.props.onZoomChange(e)}},{key:"render",value:function(){var e=this,t=this._player?this._player.duration:0;return p.createElement("div",{className:"session-player",ref:function(t){return e._container=t}},p.createElement("div",{className:"video-cont ".concat(this.props.videoContClassName||""),ref:function(t){return e.vmKeyhole=t}},p.createElement(Mi,{x:this.state.keyholeCenter.x,y:this.state.keyholeCenter.y,onClick:this._onPauseToggle,onDoubleClick:this.props.onExpandToggle,width:this.state.scaledVmWidth,height:this.state.scaledVmHeight,originalWidth:this.state.videoDimm.width,originalHeight:this.state.videoDimm.height,ref:function(t){return e._keyhole=t}},p.createElement("div",{ref:function(t){return e.vmContainer=t}},p.createElement(zi.a,{ref:function(t){return e._player=t},dispatch:this.props.dispatch,mouse:!0,showViewbox:!1,onMouseFrame:this._onMouseFrame,captionPlayer:this.props.captionPlayer,autoPlay:!1,chapter:this.props.currentChapter,controls:!1,onCanPlay:this.onCanPlay,language:this.props.course.language,onReadyMetadata:this._onPlayerReadyMetadata,onVideoDimmensions:this.onVideoDimmensions,onExpandModeChange:this.onExpandModeChange,onCueChange:this.props.onCueChange,errorContainer:this.vmKeyhole}))),p.createElement(Hi.a,{className:this.state.visibleVideoControls?"visible":"",controls:{viewbox:!1},playing:this.state.playing,duration:t,currentTime:this.state.currentTime,playerKeyhole:this.state.playerKeyhole,playbackRate:this.state.playbackRate,backwardDisabled:!this._controlsService.hasPrevChapter,forwardDisabled:this.isForwardDisabled,disableAll:!this.state.canPlayVideo,onPlay:this.play,onPause:this.onPause,onSeek:this.onSeek,onForward:this.onForward,onBackward:this._controlsService.onBackward,onPlaybackRateChange:this.onPlaybackRateChange,showCC:this.props.showCC,onCCToggle:this.props.onCCToggle}),this.state.showAutoplay&&this._controlsService.nextChapter?p.createElement(Wi,{chapter:this._controlsService.nextChapter,onPlay:this.onAutoplayPlay,onCancel:this.onAutoplayCancel}):null),this.props.ccViewer,p.createElement(Vi,{zoom:this.state.zoom,onSetZoomLevel:this.onZoomChange}))}},{key:"_onPauseToggle",value:function(){this.state.playing?this.pause():this.play()}},{key:"_onPlayerCompleted",value:function(){var e=this,t=this.props.currentChapter;if(t.canSubmit)this.props.onShowChallengeDescription();else{this.props.onChapterCompleted(t.id);var n=this._controlsService.nextChapter;this._vidCompletionEval.onEnd(),n&&(n.paid||!n.paid&&!this.props.paymentRequired)?(this.setState({showAutoplay:!0}),clearTimeout(this._nextChapterTimeout),this._nextChapterTimeout=setTimeout((function(){e._controlsService.onForward(),e.setState({showAutoplay:!1})}),5e3)):n&&!n.paid&&this.props.paymentRequired?this.props.onPaidChapter(n):this.props.onSessionCompleted()}}},{key:"_updateChapterProgress",value:function(){var e=this;!function t(){var n=new b.r({chapterId:e.props.currentChapter.chapterId,time:e.state.currentTime});e.props.dispatch(new m.E([{id:e.props.currentAttendee.id,progress:n}])),e._chapterProgressTimeout&&clearTimeout(e._chapterProgressTimeout),e._chapterProgressTimeout=setTimeout(t,500)}()}},{key:"_onPlayerReadyMetadata",value:function(){var e=this._progressRecorder.getProgress(this.props.room.id);if(e&&e.chapterId===this.props.currentChapter.chapterId&&this._player){var t=e.time;if(!this.props.paymentRequired&&this.props.currentChapter.canSkip&&this._player.duration>20&&e.time+20>=this._player.duration){var n=this._controlsService.nextChapter;if(n)return void this.props.dispatch(new m.wb(n));t=0}this._player.setCurrentTime(t)}}},{key:"_updateVideoControlsVisibility",value:function(){var e=this;this.state.visibleVideoControls&&setTimeout((function(){e.setState({visibleVideoControls:!1})}),5e3)}},{key:"_sendProgressEvent",value:function(e,t){this.props.dispatch(this.props.asyncActions.updateAttendeeSessionProgress(this.props.room,this.props.currentAttendee,new b.j({chapterId:t,videoTime:0,event:e})))}},{key:"_setVCEvalAlarms",value:function(e){var t=this,n=e.chapterId,r=e.duration,o=e.videoUrl,i=Math.round(.1*r/1e3),s=Math.round(.7*r/1e3),a=this.props,c=a.course,l=a.room;this._vidCompletionEval.alarm(i,(function(){t._sendProgressEvent(b.k.Enter,n),E.a.startChapterVideo(c.id,l.id,n,o)})),this._vidCompletionEval.alarm(s,(function(){t._sendProgressEvent(b.k.Complete,n),E.a.completeChapterVideo(c.id,l.id,n,o),t.chapters.get(t.chapters.count()-2).chapterId===n&&E.a.approxProjectCompletion(c.id,l.id,n,o)}))}},{key:"zoom",get:function(){return this.state.zoom}},{key:"screenWidth",get:function(){return this.state.videoDimm.width}},{key:"screenHeight",get:function(){return this.state.videoDimm.height}},{key:"chapters",get:function(){return this.props.course.chapters}},{key:"isForwardDisabled",get:function(){var e=this.props.currentChapter;return!this._controlsService.hasNextChapter||!e.canSkip}},{key:"isPlaying",get:function(){return this.state.playing}},{key:"videoWidth",get:function(){return this.state.height*(this.state.videoDimm.width/this.state.videoDimm.height)}}]),t}(Pi),Object(l.a)(zo.prototype,"play",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"play"),zo.prototype),Object(l.a)(zo.prototype,"onPlaybackRateChange",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"onPlaybackRateChange"),zo.prototype),Object(l.a)(zo.prototype,"onAutoplayPlay",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"onAutoplayPlay"),zo.prototype),Object(l.a)(zo.prototype,"onAutoplayCancel",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"onAutoplayCancel"),zo.prototype),Object(l.a)(zo.prototype,"onVideoDimmensions",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"onVideoDimmensions"),zo.prototype),Object(l.a)(zo.prototype,"onExpandModeChange",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"onExpandModeChange"),zo.prototype),Object(l.a)(zo.prototype,"onCanPlay",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"onCanPlay"),zo.prototype),Object(l.a)(zo.prototype,"onForward",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"onForward"),zo.prototype),Object(l.a)(zo.prototype,"onSeek",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"onSeek"),zo.prototype),Object(l.a)(zo.prototype,"onPause",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"onPause"),zo.prototype),Object(l.a)(zo.prototype,"onZoomChange",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"onZoomChange"),zo.prototype),Object(l.a)(zo.prototype,"_onPauseToggle",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"_onPauseToggle"),zo.prototype),Object(l.a)(zo.prototype,"_onPlayerCompleted",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"_onPlayerCompleted"),zo.prototype),Object(l.a)(zo.prototype,"_onPlayerReadyMetadata",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"_onPlayerReadyMetadata"),zo.prototype),Object(l.a)(zo.prototype,"_updateVideoControlsVisibility",[d.a],Object.getOwnPropertyDescriptor(zo.prototype,"_updateVideoControlsVisibility"),zo.prototype),zo),qi=(Bo=function(e){function t(e){var n;Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._keyholeRef=void 0;var r=n._loadStoredWatchedChallengesData();return n.state={isChallengeViewVisible:!1,watchedChallenges:Object(gt.List)(r.challenges),lastChallengeStartTime:r.lastChallengeStartTime},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.onbeforeunload=function(){return e._storeLeaveTime()}}},{key:"componentWillReceiveProps",value:function(e){!e.onboarding&&this.props.onboarding&&this.recorded&&this._keyholeRef&&this._keyholeRef.play()}},{key:"componentDidUpdate",value:function(e){this.props.currentChapter&&e.currentChapter&&(this.props.currentChapter.id!==e.currentChapter.id&&this.state.isChallengeViewVisible&&this.toggleChallengeView(!1),this.props.currentChapter.id===e.currentChapter.id&&!this.props.currentChapter.canSubmit&&e.currentChapter.canSubmit&&this._keyholeRef&&this._keyholeRef.complete())}},{key:"componentWillUnmount",value:function(){this._storeLeaveTime()}},{key:"toggleChallengeView",value:function(e){this.setState({isChallengeViewVisible:e})}},{key:"onShowChallengeDescription",value:function(){if(this.props.currentChapter){this._keyholeRef&&this._keyholeRef.pause();var e=this.props.currentChapter.id;if(!this.state.watchedChallenges.includes(e)){var t;switch(this.props.currentChapter.type){case b.s.ChallengeSelfApproval:t='After you solve the challenge, click the "Self-approve" button to proceed to next task and to \n            send a screenshot of your solution to the host';break;case b.s.ChallengeHostApproval:t='After you solve the challenge, record how you solve it and click the "Submit to host" button \n            to proceed to next task and to send your solution to the host';break;case b.s.ChallengePeerApproval:case b.s.Instruction:default:throw new Error("Unsupported challenge type")}this.props.dispatch(new m.i(new b.J({type:b.K.Info,title:"Solve the challenge",text:t})));var n=this.state.watchedChallenges.push(e),r=Date.now();this._storeWatchedChallengesData(n.toArray(),r),this.setState({watchedChallenges:n,lastChallengeStartTime:r})}this.toggleChallengeView(!0)}}},{key:"onShowChallengeVideo",value:function(){this._keyholeRef&&this._keyholeRef.play(),this.toggleChallengeView(!1)}},{key:"onChallengeSubmission",value:function(e,t){var n=this,r=this.props,o=r.room,i=r.currentAttendee,s=r.currentChapter;if(!s)return Promise.reject("Current chapter cannot be null");var a=this.state.lastChallengeStartTime?Date.now()-this.state.lastChallengeStartTime:0,c=new b.n({resourceUrl:e,screenshotUrl:t,duration:a,attendeeChapterId:s.id}),l=this.props.dispatch(this.props.asyncActions.sendChallengeSubmission(o,i,s,c));return l.then((function(){n.toggleChallengeView(!1),n._clearLastChallengeStartTime()})),l}},{key:"render",value:function(){return p.createElement("div",{className:"session-content"+(this.shouldShowWebcams?" controlled":"")},this.recorded?this.renderRecorded():this.renderLive(),this.shouldShowWebcams?this.renderControlledStudentView():null)}},{key:"renderControlledStudentView",value:function(){return p.createElement(Ii,{course:this.props.course,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,currentAttendee:this.props.currentAttendee,focusAttendee:this.props.focusAttendee,twilioVideo:this.props.twilioVideo,guide:this.props.guide})}},{key:"renderRecorded",value:function(){var e=this.props.currentChapter;return e?p.createElement(p.Fragment,null,this.state.watchedChallenges.contains(e.id)&&e.canSubmit?p.createElement("div",{className:"challenge-navigation"},p.createElement(at.b,{className:"empty",onClick:this.onShowChallengeDescription},"Challenge Description")):null,p.createElement(Yi,{ref:this._onKeyholeRef,onExpandToggle:this.props.onExpandToggle,onChapterCompleted:this.props.onChapterCompleted,onSessionCompleted:this.props.onSessionCompleted,onPlayerTimeUpdated:this.props.onPlayerTimeUpdated,onPaidChapter:this.props.onPaidChapter,onVideoDimmensions:this.props.onVideoDimmensions,onShowChallengeDescription:this.onShowChallengeDescription,onZoomChange:this.props.onZoomChange,currentChapter:e,paymentRequired:this.props.paymentRequired,course:this.props.course,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,currentAttendee:this.props.currentAttendee,controlled:this.props.currentAttendee.controlled,room:this.props.room,captionPlayer:this.props.captionPlayer||void 0,vm:this.props.vm,onPlaybackRateChange:this.props.onPlaybackRateChange,sidebarMode:this.props.sidebarMode,onCCToggle:this.props.onCCToggle,showCC:this.props.showCC,onCueChange:this.props.onCueChange,videoContClassName:this.props.videoContClassName,ccViewer:this.props.ccViewer}),p.createElement(Ui,{visible:this.state.isChallengeViewVisible,chapter:e,room:this.props.room,attendee:this.props.currentAttendee,vm:this.props.vm,isVmConnected:this.props.isVmConnected,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,remoteClientManager:this.props.remoteClientManager,onShowChallengeVideo:this.onShowChallengeVideo,onChallengeSubmission:this.onChallengeSubmission,onPreviewChallenge:this.props.onPreviewChallenge}),p.createElement(wi,{course:this.props.course,currentChapter:e,dispatch:this.props.dispatch,paymentRequired:this.props.paymentRequired,onPaidChapter:this.props.onPaidChapter})):null}},{key:"renderLive",value:function(){return this.props.guide?this.props.currentAttendee.virtualMachineId!==this.props.broadcastVm.id?p.createElement(Li,{ref:this._onKeyholeRef,onExpandToggle:this.props.onExpandToggle,dispatch:this.props.dispatch,broadcastVm:this.props.broadcastVm,cameraStream:this.props.cameraStream}):p.createElement("p",{className:"session-content-broadcasted-label"},"You are being broadcasted!"):null}},{key:"_loadStoredWatchedChallengesData",value:function(){var e=Object(O.d)(O.a.WatchedChallenges);if(e&&e[this.props.room.id]){var t=e[this.props.room.id].lastChallengeStartTime;if(t){var n=Object(O.d)(O.a.LeftSession);if(n&&n[this.props.room.id]){var r=n[this.props.room.id];Date.now()-r>=6e5&&(t=Date.now(),e[this.props.room.id].lastChallengeStartTime=t,Object(O.h)(O.a.WatchedChallenges,e))}}return{challenges:e[this.props.room.id].challenges||[],lastChallengeStartTime:t||null}}return{challenges:[],lastChallengeStartTime:null}}},{key:"_clearLastChallengeStartTime",value:function(){var e=Object(O.d)(O.a.WatchedChallenges)||{};e[this.props.room.id]={challenges:this.state.watchedChallenges,lastChallengeStartTime:null},Object(O.h)(O.a.WatchedChallenges,e)}},{key:"_storeWatchedChallengesData",value:function(e,t){var n=Object(O.d)(O.a.WatchedChallenges)||{};n[this.props.room.id]={challenges:e,lastChallengeStartTime:t},Object(O.h)(O.a.WatchedChallenges,n)}},{key:"_storeLeaveTime",value:function(){var e=Object(O.d)(O.a.LeftSession)||{};e[this.props.room.id]=Date.now(),Object(O.h)(O.a.LeftSession,e)}},{key:"_onKeyholeRef",value:function(e){this._keyholeRef=e,this._keyholeRef&&this.props.onKeyholeRef&&this.props.onKeyholeRef(this._keyholeRef)}},{key:"recorded",get:function(){return this.props.course.type===b.y.Recorded}},{key:"shouldShowWebcams",get:function(){return this.props.controlledByGuide&&y.a.ShowWebcam}}]),t}(p.Component),Object(l.a)(Bo.prototype,"onShowChallengeDescription",[d.a],Object.getOwnPropertyDescriptor(Bo.prototype,"onShowChallengeDescription"),Bo.prototype),Object(l.a)(Bo.prototype,"onShowChallengeVideo",[d.a],Object.getOwnPropertyDescriptor(Bo.prototype,"onShowChallengeVideo"),Bo.prototype),Object(l.a)(Bo.prototype,"onChallengeSubmission",[d.a],Object.getOwnPropertyDescriptor(Bo.prototype,"onChallengeSubmission"),Bo.prototype),Object(l.a)(Bo.prototype,"_onKeyholeRef",[d.a],Object.getOwnPropertyDescriptor(Bo.prototype,"_onKeyholeRef"),Bo.prototype),Bo),Zi=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"student-files-settings files-settings"},p.createElement("h2",null,"Upload File:"),p.createElement(er.a,{vms:[this.props.attendeeVm],dispatch:this.props.dispatch,disabled:this.fileUploadDisabled,remoteClientManager:this.props.remoteClientManager,label:"Upload files to your cloud workspace"}),p.createElement("p",{className:"upload-fallback"},"You can also use any upload service like"," ",p.createElement("a",{href:"https://ufile.io",target:"_blank"},"ufile.io")),p.createElement("div",{className:"separator"}),p.createElement($n,{disabled:this.fileUploadDisabled,remoteClient:this.ownRemoteClient,vm:this.props.focusVm}))}},{key:"fileUploadDisabled",get:function(){return this.props.attendeeVm.id!==this.props.focusVm.id||!this.props.isFocusVmConnected}},{key:"ownRemoteClient",get:function(){return this.props.focusVm?this.props.remoteClientManager.getRemoteClient(this.props.focusVm.id):void 0}}]),t}(p.PureComponent),Ji=(n(1458),function(e){function t(e){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).call(this,e))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement("div",{className:"student-settings"},p.createElement("div",{className:"session-settings"},y.a.ShowWebcam&&this.props.course.type!==b.y.Collaboration?p.createElement(_r,{isLiveSession:this.props.course.type===b.y.Live,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,currentAttendee:this.props.currentAttendee,focusAttendee:this.props.focusAttendee,twilioVideo:this.props.twilioVideo}):null,p.createElement("div",{className:"controls"},p.createElement(rr,{dispatch:this.props.dispatch,remoteClientManager:this.props.remoteClientManager,vm:this.props.focusVm})),this.props.twilioAudio&&p.createElement(lr,{twilioAudio:this.props.twilioAudio}),p.createElement("div",{className:"keyboard-shortcuts",style:{display:"none"}},p.createElement("p",null,"Keyboard shortcuts"),p.createElement("table",null,p.createElement("tbody",null,p.createElement("tr",null,p.createElement("td",null,"Alt + Shift + X"),p.createElement("td",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.")),p.createElement("tr",null,p.createElement("td",null,"Alt + Shift + X"),p.createElement("td",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.")),p.createElement("tr",null,p.createElement("td",null,"Alt + Shift + X"),p.createElement("td",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.")))))))}}]),t}(p.Component)),Xi=n(134);!function(e){e.Host="StudentHost",e.Chat="StudentChat",e.Settings="StudentSettings",e.FilesSettings="FileSettings"}(Ho||(Ho={}));var Qi,$i,es,ts,ns,rs=(Wo=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).state={isFocusVmConnected:!1,sessionCompletedOverlay:!1,cursorPosition:{x:0,y:0},timeToCompleteRecording:n.isRecorded?jr(n.props.course,n.props.course.chapters.first(),0):void 0,bottomBarWidth:0,isLeaveModalVisible:!1,isInactivityModalVisible:!1,cameraStream:null,playbackRate:qo.a.x100,showCC:!1,userChangedZoom:!1},n._chat=void 0,n._keyhole=void 0,n._notifyEndIsNear=void 0,n._notifiedExpiryBeforeEnd=void 0,n._shouldPlayVideoOnActiveUser=!1,n._stayedInSessionAfterCompletingIt=!1,n._cursorMoveCb=void 0,n._remoteTrackAddedUnsubscribe=ei.a,n._remoteTrackRemovedUnsubscribe=ei.a,n._onVmInteractionUnsubscriber=ei.a,n._onInactivityLimitReachedUnsubsctiber=ei.a,n._appInteractionTracker=new fi,n._sidebarWidth=void 0,n._keyCombo=void 0,n._rightPanel=void 0,n._captionPlayer=void 0,n._gtmVmLaunchTime=null,n._videoTrackHub=Object(ci.b)(),n._keyboardActionHandlers={"video.toggleCC":n.onCCToggle,"video.toggleExpand":n.onToggleExpandOrDock},n._onUserChangedZoom=function(){n.setState({userChangedZoom:!0}),n._onUserChangedZoom=function(){}},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;ni.a.on(ni.b,this._cursorMoveCb=function(t){e.isControlled()&&e.setState({cursorPosition:t})}),this.props.onMount&&this.props.onMount(),this._onBeforeUnloadMsg(),this._onVmInteractionUnsubscriber=this._appInteractionTracker.onVmInteraction(this._onVmInteraction),this._onInactivityLimitReachedUnsubsctiber=this._appInteractionTracker.onInactivityLimitReached(this._onInactivityLimitReched),this.props.room.broadcastCamera&&y.a.ShowWebcam&&(this._checkCameraBrowserSupport(),this._handleTwilioVideoEvents()),this._keyCombo=Dn.a.create([At.a,At.l,At.n],(function(){e.onToggleExpandOrDock()})),this.props.activityTrackerBuffer.startBuffering(this)}},{key:"componentWillUnmount",value:function(){ni.a.off(ni.b,this._cursorMoveCb),this.props.activityTrackerBuffer.stopBuffering(),Dn.a.destroy(this._keyCombo),window.onbeforeunload=function(){},this._remoteTrackAddedUnsubscribe(),this._remoteTrackRemovedUnsubscribe(),this._onVmInteractionUnsubscriber(),this._onInactivityLimitReachedUnsubsctiber(),this._appInteractionTracker.stopTracking()}},{key:"componentWillReceiveProps",value:function(e){e.sidebarMode.mode!==this.props.sidebarMode.mode&&e.sidebarMode.guide&&this.props.views&&this.props.views.switchView(Ho.Host)}},{key:"componentDidUpdate",value:function(e,t){this.props.room.broadcastCamera!==e.room.broadcastCamera&&y.a.ShowWebcam&&this._handleGuideCamera(),this.props.twilioVideo!==e.twilioVideo&&this._handleTwilioVideoEvents(),!this.state.sessionCompletedOverlay||t.sessionCompletedOverlay||this._stayedInSessionAfterCompletingIt||E.a.projectCompleted(this.props.course.id,this.props.room.id)}},{key:"isControlled",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return e.course.type===b.y.Collaboration?this.props.currentAttendee.controlled:e.focusAttendee.id===e.currentAttendee.id&&e.currentAttendee.controlled}},{key:"onCCToggle",value:function(){this.setState({showCC:!this.state.showCC})}},{key:"onVmInit",value:function(){var e=this.props,t=e.course,n=e.room,r=e.focusVm;r&&(this._gtmVmLaunchTime=E.a.sessionVmLaunchTime(t.id,n.id,r.id))}},{key:"onFocusVmConnect",value:function(){this.setState({isFocusVmConnected:!0}),this._gtmVmLaunchTime&&(this._gtmVmLaunchTime(),this._gtmVmLaunchTime=null),this._appInteractionTracker.startTracking()}},{key:"onFocusVmDisconnect",value:function(){this.setState({isFocusVmConnected:!1}),this._appInteractionTracker.stopTracking()}},{key:"onKeyholeRef",value:function(e){this._keyhole=e}},{key:"onTick",value:function(e){var t=Math.round(e/1e3),n=60*this.endSoonMins,r=this.state.timeToCompleteRecording;if(!this._notifyEndIsNear&&n-20<t&&t<n){var o=new b.J({type:b.K.PowerOff,title:"Session finishes in ".concat(this.endSoonMins," minutes"),text:"When session finishes, you will be automatically disconnected from it",ttl:2e4});this.props.dispatch(new m.i(o)),this._notifyEndIsNear=!0}else if(e>0&&!this._notifiedExpiryBeforeEnd&&r){r>this.expiration.getTime()-Date.now()&&(this.props.dispatch(new m.i(new b.J({type:b.K.Info,title:"Warning",text:"The session will end before you can complete all tasks"}))),this._notifiedExpiryBeforeEnd=!0)}else e<=0&&this.props.onSessionEnd({notify:!0})}},{key:"onToggleExpandOrDock",value:function(){var e=this.props.sidebarMode,t=b.V.Expand;e.mode===b.V.Expand&&(t=b.V.Dock),this.props.dispatch(new m.H(t))}},{key:"onViewChange",value:function(e){var t=this;this.props.onViewChange&&this.props.onViewChange(e),e===Ho.Chat&&setTimeout((function(){t._chat&&t._chat.focusChat()}))}},{key:"onSessionCompleted",value:function(){if(this.props.room.settings.timerSource===b.T.ChapterDuration&&!this._stayedInSessionAfterCompletingIt&&(this.setState({sessionCompletedOverlay:!0}),this.props.course.resourcesUrl)){var e=this.props,t=e.asyncActions,n=e.dispatch,r=e.room,o=e.currentAttendee;n(t.sendCourseResourcesEmail(r,o))}}},{key:"onPlayerTimeUpdated",value:function(e){var t=this.props.currentChapter;if(t){var n=jr(this.props.course,t,e);this.setState({timeToCompleteRecording:n})}}},{key:"onVideoDimmensions",value:function(){if(!this.state.userChangedZoom&&this._keyhole&&this.props.sidebarMode.mode){var e=this._calculateZoom();this._keyhole.setZoomLevel(e)}}},{key:"onPlaybackRateChange",value:function(e){this.setState({playbackRate:e})}},{key:"onSplitterResize",value:function(e){this.props.sidebarMode.mode!==b.V.Expand?this.setState({bottomBarWidth:e+y.a.SplitterWidth}):this._sidebarWidth&&this.setState({bottomBarWidth:window.innerWidth-this._sidebarWidth})}},{key:"onSidebarResize",value:function(e){this._sidebarWidth=e,this.setState({bottomBarWidth:window.innerWidth-e})}},{key:"stayInSessions",value:function(){this._stayedInSessionAfterCompletingIt=!0,this.setState({sessionCompletedOverlay:!1})}},{key:"toggleLeaveModal",value:function(e){this.setState({isLeaveModalVisible:e})}},{key:"toggleInactivityModal",value:function(e){e&&this.player.isPlaying?(this.player.pause(),this._shouldPlayVideoOnActiveUser=!0):!e&&this._shouldPlayVideoOnActiveUser&&(this.player.play(),this._shouldPlayVideoOnActiveUser=!1),this.setState({isInactivityModalVisible:e})}},{key:"onSessionCompletedLeave",value:function(){this.toggleLeaveModal(!0)}},{key:"goToChapter",value:function(e){this.setState({sessionCompletedOverlay:!1}),this.props.dispatch(new m.wb(e))}},{key:"calculateSidebarWidth",value:function(){if(this.props.visibleView!==Ho.Host)return this.availableWidth;var e=this._rightPanel&&parseInt((this._rightPanel.style.width||"").replace("px",""),10)||0,t=1;this.props.visibleView===Ho.Host&&this._keyhole&&(t=this._calculateZoom(),e=this._keyhole.screenWidth*t+20);if(this._rightPanel)if(this._rightPanel.clientWidth<this.availableWidth){var n=this.props.sidebarMode.mode===b.V.Expand;n&&this._rightPanel.clientWidth>e?e=this._rightPanel.clientWidth:!n&&this._rightPanel.clientWidth-20>e&&(e=this._rightPanel.clientWidth+20)}else e=this.availableWidth;return this._keyhole&&this._keyhole.setZoomLevel(t),e}},{key:"onConfirmInactivity",value:function(){this.toggleInactivityModal(!1),this.props.onConfirmInactivity()}},{key:"renderStudentUI",value:function(){var e=this,t=this.readySubtitleExists;return p.createElement(p.Fragment,null,p.createElement(Xi.Hotkeys,{handlers:this._keyboardActionHandlers}),p.createElement(Rn,{visible:this.props.currentAttendee.micMute,message:p.createElement("span",null,"Your microphone is blocked. You can find how to unblock it"," ",p.createElement("a",{target:"_blank",href:"https://support.google.com/chrome/answer/2693767"},"here"))}),p.createElement(xn,{vm:this.props.focusVm,template:this.props.focusVmTemplate,attendees:this.props.attendees,course:this.props.course,onEvent:this._appInteractionTracker.logVmInteraction,readOnly:this.isControlled(),cursorPosition:this.isControlled()?this.state.cursorPosition:void 0,currentAttendee:this.props.currentAttendee,broadcastVm:this.props.broadcastVm,dispatch:this.props.dispatch,overlay:this.renderScreenOverlays(),className:this.props.className,controls:!this.props.currentAttendee.controlled,sidebarMode:this.props.sidebarMode,asyncActions:this.props.asyncActions,calculateSidebarWidth:this.calculateSidebarWidth,vmAccessLimitReached:this.isVmAccessLimitReached,onReadWriteInit:this.onVmInit,onConnect:this.onFocusVmConnect,onResize:this.onSplitterResize,onSidebarResize:this.onSidebarResize,onDisconnect:this.onFocusVmDisconnect,onPanelsRefs:function(t,n){return e._rightPanel=n},leftPanelChildren:this.isRecorded?p.createElement(p.Fragment,null,t&&p.createElement(ai,{subscribeToTrack:this._videoTrackHub.subscribeToTrack,hidden:!this.state.showCC||this.rightPanelCCSpace}),p.createElement(li.a,{width:this.state.bottomBarWidth},p.createElement(oi.a,{ref:function(t){return e._captionPlayer=t}}))):void 0},p.createElement(st,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,attendees:this.props.attendees,course:this.props.course,room:this.props.room,currentAttendee:this.props.currentAttendee,visibleView:this.props.visibleView,views:this.props.views,rightPanel:this._rightPanel,sidebarMode:this.props.sidebarMode,expiration:this.expiration,onCountdownTick:this.onTick,onPowerOff:this.onSessionCompletedLeave}),p.createElement(Vn,{ref:this.props.onViewsRef,visible:this.props.visibleView,style:{left:y.a.ButtonsBarWidth+y.a.ButtonsBarBorderWidth},onViewChange:this.onViewChange},this.props.course.type!==b.y.Collaboration?p.createElement(Nn,{id:Ho.Host,icon:p.createElement(D,{attendee:this.props.currentAttendee})},this.renderSidebarOverlay(),p.createElement(qi,{onExpandToggle:this.onToggleExpandOrDock,controlledByGuide:this.isControlled(),vm:this.focusVm,room:this.props.room,broadcastVm:this.props.broadcastVm,cameraStream:this.showCamera?this.state.cameraStream:null,currentAttendee:this.props.currentAttendee,guide:this.props.guide,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,course:this.props.course,isVmConnected:this.state.isFocusVmConnected,currentChapter:this.props.currentChapter,captionPlayer:this._captionPlayer,onboarding:this.props.onboarding,paymentRequired:this.props.paymentRequired,focusAttendee:this.props.focusAttendee,twilioVideo:this.props.twilioVideo,remoteClientManager:this.props.remoteClientManager,sidebarMode:this.props.sidebarMode,onKeyholeRef:this.onKeyholeRef,onSessionCompleted:this.onSessionCompleted,onChapterCompleted:this.props.onChapterCompleted,onPlayerTimeUpdated:this.onPlayerTimeUpdated,onPaidChapter:this.props.onPaidChapter,onVideoDimmensions:this.onVideoDimmensions,onPlaybackRateChange:this.onPlaybackRateChange,onPreviewChallenge:this._onPreviewChallenge,videoContClassName:this.vmContClassName,ccViewer:this.isRecorded&&t?p.createElement(ai,{subscribeToTrack:this._videoTrackHub.subscribeToTrack,hidden:!this.state.showCC||!this.rightPanelCCSpace}):void 0,onCCToggle:t?this.onCCToggle:void 0,showCC:this.state.showCC,onCueChange:this._videoTrackHub.emitTrackEvent,onZoomChange:this._onUserChangedZoom})):null,p.createElement(Nn,{id:Ho.Chat,icon:p.createElement(U,{messages:this.props.messages,attendee:this.props.currentAttendee})},this.props.guide&&p.createElement(jn,{ref:function(t){e._chat=t,e.props.onChatRef(t)},visible:this.props.visibleView===Ho.Chat,room:this.props.room,attendees:this.props.attendees,currentAttendee:this.props.currentAttendee,guide:this.props.guide,dispatch:this.props.dispatch,messages:this.props.messages,asyncActions:this.props.asyncActions,vms:this.props.vms,focusAttendee:this.props.focusAttendee,remoteClientManager:this.props.remoteClientManager,course:this.props.course,broadcastVm:this.props.broadcastVm,onOpenAttachment:this.props.onOpenAttachment,onChallengeSubmissionPreview:this.props.onChallengeSubmissionPreview})),p.createElement(Nn,{id:Ho.Settings,icon:p.createElement(Q,null)},p.createElement(Ji,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,focusVm:this.focusVm,focusAttendee:this.props.focusAttendee,currentAttendee:this.props.currentAttendee,course:this.props.course,remoteClientManager:this.props.remoteClientManager,twilioAudio:this.props.twilioAudio,twilioVideo:this.props.twilioVideo})),this.areFilesSettingsSupported?p.createElement(Nn,{id:Ho.FilesSettings,icon:p.createElement(K,null)},p.createElement(Zi,{dispatch:this.props.dispatch,attendeeVm:this.attendeeVm,focusVm:this.focusVm,isFocusVmConnected:this.state.isFocusVmConnected,remoteClientManager:this.props.remoteClientManager})):null)),p.createElement(ri.a,{visible:this.state.isLeaveModalVisible,onToggle:this.toggleLeaveModal,onResolve:this.props.onFakeSessionEnd}),p.createElement(bi,{visible:this.state.isInactivityModalVisible,onToggle:this.toggleInactivityModal,onConfirmInactivity:this.onConfirmInactivity}))}},{key:"renderLoadingScreen",value:function(){return p.createElement("div",{className:"loading-screen"},p.createElement("span",null,"Loading..."))}},{key:"renderSidebarOverlay",value:function(){return p.createElement(p.Fragment,null,p.createElement(An,{on:this.props.onboarding,className:"sidebar-onboarding"},this.props.course.type===b.y.Live?"This is your host's cloud workspace":"This is a video of your host's cloud workspace"))}},{key:"renderScreenOverlays",value:function(){return p.createElement(p.Fragment,null,p.createElement(Ln,{on:this.props.onboarding}),p.createElement(_i,{on:this.state.sessionCompletedOverlay,course:this.props.course,dispatch:this.props.dispatch,stay:this.stayInSessions,leave:this.onSessionCompletedLeave,goTo:this.goToChapter,currentAttendee:this.props.currentAttendee}))}},{key:"render",value:function(){return this.props.room.id?this.renderStudentUI():this.renderLoadingScreen()}},{key:"_calculateZoom",value:function(){if(!this._keyhole)return 1;var e=null;this.props.views&&(e=Object(ti.findDOMNode)(this.props.views));for(var t=e&&e.clientHeight?e.clientHeight-20:0,n=xi,r=this._keyhole.screenHeight*n,o=this._keyhole.screenWidth*n;(r>t||o>this.availableWidth)&&!(Math.round(100*n)<=100*Ni);)n-=.1,r=this._keyhole.screenHeight*n,o=this._keyhole.screenWidth*n;return n}},{key:"_onBeforeUnloadMsg",value:function(){var e=this;window.onbeforeunload=function(t){if(e.isRecorded&&!e.state.sessionCompletedOverlay){var n="Are you sure you want to leave the session?";return t.returnValue=n,n}}}},{key:"_handleGuideCamera",value:function(e){if(this.props.twilioVideo){var t=null;if(this.props.room.broadcastCamera){var n;if(e)n=e;else{var r=this.props.twilioVideo.getAttendeeVideoInfo(this.props.guide.id);n=r?r.track:null}if(n)t=n.attach().srcObject;else this._checkCameraBrowserSupport()}this.setState({cameraStream:t})}}},{key:"_handleTwilioVideoEvents",value:function(){this.props.twilioVideo&&(this._remoteTrackAddedUnsubscribe=this.props.twilioVideo.onRemoteTrackAdded(this._remoteTrackAdded),this._remoteTrackRemovedUnsubscribe=this.props.twilioVideo.onRemoteTrackRemoved(this._remoteTrackRemoved))}},{key:"_remoteTrackAdded",value:function(e,t){e.identity===this.props.guide.id&&this._handleGuideCamera(t)}},{key:"_remoteTrackRemoved",value:function(e,t){e.identity===this.props.guide.id&&this.props.room.broadcastCamera&&(t.detach(),this._handleGuideCamera())}},{key:"_checkCameraBrowserSupport",value:function(){Object(yr.c)(window.navigator.userAgent)||this.props.dispatch(new m.i(new b.J({type:b.K.Info,title:"Unsupported webcam",text:"The host broadcasted his webcam but your browser does not support webcam functionality"})))}},{key:"_onPreviewChallenge",value:function(e,t){if(e){var n=new b.n({resourceUrl:e,attendeeChapterId:t.id});this.props.onChallengeSubmissionPreview(n)}}},{key:"_onVmInteraction",value:function(e){this.props.currentAttendee.lastActive!==e&&this.props.dispatch(new m.B([{id:this.props.currentAttendee.id,active:e}]))}},{key:"_onInactivityLimitReched",value:function(){this.state.isInactivityModalVisible||this.toggleInactivityModal(!0)}},{key:"isRecorded",get:function(){return this.props.course.type===b.y.Recorded}},{key:"attendeeVm",get:function(){return this.props.vms.get(this.props.currentAttendee.virtualMachineId)}},{key:"showCamera",get:function(){return this.state.cameraStream&&this.props.broadcastVm.id===this.props.guide.virtualMachineId}},{key:"timeToCompleteRecording",get:function(){var e=this.state,t=e.timeToCompleteRecording,n=e.playbackRate;if(t)return Math.floor(t/parseFloat(n))}},{key:"focusVm",get:function(){return this.props.focusVm||new b.lb({})}},{key:"expiration",get:function(){var e=this.props.room.expirationTime,t=this.props.vms.get(this.props.currentAttendee.virtualMachineId);return t&&t.connection&&t.connection.id&&t.connection.maxExpiryTime.getTime()&&(e=t.connection.maxExpiryTime),e}},{key:"endSoonMins",get:function(){return 5/((this.expiration.getTime()-this.props.room.startTime.getTime())/60/1e3)<=.5?5:2}},{key:"lastVMInteraction",get:function(){return this._appInteractionTracker.lastVmInteraction}},{key:"availableWidth",get:function(){return document.body.clientWidth-20}},{key:"isVmAccessLimitReached",get:function(){return this.props.currentAttendee.vmAccessLimitReached}},{key:"isCollaboration",get:function(){return this.props.course.type===b.y.Collaboration}},{key:"player",get:function(){return this.isRecorded&&this._keyhole?this._keyhole:{play:ei.a,pause:ei.a,isPlaying:!1}}},{key:"rightPanelCCSpace",get:function(){return window.innerWidth-this.state.bottomBarWidth>=550}},{key:"readySubtitleExists",get:function(){return this.props.currentChapter&&Object(ii.a)(this.props.currentChapter)}},{key:"vmContClassName",get:function(){return this.readySubtitleExists&&this.state.showCC&&this.rightPanelCCSpace?"cc-visible":""}},{key:"areFilesSettingsSupported",get:function(){var e=this.attendeeVm.templateId,t=this.props.templates.get(e);return!!t&&t.os!==b.L.Docker}}]),t}(p.Component),Object(l.a)(Wo.prototype,"onCCToggle",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onCCToggle"),Wo.prototype),Object(l.a)(Wo.prototype,"onVmInit",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onVmInit"),Wo.prototype),Object(l.a)(Wo.prototype,"onFocusVmConnect",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onFocusVmConnect"),Wo.prototype),Object(l.a)(Wo.prototype,"onFocusVmDisconnect",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onFocusVmDisconnect"),Wo.prototype),Object(l.a)(Wo.prototype,"onKeyholeRef",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onKeyholeRef"),Wo.prototype),Object(l.a)(Wo.prototype,"onTick",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onTick"),Wo.prototype),Object(l.a)(Wo.prototype,"onToggleExpandOrDock",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onToggleExpandOrDock"),Wo.prototype),Object(l.a)(Wo.prototype,"onViewChange",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onViewChange"),Wo.prototype),Object(l.a)(Wo.prototype,"onSessionCompleted",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onSessionCompleted"),Wo.prototype),Object(l.a)(Wo.prototype,"onPlayerTimeUpdated",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onPlayerTimeUpdated"),Wo.prototype),Object(l.a)(Wo.prototype,"onVideoDimmensions",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onVideoDimmensions"),Wo.prototype),Object(l.a)(Wo.prototype,"onPlaybackRateChange",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onPlaybackRateChange"),Wo.prototype),Object(l.a)(Wo.prototype,"onSplitterResize",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onSplitterResize"),Wo.prototype),Object(l.a)(Wo.prototype,"onSidebarResize",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onSidebarResize"),Wo.prototype),Object(l.a)(Wo.prototype,"stayInSessions",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"stayInSessions"),Wo.prototype),Object(l.a)(Wo.prototype,"toggleLeaveModal",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"toggleLeaveModal"),Wo.prototype),Object(l.a)(Wo.prototype,"toggleInactivityModal",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"toggleInactivityModal"),Wo.prototype),Object(l.a)(Wo.prototype,"onSessionCompletedLeave",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onSessionCompletedLeave"),Wo.prototype),Object(l.a)(Wo.prototype,"goToChapter",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"goToChapter"),Wo.prototype),Object(l.a)(Wo.prototype,"calculateSidebarWidth",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"calculateSidebarWidth"),Wo.prototype),Object(l.a)(Wo.prototype,"onConfirmInactivity",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"onConfirmInactivity"),Wo.prototype),Object(l.a)(Wo.prototype,"_remoteTrackAdded",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"_remoteTrackAdded"),Wo.prototype),Object(l.a)(Wo.prototype,"_remoteTrackRemoved",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"_remoteTrackRemoved"),Wo.prototype),Object(l.a)(Wo.prototype,"_onPreviewChallenge",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"_onPreviewChallenge"),Wo.prototype),Object(l.a)(Wo.prototype,"_onVmInteraction",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"_onVmInteraction"),Wo.prototype),Object(l.a)(Wo.prototype,"_onInactivityLimitReched",[d.a],Object.getOwnPropertyDescriptor(Wo.prototype,"_onInactivityLimitReched"),Wo.prototype),Wo),os=n(1154),is=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement(os.a,{title:"Unsupported Browser for Challenge Recording",description:"This session contains challenges that require to record how you solved them. This browser \n          is not supported for creating a challenge solution recording. Please use one of these browsers:"})}}]),t}(p.PureComponent),ss=(n(1459),n(1460)),as=(Qi=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e))).state={joining:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"continue",value:function(){this.setState({joining:!0}),this.props.onContinue()}},{key:"render",value:function(){return p.createElement("div",{className:"paid-session-reminder form-styles"},p.createElement(Pn.a,{visible:this.props.visible,title:this.title,size:"small",onToggle:this.props.onToggle,overrideClose:this.continue},p.createElement("p",{className:"text"},"Pay for remaining tasks only if you love the"," ",this.props.charge===b.t.AfterChapterOne?"first task":"first 2 tasks"),p.createElement("img",{src:ss,width:290,height:125,alt:""}),p.createElement("div",{className:"row"},p.createElement(at.b,{className:"sounds-good-btn",onClick:this.continue,loading:this.state.joining},"Sounds Good!"))))}},{key:"title",get:function(){switch(this.props.charge){case b.t.AfterChapterOne:default:return"First task is FREE";case b.t.AfterChapterTwo:return"First 2 tasks are FREE"}}}]),t}(p.Component),Object(l.a)(Qi.prototype,"continue",[d.a],Object.getOwnPropertyDescriptor(Qi.prototype,"continue"),Qi.prototype),Qi),cs=(n(1461),n(1127)),ls=($i=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"addToMySessions",value:function(){}},{key:"saveCellNumber",value:function(e){e.preventDefault();var t=this.props,n=t.asyncActions,r=t.dispatch,o=Object(cs.b)(this.props.cellNumber||""),i=Object(cs.a)(o,"E.164"),s=this.props.user.set("mobileNumber",i);r(n.updateUser(s)).then((function(){r(new m.i(new b.J({type:b.K.General,text:"The cell number has been added. You will now get SMS reminders for your sessions"})))}))}},{key:"render",value:function(){return p.createElement("div",{className:"student-lobby"},p.createElement("div",{className:"top-label"+(this.props.isAboutToStart?" about-to-start":"")},p.createElement("div",{className:"info"+(this.showAboutToStartButtons?" has-buttons":"")},p.createElement("h1",null,"Lobby - ",this.props.roomCourse.name),this.props.isAboutToStart?this.renderAboutToStartLayout():p.createElement("span",{className:"date rhyme-ellipse-bg blue"},"Starts on ",this.props.startTime)),p.createElement("div",{className:"buttons"},this.showAboutToStartButtons?p.createElement(at.b,{onClick:this.props.onSessionPay},"Join for ",this.coursePrice):null,p.createElement(at.b,{className:"small add-to-sessions",onClick:this.addToMySessions},p.createElement("i",{className:"fa fa-calendar-plus-o"}),"Add to My Sessions"))),p.createElement(_o,{lobbyGuide:this.props.lobbyGuide}),!this.props.user.mobileNumber&&p.createElement("div",{className:"bottom-bar"},p.createElement("p",null,"Get SMS reminder when the session is about to start"),p.createElement("form",{name:"smsReminder",className:"rhyme-ellipse-bg white",onSubmit:this.saveCellNumber},p.createElement("i",{className:"fa fa-mobile"}),p.createElement(to.a,Object.assign({name:"cellNumber",component:at.p,className:"form-input",alwaysShowPlaceholder:!0},{actionDispatch:this.props.dispatch})),p.createElement(at.b,{className:"small submit-form",disabled:this.isFormValid},"Save"))))}},{key:"renderAboutToStartLayout",value:function(){return this.props.paymentRefused&&(new Date>this.props.room.startTime||this.props.timeOver)?p.createElement("span",{className:"rhyme-ellipse-bg green"},"This session is currently running"):this.props.insufficientTime?p.createElement("span",{className:"rhyme-ellipse-bg red"},"Insufficient time to complete the session"):this.props.joining?this.props.waitingForGuide?p.createElement("span",{className:"waiting-for-guide rhyme-ellipse-bg green"},"Waiting for host to join"):p.createElement("span",{className:"rhyme-ellipse-bg green"},"Joining..."):p.createElement("span",{className:"about-to-start rhyme-ellipse-bg green"},"This session will start in ",p.createElement(Kr,{room:this.props.room,onTimeOver:this.props.onTimeOver}))}},{key:"isFormValid",get:function(){return!this.props.valid||!this.props.cellNumber}},{key:"screenshot",get:function(){return Object(bo.c)(this.props.templates,this.props.roomTemplate)}},{key:"coursePrice",get:function(){var e=this.props.room;return Vt.a[e.chargeCurrency]+Object(Vt.b)(parseInt(e.chargeAmount,10))}},{key:"showAboutToStartButtons",get:function(){return this.props.paymentRefused&&(new Date>this.props.room.startTime||this.props.timeOver)||!this.props.insufficientTime&&!this.props.joining&&this.props.room.charge===b.t.BeforeStart&&!this.props.currentAttendee.charged}}]),t}(p.Component),Object(l.a)($i.prototype,"addToMySessions",[d.a],Object.getOwnPropertyDescriptor($i.prototype,"addToMySessions"),$i.prototype),Object(l.a)($i.prototype,"saveCellNumber",[d.a],Object.getOwnPropertyDescriptor($i.prototype,"saveCellNumber"),$i.prototype),$i),ps=Object(no.a)({form:"smsReminder",validate:at.C})(ls),us=Object(ro.a)("smsReminder"),hs=Object(Jr.c)((function(e){return{cellNumber:us(e,"cellNumber")}}))(ps),ds=(es=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._studentInitialization=void 0,n.state={joining:!1,timeOver:!1,insufficientTime:!1,paidSessionReminderVisible:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.props.room&&this.props.room.id&&this.props.currentAttendee&&!this._studentInitialization){this._studentInitialization=!0;var t=Date.now(),n=this.props.room.startTime.getTime();if(!this.props.currentAttendee.charged&&this.props.room.charge===b.t.BeforeStart&&n-6e5<=t&&t<=n)return void this.requestPayment()}!this.props.isAboutToStart||e.isAboutToStart||this.props.room.charge!==b.t.BeforeStart||this.props.sessionEnded||!this.props.currentAttendee||this.props.currentAttendee.charged||this.requestPayment()}},{key:"onTimeOver",value:function(){var e=this.props.room.charge;if(this.setState({timeOver:!0}),this.props.paymentRequired)if(e===b.t.BeforeStart){var t=Date.now(),n=this.props.room,r=n.startTime,o=n.expirationTime,i=o.getTime()-t,s=!1;switch(this.props.roomCourse.type){case b.y.Live:case b.y.Collaboration:s=i>=.2*(o.getTime()-r.getTime())&&i>6e4;break;case b.y.Recorded:s=i>this.props.roomCourse.chapters.map((function(e){return e.duration})).reduce((function(e,t){return e+t}))}s?this.requestPayment():(this.props.dispatch(new m.i(new b.J({type:b.K.Error,title:"Insufficient time",text:"The session will end before you can complete it"}))),this.setState({insufficientTime:!0}))}else this.props.sessionEnded||this.togglePaidSessionReminder(!0);else this.join()}},{key:"requestPayment",value:function(){var e=this,t=new Date,n=this.props.room,r=n.startTime,o=n.expirationTime,i=r<=t&&t<o;return this.props.onSessionPayRequest(!i).then((function(){i&&e.join()}))}},{key:"togglePaidSessionReminder",value:function(e){this.setState({paidSessionReminderVisible:e})}},{key:"join",value:function(){this.setState({joining:!0}),this.props.onReady()}},{key:"render",value:function(){return p.createElement("div",{className:"student-lobby-wrapper"},!this.props.paymentRefused&&!this.props.sessionEnded&&p.createElement(as,{visible:this.state.paidSessionReminderVisible,charge:this.props.room.charge,onToggle:this.togglePaidSessionReminder,onContinue:this.join}),p.createElement(hs,{user:this.props.user,room:this.props.room,roomCourse:this.props.roomCourse,roomTemplate:this.props.roomTemplate,templates:this.props.templates,dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,waitingForGuide:this.props.waitingForGuide,isAboutToStart:this.props.isAboutToStart,startTime:this.props.startTime,lobbyGuide:this.props.lobbyGuide,timeOver:this.state.timeOver,joining:this.state.joining,paymentRefused:this.props.paymentRefused,insufficientTime:this.state.insufficientTime,currentAttendee:this.props.currentAttendee,onTimeOver:this.onTimeOver,onSessionPay:this.requestPayment}))}}]),t}(p.PureComponent),Object(l.a)(es.prototype,"onTimeOver",[d.a],Object.getOwnPropertyDescriptor(es.prototype,"onTimeOver"),es.prototype),Object(l.a)(es.prototype,"requestPayment",[d.a],Object.getOwnPropertyDescriptor(es.prototype,"requestPayment"),es.prototype),Object(l.a)(es.prototype,"togglePaidSessionReminder",[d.a],Object.getOwnPropertyDescriptor(es.prototype,"togglePaidSessionReminder"),es.prototype),Object(l.a)(es.prototype,"join",[d.a],Object.getOwnPropertyDescriptor(es.prototype,"join"),es.prototype),es),ms=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i))))._ended=void 0,n._timeout=void 0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.room,t=e.endTime||e.expirationTime;this._ended=Date.now()>=t.getTime(),this._ended||this._timer(this.props.room)}},{key:"componentDidUpdate",value:function(e){!e.room.endTime&&this.props.room.endTime&&(clearTimeout(this._timeout),this._end({notify:!1})),this._timer(this.props.room)}},{key:"componentWillUnmount",value:function(){clearTimeout(this._timeout)}},{key:"render",value:function(){return null}},{key:"_timer",value:function(e){var t=this;clearTimeout(this._timeout),e.expirationTime.getTime()-Date.now()<864e5&&(this._timeout=setTimeout((function(){return t._end({notify:!0})}),e.expirationTime.getTime()-Date.now()))}},{key:"_end",value:function(e){this._ended||this.props.onSessionEnd(e),this._ended=!0}}]),t}(p.PureComponent),ys=(n(1462),n(1130));!function(e){e.Yes="yes",e.No="no"}(ns||(ns={}));var fs,vs,bs=(ts=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._currentCardLoaded=void 0,n._initalState={saveCard:ns.Yes,cardForm:null,cardBrand:b.m.Unknown,cardPristine:!0,cardValid:!1,loading:!1},n.state=n._initalState,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(){!this._currentCardLoaded&&this.currentCard&&(this._currentCardLoaded=!0,this.setState({cardBrand:this.currentCard.brand,cardValid:!0}))}},{key:"performPayment",value:function(e){var t=this,n=this.props,r=n.dispatch,o=n.asyncActions,i=n.attendee,s=n.room,a=!1,c=new b.l({});return e&&(a=this.state.saveCard===ns.Yes,c=e),r(o.chargeAttendee(s,i,c,a)).then((function(){r(new m.i(new b.J({type:b.K.Dollar,text:"You successfully paid for the session"}))),t.props.onPaymentSuccessful()})).finally(this.stopLoader)}},{key:"submit",value:function(){this.setState({loading:!0}),this.state.cardPristine?this.performPayment():this.state.cardForm?this.state.cardForm.submit():console.error("Couldn't submit card")}},{key:"onCardUpdate",value:function(e){var t=e.valid,n=e.pristine,r=e.brand;this.setState({cardValid:t,cardPristine:n,cardBrand:r})}},{key:"onSaveOptionChange",value:function(e){this.setState({saveCard:e})}},{key:"onToggle",value:function(e){e||this.props.onPaymentRefused(),this.props.onToggle(e)}},{key:"onCardFormRef",value:function(e){this.setState({cardForm:e})}},{key:"stopLoader",value:function(){this.setState({loading:!1})}},{key:"leave",value:function(){this.setState(this._initalState),this._currentCardLoaded=!1,this.onToggle(!1)}},{key:"render",value:function(){return this.props.course?p.createElement("div",{className:"session-pay-up form-styles"},p.createElement(Pn.a,{title:this.props.room.charge===b.t.BeforeStart?"Start the project?":"Continue to paid tasks?",visible:this.props.visible,size:"small",onToggle:this.props.onToggle},this.props.user.unlimitedAccess?p.createElement("p",{className:"unlimited-access-message"},p.createElement("span",null,"You have unlimited access. You can continue without entering a credit card")):p.createElement(p.Fragment,null,p.createElement("p",{className:"text"},this.props.room.charge===b.t.BeforeStart?"Do you want to start the project ":p.createElement(p.Fragment,null,"Do you want to continue to the remaining ",this.chapters.size," task",1!==this.chapters.size?"s":""," ","(",this.chaptersDuration,")"," "),"for ",this.amount),p.createElement(ys.b,{card:this.currentCard,dispatch:this.props.dispatch,hideSaveButton:!0,onRef:this.onCardFormRef,onCardSave:this.performPayment,onUpdate:this.onCardUpdate,onStripeError:this.stopLoader}),this.state.cardBrand===b.m.Rhyme&&p.createElement("div",{className:"row no-rhyme-cards-warning"},"Sorry, Rhyme cards cannot be used to pay for others\u2019 sessions"),!this.state.cardPristine&&p.createElement("div",{className:"row"},p.createElement(at.y,{label:"Save Card?",value:this.state.saveCard,onChange:this.onSaveOptionChange},p.createElement(at.n,{value:ns.Yes},"Yes"),p.createElement(at.n,{value:ns.No},"No")),p.createElement(nr.a,{position:"left",className:"form-row-hint"},"Save this card for future payments",p.createElement("br",null),"(we\u2019ll still verify with you)"))),p.createElement("div",{className:"row button-sequence"},p.createElement(at.b,{className:"empty",onClick:this.leave,disabled:this.state.loading},"No, Leave"),p.createElement(at.b,{disabled:!this.valid,loading:this.state.loading,onClick:this.submit},"Yes, Continue")))):null}},{key:"amount",get:function(){var e=this.props.room.chargeAmount;return Vt.a[b.z.USD]+Object(Vt.b)(parseInt(e,10))}},{key:"chapters",get:function(){var e=this.props,t=e.course;switch(e.room.charge){case b.t.AfterChapterOne:case b.t.AfterChapterTwo:return t.chapters.filter((function(e){return!e.paid}));default:return t.chapters}}},{key:"chaptersDuration",get:function(){var e=this.chapters.map((function(e){return e.duration})).reduce((function(e,t){return e+t}),0);return Object(Rr.a)(e)}},{key:"currentCard",get:function(){return this.props.user.creditCards.find((function(e){return e.primary&&e.brand!==b.m.Rhyme}))}},{key:"valid",get:function(){var e=this.state,t=e.cardForm,n=e.cardValid,r=e.cardBrand;return n&&r!==b.m.Rhyme&&t&&!t.isExpired||this.props.user.unlimitedAccess}}]),t}(p.Component),Object(l.a)(ts.prototype,"performPayment",[d.a],Object.getOwnPropertyDescriptor(ts.prototype,"performPayment"),ts.prototype),Object(l.a)(ts.prototype,"submit",[d.a],Object.getOwnPropertyDescriptor(ts.prototype,"submit"),ts.prototype),Object(l.a)(ts.prototype,"onCardUpdate",[d.a],Object.getOwnPropertyDescriptor(ts.prototype,"onCardUpdate"),ts.prototype),Object(l.a)(ts.prototype,"onSaveOptionChange",[d.a],Object.getOwnPropertyDescriptor(ts.prototype,"onSaveOptionChange"),ts.prototype),Object(l.a)(ts.prototype,"onToggle",[d.a],Object.getOwnPropertyDescriptor(ts.prototype,"onToggle"),ts.prototype),Object(l.a)(ts.prototype,"onCardFormRef",[d.a],Object.getOwnPropertyDescriptor(ts.prototype,"onCardFormRef"),ts.prototype),Object(l.a)(ts.prototype,"stopLoader",[d.a],Object.getOwnPropertyDescriptor(ts.prototype,"stopLoader"),ts.prototype),Object(l.a)(ts.prototype,"leave",[d.a],Object.getOwnPropertyDescriptor(ts.prototype,"leave"),ts.prototype),ts),gs=(n(1463),function(e){return p.createElement("div",{className:"inactive-student-view page-wrapper"},p.createElement(eo.a,{overflow:"hidden"}),p.createElement($r.a,null),p.createElement("div",{className:"message"},p.createElement("h2",null,"We noticed you were inactive for more than ",ui," minutes. We have put your cloud workspace on hold in order to save resources."),p.createElement(at.b,{onClick:e.onActiveUser},"Continue with the project")))}),_s=(n(1464),fs=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).state={sessionPayUpVisible:!1,paymentRefused:!1,isStudentInactive:Object(O.k)(n.props.room.id),completedChapters:Object(gt.Map)([])},n._dontEnterSessionOnPayUp=void 0,n._resolvePayment=void 0,n._rejectPayment=void 0,n._afterPayUpChapter=void 0,n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.room.endTime&&!e.room.endTime&&this.onSessionEnd({notify:!1})}},{key:"onSessionEnd",value:function(e){this.setState({sessionPayUpVisible:!1,paymentRefused:!1}),this.props.onSessionEnd(e)}},{key:"onFakeSessionEnd",value:function(){return this.setState({sessionPayUpVisible:!1,paymentRefused:!1}),this.props.onFakeSessionEnd()}},{key:"toggleSessionPayUp",value:function(e){this.setState({sessionPayUpVisible:e})}},{key:"requestPayment",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._dontEnterSessionOnPayUp=t;var n=new Promise((function(t,n){e._resolvePayment=t,e._rejectPayment=n}));return this.state.sessionPayUpVisible||this.toggleSessionPayUp(!0),n}},{key:"onPaymentSuccessful",value:function(){var e=this;this._resolvePayment();var t=this._dontEnterSessionOnPayUp?Promise.resolve():this.props.dispatch(new m.Hb(!1));Promise.all([t,new Promise((function(t){e.setState({paymentRefused:!1,sessionPayUpVisible:!1},t)}))]).then((function(){if(e.props.room.charge===b.t.AfterChapterOne||e.props.room.charge===b.t.AfterChapterTwo){if(e._afterPayUpChapter)return Object(gi.d)(e._afterPayUpChapter,e.chapters)?e.props.dispatch(new m.i(new b.J({type:b.K.Info,title:"Challenge Incomplete",text:"This task requires you to complete the preceding challenge first"}))):e.props.dispatch(new m.wb(e._afterPayUpChapter)),void(e._afterPayUpChapter=null);var t=0;switch(e.props.room.charge){case b.t.AfterChapterOne:t=1;break;case b.t.AfterChapterTwo:t=2}var n=e.chapters.get(t);e.props.dispatch(new m.wb(n))}}))}},{key:"onPaymentRefused",value:function(){this._rejectPayment(),this.setState({paymentRefused:!0}),this.props.dispatch(new m.Hb(!0))}},{key:"onPaidChapterReached",value:function(e){return this._afterPayUpChapter=e,this.requestPayment(!1)}},{key:"onChapterCompleted",value:function(e){var t=this.state.completedChapters;t=t.set(e,!0),this.setState({completedChapters:t})}},{key:"onConfirmInactivity",value:function(){Object(O.j)(this.props.room.id),this.setState({isStudentInactive:!0},this.props.onConfirmInactivity)}},{key:"onActiveUser",value:function(){var e=this;this.setState({isStudentInactive:!1},(function(){Object(O.g)(e.props.room.id),e.props.onActiveUser()}))}},{key:"render",value:function(){return p.createElement("div",{className:"student-wrapper"},this.isUnsupportedBrowser?p.createElement(is,null):p.createElement(p.Fragment,null,this.state.isStudentInactive&&!this.props.sessionEnded?this.renderInactiveView():this.props.roomLobby?this.renderLobby():this.renderStudentRoomUI(),this.props.currentAttendee&&this.props.room.charge!==b.t.Never&&p.createElement(bs,{dispatch:this.props.dispatch,user:this.props.user,room:this.props.room,asyncActions:this.props.asyncActions,attendee:this.props.currentAttendee,course:this.props.roomCourse,visible:this.state.sessionPayUpVisible,onToggle:this.toggleSessionPayUp,onPaymentRefused:this.onPaymentRefused,onPaymentSuccessful:this.onPaymentSuccessful})))}},{key:"renderLobby",value:function(){var e=this.props.currentAttendee?p.createElement(ds,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,user:this.props.user,room:this.props.room,roomCourse:this.props.roomCourse,roomTemplate:this.props.roomTemplate,currentAttendee:this.props.currentAttendee,templates:this.props.templates,waitingForGuide:this.props.waitingForGuide,paymentRequired:this.paymentRequired,sessionEnded:this.props.sessionEnded,paymentRefused:this.state.paymentRefused,onReady:this.props.onReady,onSessionPayRequest:this.requestPayment}):null,t=p.cloneElement(this.props.lobbyWrapper,{completedChaptersNum:this.state.completedChapters.size},e);return p.createElement(p.Fragment,null,t,p.createElement(ms,{room:this.props.room,onSessionEnd:this.onSessionEnd}))}},{key:"renderStudentRoomUI",value:function(){return this.props.currentAttendee&&this.props.focusAttendee?p.createElement(rs,{sidebarMode:this.props.sidebarMode,course:this.props.roomCourse,currentChapter:this.currentChapter,room:this.props.room,currentAttendee:this.props.currentAttendee,focusVm:this.props.focusVm,focusVmTemplate:this.props.focusVmTemplate,focusAttendee:this.props.focusAttendee,guide:this.props.guide,broadcastVm:this.props.broadcastVm||new b.lb({}),templates:this.props.templates,attendees:this.props.attendees,dispatch:this.props.dispatch,messages:this.props.messages,onSessionEnd:this.onSessionEnd,twilioAudio:this.props.twilioAudio,twilioVideo:this.props.twilioVideo,asyncActions:this.props.asyncActions,remoteClientManager:this.props.remoteClientManager,vms:this.props.vms,className:this.props.className,visibleView:this.props.visibleView,views:this.props.views,user:this.props.user,onMount:this.props.onMount,onViewChange:this.props.onViewChange,onViewsRef:this.props.onViewsRef,onChatRef:this.props.onChatRef,onPaidChapter:this.onPaidChapterReached,onOpenAttachment:this.props.onOpenAttachment,onChallengeSubmissionPreview:this.onChallengeSubmissionPreview,onChapterCompleted:this.onChapterCompleted,onFakeSessionEnd:this.onFakeSessionEnd,onboarding:this.props.onboarding,paymentRequired:this.paymentRequired,activityTrackerBuffer:this.props.activityTrackerBuffer,onConfirmInactivity:this.onConfirmInactivity}):null}},{key:"renderInactiveView",value:function(){return p.createElement(gs,{onActiveUser:this.onActiveUser})}},{key:"onChallengeSubmissionPreview",value:function(e){var t=this.chapters.find((function(t){return t.id===e.attendeeChapterId}));t?this.props.onChallengeSubmissionPreview(e,t):console.error("Cannot find attendee chapter for challenge submission with id ".concat(e.id))}},{key:"chapters",get:function(){return this.props.roomCourse.chapters}},{key:"currentChapter",get:function(){var e=this,t=null;return this.props.roomCourse&&this.chapters&&this.props.currentChapter&&(t=this.chapters.find((function(t){return t.id===e.props.currentChapter}))),t}},{key:"paymentRequired",get:function(){return!!this.props.currentAttendee&&this.props.room.charge!==b.t.Never&&!this.props.currentAttendee.charged}},{key:"isUnsupportedBrowser",get:function(){return!(Object(yr.b)(window.navigator.userAgent)||!this.props.roomCourse)&&!!this.chapters.find((function(e){return Object(gi.g)(e)}))}}]),t}(p.PureComponent),Object(l.a)(fs.prototype,"onSessionEnd",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"onSessionEnd"),fs.prototype),Object(l.a)(fs.prototype,"onFakeSessionEnd",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"onFakeSessionEnd"),fs.prototype),Object(l.a)(fs.prototype,"toggleSessionPayUp",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"toggleSessionPayUp"),fs.prototype),Object(l.a)(fs.prototype,"requestPayment",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"requestPayment"),fs.prototype),Object(l.a)(fs.prototype,"onPaymentSuccessful",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"onPaymentSuccessful"),fs.prototype),Object(l.a)(fs.prototype,"onPaymentRefused",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"onPaymentRefused"),fs.prototype),Object(l.a)(fs.prototype,"onPaidChapterReached",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"onPaidChapterReached"),fs.prototype),Object(l.a)(fs.prototype,"onChapterCompleted",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"onChapterCompleted"),fs.prototype),Object(l.a)(fs.prototype,"onConfirmInactivity",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"onConfirmInactivity"),fs.prototype),Object(l.a)(fs.prototype,"onActiveUser",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"onActiveUser"),fs.prototype),Object(l.a)(fs.prototype,"onChallengeSubmissionPreview",[d.a],Object.getOwnPropertyDescriptor(fs.prototype,"onChallengeSubmissionPreview"),fs.prototype),fs),ks=(n(1465),function(){return p.createElement("div",{className:"missing-lti-attendee-error page-wrapper"},p.createElement(eo.a,{overflow:"hidden"}),p.createElement($r.a,null),p.createElement("div",{className:"error-message"},p.createElement("h1",null,"This project can only be accessed through ",p.createElement("a",{href:"https://www.coursera.org/search?query=rhyme"},"Coursera"))))});n.d(t,"UserWasInactive",(function(){return Es})),n.d(t,"RoomWrapper",(function(){return Ss}));var Os,ws="control-vm-mode",Cs="broadcast-vm-mode",Es=Symbol("UserWasInactive"),js=(vs=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(a.a)(t).call(this,e)))._guideAttemptAllocateVMTimer=void 0,n._lobbyPromiseResolve=void 0,n._lobbyReady=new Promise((function(e){return n._lobbyPromiseResolve=e})),n._isUserActivePromiseResolve=void 0,n._isUserActivePromiseReject=void 0,n._isUserActive=new Promise((function(e,t){n._isUserActivePromiseResolve=e,n._isUserActivePromiseReject=t})),n._onboardingCb=void 0,n._onboardingTimeout=void 0,n._guideInitUnsubscribe=void 0,n._studentInitUnsubscribe=void 0,n._waitingForGuideUnsubscribe=void 0,n._sessionEndUnsubscribe=void 0,n._chat=void 0,n.state={sessionEnded:!1,waitingForGuide:!1,className:void 0,onboarding:!1,showCourseExperienceSummary:!1,visibleView:"",views:null,previewedAttachment:null,previewModal:!1,isPreviewChallengeModalVisible:!1,allowActionsOnChallengePreview:!1,showMissingLtiAttendeeError:!1,challengeSubmission:null,challengeSubmissionChapter:null},Object(_.c)(),n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.dispatch(new m.Hb(!0)),this._init();var t=function(){e.setState({waitingForGuide:!1}),e.props.dispatch(new m.Hb(!1))};this._guideInitUnsubscribe=this.props.attendeeInitializer.onGuideInitialized(t),this._studentInitUnsubscribe=this.props.attendeeInitializer.onStudentInitialized(t),this._waitingForGuideUnsubscribe=this.props.attendeeInitializer.onStudentWaitingForGuide((function(){return e.setState({waitingForGuide:!0})})),this._sessionEndUnsubscribe=this.props.attendeeInitializer.onSessionEnded((function(){return e._endSession()}))}},{key:"componentDidUpdate",value:function(e,t){if(this.props.currentRoom&&!e.currentRoom&&(Object(O.k)(this.props.currentRoom)?this._isUserActivePromiseReject(Es):this._isUserActivePromiseResolve()),!t.views&&this.state.views&&!this.state.visibleView){var n=this.state.views.props.children.filter((function(e){return e}));if(n.length){var r=n[0].props.id;this.onViewChange(r)}}!e.roomCourse&&this.props.roomCourse&&(document.title=this.pageTitle)}},{key:"componentWillUnmount",value:function(){clearTimeout(this._guideAttemptAllocateVMTimer),clearTimeout(this._onboardingTimeout),this.props.attendeeInitializer.destroy(),document.removeEventListener("click",this._onboardingCb),this._guideInitUnsubscribe&&this._guideInitUnsubscribe(),this._studentInitUnsubscribe&&this._studentInitUnsubscribe(),this._waitingForGuideUnsubscribe&&this._waitingForGuideUnsubscribe(),this._sessionEndUnsubscribe&&this._sessionEndUnsubscribe(),this.props.dispatch(new m.P("session_only_notification"))}},{key:"componentWillReceiveProps",value:function(e){Object(g.b)().isAuthorized()&&(this._handleControlStateChange(e),this._handleNewChatMessages(e))}},{key:"onSessionEnd",value:function(e){if(document.title="Rhyme",e.notify){var t=new b.J({type:b.K.General,text:"Session ended",ttl:7500});this.props.dispatch(new m.i(t))}this._endSession()}},{key:"onFakeSessionEnd",value:function(){return this._endSession(),Promise.resolve()}},{key:"onConfirmInactivity",value:function(){this._cleanResources()}},{key:"onActiveUser",value:function(){this._isUserActive=Promise.resolve(),this._init()}},{key:"guideAttemptAllocateVM",value:function(){this._lobbyPromiseResolve()}},{key:"determineControlState",value:function(){if(this.props.roomCourse.type===b.y.Collaboration){var e=this.props.currentAttendee;if(!e)return;var t=this.props.attendees.find((function(t){return t.id!==e.id}));return e.access===b.f.Guide&&t&&t.controlled||e.access===b.f.Student&&!e.controlled?this.setState({className:ws}):void 0}this._broadcastState()?this.setState({className:Cs}):this._controlState()&&this.setState({className:ws})}},{key:"onViewChange",value:function(e){this.setState({visibleView:e})}},{key:"onViewsRef",value:function(e){this.setState({views:e})}},{key:"onChatRef",value:function(e){this._chat=e}},{key:"onOpenAttachment",value:function(e){this.setState({previewedAttachment:e,previewModal:!0})}},{key:"onPreviewAttachmentModalToggle",value:function(e){this.setState({previewModal:e,previewedAttachment:null})}},{key:"onPreviewChallengeModalToggle",value:function(e){var t={isPreviewChallengeModalVisible:e};e||(t=Object(r.a)({},t,{challengeSubmission:null,challengeSubmissionChapter:null,allowActionsOnChallengePreview:!1})),this.setState(t)}},{key:"onStudentPreviewChallenge",value:function(e,t){this._onPreviewChallenge(e,t,!1)}},{key:"onGuidePreviewChallenge",value:function(e,t){this._onPreviewChallenge(e,t,!0)}},{key:"renderAttendeeLayout",value:function(){return this.props.currentAttendee?this.props.currentAttendee.access===b.f.Guide?this.guideWrapper:this.studentWrapper:this.state.sessionEnded?this.lobbyWrapper:p.createElement(w.a,null)}},{key:"render",value:function(){return p.createElement("div",{className:"room-wrapper"},p.createElement(k.a,null),this.state.showMissingLtiAttendeeError?p.createElement(ks,null):p.createElement("div",{className:"room-wrapper-ui"},this.renderAttendeeLayout(),p.createElement(Yo,{visible:this.state.previewModal,attachment:this.state.previewedAttachment,onToggle:this.onPreviewAttachmentModalToggle}),this.challengeSubmission&&this.props.currentAttendee&&this.state.challengeSubmissionChapter?p.createElement(Qo,{dispatch:this.props.dispatch,asyncActions:this.props.asyncActions,visible:this.state.isPreviewChallengeModalVisible,currentAttendee:this.props.currentAttendee,challengeSubmission:this.challengeSubmission,challengeSubmissionChapter:this.state.challengeSubmissionChapter,onToggle:this.onPreviewChallengeModalToggle,allowActions:this.state.allowActionsOnChallengePreview}):null))}},{key:"_init",value:function(){var e=this;Promise.all([this.props.attendeeInitializer.createOrLoadAttendee(this.roomSecret),this._lobbyReady,this._isUserActive]).then((function(){return e._initializeAttendee()})).then((function(){return e.props.dispatch(new m.Y)})).then((function(){return e._onboarding()})).catch((function(t){t!==Es&&t!==f.c&&(t!==f.b?Object(v.Jb)(window.location.pathname,v.ob)&&e.props.dispatch(new m.i(new b.J({type:b.K.Error,title:"Initialization error",text:"Please refresh your browser",context:"session_only_notification"}))):e.setState({showMissingLtiAttendeeError:!0}))}))}},{key:"_initializeAttendee",value:function(){var e=this;return this.props.currentAttendee&&this.props.currentAttendee.access===b.f.Guide?this.props.attendeeInitializer.initializeGuide().catch((function(){!function t(){e.props.attendeeInitializer.initializeGuide().then((function(){return clearTimeout(e._guideAttemptAllocateVMTimer)})).catch((function(){clearTimeout(e._guideAttemptAllocateVMTimer),e._guideAttemptAllocateVMTimer=setTimeout(t,2e3)}))}()})):this.props.currentAttendee&&this.props.currentAttendee.access===b.f.Student?(console.log("Student is already here. Trying to initialize or load student if the guide is ready."),this.props.attendeeInitializer.initializeOrLoadStudentAfterSessionStarted()):(this.props.currentAttendee||console.log("Student is not here yet. Waiting for guide"),Promise.resolve())}},{key:"_controlState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return this.isGuide?!!e.attendees.find((function(e){return e.controlled})):e.focusAttendee&&e.currentAttendee&&e.focusAttendee.id===e.currentAttendee.id&&e.currentAttendee.controlled}},{key:"_broadcastState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return this.isGuide?this._controlState(e)&&e.broadcastVm&&e.currentAttendee&&e.broadcastVm.id!==e.currentAttendee.virtualMachineId:e.broadcastVm&&e.currentAttendee&&e.currentAttendee.virtualMachineId===e.broadcastVm.id&&""!==e.broadcastVm.id}},{key:"_handleControlStateChange",value:function(e){var t=this.props,n=t.currentAttendee,r=t.focusAttendee,o=t.broadcastVm,i=t.roomCourse;if(e.currentAttendee&&e.focusAttendee&&n&&r&&(i.type!==b.y.Live||o)){var s=e.currentAttendee,a=e.attendees.find((function(e){return e.id!==s.id}));if(e.roomCourse.type!==b.y.Collaboration)if(this._broadcastState(e)&&!this._broadcastState()){var c=this.isGuide?"You are broadcasting ".concat(e.focusAttendee.name,"'s cloud workspace to everyone"):y.a.ShowWebcam?"The host is in a video call with you and is broadcasting your cloud workspace to everyone":"The host is broadcasting your cloud workspace to everyone";this.props.dispatch(new m.i(new b.J({type:b.K.Bullhorn,title:"Broadcasting",text:c,context:"session_only_notification"}))),this.setState({className:Cs})}else if(this._controlState(e)&&(!this._controlState()||this._broadcastState()&&!this._broadcastState(e))){var l=this.isGuide?"You took control over ".concat(e.focusAttendee.name,"'s cloud workspace"):y.a.ShowWebcam?"The host is in a video call with you and is controlling your cloud workspace":"The host is controlling your cloud workspace";this.props.dispatch(new m.i(new b.J({type:b.K.MousePointer,title:"Controlling",text:l,context:"session_only_notification"}))),this.setState({className:ws})}else!this._controlState(e)&&this._controlState()&&this.setState({className:void 0});else e.currentAttendee.access===b.f.Guide?a&&a.controlled?this.setState({className:ws}):this.setState({className:void 0}):e.currentAttendee.controlled?this.setState({className:void 0}):this.setState({className:ws})}}},{key:"_handleNewChatMessages",value:function(e){var t=this;if(this.props.currentAttendee){var n=this.isGuide?En.Chat:Ho.Chat;if(!this.props.messages.pristine&&e.messages.entity.size>this.props.messages.entity.size){var r=e.messages.entity.last(),o="@system@"===r.sender,i=this.state.visibleView!==n,s=this._chat&&r.sender!==this.props.currentAttendee.id&&(this._chat.state.recipientId&&this._chat.state.recipientId!==r.sender||this._chat.state.audience===Yt.Private&&r.public||this._chat.state.audience===Yt.Public&&!r.public),a=this.props.attendees.get(r.sender),c=function(){t.state.views&&t.state.visibleView!==n&&t.state.views.switchView(n),setTimeout((function(){t._chat&&t._chat.onSelectRecipient(r.public?Yt.Public:Yt.Private,r.public?null:a)}))};Object(_.a)()&&"hidden"===document.visibilityState&&Object(_.b)("Message from ".concat(o?"system":a.name,' in "').concat(this.props.roomCourse.name,'"'),r.text,1e4,c),r.sender===this.props.currentAttendee.id||r.public||!i&&!s||this.props.dispatch(new m.i(new b.J({type:b.K.Chat,title:p.createElement(Sn,{attendees:this.props.attendees,message:r,onClick:c}),text:r.text,context:"session_only_notification",voiceOver:"Message from ".concat(o?"system":a.name," - ").concat(r.text)})))}}}},{key:"_onboarding",value:function(){var e=this;this.setState({onboarding:!0}),this._onboardingCb=function(){e.setState({onboarding:!1})},document.addEventListener("click",this._onboardingCb),this._onboardingTimeout=setTimeout(this._onboardingCb,1e4)}},{key:"_endSession",value:function(){this._cleanResources(),this.props.currentAttendee&&this.props.currentAttendee.access===b.f.Student&&this.setState({showCourseExperienceSummary:!0}),this.props.dispatch(new m.Hb(!0)),this.setState({sessionEnded:!0})}},{key:"_cleanResources",value:function(){this.props.dispatch(new m.S),this.props.dispatch(new m.T),this.props.dispatch(new m.Z),this.props.dispatch(new m.db)}},{key:"_onPreviewChallenge",value:function(e,t,n){this.setState({isPreviewChallengeModalVisible:!0,allowActionsOnChallengePreview:n,challengeSubmission:e,challengeSubmissionChapter:t})}},{key:"isGuide",get:function(){if(this.props.currentAttendee)return this.props.currentAttendee.access===b.f.Guide}},{key:"roomSecret",get:function(){return this.props.match.params.secret}},{key:"challengeSubmission",get:function(){var e;return this.state.challengeSubmission&&(e=this.props.challengeSubmissions.get(this.state.challengeSubmission.id)),e||this.state.challengeSubmission}},{key:"pageTitle",get:function(){return"Rhyme - "+this.props.roomCourse.name}},{key:"room",get:function(){return this.props.rooms.get(this.props.currentRoom)||new b.Q({})}},{key:"focusVm",get:function(){if(this.props.focusAttendee)return this.props.vms.get(this.props.focusAttendee.virtualMachineId)}},{key:"focusVmTemplate",get:function(){return this.focusVm?this.props.templates.get(this.focusVm.templateId):void 0}},{key:"lobbyWrapper",get:function(){return p.createElement(Ko,{showCourseExperienceSummary:this.state.showCourseExperienceSummary,sessionEnded:this.state.sessionEnded})}},{key:"guideWrapper",get:function(){return p.createElement(Zr,{roomCourse:this.props.roomCourse,room:this.room,roomLobby:this.props.roomLobby,currentAttendee:this.props.currentAttendee,lobbyWrapper:this.lobbyWrapper,focusVm:this.focusVm,focusVmTemplate:this.focusVmTemplate,focusAttendee:this.props.focusAttendee,broadcastVm:this.props.broadcastVm||new b.lb({}),user:this.props.user,attendees:this.props.attendees,templates:this.props.templates,dispatch:this.props.dispatch,messages:this.props.messages.entity,onSessionEnd:this.onSessionEnd,twilioAudio:this.props.twilioAudio,twilioVideo:this.props.twilioVideo,asyncActions:this.props.asyncActions,sidebarMode:this.props.sidebarMode,vms:this.props.vms,challengeSubmissions:this.props.challengeSubmissions,remoteClientManager:this.props.remoteClientManager,className:this.state.className,visibleView:this.state.visibleView,views:this.state.views,onMount:this.determineControlState,onViewChange:this.onViewChange,onViewsRef:this.onViewsRef,onChatRef:this.onChatRef,onOpenAttachment:this.onOpenAttachment,onChallengeSubmissionPreview:this.onGuidePreviewChallenge,onboarding:this.state.onboarding,onReady:this.guideAttemptAllocateVM})}},{key:"studentWrapper",get:function(){return p.createElement(_s,{room:this.room,roomCourse:this.props.roomCourse,roomLobby:this.props.roomLobby,currentAttendee:this.props.currentAttendee,lobbyWrapper:this.lobbyWrapper,sidebarMode:this.props.sidebarMode,focusVm:this.focusVm,focusVmTemplate:this.focusVmTemplate,focusAttendee:this.props.focusAttendee,guide:this.props.guide,broadcastVm:this.props.broadcastVm||new b.lb({}),attendees:this.props.attendees,dispatch:this.props.dispatch,location:this.props.location,messages:this.props.messages.entity,onSessionEnd:this.onSessionEnd,twilioAudio:this.props.twilioAudio,twilioVideo:this.props.twilioVideo,asyncActions:this.props.asyncActions,remoteClientManager:this.props.remoteClientManager,vms:this.props.vms,className:this.state.className,visibleView:this.state.visibleView,views:this.state.views,user:this.props.user,onMount:this.determineControlState,onViewChange:this.onViewChange,onViewsRef:this.onViewsRef,onChatRef:this.onChatRef,onOpenAttachment:this.onOpenAttachment,onChallengeSubmissionPreview:this.onStudentPreviewChallenge,onFakeSessionEnd:this.onFakeSessionEnd,onConfirmInactivity:this.onConfirmInactivity,onActiveUser:this.onActiveUser,onboarding:this.state.onboarding,activityTrackerBuffer:this.props.activityTrackerBuffer,roomTemplate:this.props.roomTemplate,templates:this.props.templates,currentChapter:this.props.currentChapter,waitingForGuide:this.state.waitingForGuide,sessionEnded:this.state.sessionEnded,onReady:this.guideAttemptAllocateVM})}}]),t}(p.Component),Object(l.a)(vs.prototype,"onSessionEnd",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onSessionEnd"),vs.prototype),Object(l.a)(vs.prototype,"onFakeSessionEnd",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onFakeSessionEnd"),vs.prototype),Object(l.a)(vs.prototype,"onConfirmInactivity",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onConfirmInactivity"),vs.prototype),Object(l.a)(vs.prototype,"onActiveUser",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onActiveUser"),vs.prototype),Object(l.a)(vs.prototype,"guideAttemptAllocateVM",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"guideAttemptAllocateVM"),vs.prototype),Object(l.a)(vs.prototype,"determineControlState",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"determineControlState"),vs.prototype),Object(l.a)(vs.prototype,"onViewChange",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onViewChange"),vs.prototype),Object(l.a)(vs.prototype,"onViewsRef",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onViewsRef"),vs.prototype),Object(l.a)(vs.prototype,"onChatRef",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onChatRef"),vs.prototype),Object(l.a)(vs.prototype,"onOpenAttachment",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onOpenAttachment"),vs.prototype),Object(l.a)(vs.prototype,"onPreviewAttachmentModalToggle",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onPreviewAttachmentModalToggle"),vs.prototype),Object(l.a)(vs.prototype,"onPreviewChallengeModalToggle",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onPreviewChallengeModalToggle"),vs.prototype),Object(l.a)(vs.prototype,"onStudentPreviewChallenge",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onStudentPreviewChallenge"),vs.prototype),Object(l.a)(vs.prototype,"onGuidePreviewChallenge",[d.a],Object.getOwnPropertyDescriptor(vs.prototype,"onGuidePreviewChallenge"),vs.prototype),vs),Ss=(Os=js,function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){!e.currentAttendee&&this.props.currentAttendee&&this.props.currentAttendee}},{key:"render",value:function(){return u.a.createElement(Os,this.props)}}]),t}(u.a.Component))},2e3:function(e,t,n){"use strict";n.r(t);var r=n(1467);n.d(t,"RoomWrapper",(function(){return r.RoomWrapper}))}}]);
//# sourceMappingURL=12.0845feed.chunk.js.map